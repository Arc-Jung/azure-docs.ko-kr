<properties title="Azure Machine Learning API service operations" pageTitle="Machine Learning API service operations | Azure" description="Creating and managing Azure Machine Learning web services" metaKeywords="" services="" solutions="" documentationCenter="" authors="derrickv" videoId="" scriptId="" />

<tags ms.service="machine-learning" ms.workload="tbd" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="derrickv" />

# Azure 기계 학습 API 서비스 작업

일반적인 Microsoft Azure 기계 학습 프로젝트에는 다음 개략적인 단계가 포함됩니다.

1.  데이터 가져오기, 분석 및 준비
2.  다양한 기계 학습 알고리즘을 활용하여 기계 학습 실험 만들기
3.  학습된 모델 교육, 테스트 및 생성
4.  학습된 모델을 사용하여 작업 워크플로 만들기 및 워크플로를 프로덕션에 배포
5.  모델 및 후속 업데이트 성능 모니터링

> "실험"이라는 용어는 데이터 입력 및 조작, 강사 및 채점자가 DAG(Directed Acyclic Graph) 형식으로 포함될 수 있는 대화형 워크플로를 설명하는 데 사용됩니다. 워크플로가 Azure 웹 서비스로 게시되면 더 이상 대화형 워크플로가 아닙니다. 즉, 워크플로를 변경하려면 모델을 업데이트하고 다시 게시하여 웹 서비스와 해당 동작을 업데이트해야 합니다.

데이터 과학자는 대개, 기계 학습 모델이 엔지니어링 및 운영 팀에 배포되어 프로덕션에서 기계 학습 모델을 사용할 수 있도록 프로덕션 시스템으로 통합될 때까지 1-3단계를 여러 번 반복하여 수행합니다.

기계 학습 모델을 프로덕션 시스템에 통합 및 배포하는 기존 프로세스는 모델 빌드에 사용된 코드(예: R, Python, C# 또는 Java), 플랫폼 통합 및 인프라 고려 사항, 배포 계획에 따라 몇 주나 몇 달이 걸릴 수 있습니다.

Azure 기계 학습은 모델 만들기 및 평가를 쉽고 직관적인 경험으로 만들고 실험을 Azure의 웹 서비스로 배포하는 단순 프로세스를 제공하는 방식으로 이 프로세스를 간소화하므로 모델 실험부터 프로덕션에서 모델을 웹 서비스로 실행할 때까지 전체 시간이 크게 단축됩니다.

이 문서에서는 기계 학습 실험에서 Azure 기계 학습 웹 서비스를 설정하는 개념 및 단계에 대해 설명합니다.

# Azure 기계 학습 프로세스 개요

Azure 기계 학습에서는 Azure 기계 학습 스튜디오(기계 학습 스튜디오)에 정의된 기계 학습 실험에서 웹 서비스를 만들 수 있습니다. Azure 기계 학습 웹 서비스를 사용하여 실제 입력 데이터를 기반으로 실시간으로 또는 일괄 처리 모드로 예측을 수행할 수 있습니다.

다음 다이어그램에서는 단계를 개략적으로 두 부분으로 보여 줍니다. 먼저 모델을 빌드하고 두 번째로 모델을 웹 서비스로 게시합니다. 이 문서에서는 그림 1 다이어그램 - 점수 매기기 웹 서비스 게시의 오른쪽에 초점을 맞추고 해당 프로세스에 포함된 개념을 설명합니다.

![][0]

그림 1: 점수 매기기 웹 서비스 프로비전, 빌드 및 게시

# Azure 기계 학습 웹 서비스

기계 학습 컨텍스트에서 웹 서비스는 외부 응용 프로그램과 기계 학습 워크플로 간에 통신을 제공하는 소프트웨어 인터페이스입니다. 웹 서비스는 점수 매기기 모델과 실시간으로 통신하여 예측 결과를 받고 외부 클라이언트 응용 프로그램에 결과를 통합할 수 있는 방법을 제공합니다. Azure 기계 학습은 Azure 기계 학습 웹 서비스의 배포, 호스트 및 관리에 Microsoft Azure를 활용합니다. Azure 기계 학습을 사용하여 두 가지 서비스를 만들 수 있습니다.

## RRS(요청-응답 서비스)

RRS(요청-응답 서비스)는 대기 시간이 짧고, 확장성이 높은 웹 서비스로, 실험 환경에서 생성하여 게시하는 상태 비저장 모델에 대한 인터페이스를 제공하는 데 사용됩니다.

-   REST API: RRS는 RESTFul 웹 서비스입니다.
-   서비스 인터페이스: RRS 웹 서비스 인터페이스는 Azure 기계 학습 스튜디오 실험에서 입/출력 포트를 사용하여 실험 설정의 일부로 정의됩니다.
-   개발 단계: Azure 기계 학습 워크플로의 일부인 RRS 서비스는 스테이징 환경에서 처음 생성되고 이 환경에서 테스트할 수 있습니다. RRS 서비스가 완전하고 프로덕션을 위한 준비가 되었다고 판단되면 프로덕션 환경에 배포됩니다.
-   Azure에 배포됨: RRS 배포 결과는 Azure 웹 서비스 끝점입니다.
-   인터페이스 매개 변수: RRS 서비스에 대한 요청은 스튜디오에서 정의된 실험을 사용하여 점수를 매겨야 하는 데이터입니다. 응답은 모델 예측의 결과입니다.
-   응답 값: RRS는 단일 입력 매개 변수 행을 수락하고 단일 행을 출력으로 생성합니다. 출력 행에는 여러 열이 포함될 수 있습니다.

## BES(일괄 처리 실행 서비스)

BES(일괄 처리 실행 서비스)는 데이터 레코드의 일과 처리에 대한 점수를 비동기적으로 계산하는 서비스입니다. BES의 입력은 RRS에 사용되는 데이터 입력과 유사합니다. 가장 중요한 차이는 BES에서는 Blob, Azure의 테이블, SQL Azure, HD Insight(Hive 쿼리), HTTP 소스 등의 다양한 소스에서 레코드 블록을 읽는다는 것입니다. 점수를 계산한 결과는 Azure Blob 저장소의 파일 출력이며 저장소 끝점의 데이터는 응답으로 반환됩니다.

BES는 실행 중인 점수 매기기 프로세스의 상태를 가져오고 요청을 취소하기 위한 인터페이스도 제공합니다. BES는 대용량 데이터에 대해 모델 패키지를 실행할 수 있습니다.

-   REST API: BES는 RESTFul 웹 서비스입니다.
-   서비스 인터페이스: RRS와 마찬가지로 BES 웹 서비스 인터페이스는 Azure 기계 학습 스튜디오 실험에서 입/출력 포트를 사용하여 모델 설정의 일부로 정의됩니다.
-   개발 단계: BES를 만드는 워크플로의 일부인 BES 서비스는 스테이징 환경에서 처음 생성되고 이 환경에서 테스트할 수 있습니다. RRS 서비스가 완전하고 프로덕션을 위한 준비가 되면 프로덕션 환경에 배포됩니다.
-   Azure에 배포됨: BES 배포 결과는 Azure 웹 서비스 끝점입니다.
-   인터페이스 매개 변수: BES 서비스에 대한 요청은 점수를 매길 레코드의 SAS 입력 또는 Azure Blob의 파일에 대한 URL입니다. 응답은 Azure Blob에 기록되고 응답 저장소 끝점의 URL이 반환됩니다.

# Azure 기계 학습 웹 서비스 게시

Azure 기계 학습 스튜디오는 그래픽 사용자 인터페이스에서 다양한 데이터 원본, 데이터 조작 및 유효성 검사 모듈과 기계 학습 알고리즘을 사용하여 기계 학습 실험을 쉽게 만들고 실행할 수 있는 브라우저 기반 응용 프로그램을 제공합니다. 기계 학습 스튜디오의 실험은 데이터 처리 모듈의 DAG(Directed Acyclic Graph)로 구성됩니다.

실험이 설정되고 데이터를 학습하도록 실행되고 나면 학습된 모델로 저장하고 점수 매기기에 사용할 수 있습니다. 그리고 나서 학습된 모델은 점수 매기기 실험 또는 워크플로에서 사용되고 Azure 웹 서비스로 게시됩니다.

## 학습 실험

실험에는 데이터 로드 및 조작, 기계 학습 알고리즘 적용, 결과 평가에 대한 다양한 모듈이 포함될 수 있습니다. 학습 모델에서는 학습 데이터 집합과 학습 알고리즘을 사용하여 응답을 예측합니다.

모델 실행이 완료되고 나면 학습 모델을 테스트 데이터 집합 및 쿼리 점수를 매기는 데 다시 사용할 수 있는 구성 요소로 저장할 수 있습니다.

![][1]

그림 2: 실험에 학습된 모델을 저장하는 과정을 보여 주는 샘플

저장된 학습된 모델은 응용 프로그램의 학습된 모델 섹션에서 사용할 수 있습니다.

![][2]

그림 3: 모델 목록을 보여 주는 학습된 모델 섹션

## 점수 매기기 실험

점수 매기기 실험에서는 학습된 모델 및 샘플 데이터를 사용하여 예측을 생성합니다.

위의 그림 1에서는 실험에서 점수 매기기 모델의 사용법을 보여 줍니다. 스튜디오에서 이 모델은 기계 학습 모듈의 일부입니다.

![][3]

그림 4: 점수 매기기 모델

### 요청-응답 서비스 및 일괄 처리 실행 서비스

웹 서비스로 게시될 점수 매기기 실험을 빌드할 때 점수 매기기 시나리오에 따라 두 가지 중 하나를 선택할 수 있습니다. 점수 매기기 요청에 고객 A가 이동 통신 사업자를 전환하려고 하는지 확인하기 위한 요청 같은 단일 레코드 점수 매기기가 관련되면 이 요청은 실시간으로 점수가 매겨지고 RRS 웹 서비스로 생성됩니다. 서비스에서 실시간으로 예측 모델의 결과를 반환하고, 위 이탈 예측 예제의 경우 결과는 예 또는 응답 없음일 수 있습니다.

단일 요청으로 여러 레코드의 점수를 매겨야 하는 점수 매기기 작업(예: 고객 데이터가 포함된 레코드 일괄 처리가 점수를 매길 서비스로 전송되는 작업)에 대해서는 BES가 적절한 서비스입니다. 이 경우 요청은 모든 처리가 완료되고 나서 응답이 반환되기 전에 모든 레코드가 Azure Blob에서 처리되고 저장되는 비동기 요청입니다.

### 학습된 모델 사용

점수 매기기 실험을 설정하기 위해 학습된 모델(그림 3의 "성인 소득 예측")이 실험에 추가됩니다. 이제 학습된 모델을 학습하는 데 사용되는 기타 모듈은 제거할 수 있습니다. 이제 마지막 워크플로는 아래 그림 5와 같습니다.

### 입력 및 출력 포트

학습된 모델을 사용하여 실험을 설정하고(자세한 내용은 위 섹션 참조) 업데이트된 실험의 점수를 매기고 나면 예측 모델 및 예측 결과에 대한 데이터의 진입점과 끝내기 점을 지정하고 게시된 웹 서비스에 대한 인터페이스 정의로 사용될 입력 및 출력 포트를 설정해야 합니다. 점수 매기기 모델의 입력 포트는 진입점을 마우스 오른쪽 단추로 클릭하여 다음과 같이 설정할 수 있습니다.

![][4]

그림 5: 점수 매기기 입력 포트 설정

마찬가지로 점수 매기기 모델의 출력 포트를 다음과 같이 설정할 수 있습니다.

![][5]

그림 6: 출력 포트 설정

## 서비스 게시

포트를 설정하고 실험을 실행하고 나서 모델을 웹 서비스로 게시할 수 있습니다. 첫 번째 단계에서는 서비스를 스테이징 환경에 게시하고 이 환경에서 테스트하여 프로덕션 배포를 위한 준비가 된 것으로 표시하기 전에 예상 결과를 반환하는지 확인합니다.

### 스테이징에 게시

웹 서비스 게시 아이콘을 클릭하면 웹 서비스가 스테이징 환경으로 배포됩니다.

![][6]

그림 7: 웹 서비스 게시 단추

모델을 웹 서비스로 스테이징 환경에 게시하고 나서 입력 매개 변수를 사용하여 모델을 테스트하고 프로덕션에 배포하도록 표시할 수 있습니다. 대시보드에는 테스트를 위한 링크가 표시됩니다.

![][7]

그림 8: 웹 서비스 대시보드

테스트 링크를 클릭하고 점수 매기기에 대한 매개 변수를 제공하는 방법으로 스테이징 환경에서 웹 서비스를 테스트할 수 있습니다. 모델을 사용하여 제공된 데이터를 기반으로 테스트 요청의 점수를 매기고 점수 매기기 결과가 반환됩니다.

### 프로덕션에 게시

웹 서비스를 프로덕션에 게시하면 예측 및 점수 매기기에 사용하도록 기타 응용 프로그램에 웹 서비스가 제공됩니다. 스테이징에 대한 배포가 완료되고 성공적으로 테스트되고 나면 웹 서비스가 프로덕션 환경에 배포하도록 표시됩니다.

![][8]

그림 9: 웹 서비스를 프로덕션 배포 준비 완료로 표시

이렇게 하면 실제로 배포가 수행되지 않고 서비스를 프로덕션에 배포할 적절한 배포 권한이 포함된 사용자에 대한 알림이 생성됩니다.

![][9]

그림 10: 배포 알림 및 프로덕션에 대한 배포 옵션

## 웹 서비스 호출

#### RRS

RRS 웹 서비스는 REST 끝점이고 다양한 프로그래밍 언어를 사용하여 클라이언트 응용 프로그램에서 호출할 수 있습니다. API 도움말 페이지에서는 C#, R, Python으로 샘플을 제공하는 새 웹 서비스를 호출하기 위한 샘플 코드 링크를 제공합니다.

![][10]

그림 11: RRS 호출을 위한 샘플 코드

## 점수 매기기 이외 실험

점수 매기기 웹 서비스를 빌드하는 실험 이외에 데이터 추출 및 변환 같은 다른 작업을 수행하기 위한 실험을 만들 수 있습니다. 이 경우 웹 서비스에서는 기계 학습 작업을 수행하지 않습니다. Azure 기계 학습 스튜디오의 데이터 조작 기능을 사용하여 다양한 데이터 원본에서 읽거나, 데이터 유형을 변환하거나, 데이터/수학 조작을 필터링 및 적용합니다.

### 점수 매기기 이외 웹 서비스 게시

점수 매기기 이외 웹 서비스 게시 단계는 위에서 설명한 점수 매기기 서비스와 비슷합니다. 주요 차이점은 점수 매기기 모델에서 출력 포트가 정의되지 않는다는 점입니다.

# 게시된 서비스 업데이트

학습 데이터 업데이트, 학습 및 점수 매기기에 사용된 데이터 스키마 변경, 알고리즘 향상 필요 또는 원본 기계 학습 모델에 대한 기타 변경 같은 다양한 이유 때문에 게시된 웹 서비스를 업데이트해야 할 수 있습니다. 이러한 변경은 학습된 모델과 점수 매기기 결과에 영향을 주고 변경에 따라 업데이트된 웹 서비스를 게시해야 합니다.

![][11]

그림 12: 모델 편집 및 업데이트된 점수 매기기 웹 서비스 게시

## 학습된 모델 업데이트

학습 실험이 변경되면 학습된 모델을 다시 학습해야 합니다. 이 작업을 하려면 게시된 모델을 편집해야 합니다. 아래 예제에서는 위 그림 5에 나와 있는 점수 매기기 워크플로에서 기존 학습된 모델이 제거되고 난 후의 상태를 보여 줍니다.

![][12]

그림 13: 워크플로에서 제거된 학습된 모델

다음 단계에서는 필요한 모듈을 추가하여 데이터를 학습 및 테스트 세그먼트로 분할하고, 학습 알고리즘을 적용하고, 모델을 학습하고, 학습 데이터에 점수를 매기고, 결과를 평가합니다. 이러한 작업은 다른 학습 알고리즘을 적용해야 하는 등 실험에 필요한 기타 변경 내용에 따라 달라질 수 있습니다. (그림 14)

새 모듈이 추가되고 나면 실험을 다시 실행하기 전에 필요에 따라 모듈을 구성해야 합니다. 예를 들어 아래 예제의 빨간색 원은 학습 모델에 대한 레이블 열이 설정되지 않았음을 나타냅니다.

![][13]

그림 14: 모델을 다시 학습하도록 추가된 모듈.

학습 모델을 클릭하고 레이블 열 이름을 설정하면 문제가 해결됩니다.

![][14]

그림 15: 소득 열을 레이블로 선택

## 업데이트된 학습된 모델 저장

새 모델이 모두 제대로 구성되고 나면 실험을 저장하고 성공적으로 다시 실행해야 합니다. 그리고 나서 위 그림 2에 나와 있는 대로 학습 모델을 저장할 수 있습니다. 차이점은 이 경우 기존 학습된 모델을 업데이트하려면 확인란을 선택해야 한다는 점입니다.

![][15]

그림 16: 기존 학습된 모델 업데이트

## 업데이트된 서비스 게시

학습된 모델이 업데이트되고 나면 위 **Azure 기계 학습 웹 서비스** 게시 섹션에 설명된 게시 단계가 반복됩니다.

-   점수 매기기 실험에서 학습된(이제 업데이트된) 모델 사용
-   입/출력 포트 설정
-   스테이징에 게시
-   프로덕션에 게시

실험이 업데이트되고 새 학습된 모델이 생성되어 점수가 매겨지고 나서 웹 서비스 게시를 클릭하면 서비스가 게시됩니다. 새로 만들어진 서비스가 기존 서비스를 덮어씁니다.



  [0]: ./media/machine-learning-overview-of-azure-ml-process/oamlp1.png
  [1]: ./media/machine-learning-overview-of-azure-ml-process/oamlp2.png
  [2]: ./media/machine-learning-overview-of-azure-ml-process/oamlp3.png
  [3]: ./media/machine-learning-overview-of-azure-ml-process/oamlp4.png
  [4]: ./media/machine-learning-overview-of-azure-ml-process/oamlp5.png
  [5]: ./media/machine-learning-overview-of-azure-ml-process/oamlp6.png
  [6]: ./media/machine-learning-overview-of-azure-ml-process/oamlp7.png
  [7]: ./media/machine-learning-overview-of-azure-ml-process/oamlp8.png
  [8]: ./media/machine-learning-overview-of-azure-ml-process/oamlp9.png
  [9]: ./media/machine-learning-overview-of-azure-ml-process/oamlp10.png
  [10]: ./media/machine-learning-overview-of-azure-ml-process/oamlp11.png
  [11]: ./media/machine-learning-overview-of-azure-ml-process/oamlp12.png
  [12]: ./media/machine-learning-overview-of-azure-ml-process/oamlp13.png
  [13]: ./media/machine-learning-overview-of-azure-ml-process/oamlp14.png
  [14]: ./media/machine-learning-overview-of-azure-ml-process/oamlp15.png
  [15]: ./media/machine-learning-overview-of-azure-ml-process/oamlp16.png
