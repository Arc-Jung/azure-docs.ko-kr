---
title: 용량 및 비용 예측
titleSuffix: Azure Cognitive Search
description: Azure의 인프라 및 도구를 비롯 하 여 용량을 예측 하 고 검색 서비스 비용을 관리 하는 방법과 리소스를 보다 효율적으로 사용 하는 모범 사례에 대 한 지침을 검토 합니다.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/15/2020
ms.openlocfilehash: d48ae71a979a2d0f1457b0cefa8a98a02710dd96
ms.sourcegitcommit: 77ab078e255034bd1a8db499eec6fe9b093a8e4f
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/16/2020
ms.locfileid: "97577689"
---
# <a name="how-to-estimate-capacity-and-costs-of-an-azure-cognitive-search-service"></a>Azure Cognitive Search 서비스의 용량 및 비용을 계산 하는 방법

Azure Cognitive Search에 대 한 용량 계획의 일부로 다음 지침을 참조 하 여 비용을 절감 하거나 비용을 보다 효율적으로 관리할 수 있습니다.

+ 대역폭 요금을 최소화 하거나 제거 하기 위해 동일한 지역에 있거나 가능한 적은 수의 지역에 모든 리소스를 만듭니다.

+ 모든 서비스를 Azure Cognitive Search, Cognitive Services 및 솔루션에 사용 되는 다른 Azure 서비스와 같은 하나의 리소스 그룹으로 통합 합니다. Azure Portal에서 리소스 그룹을 찾고 **Cost Management** 명령을 사용 하 여 실제 및 예상 지출 정보를 파악 합니다.

+ 요청 및 응답이 데이터 센터 경계 내에 유지 되도록 프런트 엔드 응용 프로그램에 대해 Azure 웹 앱을 고려 합니다.

+ 인덱싱 등의 리소스를 많이 사용 하는 작업을 확장 한 다음 일반 쿼리 워크 로드에 대해 다시 조정 합니다. Azure Cognitive Search에 대 한 최소 구성 (하나의 파티션과 하나의 복제본으로 구성 된 SU)부터 시작 하 여 더 많은 용량이 필요한 경우를 나타내는 사용 패턴을 식별 하는 사용자 활동을 모니터링 합니다. 예측 가능한 패턴이 있는 경우 크기 조정을 활동과 동기화 할 수 있습니다 .이를 자동화 하는 코드를 작성 해야 합니다.

청구 가능한 이벤트, 청구 식 및 청구 가능 요금은 [가격 책정 계층 선택](search-sku-tier.md)에 설명 되어 있습니다. 뿐만 아니라 기본 제공 도구 및 지출 관련 기능에 대 한 [청구 및 비용 관리](../cost-management-billing/cost-management-billing-overview.md) 를 방문할 수도 있습니다.

임시 방식으로 검색 서비스를 종료 하는 것은 불가능 합니다. 전용 리소스는 항상 작동 하며 서비스 수명 동안 독점적으로 사용 하도록 할당 됩니다. 서비스 삭제는 영구적 이며 연결 된 데이터도 삭제 합니다.

서비스 자체를 기준으로 청구서를 낮추는 유일한 방법은 복제본과 파티션을 여전히 허용 되는 성능 및 [SLA 준수](https://azure.microsoft.com/support/legal/sla/search/v1_0/)를 제공 하는 수준으로 축소 하거나 더 낮은 계층에서 서비스를 만드는 것입니다 (S1 시간당 요금은 S2 또는 S3 요금 보다 낮음). 부하 예측의 하단에서 서비스를 프로 비전 한다고 가정 하 고, 서비스를 증가 시키는 경우 두 번째 대규모 계층화 된 서비스를 만들고 두 번째 서비스에서 인덱스를 다시 작성 한 다음 첫 번째 서비스를 삭제할 수 있습니다.

## <a name="how-to-evaluate-capacity-requirements"></a>용량 요구 사항을 평가 하는 방법

Azure Cognitive Search에서 용량은 *복제본* 및 *파티션으로* 구성 됩니다.

+ 복제본은 검색 서비스의 인스턴스입니다. 각 복제본은 인덱스의 부하 분산 된 복사본 하나를 호스팅합니다. 예를 들어 6 개의 복제본이 있는 서비스는 서비스에 로드 된 모든 인덱스의 복사본 6 개를 포함 합니다.

+ 파티션은 인덱스를 저장 하 고 검색 가능한 데이터를 자동으로 분할 합니다. 두 파티션은 인덱스를 절반으로 분할 하 고, 세 개의 파티션은 세 개의 파티션으로 분할 하는 식으로 분할 됩니다. 용량 측면에서 *파티션 크기* 는 계층 간의 주요 차별화 기능입니다.

> [!NOTE]
> 모든 표준 및 저장소 최적화 계층은 [복제본과 파티션의 유연한 조합을](search-capacity-planning.md#chart) 지원 하므로 잔액을 변경 하 여 [시스템을 속도 또는 저장소에 맞게 최적화할](search-performance-optimization.md) 수 있습니다. 기본 계층은 고가용성을 위해 최대 3 개의 복제본을 제공 하지만 파티션이 하나 뿐입니다. 무료 계층은 전용 리소스를 제공 하지 않습니다. 컴퓨팅 리소스는 여러 구독자가 공유 합니다.

### <a name="evaluating-capacity"></a>용량 평가

서비스를 실행 하는 비용과 용량을 함께 활용 하세요. 계층은 저장소 및 콘텐츠 (예: 인덱스 수)의 두 수준에 제한을 부과 합니다. 가장 먼저 도달 하는 한도가 유효 한도 인지에 대해 생각해 야 합니다.

비즈니스 요구 사항에 따라 일반적으로 필요한 인덱스 수가 결정 됩니다. 예를 들어 문서에 대 한 많은 리포지토리의 전역 인덱스가 필요할 수 있습니다. 또는 지역, 응용 프로그램 또는 비즈니스 틈새을 기반으로 하는 인덱스가 여러 개 필요할 수 있습니다.

인덱스의 크기를 결정하려면 [하나를 빌드](search-what-is-an-index.md)해야 합니다. 이 크기는 확인 기, 필터링, 정렬 등을 사용 하도록 설정 했는지 여부와 같은 인덱스 구성과 가져온 데이터를 기반으로 합니다.

전체 텍스트 검색의 경우 주 데이터 구조는 원본 데이터와 특성이 다른 [반전 된 인덱스](https://en.wikipedia.org/wiki/Inverted_index) 구조입니다. 반전 된 인덱스의 경우 크기와 복잡성은 내용에 따라 결정 되며,이는 사용자가 제공 하는 데이터의 양이 아닐 수도 있습니다. 중복성이 높은 큰 데이터 원본을 사용 하면 가변 콘텐츠를 포함 하는 작은 데이터 집합 보다 더 작은 인덱스가 생성 될 수 있습니다. 따라서 원래 데이터 집합의 크기에 따라 인덱스 크기를 유추할 수 있는 경우는 거의 없습니다.

> [!NOTE] 
> 인덱스 및 저장소에 대 한 향후 수요를 예측 하는 것이 추측 처럼 느껴질 수 있지만이 경우에는 충분 합니다. 계층의 용량이 너무 낮을 경우 더 높은 계층에서 새 서비스를 프로 비전 한 다음 [인덱스를 다시 로드](search-howto-reindex.md)해야 합니다. 한 계층에서 다른 계층으로 서비스를 전체 업그레이드할 수 없습니다.
>

## <a name="estimate-with-the-free-tier"></a>무료 계층으로 예측

용량을 예측하기 위한 한 방법은 무료 계층으로 시작하는 것입니다. 무료 서비스는 최대 3 개의 인덱스, 50 MB의 저장소 및 2 분의 인덱싱 시간을 제공 합니다. 이러한 제약 조건을 사용 하 여 예상 인덱스 크기를 추정 하는 것은 어려울 수 있지만 다음 단계를 수행 합니다.

+ [무료 서비스를 만드세요](search-create-service-portal.md).
+ 작은 대표적인 데이터 집합을 준비 합니다.
+ [포털에서 초기 인덱스를 작성](search-get-started-portal.md) 하 고 크기를 확인 합니다. 기능 및 특성은 저장소에 영향을 줍니다. 예를 들어 확인 기 (검색 형식 쿼리)를 추가 하면 저장소 요구 사항이 증가 합니다. 동일한 데이터 집합을 사용 하면 각 필드에 서로 다른 특성을 사용 하 여 여러 버전의 인덱스를 만들어 저장소 요구 사항이 어떻게 달라 지는 지 확인할 수 있습니다. 자세한 내용은 [기본 인덱스 만들기의 "저장소 영향"](search-what-is-an-index.md#index-size)을 참조 하세요.

대략적인 추정치를 사용 하는 경우 두 인덱스 (개발 및 프로덕션)에 대 한 예산에 해당 하는 금액을 두 배로 확보 하 고 그에 따라 계층을 선택할 수 있습니다.

## <a name="estimate-with-a-billable-tier"></a>청구 가능 계층으로 예측

전용 리소스는 개발 중에 인덱스 수량, 크기 및 쿼리 볼륨의 보다 현실적인 추정치를 위해 더 큰 샘플링 및 처리 시간을 수용할 수 있습니다. 일부 고객은 청구 가능한 계층으로 바로 이동한 다음 개발 프로젝트가 성숙 될 때 재평가 됩니다.

1. [각 계층에서 서비스 제한을 검토](./search-limits-quotas-capacity.md#index-limits) 하 여 하위 계층이 필요한 인덱스 수를 지원할 수 있는지 확인 합니다. 기본, S1 및 S2 계층 전체에서 인덱스 제한은 각각 15, 50 및 200입니다. 저장소에 최적화 된 계층은 매우 큰 인덱스를 적게 지원 하도록 설계 되었기 때문에 인덱스가 10 개로 제한 됩니다.

1. [청구 가능 계층에서 서비스 만들기](search-create-service-portal.md):

    + 예상 되는 부하에 대해 잘 모르는 경우 기본 또는 S1에서 낮은 수준으로 시작 합니다.
    + 대규모 인덱싱 및 쿼리가 로드 되는 것을 알고 있는 경우 시작 높음, S2 또는 심지어 S3.
    + 내부 비즈니스 응용 프로그램과 마찬가지로, 많은 양의 데이터를 인덱싱하는 경우에는 L1 또는 L2에서 저장소에 최적화 된 저장소로 시작 합니다.

1. 원본 데이터가 인덱스로 변환되는 방법을 결정하려면 [초기 인덱스를 만듭니다](search-what-is-an-index.md). 인덱스 크기를 추정하는 유일한 방법입니다.

1. 포털에서 [스토리지, 서비스 제한, 쿼리 볼륨 및 대기 시간을 모니터링](search-monitor-usage.md)합니다. 포털에는 초당 쿼리 수, 제한 된 쿼리 및 검색 대기 시간이 표시 됩니다. 이러한 모든 값은 올바른 계층을 선택 했는지 여부를 결정 하는 데 도움이 될 수 있습니다. 

인덱스 번호와 크기는 분석에도 동일 하 게 중요 합니다. 최대 한도는 저장소 (파티션)의 전체 사용률 또는 리소스에 대 한 최대 제한 (인덱스, 인덱서 등)을 통해 도달할 수 있기 때문입니다. 포털을 사용하면 둘 모두 추적할 수 있으며, 개요 페이지에 현재 사용량 및 최대 한도가 나란히 표시됩니다.

> [!NOTE]
> 문서에 불필요 한 데이터가 포함 되어 있으면 저장소 요구 사항을 팽창 수 있습니다. 이상적으로 문서에는 검색 환경에 필요한 데이터만 포함 됩니다. 이진 데이터는 검색할 수 없으며 Azure 테이블 또는 blob 저장소에 별도로 저장 해야 합니다. 그런 다음 인덱스에 필드를 추가 하 여 외부 데이터에 대 한 URL 참조를 저장 해야 합니다. 개별 문서의 최대 크기는 16mb입니다 (한 요청에서 여러 문서를 대량으로 업로드 하는 경우에는 더 낮음). 자세한 내용은 [Azure Cognitive Search의 서비스 제한](search-limits-quotas-capacity.md)을 참조 하세요.
>

**쿼리 볼륨 고려 사항**

QPS (초당 쿼리 수)는 성능 튜닝 중에 중요 한 메트릭입니다. 그러나 일반적으로 처음에는 높은 쿼리 볼륨이 필요한 경우에만 계층을 고려 합니다.

표준 계층을 통해 복제본과 파티션의 균형을 맞출 수 있습니다. 부하 분산을 위해 복제본을 추가 하거나 병렬 처리를 위해 파티션을 추가 하 여 쿼리 수행을 늘릴 수 있습니다. 그런 다음 서비스가 프로 비전 된 후 성능을 조정할 수 있습니다.

처음부터 지속적으로 높은 쿼리 볼륨을 원하는 경우 더 강력한 하드웨어에서 지원 되는 더 높은 표준 계층을 고려해 야 합니다. 그런 다음 파티션 및 복제본을 오프 라인으로 전환 하거나, 해당 쿼리 볼륨이 발생 하지 않는 경우 하위 계층 서비스로 전환할 수도 있습니다. 쿼리 처리량을 계산 하는 방법에 대 한 자세한 내용은 [Azure Cognitive Search 성능 및 최적화](search-performance-optimization.md)를 참조 하세요.

저장소에 최적화 된 계층은 대량 데이터 워크 로드에 유용 하며, 쿼리 대기 시간 요구 사항이 그다지 중요 하지 않은 경우에 사용할 수 있는 전체 인덱스 저장소를 지원 합니다. 부하 분산 및 병렬 처리를 위한 추가 파티션에 대해서는 추가 복제본을 계속 사용 해야 합니다. 그런 다음 서비스가 프로 비전 된 후 성능을 조정할 수 있습니다.

**서비스 수준 계약**

무료 계층 및 미리 보기 기능은 [sla (서비스 수준 계약)](https://azure.microsoft.com/support/legal/sla/search/v1_0/)를 제공 하지 않습니다. 모든 청구 가능 계층에 대해 서비스에 충분한 중복성을 프로비전할 때 SLA가 적용됩니다. 쿼리 (읽기) Sla에는 두 개 이상의 복제본이 있어야 합니다. 쿼리 및 인덱싱 (읽기-쓰기) Sla에는 3 개 이상의 복제본이 있어야 합니다. 파티션 수는 Sla에 영향을 주지 않습니다.

## <a name="tips-for-tier-evaluation"></a>계층 평가에 대한 팁

+ 메트릭을 사용 하 여 쿼리를 작성 하 고 사용 패턴 (업무 시간 동안 쿼리, 사용량이 적은 시간 동안 인덱싱)에 대 한 데이터를 수집 합니다. 이 데이터를 사용 하 여 서비스 프로 비전 결정을 알립니다. 시간별 또는 일별 주기에서는 실용적이 지 않지만 쿼리 볼륨의 계획 된 변경 내용을 수용 하기 위해 파티션 및 리소스를 동적으로 조정할 수 있습니다. 또한 수준에서 조치를 취하는 데 충분 한 시간을 보유 하는 경우 계획 되지 않았지만 지속적으로 변경 될 수 있습니다.

+ 프로 비전 중인의 유일한 단점은 실제 요구 사항이 예측 보다 큰 경우 서비스를 중단 해야 할 수 있다는 것입니다. 서비스 중단을 방지 하기 위해 더 높은 계층에서 새 서비스를 만들고 모든 앱 및 요청이 새 끝점을 대상으로 할 때까지 함께 실행 합니다.

## <a name="next-steps"></a>다음 단계

무료 계층으로 시작 하 고 데이터의 하위 집합을 사용 하 여 초기 인덱스를 작성 하 여 특성을 이해 합니다. Azure Cognitive Search의 데이터 구조는 반전 된 인덱스 구조입니다. 반전 된 인덱스의 크기 및 복잡성은 내용에 따라 결정 됩니다. 중복성이 큰 콘텐츠는 결과적으로 불규칙성이 큰 콘텐츠보다 더 작은 인덱스가 되는 경향이 있습니다. 따라서 데이터 집합의 크기가 아닌 콘텐츠 특성은 인덱스 저장소 요구 사항을 결정 합니다.

인덱스 크기의 초기 추정치를 받은 후에는이 문서에서 설명 하는 기본, 표준 또는 저장소 최적화 된 계층 중 하나에서 [청구 가능 서비스를 프로 비전](search-create-service-portal.md) 합니다. 데이터 크기 조정에 대 한 인공 제약 조건을 완화 하 고 검색 하려는 모든 데이터를 포함 하도록 [인덱스를 다시 작성](search-howto-reindex.md) 합니다.

필요한 성능과 규모를 가져오려면 필요에 따라 [파티션 및 복제본을 할당](search-capacity-planning.md)합니다.

성능 및 용량이 충분 하면 작업이 완료 된 것입니다. 그렇지 않으면 사용자의 요구에 맞춰 더 밀접하게 조정하는 다른 계층에서 검색 서비스를 다시 만듭니다.

> [!NOTE]
> 질문이 있는 경우 [Stackoverflow](https://stackoverflow.com/questions/tagged/azure-search) 에 게시 하거나 [Azure 지원에 문의 하세요](https://azure.microsoft.com/support/options/).