---
title: 클라이언트 측 성능 추적 생성
description: WPF를 사용한 클라이언트 측 성능 프로파일링을 위한 모범 사례
author: florianborn71
ms.author: flborn
ms.date: 12/11/2019
ms.topic: conceptual
ms.openlocfilehash: 1f4207a11f3ae3664023fccf6178b6db7cf253b9
ms.sourcegitcommit: 642a297b1c279454df792ca21fdaa9513b5c2f8b
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/06/2020
ms.locfileid: "80681312"
---
# <a name="create-client-side-performance-traces"></a>클라이언트 측 성능 추적 생성

Azure 원격 렌더링의 성능이 원하는 만큼 좋지 않을 수 있는 데는 여러 가지 이유가 있습니다. 클라우드 서버의 순수한 렌더링 성능 외에도 특히 네트워크 연결의 품질은 경험에 큰 영향을 미칩니다. 서버 성능을 프로파일로 설명하려면 [서버 측 성능 쿼리](../overview/features/performance-queries.md)를 참조하십시오.

이 장에서는 *성능 추적을*통해 잠재적인 클라이언트 측 병목 현상을 식별하는 방법에 대해 중점합니다.

## <a name="getting-started"></a>시작

Windows 성능 추적 기능을 새로 접하는 경우 이 섹션에서는 시작하는 데 가장 기본적인 용어와 응용 프로그램에 대해 언급합니다.

### <a name="installation"></a>설치

ARR을 사용하여 추적하는 데 사용되는 응용 프로그램은 모든 Windows 개발에 사용할 수 있는 범용 도구입니다. Windows [성능 도구 키트를](https://docs.microsoft.com/windows-hardware/test/wpt/)통해 제공됩니다. 이 도구 키트를 얻으려면 [Windows 평가 및 배포 키트를](https://docs.microsoft.com/windows-hardware/get-started/adk-install)다운로드합니다.

### <a name="terminology"></a>용어

성능 추적에 대한 정보를 검색할 때 필연적으로 다양한 용어를 만날 수 있습니다. 가장 중요한 것들은 다음과 같습니다.

* `ETW`
* `ETL`
* `WPR`
* `WPA`

**ETW는** [ **W**인다우즈에 대한 **E**벤트 **T**경주를 의미합니다.](https://docs.microsoft.com/windows/win32/etw/about-event-tracing) Windows에 기본 제공되는 효율적인 커널 수준 추적 기능의 가장 중요한 이름일 뿐입니다. ETW를 지원하는 응용 프로그램은 성능 문제를 추적하는 데 도움이 될 수 있는 작업을 기록하기 위해 이벤트를 방출하기 때문에 *이벤트* 추적이라고 합니다. 기본적으로 운영 체제는 이미 디스크 액세스, 작업 스위치 등의 이벤트에 대한 이벤트를 내보전합니다. ARR과 같은 응용 프로그램은 드롭 프레임, 네트워크 지연 등에 대한 사용자 지정 이벤트를 추가로 내보전합니다.

**ETL은** **E**벤트 **T**레이스 **L**오깅을 의미합니다. 단순히 추적이 수집(loggeed)되었기 때문에 일반적으로 추적 데이터를 저장하는 파일의 파일 확장자로 사용됩니다. 따라서 추적을 수행 할 때 일반적으로 \*나중에 .etl 파일이 있습니다.

**WPR은** [ **W**인다우스 **P** **R**어폼 r ecorder를](https://docs.microsoft.com/windows-hardware/test/wpt/windows-performance-recorder) 의미하며 이벤트 추적의 기록을 시작하고 중지하는 응용 프로그램의 이름입니다. WPR은 기록할\*정확한 이벤트를 구성하는 프로필 파일(.wprp)을 사용합니다. 이러한 `wprp` 파일은 ARR SDK와 함께 제공됩니다. 데스크톱 PC에서 추적을 수행할 때 WPR을 직접 시작할 수 있습니다. HoloLens에서 추적을 수행할 때 일반적으로 웹 인터페이스를 대신 거행합니다.

**WPA는** [ **W**indows **P**erformance **A**nalyzer를](https://docs.microsoft.com/windows-hardware/test/wpt/windows-performance-analyzer) 의미하며 .etl \*파일을 열고 성능을 식별하기 위해 데이터를 선별하는 데 사용되는 GUI 응용 프로그램의 이름입니다. WPA를 사용하면 다양한 기준에 따라 데이터를 정렬하고, 여러 가지 방법으로 데이터를 표시하고, 세부 정보를 자세히 조사하고, 정보를 상호 연관시킬 수 있습니다.

ETL 추적은 모든 Windows 장치(로컬 PC, HoloLens, 클라우드 서버 등)에서 생성할 수 있지만 일반적으로 디스크에 저장되고 데스크톱 PC에서 WPA로 분석됩니다. ETL 파일을 다른 개발자에게 전송하여 살펴볼 수 있습니다. 그러나 파일 경로 및 IP 주소와 같은 중요한 정보는 ETL 추적에서 캡처될 수 있습니다. ETW를 사용하여 추적을 기록하거나 추적을 분석할 수 있습니다. 기록 추적은 간단하고 최소한의 설정이 필요합니다. 반면에 추적을 분석하려면 WPA 도구와 조사 중인 문제를 모두 잘 이해해야 합니다. WPA 학습을 위한 일반 자료는 ARR 특이적 추적을 해석하는 방법에 대한 지침뿐만 아니라 아래에 주어집니다.

## <a name="recording-a-trace-on-a-local-pc"></a>로컬 PC에 추적 기록

ARR 성능 문제를 식별하려면 HoloLens에서 직접 추적을 수행하는 것이 진정한 성능 특성의 스냅샷을 얻을 수 있는 유일한 방법이기 때문입니다. 그러나 HoloLens 성능 제한 없이 추적을 수행하거나 WPA를 사용하는 방법을 배우고 현실적인 추적이 필요하지 않은 경우 다음과 같은 작업을 수행하는 방법을 설명합니다.

### <a name="wpr-configuration"></a>WPR 구성

1. *시작 메뉴에서* [Windows 성능 레코더를](https://docs.microsoft.com/windows-hardware/test/wpt/windows-performance-recorder) 시작합니다.
1. **더 많은 옵션** 확장
1. **프로필 추가를 클릭합니다...**
1. *AzureRemote렌더링네트워크프로파일링.wprp*파일을 선택합니다. 이 파일은 *도구/ETLProfile에서*ARR SDK에서 찾을 수 있습니다.
   이제 프로필이 사용자 지정 측정 아래 *WPR에 나열됩니다.* 활성화된 프로필만 활성화되어 있는지 확인합니다.
1. *첫 번째 수준 심사 확장*:
    * ARR 네트워킹 이벤트의 빠른 추적을 캡처하기만 하면 이 옵션을 **사용하지 않도록 설정합니다.**
    * ARR 네트워크 이벤트를 CPU 또는 메모리 사용량과 같은 다른 시스템 특성과 상호 연관시켜야 하는 경우 이 옵션을 **사용하도록 설정합니다.**
    * 이 옵션을 사용하도록 설정하면 추적의 크기가 여러 기가바이트가 될 가능성이 높으며 WPA에서 저장하고 여는 데 시간이 오래 걸릴 수 있습니다.

이후에 WPR 구성은 다음과 같아야 합니다.

![WPR 구성](./media/wpr.png)

### <a name="recording"></a>기록

추적 기록을 시작하려면 **시작을** 클릭합니다. 언제든지 녹화를 시작하고 중지할 수 있습니다. 이렇게 하기 전에 응용 프로그램을 닫을 필요가 없습니다. 당신이 볼 수 있듯이 ETW는 항상 전체 시스템에 대한 추적을 기록하기 때문에 추적 할 응용 프로그램을 지정할 필요가 없습니다. 파일은 `wprp` 기록할 이벤트 유형을 지정합니다.

**저장을** 클릭하여 기록을 중지하고 ETL 파일을 저장할 위치를 지정합니다.

이제 WPA에서 직접 열거나 다른 사람에게 보낼 수 있는 ETL 파일이 있습니다.

## <a name="recording-a-trace-on-a-hololens"></a>홀로렌즈에 흔적 기록

HoloLens에 추적을 기록하려면 장치를 부팅하고 IP 주소를 브라우저에 입력하여 *장치 포털을*엽니다.

![디바이스 포털](./media/wpr-hl.png)

1. 왼쪽에서 *성능 > 성능 추적으로*이동합니다.
1. **사용자 지정 프로필** 선택
1. **찾아보기를 클릭합니다...**
1. *AzureRemote렌더링네트워크프로파일링.wprp*파일을 선택합니다. 이 파일은 *도구/ETLProfile에서*ARR SDK에서 찾을 수 있습니다.
1. **추적 시작을 클릭합니다.**
1. 홀로렌즈가 흔적을 기록하고 있습니다. 조사하려는 성능 문제를 트리거해야 합니다. 그런 다음 **추적 중지를 클릭합니다.**
1. 추적은 웹 페이지 하단에 나열됩니다. 오른쪽에 있는 디스크 아이콘을 클릭하여 ETL 파일을 다운로드합니다.

이제 WPA에서 직접 열거나 다른 사람에게 보낼 수 있는 ETL 파일이 있습니다.

## <a name="analyzing-traces-with-wpa"></a>WPA로 트레이스 분석

### <a name="wpa-basics"></a>WPA 기본 사항

Windows 성능 분석기는 ETL 파일을 열고 추적을 검사하는 표준 도구입니다. WPA 작동 방식에 대한 설명은 이 문서의 범위를 벗어납니다. 시작하려면 다음 리소스를 살펴보십시오.

* 첫 번째 개요를 보려면 [소개 비디오를](https://docs.microsoft.com/windows-hardware/test/wpt/windows-performance-analyzer) 시청하세요.
* WPA 자체에는 일반적인 단계를 설명하는 *시작 하기* 탭이 있습니다. 사용 가능한 항목을 살펴보십시오. 특히 "데이터 보기"에서는 특정 데이터에 대한 그래프를 만드는 방법을 빠르게 소개합니다.
* 이 웹 [사이트에](https://randomascii.wordpress.com/2015/09/24/etw-central/)우수한 정보가 있습니다, 그러나, 그것의 모든 초보자를위한 관련이 없습니다.

### <a name="graphing-data"></a>그래프 데이터

ARR 추적을 시작하려면 다음 조각을 알아두면 좋습니다.

![성능 그래프](./media/wpa-graph.png)

위의 이미지는 추적 데이터 테이블과 동일한 데이터의 그래프 표현을 보여 주며 있습니다.

하단의 표에서 노란색(황금색) 막대와 파란색 막대를 확인합니다. 이러한 막대를 드래그하여 원하는 위치에 배치할 수 있습니다.

**노란색 막대의 왼쪽에 있는** 모든 열은 **키로**해석됩니다. 키는 왼쪽 위 창에서 트리를 구성하는 데 사용됩니다. 여기서는 "공급자 이름"과 "작업 이름"이라는 두 가지 *주요* 열이 있습니다. 따라서 왼쪽 위 창의 트리 구조는 두 수준 깊이입니다. 열순서를 변경하거나 키 영역에서 열을 추가 하거나 제거 하면 트리 뷰의 구조가 변경 됩니다.

**파란색 막대 의 오른쪽에** 있는 열은 오른쪽 상단 창의 **그래프 표시에** 사용됩니다. 대부분의 경우 첫 번째 열만 사용되지만 일부 그래프 모드에는 여러 개의 데이터 열이 필요합니다. 선 그래프가 작동하려면 해당 열의 *집계 모드를* 설정해야 합니다. '평균' 또는 '최대'를 사용합니다. 집계 모드는 픽셀이 여러 이벤트가 있는 범위를 덮을 때 지정된 픽셀에서 그래프 값을 결정하는 데 사용됩니다. 집계를 'Sum'으로 설정한 다음 확대/축소하여 관찰할 수 있습니다.

가운데의 열에는 특별한 의미가 없습니다.

![이벤트 보기](./media/wpa-event-view.png)

일반 *이벤트 보기 편집기에서* 표시할 모든 열, 집계 모드, 정렬 및 키또는 그래프로 사용되는 열을 구성할 수 있습니다. 위의 예에서는 **필드 2가** 활성화되고 필드 3 - 6이 비활성화됩니다. 필드 2는 일반적으로 ETW 이벤트의 첫 번째 *사용자 지정 데이터* 필드이므로 일부 네트워크 대기 시간 값을 나타내는 ARR "FrameStatistics" 이벤트의 경우입니다. 다른 "필드" 열을 사용하여 이 이벤트의 추가 값을 볼 수 있습니다.

### <a name="presets"></a>기본 설정

추적을 제대로 분석하려면 고유한 워크플로우와 기본 데이터 표시를 파악해야 합니다. 그러나 ARR 관련 이벤트에 대한 간략한 개요를 얻으려면 Windows 소프트웨어 보호 플랫폼 프로필과 폴더 *도구/ETLProfiles에*사전 설정 파일이 포함되어 있습니다. 전체 프로파일을 로드하려면 WPA 메뉴 모음에서 *프로파일 > 적용하거나* *내 사전 설정* 패널(내*사전 설정*> 창)을 열고 *가져오기를*선택합니다. 전자는 아래 이미지와 같이 완전한 WPA 구성을 설정합니다. 후자는 다양한 뷰 구성에 대한 사전 설정만 사용할 수 있도록 하고 보기를 빠르게 열어 ARR 이벤트 데이터의 특정 부분을 볼 수 있도록 합니다.

![기본 설정](./media/wpa-arr-trace.png)

위의 이미지는 다양한 ARR 관련 이벤트의 뷰와 전체 CPU 사용률을 보여 주며 있습니다.

## <a name="next-steps"></a>다음 단계

* [서버 측 성능 쿼리](../overview/features/performance-queries.md)
