<properties
   pageTitle="VNet 간 연결 구성 | Microsoft Azure"
   description="PowerShell 및 Azure 클래식 포털을 사용하여 같거나 다른 구독 또는 지역에서 Azure 가상 네트워크를 함께 연결하는 방법에 대해 설명합니다. 이 문서는 클래식 배포 모델을 사용하여 만든 VNet에 적용됩니다."
   services="vpn-gateway"
   documentationCenter="na"
   authors="cherylmc"
   manager="carmonm"
   editor=""/>

<tags
   ms.service="vpn-gateway"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="infrastructure-services"
   ms.date="03/08/2016"
   ms.author="cherylmc"/>


# 클래식 배포 모델에 대한 VNet 간 연결 구성

> [AZURE.SELECTOR]
- [Azure 클래식 포털](virtual-networks-configure-vnet-to-vnet-connection.md)
- [PowerShell - Azure 리소스 관리자](vpn-gateway-vnet-vnet-rm-ps.md)


이 문서에서는 클래식 배포 모델(서비스 관리라고도 함)을 사용하여 가상 네트워크를 만들어 하나로 연결하는 과정을 안내합니다. 아래 단계에서는 Azure 클래식 포털과 PowerShell을 조합하여 사용합니다. 리소스 관리자 배포 모델을 사용하여 만든 가상 네트워크를 연결하려는 경우 [Azure Resource Manager 및 PowerShell을 사용하여 가상 네트워크의 VNet 간 연결 구성](vpn-gateway-vnet-vnet-rm-ps.md)을 참조하세요.

**Azure 배포 모델 정보**

[AZURE.INCLUDE [vpn-gateway-clasic-rm](../../includes/vpn-gateway-classic-rm-include.md)]클래식 배포 모델에서 만든 VNet을 리소스 관리자 모델을 사용하여 만든 VNet에 연결하려면 [새 VNet에 클래식 VNet 연결](../virtual-network/virtual-networks-arm-asm-s2s.md)을 참조하세요.

**VNet 간 배포 모델 및 도구**

[AZURE.INCLUDE [vpn-gateway-table-vnet-to-vnet](../../includes/vpn-gateway-table-vnet-to-vnet-include.md)]


## VNet 간 연결 정보

가상 네트워크를 다른 가상 네트워크에 연결(VNet 간)하는 것은 가상 네트워크를 온-프레미스 사이트 위치에 연결하는 것과 매우 유사합니다. 두 연결 유형 모두 VPN 게이트웨이를 사용하여 IPsec/IKE를 통한 보안 터널을 제공합니다. 연결하는 VNet은 서로 다른 구독 및 지역에 있을 수 있습니다. VNet 간 통신을 다중 사이트 구성과 통합할 수도 있습니다. 이렇게 하면 아래 다이어그램에 표시된 것처럼 크로스-프레미스 연결을 가상 네트워크 간 연결과 결합하는 네트워크 토폴로지를 설정할 수 있습니다.

![VNet 간 연결 다이어그램](./media/virtual-networks-configure-vnet-to-vnet-connection/vnet2vnet.png)

### 가상 네트워크에 연결하는 이유

다음과 같은 이유로 가상 네트워크에 연결할 수 있습니다.

- **지역 간 지리적 중복 및 지리적 상태**
	- 인터넷 연결 끝점으로 이동하지 않고도 보안 연결을 통해 지역에서 복제 또는 동기화를 직접 설정할 수 있습니다.
	- Azure 부하 분산 장치 및 Microsoft 또는 타사 클러스터링 기술을 사용하여 여러 Azure 지역 간의 지리적 중복을 통해 워크로드의 가용성을 높게 설정할 수 있습니다. 이러한 작업의 한 가지 주요 예는 여러 Azure 지역에 분산된 가용성 그룹을 사용하여 SQL AlwaysOn을 설정하는 것입니다.

- **분리 경계가 뚜렷한 지역별 다중 계층 응용 프로그램**
	- 같은 지역 내에서 뚜렷한 경계를 적용해 여러 가상 네트워크가 함께 연결된 다중 계층 응용 프로그램을 설정하고 계층 간 통신을 보호할 수 있습니다.

- **Azure의 구독 간/조직 간 통신**
	- Azure 구독이 여러 개인 경우 이제 가상 네트워크 간에 여러 구독의 작업을 안전하게 연결할 수 있습니다.
	- 엔터프라이즈 또는 서비스 공급자의 경우 이제 Azure 내의 보안 VPN 기술을 사용하여 조직 간 통신을 사용하도록 설정할 수 있습니다.

### VNet-VNet FAQ

- 가상 네트워크는 같은 구독에 있을 수도 있고 다른 구독에 있을 수도 있습니다.

- 가상 네트워크는 같은 Azure 지역(위치)에 있을 수도 있고 다른 Azure 지역(위치)에 있을 수도 있습니다.

- 클라우드 서비스 또는 부하 분산 끝점은 연결되어 있더라도 여러 가상 네트워크에 분산될 수 없습니다.

- 크로스-프레미스 연결이 필요한 경우가 아니면 여러 가상 네트워크를 연결할 때 온-프레미스 VPN 게이트웨이는 필요하지 않습니다.

- VNet 간 연결은 Azure 가상 네트워크 연결을 지원합니다. 그러나 가상 네트워크에 포함되어 있지 않은 가상 컴퓨터 또는 클라우드 서비스 연결은 지원하지 않습니다.

- VNet 간 연결에는 동적 라우팅 VPN이 있는 Azure VPN 게이트웨이가 필요합니다. Azure 정적 라우팅 VPN은 지원되지 않습니다.

- 가상 네트워크 연결을 다중 사이트 VPN과 함께 사용할 수 있으며 가상 네트워크 VPN 게이트웨이당 최대 10개의 VPN 터널을 다른 가상 네트워크 또는 온-프레미스 사이트에 연결할 수 있습니다.

- 가상 네트워크 및 온-프레미스 로컬 네트워크 사이트의 주소 공간이 겹쳐서는 안 됩니다. 주소 공간이 겹치면 가상 네트워크 만들기 또는 netcfg 구성 파일 업로드가 실패합니다.

- 가상 네트워크 한 쌍 간의 중복 터널은 지원되지 않습니다.

- P2S VPN을 비롯한 가상 네트워크의 모든 VPN 터널은 Azure VPN 게이트웨이의 사용 가능한 대역폭 및 Azure의 동일 VPN 게이트웨이 작동 시간 SLA를 공유합니다.

- VNet-VNet 트래픽은 Azure 백본 전체에서 이동됩니다.

## VNet 간 연결 구성

이 절차에서는 VNet1과 VNet2의 두 가상 네트워크를 연결하는 과정을 단계별로 진행합니다. 여기서 실제 네트워크 디자인 요구 사항과 호환되는 IP 주소 범위를 대체하려면 네트워킹에 대해 잘 알고 있어야 합니다. Azure 가상 네트워크에서 다른 Azure 가상 네트워크에 연결하는 과정은 S2S(사이트 간) VPN을 통해 온-프레미스 네트워크에 연결하는 과정과 같습니다.

이 절차에서는 기본적으로 Azure 클래식 포털을 사용하지만 VPN 게이트웨이를 연결하려면 Microsoft Azure PowerShell cmdlet을 사용해야 합니다.



## 1단계 - IP 주소 범위 계획

네트워크 구성 파일(netcfg)을 구성하는 데 사용할 범위를 결정하는 것이 중요합니다. VNet1 측면에서 볼 때 VNet2는 Azure 플랫폼에 정의되어 있는 또 다른 VPN 연결일 뿐이고 VNet2에서도 마찬가지로 VNet1은 또 하나의 VPN 연결일 뿐입니다. 이 두 가상 네트워크는 모두 서로를 로컬 네트워크 사이트로 식별합니다. 따라서 VNet 범위 또는 로컬 네트워크 범위가 겹치지 않는지 확인해야 합니다.

표 1에는 VNet을 정의하는 방법의 예가 나와 있습니다. 아래의 범위는 지침으로만 참고하고, 실제 가상 네트워크에 사용할 범위를 기록해야 합니다. 이 정보는 이후 단계에서 필요합니다.

**표 1**

|가상 네트워크 |가상 네트워크 사이트 정의 |로컬 네트워크 사이트 정의|
|:----------------|:-------------------------------|:----------------------------|
|VNet1 |VNet1(10.1.0.0/16) |VNet2(10.2.0.0/16) |
|VNet2 |VNet2(10.2.0.0/16) |VNet1(10.1.0.0/16) |

## 2단계 - 가상 네트워크 만들기

이 자습서에서는 VNet1과 VNet2의 두 가상 네트워크를 만듭니다. 실제로 VNet을 만들 때는 해당 VNet에 맞는 값을 대신 사용하세요. 이 자습서에서는 VNet에 대해 다음 값을 사용합니다.

VNet1: 주소 공간 = 10.1.0.0/16, 지역 = US West

VNet2: 주소 공간 = 10.2.0.0/16, 지역 = Japan East

1. [Azure 클래식 포털](https://manage.windowsazure.com)에 로그인합니다. 이러한 단계는 최신 Azure 포털을 사용하지 않습니다.

2. 화면의 왼쪽 아래에서 **새로 만들기**를 클릭합니다. 탐색 창에서 **네트워크 서비스**를 클릭한 다음 **가상 네트워크**를 클릭합니다. **사용자 지정 만들기**를 클릭하여 구성 마법사를 시작합니다.

**가상 네트워크 세부 정보** 페이지에서 아래 정보를 입력합니다.

  ![가상 네트워크 세부 정보](./media/virtual-networks-configure-vnet-to-vnet-connection/IC736055.png)

  - **이름** - 가상 네트워크의 이름을 지정합니다. 예를 들면 VNet1이 있습니다.
  - **위치** – 가상 네트워크를 만들 때 Azure 위치(지역)와 연결합니다. 예를 들어 실제로 West US에 배치할 가상 네트워크에 VM을 배포하려는 경우 해당 위치를 선택합니다. 가상 네트워크를 만든 후에는 가상 네트워크에 연결된 위치를 변경할 수 없습니다.


**DNS 서버 및 VPN 연결** 페이지에서 다음 정보를 입력한 후 오른쪽 아래에서 다음 화살표를 클릭합니다.

  ![DNS 서버 및 VPN 연결](./media/virtual-networks-configure-vnet-to-vnet-connection/IC736056.jpg)


- **DNS 서버** - DNS 서버 이름 및 IP 주소를 입력하거나 드롭다운에서 이전에 등록된 DNS 서버를 선택합니다. 이 설정은 DNS 서버를 만들지 않으며, 이 설정을 사용하여 이 가상 네트워크에 대한 이름 확인에 사용할 DNS 서버를 지정할 수 있습니다. 가상 네트워크 간에 이름 확인을 사용하려면 Azure에서 제공하는 이름 확인 기능을 사용하는 대신 고유한 DNS 서버를 구성해야 합니다.

  - 확인란은 선택하지 말고 오른쪽 아래의 화살표를 클릭하여 다음 화면으로 이동합니다.

**가상 네트워크 주소 공간** 페이지에서 가상 네트워크에 사용할 주소 범위를 지정합니다. 이 범위의 DIPS(동적 IP 주소)가 해당 가상 네트워크에 배포하는 VM 및 기타 역할 인스턴스에 할당됩니다. 온-프레미스 네트워크에 사용되는 범위와 겹치지 않는 범위를 선택해야 합니다. 이러한 범위는 네트워크 관리자와 협의해야 하며, 네트워크 관리자는 가상 네트워크에 사용할 수 있도록 온-프레미스 네트워크 주소 공간에서 IP 주소 범위를 지정해야 할 수 있습니다.


  ![가상 네트워크 주소 공간 페이지](./media/virtual-networks-configure-vnet-to-vnet-connection/IC736057.jpg)

  **다음 정보를 입력하고** 오른쪽 아래의 확인 표시를 클릭하여 네트워크를 구성합니다.

  - **주소 공간** - 시작 IP 및 주소 수를 포함합니다. 지정한 주소 공간이 온-프레미스 네트워크에 가지고 있는 주소 공간과 겹치지 않는지 확인하세요. 이 예제에서는 VNet1에 대해 10.1.0.0/16을 사용합니다.
  - **서브넷 추가** - 시작 IP 및 주소 수를 포함합니다. 추가 서브넷은 필요하지 않지만 고정 DIPS가 있는 VM에 대해 별도의 서브넷을 만들 수 있습니다. 또는 기타 역할 인스턴스와 별도의 서브넷에 VM을 배치할 수 있습니다.

페이지 오른쪽 아래에 있는 **확인 표시를 클릭하면** 가상 네트워크 만들기가 시작됩니다. 완료되면 Azure 클래식 포털의 *네트워크* 페이지에 있는 *상태*에 *생성됨*이 표시됩니다.

## 3단계 - 다른 가상 네트워크 만들기

다음으로, 이전 단계를 반복하여 다른 가상 네트워크를 만듭니다. 이 연습에서 나중에 이 두 개의 가상 네트워크를 연결하게 됩니다. 주소 공간이 반드시 중복되거나 겹치지 않도록 해야 합니다. 이 자습서에서는 다음 값을 사용합니다.

- **VNet2**
- **주소 공간** = 10.2.0.0/16
- **지역** = 일본 동부

## 4단계 - 로컬 네트워크 추가

VNet 간 구성을 만드는 경우 서로를 로컬 네트워크 사이트로 식별하도록 각 VNet을 구성해야 합니다. 이 절차에서는 각 VNet을 로컬 네트워크로 구성합니다. 이전에 구성한 VNet이 이미 있으면 다음 방법을 통해 Azure 클래식 포털에서 해당 VNet을 로컬 네트워크로 추가합니다.

1. 화면의 왼쪽 아래에서 **새로 만들기**를 클릭합니다. 탐색 창에서 **네트워크 서비스**를 클릭한 다음 **가상 네트워크**를 클릭합니다. **로컬 네트워크 추가**를 클릭합니다.

2. **로컬 네트워크 세부 정보 지정** 페이지의 **이름**에 VNet 간 구성에 사용할 가상 네트워크의 이름을 입력합니다. 이 예제에서는 구성에서 VNet2가 이 가상 네트워크를 가리키도록 지정할 것이므로 VNet 1을 사용합니다.

  VPN 장치 IP 주소에는 IP 주소를 사용합니다. 일반적으로는 VPN 장치의 실제 외부 IP 주소를 사용합니다. VNet 간 구성에서는 게이트웨이 IP 주소를 사용합니다. 그러나 아직 게이트웨이를 만들지 않았으므로 여기서 지정하는 IP 주소를 자리 표시자로 사용합니다. Azure에서 해당하는 게이트웨이 IP 주소를 생성하고 나면 이 설정으로 돌아와서 IP 주소를 구성합니다.

3. **주소 지정 페이지**에서 VNet1의 실제 IP 주소 범위와 주소 수를 입력합니다. 이 범위는 앞에서 VNet1에 대해 지정한 범위와 정확하게 일치해야 합니다.

4. VNet1을 로컬 네트워크로 구성한 후 뒤로 돌아가서 해당 VNet에 해당하는 값을 사용해 VNet2를 구성합니다.

5. 이제 각 VNet이 서로를 로컬 네트워크로 가리킵니다. Azure 클래식 포털에서 VNet1의 **구성** 페이지로 이동합니다. **사이트 간 연결**에서 **로컬 네트워크에 연결**을 선택하고 로컬 네트워크로 **VNET2**를 선택합니다.

  ![로컬 네트워크에 연결](./media/virtual-networks-configure-vnet-to-vnet-connection/IC736058.jpg)

6. 같은 페이지의 **가상 네트워크 주소 공간** 섹션에서 **게이트웨이 서브넷 추가**를 클릭하고 페이지 아래쪽의 **저장** 아이콘을 클릭하여 구성을 저장합니다.

7. VNet2에 대해 위의 단계를 반복하여 VNet1을 로컬 네트워크로 지정합니다.

## 5단계 - 각 VNet에 대한 동적 라우팅 게이트웨이 만들기

각 VNet을 구성했으므로 이제 VNet 게이트웨이를 구성합니다.

1. **네트워크** 페이지에서 가상 네트워크의 상태 열이 **생성됨**인지 확인합니다.

2. **이름** 열에서 가상 네트워크의 이름을 클릭합니다.

3. **대시보드** 페이지에서 이 VNet에 게이트웨이가 아직 구성되지 않은 것을 볼 수 있습니다. 게이트웨이 구성 단계를 진행할 때 이 상태 변경 내용이 표시됩니다.

4. 페이지 아래쪽에서 **게이트웨이 만들기**를 클릭합니다.

  **동적 라우팅**을 선택해야 합니다. 시스템에서 게이트웨이 만들 것인지 확인하는 메시지를 표시하면 예를 클릭합니다.

  ![게이트웨이 유형](./media/virtual-networks-configure-vnet-to-vnet-connection/IC717026.png)

5. 게이트웨이를 만들 때 페이지의 게이트웨이 그래픽이 노란색으로 변경되고 게이트웨이를 만드는 중이 표시됩니다. 일반적으로 게이트웨이를 만드는 데 약 15분이 소요됩니다.

6. 다른 VNet에 대해서도 같은 단계를 반복합니다. 이때 **동적 게이트웨이**를 선택해야 합니다. 첫 번째 VNet 게이트웨이 만들기가 완료되지 않아도 다른 VNet의 게이트웨이 만들기를 시작할 수 있습니다.

7. 게이트웨이 상태가 연결 중으로 변경되면 각 게이트웨이의 IP 주소가 대시보드에 표시됩니다. 혼합되지 않도록 주의하여 각 VNet에 해당하는 IP 주소를 적어 둡니다. 이는 **로컬 네트워크**의 VPN 장치에 대한 자리 표시자 IP 주소를 편집할 때 사용되는 IP 주소입니다.

## 6단계 - 로컬 네트워크 편집

1. **로컬 네트워크** 페이지에서 편집할 로컬 네트워크 이름을 클릭하고 페이지 아래쪽에서 **편집**을 클릭합니다. **VPN 장치 IP 주소**의 경우 VNet에 해당하는 게이트웨이의 IP 주소를 입력합니다. 예를 들어 VNet1의 경우 VNet1에 할당한 게이트웨이 IP 주소를 입력합니다. 그런 다음 페이지 아래쪽의 화살표를 클릭합니다.

2. **주소 공간 지정** 페이지에서 아무 것도 변경하지 않고 오른쪽 아래의 확인 표시를 클릭합니다.

## 7단계 - VPN 게이트웨이 연결

위의 모든 단계를 완료한 후에는 IPsec/IKE 사전 공유 키를 동일하게 설정합니다. 이 작업은 REST API 또는 PowerShell cmdlet을 사용하여 수행할 수 있습니다. PowerShell을 사용하는 경우 Microsoft Azure PowerShell cmdlet이 [최신 버전](https://azure.microsoft.com/downloads/)인지 확인합니다. 아래의 예에서는 PowerShell cmdlet을 사용하여 키 값을 A1b2C3D4로 설정합니다. 두 키가 모두 같은 키 값을 사용해야 합니다. 아래의 예를 편집하여 실제 값을 반영하세요.

VNet1의 경우

	Set-AzureVNetGatewayKey -VNetName VNet1 -LocalNetworkSiteName VNet2 -SharedKey A1b2C3D4

VNet2의 경우

	Set-AzureVNetGatewayKey -VNetName VNet2 -LocalNetworkSiteName VNet1 -SharedKey A1b2C3D4

연결이 초기화될 때까지 기다립니다. 게이트웨이가 초기화되면 아래 그림과 같이 게이트웨이가 표시되며 가상 네트워크가 연결됩니다.

![게이트웨이 상태 - 연결됨](./media/virtual-networks-configure-vnet-to-vnet-connection/IC736059.jpg)

[AZURE.INCLUDE [vpn-gateway-no-nsg-include](../../includes/vpn-gateway-no-nsg-include.md)]

## 다음 단계

연결이 완료되면 가상 네트워크에 가상 컴퓨터를 추가할 수 있습니다. 자세한 내용은 [가상 컴퓨터 설명서](https://azure.microsoft.com/documentation/services/virtual-machines/)를 참조하세요.


[1]: ../hdinsight-hbase-geo-replication-configure-vnets.md
[2]: http://channel9.msdn.com/Series/Getting-started-with-Windows-Azure-HDInsight-Service/Configure-the-VPN-connectivity-between-two-Azure-virtual-networks
 

<!---HONumber=AcomDC_0316_2016-->