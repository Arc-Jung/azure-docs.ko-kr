<properties 
   pageTitle="Visual Studio 및 SSDT를 사용하여 마이그레이션" 
   description="Microsoft Azure SQL 데이터베이스, 데이터베이스 마이그레이션, 데이터베이스 가져오기, 데이터베이스 내보내기, 마이그레이션 마법사" 
   services="sql-database" 
   documentationCenter="" 
   authors="pehteh" 
   manager="jeffreyg" 
   editor="monicar"/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-management" 
   ms.date="04/14/2015"
   ms.author="pehteh"/>

#데이터베이스를 제자리에서 업데이트한 후 Azure SQL 데이터베이스에 배포

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/01VSSSDTDiagram.png)

데이터베이스를 Azure SQL 데이터베이스 V12로 마이그레이션하려면 스키마를 변경해야 하는데 스키마 변경 작업을 SAMW(SQL Azure 마이그레이션 마법사)에서 처리할 수 없는 경우에 이 옵션을 사용하세요. 해당 데이터베이스가 아직 Azure SQL 데이터베이스에서 지원되지 않는 SQL Server 기능을 사용하는 경우에 이 문제가 발생합니다. 이 옵션에서는 일단 Visual Studio를 사용하여 원본 데이터베이스에서 데이터베이스 프로젝트를 만듭니다. 그런 다음 프로젝트의 대상 플랫폼을 Azure SQL 데이터베이스 V12로 설정하고 모든 호환성 문제를 식별할 수 있도록 프로젝트를 빌드합니다. SAMW는 전부는 아니지만 많은 호환성 문제를 해결할 수 있기 때문에 프로젝트의 모든 스크립트를 처리하는 첫 번째 단계로 사용됩니다. SAMW를 사용하는 것은 선택 사항이지만 사용하는 것이 좋습니다. SAMW 사용하여 스크립트 파일을 처리한 후 프로젝트를 빌드하면 나머지 문제가 식별됩니다. 식별된 문제는 Visual Studio에서 T-SQL 편집 도구를 사용하여 수동으로 해결해야 합니다. 프로젝트가 빌드되면 스키마를 원본 데이터베이스의 복사본(권장)에 다시 게시하여 스키마와 데이터를 제자리에서 업데이트합니다. 그런 다음 업데이트된 데이터베이스를 Azure에 직접 배포하거나 옵션 1에서 설명한 방법에 따라 BACPAC 파일을 내보낸 후 가져와서 배포합니다.
 
이 옵션은 데이터베이스 스키마를 제자리에서 업데이트한 후 Azure에 배포하기 때문에 데이터베이스의 복사본으로 작업을 수행하는 것이 좋습니다. Visual Studio 스키마 비교 도구를 사용하여 데이터베이스에 적용될 모든 변경 사항을 검토한 후 프로젝트를 게시할 수 있습니다.

SAMW(SQL Azure 마이그레이션 마법사)의 사용은 선택 사항이지만 사용하는 것이 좋습니다. SAMW는 함수 본문, 저장 프로시저 및 트리거 내부의 호환성 문제를 감지합니다. 만약 SAMW를 사용하지 않는다면 배포 전에는 이러한 호환성 문제를 감지할 수 없습니다. 스키마 전용 배포가 필요한 경우에는 업데이트된 스키마를 Visual Studio에서 Azure SQL 데이터베이스로 직접 게시할 수 있습니다.

## 마이그레이션 단계

1.	Visual Studio에서 **SQL Server 개체 탐색기**를 엽니다. **SQL Server 추가**를 사용하여 마이그레이션할 데이터베이스가 포함된 SQL Server 인스턴스에 연결합니다. 탐색기에서 데이터베이스를 찾아 마우스 오른쪽 단추로 클릭하고 **새 프로젝트 만들기…**를 선택합니다. 

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/02MigrateSSDT.png)

2.	가져오기 설정을 **응용 프로그램 범위 개체만 가져오기**로 구성합니다. 참조된 로그인, 사용 권한 및 데이터베이스 설정을 가져오는 옵션의 선택을 취소합니다.

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/03MigrateSSDT.png)

3.	**시작**을 클릭하여 데이터베이스를 가져오고 프로젝트를 만듭니다. 이 프로젝트에는 데이터베이스의 각 개체에 대한 T-SQL 스크립트 파일이 포함될 것입니다. 스크립트 파일은 프로젝트 내의 폴더에서 중첩됩니다.

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/04MigrateSSDT.png)

4.	Visual Studio 솔루션 탐색기에서 데이터베이스 프로젝트를 마우스 오른쪽 단추로 클릭하고 속성을 선택합니다. **프로젝트 설정** 페이지가 열릴 것입니다. 이 페이지에서 대상 플랫폼을 Microsoft Azure SQL 데이터베이스 V12로 구성해야 합니다.

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/05MigrateSSDT.png)

5.	선택 사항: 프로젝트를 마우스 오른쪽 단추로 클릭하고 **빌드**를 클릭하여 프로젝트를 빌드합니다. 이 시점에서 꼭 필요한 작업은 아니지만 지금 이렇게 하면 프로젝트의 호환성 문제 수와 다음 단계의 효과에 대한 기준을 세울 수 있습니다.

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/06MigrateSSDT.png)

6.	선택 사항: 프로젝트를 마우스 오른쪽 단추로 클릭하고 **스냅숏 프로젝트**를 선택합니다. 변환의 시작 단계부터 이후 단계까지 스냅숏을 만들면 스키마 비교 도구를 사용하여 각 단계의 스키마를 비교할 수 있습니다.

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/07MigrateSSDT.png) - 프로젝트 스냅숏을 만들면 완전한 프로젝트 스키마를 포함하는 타임스탬프 .dacpac 파일이 생성됩니다. 프로세스의 어떤 단계에서 해당 스냅숏을 만들었는지 나타내도록 파일 이름을 수정할 수 있습니다. ![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/08MigrateSSDT.png)

7.	SAMW(SQL Azure 마이그레이션 마법사)를 사용하여 가져온 스크립트 파일을 처리합니다. 폴더 옵션을 사용하여 루트 프로젝트 폴더를 선택합니다. ![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/09MigrateSSDT.png)

8.	마법사가 이 폴더와 모든 하위 폴더의 각 스크립트 파일을 처리할 것입니다. 다음 페이지에 결과 요약 정보가 표시됩니다. ![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/10MigrateSSDT.png)
9.	다음을 클릭하여 변경된 파일의 요약 목록을 봅니다. 

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/11MigrateSSDT.png)

>처리 이전의 원본 파일과 처리 이후에 영향을 받은 파일을 모두 사용하여 페이지 상단에 표시된 위치에 임시 복사본이 생성됩니다.

10.	덮어쓰기를 클릭하고 확인 대화 상자에서 확인을 클릭하면 변경된 파일이 원래 파일을 덮어씁니다. 실제로 변경된 파일만 덮어씁니다.
11.	선택 사항입니다. 스키마 비교를 사용하여 프로젝트를 이전 스냅숏 또는 원래 데이터베이스와 비교하여 마법사에서 무엇을 변경했는지 파악합니다. 이 시점에서 스냅숏을 더 만들 수도 있습니다. 

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/12MigrateSSDT.png)

12.	프로젝트를 다시 빌드(이전 단계 참조)하여 어떤 오류가 남아 있는지 확인합니다.

13.	오류를 체계적으로 처리하여 각 문제를 해결합니다. 각 변경 사항이 해당 데이터베이스를 사용하는 응용 프로그램에 미치는 영향을 평가합니다.

14.	데이터베이스에 오류가 없으면 프로젝트를 마우스 오른쪽 단추로 클릭하고 **게시**를 선택하여 빌드한 후 원본 데이터베이스의 복사본(적어도 처음에는 복사본을 사용하기를 권장)에 데이터베이스를 게시합니다. 이 단계의 목표는 원본 데이터베이스 스키마를 업데이트하고 그에 따라 데이터베이스의 데이터를 변경하는 것입니다.
- 원본 SQL Server 버전에 따라 게시하기 전에 배포가 가능하도록 프로젝트의 대상 플랫폼을 다시 설정해야 할 수 있습니다. 기존 SQL Server 데이터베이스를 마이그레이션하는 경우 상위 SQL Server 버전으로 데이터베이스를 처음 마이그레이션하는 경우를 제외하고 원본 SQL Server에서 지원되지 않는 기능을 프로젝트에 가져오면 안 됩니다. 
- 적절한 게시 옵션을 사용하도록 게시 단계를 구성해야 합니다. 예를 들어 프로젝트에서 지원되지 않는 개체를 삭제하거나 주석으로 처리하면 데이터베이스에서도 해당 개체를 삭제해야 하므로 대상 데이터베이스에서 데이터를 삭제할 수 있도록 게시를 허용해야 합니다. 
- 반복적으로 게시할 것으로 예상되는 경우 

15.	옵션 1에서 설명한 방법에 따라 복사한 데이터베이스를 Azure SQL 데이터베이스에 배포합니다.

## 마이그레이션 유효성 검사

마이그레이션을 완료한 후에는 마이그레이션된 데이터베이스의 스키마를 원본 데이터베이스의 스키마와 비교하여 변경 사항을 살펴보고 스키마가 예상대로 되었는지, 응용 프로그램을 새 데이터베이스로 마이그레이션할 때 아무 문제도 일으키지 않는지 확인하는 것이 좋습니다. Visual Studio의 SQL Server 도구에 포함된 스키마 비교 도구를 사용하여 비교할 수 있습니다. Azure SQL 데이터베이스의 데이터베이스를 원래 SQL Server 데이터베이스 또는 데이터베이스를 처음으로 프로젝트에 가져올 때 만든 스냅숏과 비교할 수 있습니다.

1.	마이그레이션된 데이터베이스가 들어 있는 Azure SQL 데이터베이스의 서버에 연결하고 데이터베이스를 찾습니다. 

2.	데이터베이스를 마우스 오른쪽 단추로 클릭하고 **스키마 비교...**를 선택합니다. 그러면 새로운 스키마 비교가 시작되고 왼쪽에 Azure 데이터베이스가 원본으로 선택될 것입니다. 오른쪽에서 대상 선택 드롭다운을 사용하여 비교할 대상 데이터베이스 또는 스냅숏 파일을 선택합니다.

3.	원본과 대상을 선택했으면 비교를 클릭하여 비교를 시작합니다. Azure SQL 데이터베이스에서 복잡한 데이터베이스의 스키마를 로드하려면 상당한 시간이 걸릴 수 있습니다. 가격 책정 계층을 더 높이고 Azure SQL 데이터베이스에서 스키마를 로드하고 다른 메타데이터 작업을 수행하면 시간이 적게 걸립니다.

4.	비교가 완료되면 차이점을 검토합니다. 특별한 문제가 없다면 일반적으로 어느 스키마에도 변경 사항을 적용하면 안 됩니다.

아래의 스키마 비교에서 왼쪽에 있는 Azure SQL 데이터베이스 V12의 Adventure Works 2014 데이터베이스는 SQL Azure 마이그레이션 마법사를 통해 변환 및 마이그레이션되었으므로 오른쪽에 있는 SQL Server의 원본 데이터베이스와 비교합니다.

![대체 텍스트](./media/sql-database-migrate-visualstudio-ssdt/13MigrateSSDT.png)

 

<!---HONumber=July15_HO2-->