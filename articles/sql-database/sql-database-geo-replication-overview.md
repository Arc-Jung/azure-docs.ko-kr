<properties
	pageTitle="Azure SQL 데이터베이스에 대한 활성 지역 복제"
	description="이 항목에서는 SQL 데이터베이스 및 그 사용법에 대한 활성 지역 복제를 설명합니다."
	services="sql-database"
	documentationCenter="na"
	authors="rothja"
	manager="jeffreyg"
	editor="monicar" />


<tags
	ms.service="sql-database"
	ms.devlang="na"
	ms.topic="article"
	ms.tgt_pltfrm="na"
	ms.workload="data-management"
	ms.date="10/21/2015"
	ms.author="jroth" />

# Azure SQL 데이터베이스에 대한 활성 지역 복제

## 개요
활성 지역 복제 기능은 매커니즘을 구현하여 동일한 Microsoft Azure 지역이나 다른 지역(지역 중복)에서 데이터베이스 중복을 제공합니다. 활성 지역 복제는 데이터베이스에서 커밋된 트랜잭션을 서로 다른 서버의 최대 4개의 데이터베이스 복사본으로 비동기적으로 복제합니다. 원본 데이터베이스는 연속 복사의 주 데이터베이스가 됩니다. 각 연속 복사는 온라인 보조 데이터베이스라고 합니다. 주 데이터베이스는 커밋된 트랜잭션을 각 온라인 보조 데이터베이스로 비동기적으로 복제합니다. 지정된 지점에서 온라인 보조 데이터는 주 데이터베이스보다 약간 뒤에 있을 수 있는 반면 온라인 보조 데이터는 주 데이터베이스에 커밋된 변경 내용과 트랜잭션 측면에서 항상 일관되도록 보장됩니다. 활성 지역 복제는 최대 4개의 온라인 보조 또는 최대 3개의 온라인 보조 및 하나의 오프라인 보조를 지원합니다.

활성 지역 복제의 주요 이점 중 하나는 데이터베이스 수준 재해 복구 솔루션을 제공한다는 것입니다. 활성 지역 복제를 사용하여 Premium 서비스 계층에서 사용자 데이터베이스를 구성하여 동일한 또는 다른 영역 내에서 서로 다른 Microsoft Azure SQL 데이터베이스 서버의 데이터베이스에 트랜잭션을 복제할 수 있습니다. 지역 간 중복을 통해 응용 프로그램을 자연 재해, 치명적인 사람의 실수 또는 악의적 행동으로 인한 데이터 센터의 영구적 손실로부터 복구합니다.

다른 주요 이점은 온라인 보조 데이터베이스를 읽을 수 있다는 것입니다. 따라서 온라인 보조는 보고와 같은 읽기 작업에 대한 부하 분산 장치로 작동할 수 있습니다. 재해 복구에 대해 다른 지역에 온라인 보조를 만들 수 있으며 다른 서버의 동일한 지역에 온라인 보조도 보유할 수 있습니다. 두 온라인 보조 데이터베이스는 여러 지역에 분산된 클라이언트를 처리하는 읽기 전용 작업의 균형을 조정하는데 사용할 수 있습니다.

활성 지역 복제를 사용할 수 있는 다른 시나리오는 다음을 포함할 수 있습니다.

- **데이터베이스 마이그레이션**: 활성 지역 복제를 사용하여 최소 가동 중지 시간으로 하나의 서버에서 다른 온라인으로 데이터베이스를 마이그레이션할 수 있습니다.
- **응용 프로그램 업그레이드**: 장애 복구 옵션으로 온라인 보조를 사용할 수 있습니다.

실제 비즈니스 연속성을 달성하기 위해 데이터 센터 간에 중복을 관계형 저장소에 추가하는 것은 솔루션의 일부입니다. 치명적인 오류 후 응용 프로그램(서비스) 종단 간 복구에는 서비스 및 모든 종속성 서비스를 구성하는 모든 구성 요소의 복구가 필요합니다. 이러한 구성 요소의 예에는 클라이언트 소프트웨어(예: 사용자 지정 JavaScript를 사용한 브라우저), 웹 프런트 엔드, 저장소 및 DNS가 포함됩니다. 모든 구성 요소는 동일한 오류에 탄력적이며 응용 프로그램의 복구 시간 목표(RTO) 내에서 사용할 수 있는 것이 중요합니다. 따라서 모든 종속성 서비스를 확인하고 제고하는 보장 사항 및 기능을 이해해야 합니다. 그런 다음 의존하는 서비스 장애 조치 중 서비스 기능을 확인하도록 적절한 단계를 수행해야 합니다. 재해 복구를 위한 솔루션 설계에 대한 자세한 내용은 [활성 지역 복제를 사용하여 재해 복구를 위한 클라우드 솔루션 설계](sql-database-designing-cloud-solutions-for-disaster-recover.md)를 참조하세요.

## 활성 지역 복제 기능
활성 지역 복제 기능은 다음과 같은 필수 기능을 제공합니다.

- **자동 비동기 복제**: 온라인 보조 데이터베이스가 시드된 후 주 데이터베이스에 대한 업데이트는 온라인 보조 데이터베이스에 자동으로 비동기적으로 복사됩니다. 즉, 트랜잭션은 온라인 보조 데이터베이스에 복사되기 전에 주 데이터베이스에 커밋됩니다. 그러나 시드 후 온라인 보조 데이터베이스는 시간의 특정된 시점에서 트랜잭션 측면에서 일관적입니다.
	>[AZURE.NOTE]비동기 복제는 원격 데이터 센터가 연결된 광역 네트워크가 특징인 대기 시간을 수용합니다.

- **여러 온라인 보조 데이터베이스**: 두 개 이상의 온라인 보조 데이터베이스는 주 데이터베이스와 응용 프로그램에 대한 중복성 및 보호를 늘립니다. 여러 온라인 데이터베이스가 있는 경우 응용 프로그램은 온라인 보조 데이터베이스 중 하나가 실패하더라도 보호를 유지합니다. 하나의 온라인 보조 데이터베이스가 있고 실패할 경우 새 온라인 보조 데이터베이스를 만들 때까지 응용 프로그램은 더 높은 위험에 노출됩니다.

- **읽을 수 있는 온라인 보조 데이터베이스**: 응용 프로그램은 주 데이터베이스에 액세스하는데 사용된 동일한 보안 주체를 사용하여 읽기 전용 작업에 대한 온라인 보조 데이터베이스에 액세스할 수 있습니다. 온라인 보조 데이터베이스에 대한 연속 복사 작업은 응용 프로그램 액세스보다 우선합니다. 또한 온라인 보조 데이터베이스의 쿼리가 장기적 테이블 잠금을 야기하는 경우 트랜잭션은 주 데이터베이스에서 결국 실패할 수 있습니다.

- **장애 조치에 대한 사용자 제어 종료**: 온라인 보조 데이터베이스로 응용 프로그램 장애 조치를 하기 전에 주 데이터베이스와의 연속 복사 관계를 종료해야 합니다. 연속 복사 관계 종료는 응용 프로그램 또는 관리 스크립트에 의한 명시적 작업 또는 포털을 통한 수동적인 작업이 필요합니다. 종료 후 온라인 보조 데이터베이스는 독립 실행형 데이터베이스가 됩니다. 주 데이터베이스가 읽기 전용 데이터베이스가 아닌 한 읽기-쓰기 데이터베이스가 됩니다. 두 가지 형태의 [연속 복사 관계 종료](#termination-of-a-continuous-copy-relationship)는 이 항목의 뒷부분에 설명되어 있습니다.

>[AZURE.NOTE]활성 지역 복제는 Premium 서비스 계층의 데이터베이스에 대해서만 지원됩니다. 주 데이터베이스 및 온라인 보조 데이터베이스 모두에 적용됩니다. 온라인 보조 데이터베이스는 주 데이터베이스 이상의 성능 수준으로 구성되어야 합니다. 주 데이터베이스에 대한 성능 수준 변경은 보조 데이터베이스에 자동으로 복제되지 않습니다. 모든 업그레이드는 보조 데이터베이스에서 먼저 수행되고 주 데이터베이스에서 마지막으로 수행되어야 합니다. 성능 수준 변경에 대한 자세한 내용은 [성능 수준 변경](sql-database-scale-up.md)을 참조하세요. 온라인 보조 데이터베이스가 주 데이터베이스와 최소한 같은 크기여야 하는데 두 가지 주요한 이유가 있습니다. 보조는 주 데이터베이스와 같은 속도로 복제된 트랜잭션을 처리하기에 충분한 용량이 있어야 합니다. 보조 데이터베이스에 들어오는 트랜잭션을 처리할 수 있는 최소한 동일한 용량이 없는 경우 이 처리가 지연되어 결국 주 데이터베이스의 가용성에 영향을 줄 것입니다. 보조 데이터베이스에 주 데이터베이스와 동일한 용량이 없는 경우 장애 조치는 응용 프로그램의 성능 및 가용성을 저하시킬 수 있습니다.

## 연속 복사 관계 개념
로컬 데이터 중복성 및 작업 복구는 Azure SQL 데이터베이스에 대한 표준 기능입니다. 각 데이터베이스는 해당 데이터 센터 내에서 고가용성을 제공하는 동일한 데이터 센터에 상주하는 하나의 주 복제본 데이터베이스 및 두 개의 로컬 복제본 데이터베이스를 소유합니다. 즉, 활성 지역 복제 데이터베이스도 중복 복제본입니다. 두 주 및 온라인 보조 데이터베이스는 두 개의 보조 복제본이 있습니다. 그러나 보조 데이터베이스에 대한 주 복제본은 연속 복사 메커니즘에 의해 직접 업데이트되고 응용 프로그램에서 시작하는 모든 업데이트를 받아들일 수 없습니다. 다음 그림은 활성 지역 복제가 두 Azure 지역에 걸쳐 데이터베이스 중복성을 확장하는 방법을 보여 줍니다. 주 데이터베이스를 호스팅하는 지역은 주 지역이라고 합니다. 온라인 보조 데이터베이스를 호스팅하는 지역은 보조 지역이라고 합니다. 이 그림에서는 북유럽이 기본 지역입니다. 서유럽이 보조 지역입니다.

![연속 복사 관계](./media/sql-database-active-geo-replication/continuous-copy-relationships.gif)

주 데이터베이스를 사용할 수 없는 경우 지정된 온라인 보조 데이터베이스에 대한 연속 복사 관계 종료는 온라인 보조 데이터베이스를 독립 실행형 데이터베이스로 만듭니다. 온라인 보조 데이터베이스는 종료 시에도 변경되지 않는 주 데이터베이스의 읽기 전용/읽기-쓰기 모드를 상속합니다. 예를 들어 주 데이터베이스가 읽기 전용 데이터베이스인 경우 종료된 후 온라인 보조 데이터베이스는 읽기 전용 데이터베이스가 됩니다. 이 시점에서 응용 프로그램은 장애 조치를 수행하고 계속해서 온라인 보조 데이터베이스를 사용할 수 있습니다. 데이터 센터의 치명적인 오류 또는 기본 지역의 장시간 가동 중단 시 복원 기능을 제공하려면 하나 이상의 온라인 보조 데이터베이스를 다른 지역에 배치해야 합니다.

## 연속 복사 만들기
기존 데이터베이스의 연속 복사만 만들 수 있습니다. 기존 데이터베이스의 연속 복사를 만들면 지역 중복성을 추가하는데 유용합니다. 기존 데이터베이스를 다른 Azure SQL 데이터베이스 서버에 복사하는 연속 복사를 만들 수도 있습니다. 한번 만들면 보조 데이터베이스는 주 데이터베이스에서 복사된 데이터로 채워집니다. 이 프로세스를 시드라고 합니다. 시드가 완료되면 새로운 각각의 트랜잭션이 주 데이터베이스에 커밋된 후 복제됩니다.

기존 데이터베이스의 연속 복사를 만드는 방법에 대한 정보는 [지역에서 복제를 사용하도록 설정하는 방법](sql-database-business-continuity-design.md#how-to-enable-geo-replication)을 참조하세요.

## 중요한 데이터 손실 방지
광역 네트워크의 높은 대기 시간으로 인해 연속 복사는 비동기 복제 메커니즘을 사용합니다. 이렇게 하면 오류가 발생하는 경우 일부 데이터 손실은 불가피합니다. 그러나 일부 응용 프로그램은 데이터 손실이 없어야 합니다. 이러한 중요한 업데이트를 보호하기 위해 응용 프로그램 개발자는 트랜잭션을 커밋한 후 즉시 [sp\_wait\_for\_database\_copy\_sync](https://msdn.microsoft.com/library/dn467644.aspx) 시스템 프로시저를 호출할 수 있습니다. **sp\_wait\_for\_database\_copy\_sync** 호출은 마지막으로 커밋된 트랜잭션이 온라인 보조 데이터베이스로 복제될 때까지 호출 스레드를 차단합니다. 프로시저는 온라인 보조 데이터베이스에서 대기 중인 모든 트랜잭션을 승인할 때까지 기다립니다. **sp\_wait\_for\_database\_copy\_sync** 범위는 특정 연속 복사 링크로 지정됩니다. 주 데이터베이스에 대한 연결 권한이 있는 모든 사용자는 이 프로시저를 호출할 수 있습니다.

>[AZURE.NOTE]**sp\_wait\_for\_database\_copy\_sync** 프로시저 호출로 인해 발생한 지연은 상당히 클 수 있습니다. 지연은 큐의 길이 및 사용 가능한 대역폭에 따라 다릅니다. 반드시 필요하지 않는 한 이 프로시저 호출을 피합니다.

## 연속 복사 관계 종료
연속 복사 관계는 언제든지 종료될 수 있습니다. 연속 복사 관계 종료는 보조 데이터베이스를 제거하지 않습니다. 연속 복사 관계 종료하는 방법은 두 가지가 있습니다.

- **계획된 종료**는 데이터 손실이 허용되지 않는 계획된 작업에 유용합니다. 계획된 종료는 온라인 보조 데이터베이스가 시드된 후 주 데이터베이스에서만 수행할 수 있습니다. 계획된 종료에서는 주 데이터베이스에서 커밋된 모든 트랜잭션이 온라인 보조 데이터베이스에 먼저 복제된 다음 연속 복사 관계가 종료됩니다. 이는 보조 데이터베이스의 데이터 손실을 방지합니다.
- **계획되지 않은(강제) 종료**는 주 데이터베이스 또는 해당 온라인 보조 데이터베이스 중 하나의 손실에 응답하기 위한 것입니다. 강제 종료는 주 데이터베이스 또는 보조 데이터베이스에서 수행할 수 있습니다. 모든 강제 종료는 주 데이터베이스와 연결된 온라인 보조 데이터베이스 간의 복제 관계의 되돌릴 수 없는 손실을 가져옵니다. 또한 강제 종료는 주 데이터베이스에서 복제되지 않은 모든 트랜잭션 손실을 야기합니다. 강제 종료는 연속 복사 관계를 즉시 종료합니다. 진행 중인 트랜잭션은 온라인 보조 데이터베이스에 복제되지 않습니다. 그러므로 강제 종료는 주 데이터베이스에서 복제되지 않은 모든 트랜잭션의 되돌릴 수 없는 손실이 발생할 수 있습니다.

>[AZURE.NOTE]주 데이터베이스에 하나의 연속 복사 관계가 있는 경우 종료된 후 주 데이터베이스에 대한 업데이트는 더 이상 보호되지 않습니다.

연속 복사 관계를 종료하는 방법에 대한 자세한 내용은 [중단 상태에서 Azure SQL 데이터베이스 복구](sql-database-disaster-recovery.md)를 참조하세요.

## 다음 단계
활성 지역 복제 및 SQL 데이터베이스의 추가 비즈니스 연속성 기능에 대한 자세한 내용은 [비즈니스 연속성 개요](sql-database-business-continuity.md)를 참조하세요.

<!---HONumber=Oct15_HO4-->