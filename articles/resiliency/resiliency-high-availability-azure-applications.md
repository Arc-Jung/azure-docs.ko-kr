---
title: "Azure 응용 프로그램의 고가용성 | Microsoft 문서"
description: "Microsoft Azure에서 고가용성을 위한 응용 프로그램 설계 및 빌드에 대한 기술 개요와 심층 정보입니다."
services: 
documentationcenter: na
author: adamglick
manager: saladki
editor: 
ms.assetid: 8be4f323-ca00-4025-9356-c9bbc998eef3
ms.service: resiliency
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/18/2016
ms.author: aglick
translationtype: Human Translation
ms.sourcegitcommit: 219dcbfdca145bedb570eb9ef747ee00cc0342eb
ms.openlocfilehash: f7289c969184b518a6ff836cbb9ed7e20841206b


---
# <a name="high-availability-for-applications-built-on-microsoft-azure"></a>Microsoft Azure에 빌드된 응용 프로그램에 대한 고가용성
항상 사용 가능한 응용 프로그램은 종속 서비스 및 하드웨어에서 가용성, 부하 및 임시 오류의 변동 폭을 완화합니다. 응용 프로그램은 비즈니스 요구 사항 또는 SLA(서비스 수준 약정)에 정의된 적절한 사용자 및 시스템 응답 수준으로 계속 작동합니다.

## <a name="azure-high-availability-features"></a>Azure 고가용성 기능
Azure에는 항상 사용 가능한 응용 프로그램을 지원하는 많은 기본 제공 플랫폼 기능이 있습니다. 이 섹션에서는 이러한 주요 기능 중 일부를 설명합니다. 플랫폼의 보다 포괄적인 분석은 [Azure 복원력 기술 지침](resiliency-technical-guidance.md)을 참조하세요.

### <a name="fabric-controller"></a>패브릭 컨트롤러
Azure 패브릭 컨트롤러는 Azure 계산 인스턴스의 상태를 프로비전하고 모니터링합니다. 패브릭 컨트롤러는 호스트 및 게스트 컴퓨터 인스턴스의 하드웨어 및 소프트웨어의 상태를 확인합니다. 오류가 감지되면 VM 인스턴스를 자동으로 재배치하여 SLA를 적용합니다. 장애 도메인 및 업그레이드 도메인의 개념에서는 계산 SLA를 지원합니다.

여러 클라우드 서비스 역할 인스턴스를 배포할 경우 Azure는 여러 장애 도메인에 이러한 인스턴스를 배포합니다. 장애 도메인 경계는 기본적으로 동일한 지역에 있는 다른 하드웨어 랙입니다. 장애 도메인은 지역화된 하드웨어 오류로 인해 응용 프로그램의 서비스가 중단될 가능성을 줄입니다. 작업자 또는 웹 역할에 할당되는 장애 도메인의 수를 관리할 수 없습니다. 패브릭 컨트롤러는 Azure에서 호스팅한 응용 프로그램과 구별된 전용 리소스를 사용합니다. Azure 시스템의 핵심이기 때문에 작동 시간이 100%입니다. 장애 도메인에서 역할 인스턴스를 모니터링하고 관리합니다.

다음 다이어그램에서는 패브릭 컨트롤러에서 여러 장애 도메인에 배포하고 관리하는 Azure 공유 리소스를 보여 줍니다.

![장애 도메인 격리의 단순화된 보기](./media/resiliency-high-availability-azure-applications/fault-domain-isolation.png)

업그레이드 도메인은 함수에서 장애 도메인과 유사하지만 오류보다는 업그레이드를 지원합니다. 업그레이드 도메인은 특정 서비스의 어떤 인스턴스를 특정 지점에 업그레이드할지 결정하는 인스턴스 분리의 논리적 단위입니다. 호스티드 서비스 배포의 경우 기본적으로 5개의 업그레이드 도메인이 정의됩니다. 그러나 서비스 정의 파일에서 해당 값을 변경할 수 있습니다. 예를 들어, 웹 역할에 8개의 인스턴스가 있다고 가정합니다. 세 개의 업그레이드 도메인에 두 개의 인스턴스가 있고 하나의 업그레이드 도메인에 두 개의 인스턴스가 있습니다. Azure는 업데이트 시퀀스를 정의하지만 업그레이드 도메인 수에 기반합니다. 업그레이드 도메인에 대한 자세한 내용은 [클라우드 서비스 업데이트](../cloud-services/cloud-services-update-azure-service.md)를 참조하세요.

### <a name="features-in-other-services"></a>다른 서비스의 기능
계산 고가용성을 지원하는 이러한 플랫폼 기능 외에도 Azure는 다른 서비스에 대한 고가용성 기능을 포함합니다. 예를 들어, Azure 저장소는 모든 BLOB, 테이블 및 큐 데이터의 복제본 3개를 유지 관리합니다. 또한 보조 지역에 Blob 및 테이블의 백업을 저장하는 지역에서 복제 옵션을 사용할 수 있습니다. Azure 콘텐츠 배달 네트워크를 사용하면 중복성 및 확장성을 위해 Blob을 전 세계에 캐시할 수 있습니다. Azure SQL 데이터베이스는 여러 복제본도 유지 관리합니다.

문서의 [복원력 기술 지침](https://aka.ms/bctechguide) 시리즈 외에도 [Azure 클라우드 서비스에서 대규모 서비스 설계를 위한 모범 사례](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/) 문서를 참조하세요. 이 문서는 Azure 플랫폼 가용성 기능에 대한 자세한 논의를 제공합니다.

Azure에서 고가용성을 지원하는 여러 기능을 제공하지만 이러한 기능의 한계를 이해하는 것이 중요합니다.

* 계산의 경우 Azure는 역할을 사용할 수 있고 실행 중임을 보장하지만 응용 프로그램이 실행 중이거나 과부하된 상태인지는 알 수 없습니다.
* Azure SQL 데이터베이스의 경우 데이터는 지역 내에서 동기적으로 복제됩니다. 활성 지역 복제를 선택하면 동일한 지역(또는 다른 지역)에서 최대 4개의 추가 데이터베이스 복사본을 보유할 수 있습니다. 이러한 데이터베이스 복제본은 특정 시점 백업이 아닙니다. SQL 데이터베이스는 지정 시간 백업 기능을 제공합니다. SQL 데이터베이스에서 지정 시간 기능에 대해 자세히 알아보려면 [Azure SQL 데이터베이스 특정 시점 복원](https://azure.microsoft.com/blog/azure-sql-database-point-in-time-restore/)을 참고하세요.
* Azure 저장소의 경우 테이블 및 Blob 데이터는 기본적으로 대체 지역에 복제됩니다. 그러나 Microsoft가 대체 사이트로 장애 조치를 선택할 때까지 사용자는 복제본에 액세스할 수 없습니다. 지역 장애 조치는 장시간 지역 전체 서비스 중단의 경우에만 발생하고 지역 장애 조치 시간에 대한 SLA는 발생하지 않습니다. 데이터 손상이 복제본에 신속하게 확장된다는 점을 기억합니다.

이러한 이유로, 응용 프로그램별 가용성 기능을 사용하여 플랫폼 가용성 기능을 보완해야 합니다. 응용 프로그램에 특정된 가용성 기능에는 Blob 스냅숏 기능이 포함되어 Blob 데이터의 특정 시점 백업을 만듭니다.

### <a name="availability-sets-for-azure-virtual-machines"></a>Azure 가상 컴퓨터에 대한 가용성 집합
이 문서의 대부분은 클라우드 서비스에 중점을 두며 PaaS(Platform as a Service) 모델을 사용합니다. 그러나 Azure 가상 컴퓨터에 대한 특정 가용성 기능이 있으며 IaaS(Infrastructure as a Service) 모델을 사용합니다. 가상 컴퓨터를 사용하여 고가용성을 달성하려면 가용성 집합을 사용해야 합니다. 가용성 집합은 장애 도메인 및 업그레이드 도메인에 유사한 기능을 제공합니다. 가용성 집합 내에서 Azure는 하드웨어 오류 및 유지 관리 활동이 해당 그룹에서 컴퓨터를 모두 중지시키지 않도록 방지하는 방식으로 가상 컴퓨터를 배치합니다. 가용성 집합은 가상 컴퓨터의 가용성을 위해 Azure SLA를 달성해야 합니다.

다음 다이어그램은 해당하는 웹 및 SQL Server 가상 컴퓨터를 그룹화하는 두 개의 가용성 집합을 나태냅니다.

![Azure 가상 컴퓨터에 대한 가용성 집합](./media/resiliency-high-availability-azure-applications/availability-set-for-azure-virtual-machines.png)

> [!NOTE]
> 위의 다이어그램에서 SQL Server는 가상 컴퓨터에 설치되고 실행됩니다. Azure SQL 데이터베이스의 이전 설명과 달리 데이터베이스를 관리되는 서비스로 제공합니다.
> 
> 

## <a name="application-strategies-for-high-availability"></a>고가용성을 위한 응용 프로그램 전략
고가용성을 위한 대부분의 응용 프로그램 전략에는 응용 프로그램 구성 요소 간의 굳은 종속성을 중복하거나 제거하는 작업이 포함됩니다. 응용 프로그램 설계는 Azure 또는 타사 서비스의 산발적 가동 중지 시간 동안 내결함성을 지원해야 합니다. 다음 섹션에서는 클라우드 서비스의 가용성을 높이기 위한 응용 프로그램 패턴을 설명합니다.

### <a name="asynchronous-communication-and-durable-queues"></a>비동기 통신 및 지속성 큐
Azure 응용 프로그램의 가용성 향상을 위해 느슨하게 결합된 서비스 간의 비동기 통신을 고려합니다. 이 패턴에서는 저장소 큐 또는 Azure 서비스 버스 큐에 나중에 처리할 메시지를 작성합니다. 큐에 메시지를 작성하는 경우 제어는 메시지의 보낸 사람에게 즉시 반환됩니다. 응용 프로그램의 다른 계층은 메시지를 처리하며 일반적으로 작업자 역할로 구현됩니다. 작업자 역할이 중단되면 처리 서비스가 복원될 때까지 메시지가 큐에 누적됩니다. 큐를 사용할 수 있는 한 프런트 엔드 보낸 사람과 메시지 처리기 간에 직접적인 종속성은 없습니다. 따라서 분산된 응용 프로그램에서 처리량 병목 지점이 될 수 있는 동기적 서비스 호출에 대한 요구 사항을 제거합니다.

이 작업의 변형은 실패한 데이터베이스 호출에 대한 장애 조치 위치로 Azure 저장소(Blob, 테이블, 큐) 또는 서비스 버스 큐를 사용합니다. 예를 들어, 다른 서비스(예: Azure SQL 데이터베이스)에 대한 응용 프로그램 내의 동기적 호출이 반복해서 실패합니다. 지속성 저장소에 해당 데이터를 직렬화할 수 있습니다. 나중에 서비스 또는 데이터베이스가 다시 온라인 상태가 되면 응용 프로그램은 저장소의 요청을 다시 제출할 수 있습니다. 이 모델의 차이점은 중간 위치가 응용 프로그램 워크플로의 지속적인 부분이 아니라는 점입니다. 오류 시나리오에서만 사용됩니다.

두 시나리오 모두에서 비동기적 통신과 중간 저장소는 중단된 백 엔드 서비스가 전체 응용 프로그램을 중단하지 않도록 방지합니다. 큐는 논리적 매개자로 사용됩니다. 올바른 큐 서비스를 선택하는 방법에 자세한 지침은 [Azure 큐 및 Azure 서비스 버스 큐--비교 및 대조](../service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted.md)를 참조하세요.

### <a name="fault-detection-and-retry-logic"></a>오류 감지 및 다시 시도 논리
항상 사용 가능한 응용 프로그램 설계의 핵심은 코드 내에서 재시도 논리를 사용하여 일시적으로 중단된 서비스를 정상적으로 처리하는 것입니다. Microsoft Patterns and Practices 팀에서 개발된 [임시 오류 처리 응용 프로그램 블록](https://msdn.microsoft.com/library/hh680934.aspx)은 이 프로세스에서 응용 프로그램 개발자를 지원합니다. "임시"라는 단어는 비교적 짧은 시간 동안만 지속되는 일시적인 조건을 의미합니다. 이 문서의 컨텍스트에서 임시 오류 처리는 항상 사용 가능한 응용 프로그램을 개발하는 작업의 일부입니다. 임시 조건의 예로 간헐적인 네트워크 오류 및 데이터베이스 연결 끊김이 있습니다.

임시 오류 처리 응용 프로그램 블록은 정상적인 방법으로 코드 내에서 오류를 처리하는 간단한 방법입니다. 강력한 임시 오류 처리 논리를 추가하여 응용 프로그램의 가용성을 향상시키도록 사용할 수 있습니다. 대부분의 경우에 재시도 논리는 간략한 중단을 처리하고 한 번 이상의 실패한 시도 후에 보낸 사람과 받는 사람을 다시 연결합니다. 다시 시도가 성공하면 일반적으로 응용 프로그램 사용자에게 알려지지 않습니다.

개발자에게는 해당 재시도 논리를 관리하는 증분, 고정 간격 및 지수 등 세 가지 옵션이 있습니다. 증분은 재시도가 각각 선형 방식으로 증가하기 전까지 좀 더 오래 대기합니다(예: 1, 2, 3, 4 초). 고정 간격은 재시도 간에 동일한 시간(예: 2초)동안 대기합니다. 보다 임의적인 옵션의 경우 지수적 백오프는 재시도 사이에서 더 길게 대기합니다. 그러나 지수 동작을 사용합니다(예: 2, 4, 8, 16초).

다음은 코드 내에서 높은 수준의 전략입니다.

1. 재시도 전략 및 정책을 정의합니다.
2. 임시 오류가 발생할 수 있는 작업을 시도합니다.
3. 임시 오류가 발생할 경우 재시도 정책을 호출합니다.
4. 모든 재시도가 실패할 경우 최종 예외를 catch합니다.

시뮬레이션 된 오류에서 재시도 논리를 테스트하여 연속 작업을 재시도하면 예기치 않게 지연 시간이 길어지지 않는지 확인합니다. 전체 작업이 실패했다고 결정하기 전에 이 작업을 수행합니다.

### <a name="reference-data-pattern-for-high-availability"></a>고가용성에 대한 참조 데이터 패턴
참조 데이터는 응용 프로그램의 읽기 전용 데이터입니다. 이 데이터는 응용 프로그램이 비즈니스 작업 과정에서 트랜잭션 데이터를 생성하는 비즈니스 컨텍스트를 제공합니다. 트랜잭션 데이터는 참조 데이터의 특정 시점 함수입니다. 따라서 무결성은 트랜잭션 시 참조 데이터의 스냅숏에 따라 달라집니다. 다소 느슨한 정의이지만 이러한 목적에는 충분합니다.

응용 프로그램의 컨텍스트에서 참조 데이터는 응용 프로그램이 작동하기 위해 필요합니다. 해당하는 응용 프로그램은 참조 데이터를 만들고 유지 관리합니다. MDM(마스터 데이터 관리) 시스템은 종종 이러한 기능을 수행합니다. 이러한 시스템은 참조 데이터의 수명 주기를 담당합니다. 참조 데이터의 예로 제품 카탈로그, 직원 마스터, 부품 마스터 및 장비 마스터가 있습니다. 참조 데이터는 우편 번호 또는 세율 등 조직 외부에서 비롯되기도 합니다. 참조 데이터의 가용성을 높이기 위한 전략은 일반적으로 트랜잭션 데이터에 대한 전략보다 쉽습니다. 참조 데이터는 대부분 변경할 수 없다는 장점이 있습니다.

응용 프로그램과 함께 참조 데이터를 배포하여 런타임 시 자치적인 참조 데이터를 사용하는 Azure 웹 및 작업자 역할을 만들 수 있습니다. 로컬 저장소의 크기가 이러한 배포를 허용하는 경우 이상적인 상태입니다. 포함된 데이터베이스(SQL, NoSQL) 또는 로컬 파일 시스템에 배포된 XML 파일은 Azure 계산 규모 단위의 자치에 도움이 됩니다. 그러나 재배포하지 않아도 각 역할에서 데이터를 업데이트하는 메커니즘이 있어야 합니다. 이를 위해서 클라우드 저장소 끝점(예: Azure Blob 저장소 또는 SQL 데이터베이스)에 대한 참조 데이터를 업데이트합니다. 역할 시작 시 계산 노드에 데이터 업데이트를 다운로드하는 각 역할에 코드를 추가합니다. 또는 관리자가 역할 인스턴스에 강제 다운로드를 수행할 수 있게 하는 코드를 추가합니다.

또한 가용성을 향상하려면 저장소가 중지된 경우 역할이 참조 데이터 집합을 포함해야 합니다. 이를 통해 저장소 리소스가 업데이트를 사용할 수 있게 될 때까지 역할이 참조 데이터의 기본 집합을 시작할 수 있습니다.

![자치 계산 노드를 통한 응용 프로그램 고가용성](./media/resiliency-high-availability-azure-applications/application-high-availability-through-autonomous-compute-nodes.png)

이 패턴에서 역할에 대한 배포 및 시작 속도를 고려합니다. 시작 시 대량의 참조 데이터를 배포하거나 다운로드하는 경우 새 배포 또는 역할 인스턴스를 스핀업하는 데 걸리는 시간을 증가시킬 수 있습니다. 이렇게 하여 외부 저장소 서비스에 의존하지 않고 각 역할에 즉시 사용할 수 있는 참조 데이터를 보관하는 자치를 허용할 수 있습니다.

### <a name="transactional-data-pattern-for-high-availability"></a>고가용성에 대한 트랜잭션 데이터 패턴
트랜잭션 데이터는 응용 프로그램이 비즈니스 컨텍스트에서 생성시킨 데이터입니다. 트랜잭션 데이터는 응용 프로그램이 구현하는 일련의 비즈니스 프로세스와 이러한 프로세스를 지원하는 참조 데이터의 조합입니다. 트랜잭션 데이터의 예로 주문, 고급 선적 통지, 송장 및 CRM(고객 관계 관리) 기회가 있습니다. 따라서 생성된 트랜잭션 데이터는 기록 보관 또는 추가 프로세스를 위해 외부 시스템에 공급됩니다.

이 데이터를 담당하는 시스템 내에서 참조 데이터가 변경될 수 있습니다. 이러한 이유로 트랜잭션 데이터는 해당 의미 체계의 일관성에 대한 최소한의 외부 종속성을 갖도록 특정 시점 참조 데이터 컨텍스트를 저장해야 합니다. 예를 들어 주문을 처리한 후에 몇 개월 동안 카탈로그에서 제품을 제거하는 방법을 고려합니다. 모범 사례는 트랜잭션에 가능한 많은 참조 데이터 컨텍스트를 포함하는 것입니다. 트랜잭션이 캡처된 후에 참조 데이터를 변경해야 하더라도 트랜잭션과 관련된 의미 체계를 유지합니다.

이전에 설명한 것처럼 느슨한 결합 및 비동기 통신을 사용하는 아키텍처는 자체적으로 높은 수준의 가용성을 제공합니다. 트랜잭션 데이터의 경우에도 그렇지만 구현은 좀 더 복잡합니다. 기존의 트랜잭션 개념은 일반적으로 트랜잭션을 보장하기 위해 데이터베이스에 의존합니다. 중간 계층을 도입할 경우 응용 프로그램 코드는 다양한 계층에서 데이터를 올바르게 처리하여 충분한 일관성 및 영속성을 확보해야 합니다.

다음 순서에서는 해당 처리에서 트랜잭션 데이터의 캡처를 구분하는 워크플로에 대해 설명합니다.

1. 웹 계산 노드: 참조 데이터를 표시합니다.
2. 외부 저장소: 중간 트랜잭션 데이터를 저장합니다.
3. 웹 계산 노드: 최종 사용자 트랜잭션을 완료합니다.
4. 웹 계산 노드: 예측 가능한 응답을 제공하도록 보장하는 임시 지속성 저장소에 참조 데이터 컨텍스트와 함께 완료된 트랜잭션 데이터를 보냅니다.
5. 웹 계산 노드: 최종 사용자에게 트랜잭션 완료를 알립니다.
6. 백그라운드 계산 노드: 트랜잭션 데이터를 추출하고 필요한 경우를 프로세스를 게시하며 현재 시스템에서 최종 저장 위치로 전송합니다.

다음 다이어그램은 Azure에서 호스팅되는 클라우드 서비스에서 이 디자인을 구현하는 방법을 보여 줍니다.

![느슨한 연결을 통한 고가용성](./media/resiliency-disaster-recovery-high-availability-azure-applications/application-high-availability-through-loose-coupling.png)

위의 다이어그램에서 점선으로 된 화살표는 비동기 처리를 나타냅니다. 프런트 엔드 웹 역할은 비동기 처리를 인식하지 않습니다. 이렇게 하면 현재 시스템에 대한 참조가 있는 최종 대상에 트랜잭션을 저장하게 됩니다. 이 비동기 모델에서 발생한 대기 시간으로 인해 트랜잭션 데이터는 쿼리에 즉시 사용할 수 없습니다. 따라서 각 트랜잭션 데이터 단위를 캐시 또는 사용자 세션에 저장하여 즉각적인 UI 요구를 충족해야 합니다.

웹 역할은 나머지 인프라로부터 자치적입니다. 가용성 프로필은 전체 인프라가 아니라 웹 역할 및 Azure 큐의 조합입니다. 고가용성 외에도 이 방법을 사용하면 백 엔드 저장소와 독립하도록 웹 역할을 수평적으로 확장할 수 있습니다. 이러한 고가용성 모델은 작업의 경제에 영향을 미칠 수 있습니다. Azure 큐 및 작업자 역할과 같은 추가 구성 요소가 월간 사용 비용에 영향을 줄 수 있습니다.

위의 다이어그램에서는 트랜잭션 데이터와 분리된 이 방법의 구현을 보여 줍니다. 가능한 다른 구현이 많이 있습니다. 다음 목록은 몇 가지 대안을 제공합니다.

* 작업자 역할은 웹 역할과 저장소 큐 간에 있을 수 있습니다.
* Azure 저장소 큐 대신 서비스 버스 큐를 사용할 수 있습니다.
* 최종 대상은 Azure 저장소 또는 다른 데이터베이스 공급자일 수 있습니다.
* Azure 캐시는 트랜잭션 이후에 즉각적인 캐싱 요구 사항을 제공하는 웹 계층에 사용될 수 있습니다.

### <a name="scalability-patterns"></a>확장성 패턴
클라우드 서비스의 확장성이 가용성에 직접 영향을 준다는 사실을 고려해야 합니다. 부하 증가로 인해 서비스가 응답하지 않는 경우 사용자는 응용 프로그램이 중단되었다는 인상을 받습니다. 예상된 응용 프로그램 부하 및 이후의 예측에 기반한 확장성에 대한 모범 사례를 따릅니다. 최대 규모는 단일 및 다중 저장소 계정 사용, 여러 데이터베이스 간의 공유 및 캐싱 전략과 같은 여러 고려 사항을 포함합니다. 이러한 패턴을 자세히 살펴보려면 [Azure 클라우드 서비스에서 대규모 서비스 설계를 위한 모범 사례](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/)를 참조하세요.

## <a name="next-steps"></a>다음 단계
이 문서는 [Microsoft Azure에 빌드된 응용 프로그램에 대한 재해 복구 및 고가용성](resiliency-disaster-recovery-high-availability-azure-applications.md)에 초점을 맞춘 문서 시리즈의 일부입니다. 이 시리즈의 다음 문서는 [Microsoft Azure에 빌드된 응용 프로그램에 대한 재해 복구](resiliency-disaster-recovery-azure-applications.md)입니다.




<!--HONumber=Nov16_HO3-->


