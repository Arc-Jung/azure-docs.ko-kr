<properties 
   pageTitle="Azure 부하 분산 장치 개요 | Microsoft Azure"
	description="Azure 부하 분산 장치 기능, 아키텍처 및 구현에 대한 개요입니다. 부하 분산 장치의 작동 방식을 이해하고 클라우드에 활용하는 데 도움이 됩니다."
	services="load-balancer"
	documentationCenter="na"
	authors="joaoma"
	manager="adinah"
	editor="tysonn"/>
<tags 
   ms.service="load-balancer"
	ms.devlang="na"
	ms.topic="article"
	ms.tgt_pltfrm="na"
	ms.workload="infrastructure-services"
	ms.date="07/10/2015"
	ms.author="joaoma"/>


# 부하 분산 장치 개요 
Azure 부하 분산 장치는 응용 프로그램에 고가용성 및 네트워크 성능을 제공합니다. 부하 분산 장치 집합에 정의된 클라우드 서비스 또는 가상 컴퓨터의 정상 서비스 인스턴스 간에 들어오는 트래픽을 배포하는 계층-4(TCP, UDP) 유형의 부하 분산 장치입니다.
 
다음을 수행하도록 구성할 수 있습니다.

- 들어오는 인터넷 트래픽을 가상 컴퓨터에 부하 분산합니다. 이를 [인터넷 연결 부하 분산](load-balancer-internet-overview.md)이라고 합니다.
- 가상 네트워크의 가상 컴퓨터 간, 클라우드 서비스의 가상 컴퓨터 간 또는 크로스-프레미스 가상 네트워크의 온-프레미스 컴퓨터와 가상 컴퓨터 간에 트래픽을 부하 분산합니다. 이를 [ILB(내부 부하 분산)](load-balancer-internal-overview.md)라고 합니다.
- 	외부 트래픽을 특정 가상 컴퓨터 인스턴스로 전달합니다.


## 부하 분산 장치 기능

### 계층-4 부하 분산 장치, 해시 기반 배포

Azure 부하 분산 장치는 해시 기반 배포 알고리즘을 사용합니다. 기본적으로 트래픽을 사용 가능한 서버에 매핑하는 5개 튜플(원본 IP, 원본 포트, 대상 IP, 대상 포트, 프로토콜 종류) 해시를 사용합니다. 전송 세션 내에서만 연결이 유지됩니다. 동일한 TCP 또는 UDP 세션의 패킷은 부하 분산 끝점 뒤의 동일한 DIP(데이터 센터 IP) 인스턴스로 전송됩니다. 클라이언트가 연결을 닫았다가 다시 열거나 동일한 원본 IP에서 새 세션을 시작하는 경우 원본 포트가 변경되어 트래픽이 다른 DIP 끝점으로 이동할 수 있습니다.


자세한 내용은 [부하 분산 배포 모드](load-balancer-distribution-mode.md)를 참조하세요.

![해시 기반 부하 분산 장치](./media/load-balancer-overview/load-balancer-distribution.png)

### 포트 전달

Azure 부하 분산 장치를 사용하면 인터넷 호스트에서 시작되었거나 다른 클라우드 서비스 또는 가상 네트워크에 있는 가상 컴퓨터에서 시작된 트래픽과 같은 인바운드 통신이 관리되는 방법을 제어할 수 있습니다. 이 제어는 끝점(입력 끝점이라고도 함)으로 표시됩니다.

끝점은 공용 포트를 수신 대기하고 트래픽을 내부 포트로 전달합니다. 내부 또는 외부 끝점에 대해 동일한 포트를 매핑하거나 다른 포트를 사용할 수 있습니다. 예를 들어 공용 끝점 매핑은 포트 80이지만 포트 81에서 수신 대기하도록 웹 서버를 구성할 수 있습니다. 공용 끝점을 만들면 Azure 부하 분산 장치 생성이 트리거됩니다.

Azure 관리 포털을 사용하여 만든 가상 컴퓨터의 끝점에 적용되는 기본적인 용도와 구성은 RDP(원격 데스크톱 프로토콜) 및 원격 Windows PowerShell 세션 트래픽을 위한 것입니다. 이 끝점을 사용하여 가상 컴퓨터를 인터넷으로 원격 관리할 수 있습니다.


### 규모 확장/규모 축소 시 자동 재구성

Azure 부하 분산 장치는 웹/작업자 역할에 대한 인스턴스 개수를 늘리거나 동일한 부하 분산 집합 아래에 추가 가상 컴퓨터를 배치하여 인스턴스를 확장하거나 축소할 때 즉시 재구성됩니다.


### 서비스 모니터링
Azure 부하 분산 장치는 다양한 서버 인스턴스의 상태를 검색하는 기능을 제공합니다. 프로브가 응답하지 않으면 Azure 부하 분산 장치에서 비정상 인스턴스에 대한 새 연결 전송을 중지합니다. 기존 연결은 영향을 받지 않습니다.

지원되는 프로브에는 다음 세 가지 유형이 있습니다.
 
- 게스트 에이전트 프로브(PaaS VM에만 해당). Azure 부하 분산 장치는 가상 컴퓨터 내의 게스트 에이전트를 활용하고, 수신 대기하여 인스턴스가 Ready 상태인 경우(즉, 인스턴스가 Busy, Recycling, Stopping 등의 상태가 아닌 경우)에만 HTTP 200 OK 응답으로 응답합니다. 게스트 에이전트가 HTTP 200 OK로 응답하지 않으면 Azure 부하 분산 장치에서 인스턴스를 응답하지 않는 것으로 표시하고 해당 인스턴스로 트래픽 전송을 중지합니다. Azure 부하 분산 장치는 계속해서 인스턴스에 ping을 수행하며, 게스트 에이전트가 HTTP 200으로 응답하면 Azure 부하 분산 장치에서 해당 인스턴스로 다시 트래픽을 전송합니다. 웹 역할을 사용하는 경우 웹 사이트 코드는 일반적으로 Azure 패브릭 또는 게스트 에이전트가 모니터링하지 않는 w3wp.exe에서 실행되므로 w3wp.exe의 오류(예: HTTP 500 응답)가 게스트 에이전트에 보고되지 않으며 부하 분산 장치가 해당 인스턴스를 순환에서 제거해야 하는지 알 수 없습니다.

- HTTP 사용자 지정 프로브. 사용자 지정 부하 분산 장치 프로브는 기본 게스트 에이전트 프로브를 재정의하며, 역할 인스턴스의 상태를 확인하는 고유한 사용자 지정 논리를 만들 수 있게 합니다. 부하 분산 장치는 주기적으로 끝점을 검색하며(기본적으로 15초마다), 시간 제한 기간(기본값 31초) 내에 TCP ACK 또는 HTTP 200으로 응답하는 경우 인스턴스가 순환된다고 간주됩니다. 이 기능은 부하 분산 장치 순환에서 인스턴스를 제거하는 사용자 고유의 논리를 구현하는 데 유용할 수 있습니다. 예를 들어 인스턴스가 90% CPU를 초과하면 200이 아닌 상태가 반환됩니다. w3wp.exe를 사용하는 웹 역할의 경우 웹 사이트 코드에 오류가 있으면 부하 분산 장치 프로브에 200이 아닌 상태가 반환되므로 웹 사이트의 자동 모니터링도 사용할 수 있습니다.

- TCP 사용자 지정 프로브. TCP 프로브를 사용하려면 정의된 프로브 포트에 대한 TCP 세션을 설정해야 합니다.

자세한 내용은 [부하 분산 장치 상태 프로브](https://msdn.microsoft.com/library/azure/jj151530.aspx)를 참조하세요.

### SNAT(원본 NAT)


서비스에서 인터넷으로 전송되는 모든 아웃바운드 트래픽은 들어오는 트래픽과 동일한 VIP 주소를 사용하여 SNAT(원본 NAT)됩니다. SNAT에는 다음과 같은 중요한 이점이 있습니다.

- VIP를 서비스의 다른 인스턴스에 동적으로 매핑할 수 있으므로 서비스의 업그레이드 및 재해 복구가 용이합니다.

- ACL을 VIP로 표현할 수 있고 서비스가 확장 또는 축소되거나 다시 배포될 때 변경되지 않으므로 ACL 관리가 더 용이합니다.

Azure 부하 분산 장치 구성은 UDP에 대해 완전한 원뿔형 NAT를 지원합니다. 전체 원뿔형 NAT는 포트에서 아웃바운드 요청에 대한 응답으로 외부 호스트에서 수행된 인바운드 연결을 허용하는 NAT의 한 유형입니다.

![snat](./media/load-balancer-overview/load-balancer-snat.png)


>[AZURE.NOTE]Azure 부하 분산 장치는 VM에서 시작된 새로운 아웃바운드 연결마다 아웃바운드 포트도 할당합니다. 외부 호스트에서는 트래픽이 VIP: 할당된 포트로 들어오는 것으로 표시됩니다. 시나리오에 다수의 아웃바운드 연결이 필요한 경우 SNAT(Source Network Address Translation)에 전용 아웃바운드 IP가 있도록 VM에서 인스턴스 수준 공용 IP를 사용하는 것이 좋습니다. 이렇게 하면 포트 고갈 위험이 줄어듭니다.
>
>VIP 또는 ILPIP에서 사용할 수 있는 최대 포트 수는 64k입니다. 이는 TCP 표준 제한입니다.


**가상 컴퓨터에 대해 여러 개의 부하 분산 IP 지원**

가상 컴퓨터 집합에 두 개 이상의 부하 분산 공용 IP 주소를 할당할 수 있습니다. 이 기능을 사용하면 동일한 가상 컴퓨터 집합에서 여러 개의 SSL 웹 사이트 및/또는 여러 개의 SQL AlwaysOn 가용성 그룹 수신기를 호스트할 수 있습니다. 자세한 내용은 [클라우드 서비스당 여러 VIP](load-balancer-multivip.md)를 참조하세요.

**Azure 리소스 관리자(공개 미리 보기)를 사용한 템플릿 기반 배포** ARM(Azure 리소스 관리자)은 Azure 서비스에 대한 새로운 관리 프레임워크입니다. 이제 Azure 리소스 관리자 기반 API 및 도구를 사용하여 Azure 부하 분산 장치를 관리할 수 있습니다. Azure 리소스 관리자에 대한 자세한 내용은 [Azure 리소스 관리자를 통해 Iaas가 더 쉬워짐](http://azure.microsoft.com/blog/2015/04/29/iaas-just-got-easier-again/)을 참조하세요.


## 다음 단계

[인터넷 연결 부하 분산 장치 개요](load-balancer-internet-overview.md)

[내부 부하 분산 장치 개요](load-balancer-internal-overview.md)

[시작 - 인터넷 연결 부하 분산 장치](load-balancer-internet-getstarted.md)
 

<!---HONumber=September15_HO1-->