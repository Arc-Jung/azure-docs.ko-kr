---
title: 클라우드 계층화 Azure 파일 동기화 이해 | Microsoft Docs
description: 선택적 Azure 파일 동기화 기능인 클라우드 계층화를 이해 합니다. 자주 액세스 하는 파일은 서버에서 로컬로 캐시 됩니다. 다른 항목은 Azure Files로 계층화 됩니다.
author: roygara
ms.service: storage
ms.topic: conceptual
ms.date: 1/4/2021
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: 9ca8df21e0221d364f75eaeb26f0b2961d7e0b08
ms.sourcegitcommit: dda0d51d3d0e34d07faf231033d744ca4f2bbf4a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/05/2021
ms.locfileid: "102204468"
---
# <a name="cloud-tiering-overview"></a>클라우드 계층화 개요
Azure 파일 동기화의 선택적인 기능인 클라우드 계층화는 온-프레미스 파일 서버의 성능을 유지 하면서 필요한 로컬 저장소의 양을 줄입니다.

이 기능을 사용 하도록 설정 하면 자주 액세스 하는 (핫) 파일만 로컬 서버에 저장 됩니다. 자주 액세스 하지 않는 (쿨) 파일은 네임 스페이스 (파일 및 폴더 구조) 및 파일 내용으로 분할 됩니다. 네임 스페이스는 로컬에 저장 되 고 파일 콘텐츠는 클라우드의 Azure 파일 공유에 저장 됩니다. 

사용자가 계층화 된 파일을 열면 Azure의 파일 공유에서 파일 데이터를 원활 하 게 회수할 Azure 파일 동기화.

## <a name="how-cloud-tiering-works"></a>클라우드 계층화 작동 방법

### <a name="cloud-tiering-policies"></a>클라우드 계층화 정책
클라우드 계층화를 사용 하도록 설정 하는 경우 사용 **가능한 볼륨 공간 정책** 및 **날짜 정책** 등의 쿨 파일을 계층화 할 때 Azure 파일 동기화 알리기 위해 설정할 수 있는 두 가지 정책이 있습니다. 

#### <a name="volume-free-space-policy"></a>사용 가능한 볼륨 공간 정책
**사용 가능한 볼륨 공간 정책은** 로컬 디스크에서 일정 한 공간을 차지 하는 경우 클라우드에 쿨 파일을 계층화 Azure 파일 동기화에 지시 합니다. 

예를 들어 로컬 디스크 용량이 200 GB이 40 고 항상 사용 가능한 로컬 디스크 용량을 항상 사용 가능한 상태로 유지 하려는 경우 사용 가능한 볼륨 공간 정책을 20%로 설정 해야 합니다. 사용 가능한 볼륨 공간은 개별 디렉터리 또는 서버 끝점의 수준이 아니라 볼륨 수준에서 적용 됩니다. 

새 서버 끝점을 추가할 때 처음 다운로드 한 파일에 볼륨의 사용 가능한 공간 정책이 어떻게 영향을 주는지 알아보려면 ( [클라우드 계층화에 영향을 주는 동기화 정책](#sync-policies-that-affect-cloud-tiering)참조) 섹션을 참조 하세요.

#### <a name="date-policy"></a>날짜 정책
**날짜 정책** 에서 쿨 파일은 x 일 수에 액세스 (즉, 읽기 또는 쓰기) 되지 않은 경우 클라우드에 계층화 됩니다. 예를 들어, 일반적으로 액세스 하지 않고 15 일이 넘는 파일이 보관 파일인 경우 날짜 정책을 15 일로 설정 해야 합니다. 

날짜 정책 및 볼륨의 사용 가능한 공간 정책이 함께 작동 하는 방법에 대 한 자세한 예제는 [클라우드 계층화 정책 선택 Azure 파일 동기화](storage-sync-choose-cloud-tiering-policies.md)을 참조 하세요.

### <a name="windows-server-data-deduplication"></a>Windows Server 데이터 중복 제거
데이터 중복 제거는 Windows Server 2016부터 클라우드 계층화를 사용 하도록 설정 된 볼륨에서 지원 됩니다. 자세한 내용은 [Azure 파일 동기화 배포 계획](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#data-deduplication)을 참조 하세요.

### <a name="cloud-tiering-heatmap"></a>클라우드 계층화 열 지도
Azure 파일 동기화는 시간이 지남에 따라 파일 액세스 (읽기 및 쓰기 작업)를 모니터링 하 고, 자주 액세스 하는 빈도에 따라 모든 파일에 열 점수를 할당 합니다. 이러한 점수를 사용 하 여 각 서버 끝점에서 네임 스페이스의 "열 지도"를 작성 합니다. 이 열 지도는 클라우드 계층화를 사용 하도록 설정 된 위치에서 열 점수를 기준으로 정렬 된 모든 동기화 파일의 목록입니다. 최근에 액세스 한 파일은 활성 상태인 것으로 간주 되 고, 거의 수행 되지 않았고 특정 시간 동안 액세스 되지 않은 파일은 쿨로 간주 됩니다. 

열 지도에서 개별 파일의 상대 위치를 확인 하기 위해 시스템은 최대 타임 스탬프를 다음 순서로 사용 합니다. 최대 (마지막 액세스 시간, 마지막 수정 시간, 만든 시간) 

일반적으로 마지막 액세스 시간이 추적 되 고 사용 가능 합니다. 그러나 새 서버 끝점을 만들 때 클라우드 계층화를 사용 하도록 설정 하면 시간이 충분 하지 않아 파일 액세스를 관찰할 수 없습니다. 유효한 마지막 액세스 시간이 없으면 열 지도의 상대 위치를 평가 하는 대신 마지막으로 수정한 시간이 사용 됩니다.  

날짜 정책은 동일한 방식으로 작동 합니다. 마지막으로 액세스 하지 않으면 날짜 정책이 마지막으로 수정 된 시간에 적용 됩니다. 사용할 수 없는 경우 파일의 만든 시간으로 대체 됩니다. 시간이 지남에 따라 시스템은 더 많은 파일 액세스 요청을 관찰 하 고 자동으로 추적 되는 마지막 액세스 시간을 사용 하기 시작 합니다.

> [!Note]
> 클라우드 계층화는 마지막 액세스 시간을 추적 하는 NTFS 기능에 의존 하지 않습니다. 이 NTFS 기능은 기본적으로 해제 되어 있으며, 성능 고려 사항으로 인해이 기능을 수동으로 사용 하지 않는 것이 좋습니다. 클라우드 계층화는 마지막 액세스 시간을 별도로 추적 합니다.

### <a name="sync-policies-that-affect-cloud-tiering"></a>클라우드 계층화에 영향을 주는 동기화 정책

Azure 파일 동기화 agent 버전 11을 사용 하는 경우 클라우드 계층화에 영향을 주는 두 가지 추가 Azure 파일 동기화 정책이 있습니다. **초기 다운로드** 와 **자동 관리 회수** 는 다음과 같습니다.

#### <a name="initial-download"></a>초기 다운로드

서버에서 파일을 사용 하 여 Azure 파일 공유에 연결 하는 경우 이제 서버에서 파일 공유 데이터를 처음으로 다운로드 하도록 할 방법을 결정할 수 있습니다. 클라우드 계층화를 사용 하는 경우 두 가지 옵션이 있습니다. 

![클라우드 계층화를 사용 하는 경우 초기 다운로드의 스크린샷](media/storage-sync-cloud-tiering-overview/cloud-tiering-overview-3.png)  

첫 번째 옵션은 먼저 네임 스페이스를 회수 한 다음 로컬 디스크 용량에 도달할 때까지 마지막으로 수정 된 타임 스탬프를 기준으로 파일 콘텐츠를 회수 하는 것입니다. 디스크 공간이 충분 하 고 마지막으로 수정 된 파일이 로컬로 캐시 되어야 하는 경우이 옵션을 선택 하는 것이 좋습니다. 디스크 공간이 부족 하 여 로컬로 저장할 수 없는 파일은 계층화 됩니다.        

두 번째 옵션은 처음에는 네임 스페이스만 회수 하 고 액세스 하는 경우에만 파일 콘텐츠를 회수 하는 것입니다. 로컬 디스크에서 사용 되는 용량을 최소화 하 고 사용자가 로컬로 캐시 해야 하는 파일을 결정 하려는 경우이 옵션을 사용 하는 것이 가장 좋습니다. 모든 파일은이 옵션을 사용 하 여 계층화 된 파일로 시작 됩니다.

![클라우드 계층화를 사용 하지 않는 경우 초기 다운로드의 스크린샷](media/storage-sync-cloud-tiering-overview/cloud-tiering-overview-4.png)

클라우드 계층화를 사용 하지 않도록 설정한 경우 세 번째 옵션을 사용할 수 있습니다 .이 옵션은 계층화 된 파일을 모두 함께 사용 하지 않는 것입니다. 이 경우 파일은 완전히 다운로드 된 후에만 서버에 표시 됩니다. 전체 파일이 있어야 하 고 해당 네임 스페이스에서 계층화 된 파일을 허용할 수 없는 응용 프로그램이 있는 경우이 방법이 적합 합니다.      

#### <a name="proactive-recalling"></a>자동 관리 재호출

파일이 만들어지거나 수정 되 면 지정 된 서버에 파일을 사전에 회수할 수 있습니다. 이렇게 하면 지정 된 각 서버에서 새 파일 또는 수정 된 파일을 쉽게 사용할 수 있습니다. 

예를 들어 전 세계에 분산 된 회사에는 미국 및 인도의 지사가 있습니다. 아침 (미국 표준시) 정보 근로자는 새로운 새 폴더와 새 파일을 만들어 모든 날에 사용할 수 있습니다. Azure 파일 동기화는 폴더와 파일을 Azure 파일 공유 (클라우드 끝점)와 동기화 합니다. 인도의 정보 근로자는 표준 시간대에서 프로젝트에 대 한 작업을 계속 합니다. 매일 Azure 파일 동기화 아침에 도착 하면 인도 팀에서 로컬 캐시를 효율적으로 사용할 수 있도록 이러한 새 파일을 로컬에서 사용할 수 있도록 설정 해야 합니다. 이 모드를 사용 하도록 설정 하면 요청 시 회수로 인해 초기 파일 액세스 속도가 느려지고 서버에서 Azure 파일 공유에 변경 되거나 생성 되는 즉시 파일을 사전에 회수할 수 있습니다.

서버로 회수 된 파일이 실제로 로컬에서 필요 하지 않은 경우에는 불필요 한 회수로 인해 송신 트래픽과 비용이 늘어날 수 있습니다. 따라서 클라우드의 최근 변경 내용으로 서버 캐시를 미리 채우면 해당 서버에 있는 파일을 사용 하는 사용자 또는 응용 프로그램에 긍정적인 영향을 주는 것을 알고 있는 경우에만 자동 관리 회수를 사용 하도록 설정 합니다. 

자동 관리 회수를 사용 하도록 설정 하면 서버에서 대역폭 사용량이 증가 하 고, 회수 되는 파일이 증가 하 여 로컬 서버의 다른 비교적 새로운 콘텐츠가 적극적으로 계층화 될 수도 있습니다. 따라서 계층화 되는 파일이 서버에서 핫으로 간주 되는 경우 더 많은 회수가 발생할 수 있습니다. 

:::image type="content" source="media/storage-sync-files-deployment-guide/proactive-download.png" alt-text="현재 적용 중인 서버 끝점에 대 한 Azure 파일 공유 다운로드 동작과이를 변경할 수 있는 메뉴를 여는 단추를 표시 하는 이미지입니다.":::

자동 관리 회수에 대 한 자세한 내용은 [Azure 파일 동기화 배포](storage-sync-files-deployment-guide.md#proactively-recall-new-and-changed-files-from-an-azure-file-share)를 참조 하세요.

## <a name="tiered-vs-locally-cached-file-behavior"></a>계층화 된 파일 및 로컬에서 캐시 된 파일 동작

클라우드 계층화는 네임 스페이스 (파일 및 폴더 계층 구조와 파일 속성)와 파일 콘텐츠를 분리 하는 것입니다. 

#### <a name="tiered-file"></a>계층화 된 파일

계층화 된 파일의 경우 파일 콘텐츠 자체가 로컬로 저장 되지 않으므로 디스크의 크기는 0입니다. 파일이 계층화 되 면 Azure 파일 동기화 파일 시스템 필터 (StorageSync.sys)가 파일을 포인터 (재분석 지점)로 로컬로 바꿉니다. 재분석 지점은 Azure 파일 공유의 파일에 대 한 URL을 나타냅니다. 계층화된 파일의 경우 NTFS에서 FILE_ATTRIBUTE_RECALL_ON_DATA_ACCESS 특성과 “offline” 특성이 모두 설정되므로 타사 애플리케이션이 계층화된 파일을 안전하게 식별할 수 있습니다.   

![계층화 된 경우에만 파일 속성의 스크린샷.](media/storage-sync-cloud-tiering-overview/cloud-tiering-overview-2.png)    

#### <a name="locally-cached-file"></a>로컬로 캐시 된 파일

반면, 온-프레미스 파일 서버에 저장 된 파일의 경우 전체 파일 (파일 특성 + 파일 콘텐츠)이 로컬로 저장 되기 때문에 디스크의 크기는 파일의 논리적 크기와 같습니다.     

![계층화 되지 않은 파일의 속성에 대 한 스크린샷-네임 스페이스 + 파일 콘텐츠](media/storage-sync-cloud-tiering-overview/cloud-tiering-overview-1.png) 

파일을 부분적으로 계층화할 수 있습니다(또는 부분적으로 회수). 부분적으로 계층화된 파일에서 파일 일부가 디스크에 있습니다. 파일에 대 한 스트리밍 액세스를 지 원하는 멀티미디어 플레이어 또는 zip 유틸리티와 같은 응용 프로그램에서 파일을 부분적으로 읽을 때 이러한 상황이 발생할 수 있습니다. Azure 파일 동기화는 smart 이며 연결 된 Azure 파일 공유에서 요청 된 정보만 회수 합니다.

> [!NOTE]
> 크기는 파일의 논리적 크기를 나타냅니다. 디스크 크기는 디스크에 저장 된 파일 스트림의 실제 크기를 나타냅니다.

## <a name="next-steps"></a>다음 단계
* [Azure 파일 동기화 클라우드 계층화 정책 선택](storage-sync-choose-cloud-tiering-policies.md)
* [Azure 파일 동기화 배포에 대한 계획](storage-sync-files-planning.md)

