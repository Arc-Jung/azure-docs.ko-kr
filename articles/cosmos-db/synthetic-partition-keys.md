---
title: Azure Cosmos DB의 가상 파티션 키
description: Azure Cosmos DB 컨테이너에 가상 파티션 키를 사용하는 방법 알아보기
author: aliuy
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 10/30/2018
ms.author: andrl
ms.openlocfilehash: f6323549c0ecf8f0196d327779f7f7cb67c6e03f
ms.sourcegitcommit: da3459aca32dcdbf6a63ae9186d2ad2ca2295893
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/07/2018
ms.locfileid: "51263348"
---
# <a name="create-a-synthetic-partition-key"></a>가상 파티션 키 만들기

파티션 키의 고유한 값이 많은(수백 개 또는 수천 개) 것이 좋습니다. 이러한 파티션 키 값과 연결된 항목에 데이터 및 워크로드를 균등하게 배포하는 것이 목표입니다. 속성이 데이터에 없는 경우 가상 파티션 키를 생성할 수 있습니다. 다음 섹션에서는 컨테이너에 대한 가상 파티션 키를 생성하는 몇 가지 기본 기술을 설명합니다.

## <a name="concatenating-multiple-properties-of-an-item"></a>항목의 여러 속성을 연결

여러 속성 값을 인위적인 `partitionKey` 속성 하나에 연결하여 파티션 키를 구성할 수 있습니다. 이러한 키는 가상 키로 참조됩니다. 예를 들어 다음 예제 문서를 살펴보겠습니다.

```JavaScript
{
"deviceId": "abc-123",
"date": 2018
}
```

이전 문서의 경우 한 가지 옵션은 디바이스 ID 또는 날짜에 따라 컨테이너를 분할하려는 경우 파티션 키로 /deviceId 또는 /date를 설정하는 것입니다. 또 다른 옵션은 이러한 두 값을 파티션 키로 사용되는 가상 `partitionKey` 속성에 연결하는 것입니다.

```JavaScript
{
"deviceId": "abc-123",
"date": 2018,
"partitionKey": "abc-123-2018"
}
```

실제 시나리오에서는 데이터베이스에 수천 개의 문서가 있을 수 있으므로, 가상 키를 수동으로 추가하는 대신 값을 연결하는 클라이언트 쪽 논리를 정의하고 가상 키를 문서에 삽입해야 합니다.

## <a name="using-a-partition-key-with-random-suffix"></a>임의의 접미사가 붙는 파티션 키 사용

워크로드를 보다 균등하게 분산할 수 있는 또 다른 전략은 파티션 키 값의 끝에 임의의 숫자를 추가하는 것입니다. 이러한 방식으로 항목을 분산하면 여러 파티션에 병렬 쓰기 작업을 수행할 수 있습니다.

예를 들어 파티션 키가 날짜를 나타내는 경우 1~400 사이의 난수를 선택하여 날짜에 접미사로 연결할 수 있습니다. 이 방법을 사용하면 2018-08-09.1, 2018-08-09.2, 이런 식으로 2018-08-09.400까지 파티션 키 값을 얻을 수 있습니다. 파티션 키가 임의로 결정되므로 매일 컨테이너에 대한 쓰기 작업이 여러 파티션에 균등하게 분산됩니다. 이 방법을 사용하면 병렬 처리 성능이 향상되고 전체적인 처리량이 많아집니다.

## <a name="using-a-partition-key-with-pre-calculated-suffixes"></a>미리 계산된 접미사가 붙는 파티션 키 사용 

임의 전략을 사용하면 쓰기 처리량을 크게 높일 수 있지만, 항목을 쓸 때 사용되는 접미사 값을 모르기 때문에 특정 항목을 읽기가 어렵습니다. 미리 계산된 접미사 전략을 사용하면 개별 항목을 쉽게 읽을 수 있습니다. 난수를 사용하여 여러 파티션에 항목을 분산하는 대신, 쿼리하려는 항목을 기반으로 계산된 숫자를 사용합니다.

파티션 키의 날짜가 컨테이너에 사용되는 이전 예제를 생각해 보세요. 이번에는 항목마다 액세스 가능한 VIN(차량 식별 번호) 특성이 있고, 날짜와 함께 VIN을 사용하여 항목을 찾는 쿼리를 자주 실행한다고 가정해 보겠습니다. 애플리케이션은 컨테이너에 항목을 쓰기 전에 VIN을 기반으로 해시 접미사를 계산하여 파티션 키 날짜에 추가할 수 있습니다. 임의 전략 방법에서 얻는 결과와 마찬가지로, 계산 결과 1~400 사이의 숫자가 생성되어 균등하게 분산됩니다. 날짜에 계산 결과를 연결한 값이 파티션 키 값이 됩니다.

이 전략을 사용하면 쓰기가 파티션 키 값 및 파티션 간에 균등하게 분산됩니다. 특정 차량 식별 번호의 파티션 키 값을 계산할 수 있으므로 특정 항목 및 날짜를 쉽게 읽을 수 있습니다. 이 방법의 장점은 단일 핫 파티션 키(모든 워크로드가 집중되는 파티션 키)를 피할 수 있다는 점입니다. 

## <a name="next-steps"></a>다음 단계

다음 문서에서 분할이라는 개념에 대해 좀 더 자세히 알아볼 수 있습니다.

* [논리 파티션](partition-data.md)에 대한 자세한 정보
* [Cosmos 컨테이너 및 데이터베이스에 대한 처리량 프로비전](set-throughput.md)에 대한 자세한 정보
* [Cosmos 컨테이너의 처리량을 프로비전하는 방법](how-to-provision-container-throughput.md) 알아보기
* [Cosmos 데이터베이스의 처리량을 프로비전하는 방법](how-to-provision-database-throughput.md) 알아보기
