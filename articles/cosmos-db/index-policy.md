---
title: Azure Cosmos DB 인덱싱 정책
description: Azure Cosmos DB에서 인덱싱의 작동 방식을 파악하고 자동 인덱싱 및 성능 향상을 위해 인덱싱 정책을 구성 및 변경하는 방법에 대해 알아봅니다.
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/08/2019
ms.author: rimman
ms.openlocfilehash: 6998db1679e67f8ac4bf7c81ea9373c66a9618ee
ms.sourcegitcommit: c174d408a5522b58160e17a87d2b6ef4482a6694
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/18/2019
ms.locfileid: "59278567"
---
# <a name="index-policy-in-azure-cosmos-db"></a>Azure Cosmos DB의 인덱스 정책

다음 매개 변수를 구성하여 Azure Cosmos 컨테이너에서 기본 인덱싱 정책을 재정의할 수 있습니다.

* **인덱스에서 항목 및 경로 포함 또는 제외**: 제외할 수도 있고 삽입 하거나 컨테이너 내의 항목을 바꿀 때 인덱스의 특정 항목을 포함 합니다. 또한 컨테이너 간에 인덱싱할 특정 경로/속성을 포함하거나 제외할 수 있습니다. 경로는 와일드카드 패턴(예: *)을 포함할 수 있습니다.

* **인덱스 유형 구성**: 또한 인덱싱된 경로 범위를 추가할 수 있습니다 다른 유형의 인덱스와 같은 공간입니다.

* **인덱스 모드 구성**: 컨테이너에서 인덱싱 정책을 사용하면 *일관성* 또는 *없음*과 같은 다른 인덱싱 모드를 구성할 수 있습니다.

## <a name="indexing-modes"></a>인덱싱 모드

Azure Cosmos DB의 인덱싱 정책을 통해 Azure Cosmos 컨테이너를 구성할 수 있는 두 가지 인덱싱 모드를 지원 합니다.

* **일관성**: 는 Azure Cosmos 컨테이너의 정책이 설정 되어 있으면 *일관성*, 특정 컨테이너에 대 한 쿼리는 지점 읽기에 대해 지정 된 것과 동일한 일관성 수준을 따릅니다 (예를 들어는 강력, 제한 된 부실, 세션 또는 최종). 

  인덱스는 항목을 업데이트할 때 동기적으로 업데이트됩니다. 예를 들어, 항목에 대한 삽입, 바꾸기, 업데이트 및 삭제 작업은 인덱스 업데이트로 이어집니다. 일관성 인덱싱은 일관된 쿼리를 지원하는 대신 쓰기 처리량에 영향을 미칩니다. "경로 인덱스에 포함 된"에 따라 달라 집니다 쓰기 처리량이 감소 하 고 "일관성 수준입니다." 일관성 인덱싱 모드 인덱스를 모든 업데이트를 사용 하 여 최신 상태로 유지 하 고 즉시 쿼리를 제공 하도록 설계 되었습니다.

* **없음**: 없음 인덱스 모드를 사용하는 컨테이너에는 연관된 인덱스가 없습니다. 이 모드는 Azure Cosmos 데이터베이스를 키-값 스토리지로 이용하고 해당 ID 속성에 의해서만 항목에 액세스하는 경우에 흔히 사용됩니다.

  > [!NOTE]
  > 으로 인덱싱 모드 구성를 *None* 에 영향을 주는 모든 기존 인덱스를 삭제 합니다. 액세스 패턴에 ID 또는 자체 링크만 필요한 경우 이 옵션을 사용해야 합니다.

쿼리 일관성 수준은 일반 읽기 작업과 비슷하게 유지됩니다. Azure Cosmos 데이터베이스 보유 하는 컨테이너를 쿼리 하는 경우 오류를 반환 합니다는 *None* 인덱싱 모드입니다. 검색을 통해 명시적으로 쿼리를 실행할 수 있습니다 **x-ms-documentdb-enable-검색** REST API에서 헤더 또는 **EnableScanInQuery** .NET SDK를 사용 하 여 옵션을 요청 합니다. ORDER BY와 같은 일부 쿼리 기능은 해당 인덱스를 위임하므로 현재 **EnableScanInQuery**에서 지원되지 않습니다.

## <a name="modifying-the-indexing-policy"></a>인덱싱 정책 수정

Azure Cosmos DB에서는 언제든지 컨테이너의 인덱싱 정책을 업데이트할 수 있습니다. Azure Cosmos 컨테이너에 인덱싱 정책 변경 인덱스의 모양 변경 시킬 수 있습니다. 이 변경은 인덱싱할 수 있는 경로, 해당 전체 자릿수 및 인덱스 자체의 일관성 모델에 영향을 줍니다. 따라서 인덱싱 정책을 변경하려면 실제로 이전 인덱스를 새 인덱스로 변환해야 합니다.

### <a name="index-transformations"></a>인덱스 변환

모든 인덱스 변환은 온라인으로 이루어집니다. 이전 정책을 기준으로 인덱싱된 항목 쓰기 가용성 또는 컨테이너에서 프로 비전 된 처리량에 영향을 주지 않고 새 정책에 따라 효율적으로 변환 됩니다. 일관성 및 읽기 및 쓰기 저장 프로시저를 사용 하거나 REST API, Sdk 등을 사용 하 여 수행 되는 작업이 인덱스 변환 중 트리거 영향을 받지 않습니다.

인덱싱 정책을 변경 하는 것은 비동기 작업 및 작업 완료 시간은 경우에 항목 수, 프로 비전 된 처리량 및 항목의 크기에 따라 달라 집니다. 진행 중인 인덱싱을 다시 수행 하는 동안 쿼리를 수정 하는 인덱스를 사용 하는 쿼리가 수행 하는 경우 일치 하는 모든 결과 반환 하지 않을 수 및 쿼리는 모든 오류를 반환 하지 않습니다. 진행 중인 인덱싱을 다시 수행 하는 동안 쿼리는 결국 인덱싱 모드 구성에 관계 없이 일관성입니다. 인덱스 변환이 완료된 후 계속 일관된 결과를 확인할 수 있습니다. 이는 REST API, SDK 또는 저장 프로시저 및 트리거와 같은 인터페이스에서 발행되는 쿼리에 적용됩니다. 인덱스 변환은 특정 복제본에 대 한 사용 가능한 예비 리소스를 사용 하 여 복제본의 백그라운드에서 비동기적으로 수행 됩니다.

모든 인덱스 변환도 수행됩니다. Azure Cosmos DB는 인덱스의 두 복사본을 유지 관리하지 않습니다. 따라서 인덱스 변환을 수행하는 동안 컨테이너에서 디스크 공간이 추가로 필요하거나 사용되지 않습니다.

인덱싱 정책을 변경 하는 경우 변경 내용을 이전 인덱스에서 새 인덱스를 이동할 적용 되 고 주로 기반으로 인덱싱 모드 구성. 인덱싱 모드 구성은 포함/제외된 경로, 인덱스 종류 및 전체 자릿수와 같은 다른 속성에 비해 중요한 역할을 합니다.

이전 및 새 인덱싱 정책 모두가 **일관성** 인덱싱을 사용하는 경우, Azure Cosmos 데이터베이스는 온라인 인덱스 변환을 수행합니다. 변환이 진행 중인 동안 일관성 인덱싱 모드인 다른 인덱싱 정책 변경을 적용할 수 없습니다. 없음 인덱싱 모드로 이동하면 인덱스가 즉시 삭제됩니다. 진행 중인 변환을 취소하고 다른 인덱싱 정책으로 새로 시작하려는 경우 없음으로 이동하는 것이 유용합니다.

## <a name="modifying-the-indexing-policy---examples"></a>인덱싱 정책 수정 - 예제

다음은 가장 일반적인 사용 사례는 인덱싱 정책을 업데이트 하려는 경우입니다.

* 정상 작동 하는 동안 일관 된 결과 수 있지만 대체 하려는 경우는 **None** 대량 데이터를 가져오는 동안 인덱싱 모드입니다.

* 현재 Azure Cosmos 컨테이너에 인덱싱 기능을 사용하려는 경우. 예를 들어 지리 공간적 쿼리를 사용하려면 공간 인덱스 종류가 필요하고 ORDER BY/문자열 범위 쿼리를 사용하려면 문자열 범위 인덱스 종류가 필요할 수 있습니다.

* 인덱싱할 속성을 수동으로 선택하고 시간에 따라 변경하여 워크로드에 맞게 조정하려는 경우.

* 인덱싱 전체 자릿수를 조정하여 쿼리 성능을 향상하거나 소비되는 스토리지 공간을 줄이려는 경우.

## <a name="next-steps"></a>다음 단계

다음 문서에서 인덱싱에 대해 자세히 알아보세요.

* [인덱싱 개요](index-overview.md)
* [인덱싱 형식](index-types.md)
* [인덱스 경로](index-paths.md)
* [인덱싱 정책을 관리하는 방법](how-to-manage-indexing-policy.md)
