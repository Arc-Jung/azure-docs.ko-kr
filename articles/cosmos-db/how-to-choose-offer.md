---
title: Azure Cosmos DB에서 수동 및 자동 크기 조정 중에서 선택 하는 방법
description: 워크 로드에 대 한 표준 (수동) 프로 비전 된 처리량과 자동 크기 조정 프로 비전 된 처리량 중에서 선택 하는 방법을 알아봅니다.
author: deborahc
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 08/19/2020
ms.author: dech
ms.openlocfilehash: 0365238fd70e2e098e5a228ee71d5b9e0e584c71
ms.sourcegitcommit: b6f3ccaadf2f7eba4254a402e954adf430a90003
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/20/2020
ms.locfileid: "92279776"
---
# <a name="how-to-choose-between-standard-manual-and-autoscale-provisioned-throughput"></a>표준(수동) 및 자동 크기 조정 프로비저닝된 처리량 중에서 선택하는 방법 

Azure Cosmos DB는 프로비저닝된 처리량의 두 가지 유형 또는 제공 방식인 표준(수동) 및 자동 크기 조정을 지원합니다. 두 처리량 유형 모두 높은 성능과 규모를 필요로 하는 중요 비즈니스용 워크로드에 적합하며 동일한 Azure Cosmos DB SLA에 따라 처리량, 가용성, 대기 시간 및 일관성이 지원됩니다.

이 문서에서는 워크로드에 대한 표준(수동) 및 자동 크기 조정 프로비저닝된 처리량 중에서 선택하는 방법을 설명합니다. 

## <a name="overview-of-provisioned-throughput-types"></a>프로비저닝된 처리량 유형 개요
표준(수동) 및 자동 크기 조정 간의 차이점을 살펴 보기 전에 먼저 Azure Cosmos DB에서 프로비저닝된 처리량이 작동하는 방식을 이해하는 것이 중요합니다. 

프로비저닝된 처리량을 사용하는 경우 워크로드에 필요한 처리량을 초당 요청 단위(RU/초)로 설정합니다. 서비스는 처리량 요구 사항을 지원하는 데 필요한 용량을 프로비저닝합니다. 읽기, 쓰기 및 쿼리와 같은 서비스에 대한 데이터베이스 작업은 일부 RU(요청 단위)를 사용합니다. [요청 단위](request-units.md)에 대해 자세히 알아보세요.

다음 표에서는 표준(수동) 및 자동 크기 조정 간을 간략히 비교해서 보여 줍니다.

|Description|표준(수동)|자동 크기 조정|
|-------------|------|-------|
|가장 적합한 용도|트래픽이 안정적이고 예측 가능한 워크로드|트래픽이 가변적이거나 예측 불가능한 워크로드 [자동 크기 조정 사용 사례](provision-throughput-autoscale.md#use-cases-of-autoscale)를 참조하세요.|
|작동 방법|수동으로 변경하지 않는 한, 시간이 지나도 일정하게 고정되는 설정된 초당 RU 크기의 `T`를 프로비저닝합니다. 초당 최대 `T` RU/초 처리량을 사용할 수 있습니다. <br/><br/>예를 들어 표준(수동) 초당 400RU를 설정하는 경우 처리량은 초당 400RU로 유지됩니다.|시스템이 초과하지 않을 가장 높은 초당 최대 RU `Tmax`를 설정합니다. 시스템은 `0.1* Tmax <= T <= Tmax`가 되도록 처리량 `T`를 자동으로 조정합니다. <br/><br/>예를 들어, 자동 크기 조정 초당 최대 RU를 초당 4,000RU로 설정하면 시스템은 초당 400-4000RU 사이에서 크기를 조정합니다.|
|사용하는 경우|처리량 용량(RU/초)을 수동으로 관리하고 크기를 조정하려고 합니다.<br/><br/>프로비저닝된 RU/s를 일관되게 많이 사용합니다. 1달의 모든 시간 중에서 프로비저닝된 초당 RU `T`를 설정하고 시간의 66% 이상 동안 전체 크기를 사용하는 경우 표준(수동) 프로비저닝된 초당 RU로 비용을 절감할 것으로 예상됩니다.<br/><br/>이러한 예상은 표준(수동)에서 `T`를 설정할 때와 자동 크기 조정에서 같은 크기 `Tmax`를 설정하는 경우를 비교해서 얻은 것입니다. |Azure Cosmos DB에서 사용량에 따라 처리량 용량(초당 RU) 및 크기 조정을 관리하도록 하려고 합니다.<br/><br/>변동되거나 예측하기 어려운 초당 RU 사용량을 나타냅니다. 1달의 모든 시간 중에서 자동 크기 조정 최대 초당 RU `Tmax`를 설정하고 시간의 66% 이내에서 전체 크기 `Tmax`를 사용하는 경우 자동 크기 조정으로 비용을 절감할 것으로 예상됩니다.<br/><br/>이러한 예상은 자동 크기 조정 `Tmax`를 설정할 때와 표준(수동) 처리량에서 같은 크기 `T`를 설정하는 경우를 비교해서 얻은 것입니다.|
|청구 모델|청구는 사용된 RU 수에 관계없이 프로비저닝된 초당 RU의 시간당 기준으로 수행됩니다.<br/><br/>예제: <li>초당 400RU 프로비저닝</li><li>시간 1: 요청 없음</li><li>시간 2: 초당 400RU 가치의 요청</li><br/><br/>시간 1과 2 모두 [표준(수동) 비율](https://azure.microsoft.com/pricing/details/cosmos-db/)로 초당 400RU에 대해 비용이 청구됩니다.|요금은 시스템에서 해당 시간에 증가된 가장 높은 초당 RU 크기에 따라 시간 기준으로 청구됩니다. <br/><br/>예제: <li>자동 크기 조정의 초당 최대 RU인 초당 4000RU를 프로비저닝합니다(초당 400-4000RU 범위에서 크기 조정).</li><li>시간 1: 시스템이 최댓값인 초당 3500RU로 확장되었습니다.</li><li>시간 2: 사용량이 없으므로 시스템이 최솟값인 초당 400RU(항상 `Tmax`의 10%)로 축소되었습니다.</li><br/><br/>시간 1에서는 초당 3500RU로, 시간 2에서는 초당 400RU로, [자동 크기 조정 프로비저닝된 처리량 비율](https://azure.microsoft.com/pricing/details/cosmos-db/)에 따라 요금이 청구됩니다. 초당 RU에 따른 자동 크기 조정 비율은 1.5 * 표준(수동) 비율입니다.
|프로비저닝된 초당 RU를 초과하면 어떻게 되나요?|초당 RU는 프로비저닝된 크기를 유지합니다. 초당 프로비저닝된 RU보다 많이 사용하는 모든 요청은 속도가 제한되며 다시 시도하기 전에 대기할 시간이 권장됩니다. 필요한 경우 수동으로 초당 RU를 늘리거나 줄일 수 있습니다.| 시스템은 초당 RU 크기를 자동 크기 조정 최대 초당 RU까지 조정합니다. 자동 크기 조정 초당 최대 RU보다 많이 사용하는 모든 요청은 속도가 제한되며 다시 시도하기 전에 대기할 시간이 권장됩니다.|

## <a name="understand-your-traffic-patterns"></a>트래픽 패턴 이해

### <a name="new-applications"></a>새 애플리케이션 ###

새 애플리케이션을 빌드하려고 하지만 트래픽 패턴을 모르는 경우 진입점의 초당 RU(또는 초당 최소 RU)에서 시작하여 시작 부분의 과도한 프로비저닝을 방지할 수 있습니다. 또는 대규모가 필요하지 않은 소형 애플리케이션을 사용하는 경우 비용을 최적화하기 위해 최소 진입점의 초당 RU만 프로비저닝할 수 있습니다. 예상 트래픽이 낮은 작은 응용 프로그램의 경우 [서버](throughput-serverless.md) 리스 용량 모드를 고려할 수도 있습니다.

표준 (수동) 또는 자동 크기 조정을 사용할지 여부는 다음을 고려해 야 합니다.

진입점의 초당 400RU에서 표준(수동) 초당 RU를 프로비저닝하는 경우 처리량을 수동으로 변경하지 않는 한, 초당 400RU 이상을 사용할 수 없습니다. 시간을 기준으로 시간당 표준(수동) 프로비저닝된 처리량 속도로 초당 400RU로 요금이 청구됩니다.

자동 크기 조정 처리량을 초당 최대 RU인 초당 4000RU의 진입점에서 프로비저닝하는 경우 리소스는 초당 400RU에서 4000RU 범위에서 크기를 조정합니다. 자동 크기 조정 처리량 청구 비율(초당 RU)이 표준(수동) 비율의 1.5배이므로 시스템에서 최소 초당 400RU로 축소한 시간 동안 사용자 요금은 수동으로 초당 400RU를 프로비저닝한 경우보다 높아집니다. 그러나 자동 크기 조정 기능을 사용하면 언제든지 애플리케이션 트래픽이 급증하는 경우 사용자 작업 없이도 초당 최대 4000RU를 소비할 수 있습니다. 일반적으로 1.5배 비율의 자동 크기 조정을 사용하여 언제든지 초당 최대 RU까지 사용할 수 있다는 이점이 있습니다.

Azure Cosmos DB [용량 계산기](estimate-ru-with-capacity-planner.md)를 사용하여 처리량 요구 사항을 예상합니다. 

### <a name="existing-applications"></a>기존 애플리케이션 ###

표준(수동) 프로비저닝된 처리량을 사용하는 기존 애플리케이션이 있는 경우 [Azure Monitor 메트릭](../azure-monitor/insights/cosmosdb-insights-overview.md)을 사용하여 트래픽 패턴이 자동 크기 조정에 적합한지 확인할 수 있습니다. 

먼저 데이터베이스 또는 컨테이너의 [정규화된 요청 단위 사용 메트릭](monitor-normalized-request-units.md#view-the-normalized-request-unit-consumption-metric)을 찾습니다. 정규화된 사용률은 현재 사용 중인 표준(수동) 프로비저닝된 처리량을 측정한 값입니다. 숫자가 100%에 가까울수록 프로비저닝된 초당 RU를 완전히 사용하는 경우가 많아집니다. 메트릭에 대해 [자세히 알아봅니다](monitor-normalized-request-units.md#view-the-normalized-request-unit-consumption-metric).

다음으로, 시간에 따라 정규화된 사용률이 어떻게 달라지는지 확인합니다. 각 시간에 대 한 가장 높은 정규화 된 사용률을 찾습니다. 그런 다음 모든 시간에 걸쳐 정규화 된 평균 사용률을 계산 합니다. 평균 사용률이 66% 미만인 경우에는 데이터베이스 또는 컨테이너에서 자동 크기 조정을 사용 하도록 설정 하는 것이 좋습니다. 반면 평균 사용률이 66% 보다 크면 표준 (수동) 프로 비전 된 처리량을 유지 하는 것이 좋습니다.

> [!TIP]
> 계정이 다중 지역 쓰기를 사용 하도록 구성 되어 있고 지역이 둘 이상인 경우에는 수동 및 자동 크기 조정에 대해 100 r u/초 당 요금이 동일 합니다. 즉, 자동 크기 조정을 사용 하면 사용률에 관계 없이 추가 비용이 발생 하지 않습니다. 따라서 둘 이상의 지역이 있는 경우 다중 지역 쓰기에 자동 크기 조정을 사용 하 여 응용 프로그램의 크기를 조정 하는 데 필요한 경우에만 요금을 지불할 수 있습니다. 다중 지역 쓰기와 한 지역이 있는 경우 평균 사용량을 사용 하 여 자동 크기 조정으로 비용을 절감할 수 있는지 확인 합니다. 

#### <a name="examples"></a>예

두 가지 예제 작업을 살펴보고 수동 또는 자동 크기 조정 처리량에 적합 한지를 분석 해 보겠습니다. 일반적인 접근 방식을 설명 하기 위해 3 시간의 기록을 분석 하 여 수동 및 자동 크기 조정 사용 간의 비용 차이를 확인 합니다. 프로덕션 워크 로드의 경우 7 ~ 30 일 동안의 기록 (또는 사용 가능한 경우 더 오래 된)을 사용 하 여 사용 패턴을 설정 하는 것이 좋습니다.

> [!NOTE]
> 이 문서에 표시 된 모든 예제는 미국의 비 정부 지역에 배포 된 Azure Cosmos 계정에 대 한 가격을 기준으로 합니다. 가격 책정 및 계산은 사용 중인 지역에 따라 달라 지 며, 최신 가격 책정 정보는 Azure Cosmos DB [가격 책정 페이지](https://azure.microsoft.com/pricing/details/cosmos-db/) 를 참조 하세요.

가정:
- 현재 수동 처리량이 3만 r u/초 라고 가정 합니다. 
- 지역은 단일 지역 쓰기로 구성 되며 지역이 하나 있습니다. 여러 지역이 있는 경우 시간당 비용을 지역 수로 곱합니다.
- 단일 지역 쓰기 계정에서 수동 (시간당 $0.008 100 USD/s/s/s/s 당) 및 자동 크기 조정 처리량 (시간당 $0.012 100 USD/시간당)을 사용 합니다. 자세한 내용은 [가격 책정 페이지](https://azure.microsoft.com/pricing/details/cosmos-db/) 를 참조 하세요. 

#### <a name="example-1-variable-workload-autoscale-recommended"></a>예 1: 가변 작업 (자동 크기 조정 권장)

첫째, 정규화 된를 사용 합니다. 이 워크 로드에는 6%에서 100%까지 정규화 된를 사용 하는 가변 트래픽이 있습니다. 예측 하기 어려운 100%까지 급증 하지만 사용률이 낮은 많은 시간이 발생 합니다. 

:::image type="content" source="media/how-to-choose-offer/variable-workload_use_autoscale.png" alt-text="모든 시간에 대해 가변 트래픽 표준화 된 작업 (6% ~ 100%)":::

자동 크기 조정 최대 r u/초를 3만 (3000-3만 r u/초 사이)로 설정 하는 것과 비교 하 여 3만 r u/s 수동 처리량을 프로 비전 하는 비용을 비교해 보겠습니다. 

이제 기록을 분석 하겠습니다. 다음 표에 설명 된 사용률이 있다고 가정 합니다. 이 3 시간 동안의 평균 사용률은 39%입니다. 정규화 된 과도 소비는 66% 미만으로 평균을 계산 하므로 자동 크기 조정을 사용 하 여 저장 합니다. 

1 시간 1에 6% 사용량이 있으면 자동 크기 조정에서 시간당 최소/초의 10%에 대 한 요금을 청구 합니다. 모든 시간 동안 평균 사용률이 66% 미만이 면 자동 크기 조정 비용이 수동 처리량 보다 높을 수 있지만, 자동 크기 조정은 전체 비용을 저렴 하 게 됩니다.

|  | 사용률 |청구 된 자동 크기 조정/초  |옵션 1: 수동 3만 o s/s  | 옵션 2:3000-3만 r u/초 간 자동 크기 조정 |
|---------|---------|---------|---------|---------|
|시간 1  | 6%  |     3000  |  3만 * 0.008/100 = $2.40        |   3000 * 0.012/100 = $0.36      |
|시간 2  | 100%  |     30,000    |  3만 * 0.008/100 = $2.40       |  3만 * 0.012/100 = $3.60      |
|시간 3 |  11%  |     3300    |  3만 * 0.008/100 = $2.40       |    3300 * 0.012/100 = $0.40     |
|**합계**   |  |        |  $7.20       |    $4.36 (39% 절감)    |

#### <a name="example-2-steady-workload-manual-throughput-recommended"></a>예 2: 안정적인 작업 (수동 처리량 권장)

이 워크 로드는 트래픽이 안정적 이며, 72%에서 100%까지 정규화 된를 사용 합니다. 3만 r u/s가 프로 비전 되 면 21600에서 3만 r u/초 사이를 사용 하는 것입니다.

:::image type="content" source="media/how-to-choose-offer/steady_workload_use_manual_throughput.png" alt-text="모든 시간에 대해 가변 트래픽 표준화 된 작업 (6% ~ 100%)":::

자동 크기 조정 최대 r u/초를 3만 (3000-3만 r u/초 사이)로 설정 하는 것과 비교 하 여 3만 r u/s 수동 처리량을 프로 비전 하는 비용을 비교해 보겠습니다.

테이블에 설명 된 대로 사용률 기록이 있다고 가정해 보겠습니다. 이 3 시간 동안의 평균 사용률은 88%입니다. 정규화 된 과도 소비는 66% 이상으로 평균을 계산 하므로 수동 처리량을 사용 하 여 저장 합니다.

일반적으로 한 달에 730 시간 동안의 평균 사용률이 66% 보다 크면 수동 처리량을 사용 하 여 저장 합니다. 

|  | 사용률 |청구 된 자동 크기 조정/초  |옵션 1: 수동 3만 o s/s  | 옵션 2:3000-3만 r u/초 간 자동 크기 조정 |
|---------|---------|---------|---------|---------|
|시간 1  | 72%  |     21600   |  3만 * 0.008/100 = $2.40        |   21600 * 0.012/100 = $2.59      |
|시간 2  | 93%  |     28,000    |  3만 * 0.008/100 = $2.40       |  28000 * 0.012/100 = $3.36       |
|시간 3 |  100%  |     30,000    |  3만 * 0.008/100 = $2.40       |    3만 * 0.012/100 = $3.60     |
|**합계**   |  |        |  $7.20       |    $9.55     |

> [!TIP]
> 표준(수동) 처리량을 사용하면 정규화된 사용률 메트릭을 사용하여 자동 크기 조정으로 전환하는 경우에 사용할 수 있는 실제 초당 RU를 예상할 수 있습니다. 특정 시점의 정규화된 사용률을 현재 프로비저닝된 표준(수동) 초당 RU와 곱합니다. 예를 들어, 초당 5,000RU를 프로비저닝했으며 정규화된 사용률이 90%인 경우 초당 RU 사용량은 0.9 * 5000 = 4500RU/초입니다. 트래픽 패턴이 가변적이지만 초과 프로비저닝되거나 미달 프로비저닝된 경우 자동 크기 조정을 사용하도록 설정한 후 그에 따라 자동 크기 조정 최대 초당 RU를 변경할 수 있습니다.

#### <a name="how-to-calculate-average-utilization"></a>평균 사용률을 계산 하는 방법
1 시간 내에 크기 조정 된 최고 r u/초에 대 한 자동 크기 조정 요금입니다. 시간에 따른 정규화 된 과도 소비를 분석할 때 평균을 계산할 때 시간당 최고 사용률을 사용 하는 것이 중요 합니다. 

모든 시간 동안의 최고 사용률에 대 한 평균을 계산 하려면:
1. Noramlized r 소비 메트릭에 대 한 **집계** 를 **Max**로 설정 합니다.
1. **시간 세분성** 을 1 시간으로 선택 합니다.
1. **차트 옵션**으로 이동 합니다.
1. 가로 막대형 차트 옵션을 선택 합니다. 
1. **공유**에서 **Excel로 다운로드** 옵션을 선택 합니다. 생성 된 스프레드시트에서 모든 시간 동안의 평균 사용률을 계산 합니다. 

:::image type="content" source="media/how-to-choose-offer/variable-workload-highest-util-by-hour.png" alt-text="모든 시간에 대해 가변 트래픽 표준화 된 작업 (6% ~ 100%)":::

## <a name="measure-and-monitor-your-usage"></a>사용량 측정 및 모니터링
시간이 지남에 따라 처리량 유형을 선택한 후에는 애플리케이션을 모니터링하고 필요에 맞게 조정해야 합니다. 

자동 크기 조정을 사용하는 경우 Azure Monitor를 사용하여 프로비저닝된 자동 크기 조정 최대 초당 RU(**자동 크기 조정 최대 처리량**) 및 시스템이 현재 조정된 초당 RU(**프로비저닝된 처리량**)를 확인합니다. 다음은 자동 크기 조정을 사용하는 가변 또는 예측할 수 없는 워크로드의 예제입니다. 트래픽이 없는 경우 시스템은 초당 RU 크기를 초당 최대 RU 중 최소 10%로 조정합니다. 이 경우에는 각각 초당 5,000RU 및 초당 50,000RU입니다. 

:::image type="content" source="media/how-to-choose-offer/autoscale-metrics-azure-monitor.png" alt-text="모든 시간에 대해 가변 트래픽 표준화 된 작업 (6% ~ 100%)":::

> [!NOTE]
> 표준(수동) 프로비저닝된 처리량을 사용하는 경우 **프로비저닝된 처리량** 메트릭은 사용자가 설정한 크기를 나타냅니다. 자동 크기 조정 처리량을 사용하는 경우 이 메트릭은 시스템이 현재 조정된 초당 RU를 나타냅니다.

## <a name="next-steps"></a>다음 단계
* [RU 계산기](https://cosmos.azure.com/capacitycalculator/)를 사용하여 새 워크로드에 대한 처리량을 예측합니다.
* [Azure Monitor](monitor-cosmos-db.md#view-operation-level-metrics-for-azure-cosmos-db)를 사용하여 기존 워크로드를 모니터링합니다.
* [Azure Cosmos 데이터베이스 또는 컨테이너에서 자동 크기 조정 처리량을 프로비저닝](how-to-provision-autoscale-throughput.md)하는 방법을 알아봅니다.
* [자동 크기 조정 FAQ](autoscale-faq.md)를 검토합니다.