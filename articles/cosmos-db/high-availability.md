---
title: Azure Cosmos DB의 고가용성
description: 이 문서에서는 Azure Cosmos DB에서 고가용성을 제공하는 방법을 설명합니다.
services: cosmos-db
author: markjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 10/15/2018
ms.author: mjbrown
ms.reviewer: sngun
ms.openlocfilehash: fdf1bf227ed21111c1aa0754a8423c1ee6aa151b
ms.sourcegitcommit: dbfd977100b22699823ad8bf03e0b75e9796615f
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/30/2018
ms.locfileid: "50243928"
---
# <a name="high-availability-in-azure-cosmos-db"></a>Azure Cosmos DB의 고가용성

Azure Cosmos DB는 사용자의 Cosmos 계정과 연결된 Azure 지역에 데이터를 투명하게 복제합니다.  Cosmos DB는 데이터에 여러 계층의 중복성을 사용합니다. 아래 그림에서 확인할 수 있습니다.

- Cosmos 컨테이너 내 데이터는 수평 분할됩니다.
- 각 지역 내에서 각 파티션은 복제된 모든 쓰기를 사용한 복제본 집합으로 보호되며 대부분의 복제본에 의해 지속력 있게 커밋됩니다. 복제본은 10 ~ 20개의 장애 도메인 간에 분산됩니다.
- 모든 지역에서 모든 파티션이 복제됩니다. 각 지역에는 Cosmos 컨테이너의 전체 데이터 파티션을 포함하며, 쓰기를 허용하고 읽기를 사용할 수 있습니다.  

![리소스 분할](./media/high-availability/figure1.png) 

Cosmos 계정이 N개 Azure 지역에 분산된 경우 데이터 복사본은 최소 N x 4개가 됩니다. Cosmos 계정과 연결된 지역에서 데이터에 대해 대기 시간이 짧은 액세스를 제공하고 쓰기 및 읽기 처리량을 조정하는 것 외에도, 지역이 더 많아지면(더 높은 N) 가용성은 더 개선됩니다.  

## <a name="availability-slas"></a>가용성 SLA  

전역적으로 분산된 데이터베이스로, Cosmos DB는 처리량, 99번째 백분위수의 대기 시간, 일관성 및 고가용성을 포함하는 포괄적인 SLA를 제공합니다. 다음 표에서는 Cosmos DB가 제공하는 단일 및 다중 지역 계정에 대한 고가용성 보장 내용을 설명합니다. 가장 높은 가용성의 경우 여러 쓰기 지역이 있는 Cosmos 계정을 구성하는 것이 좋습니다.

|작업 유형  | 단일 지역 |다중 지역(단일 지역 쓰기)|다중 지역(다중 지역 쓰기)|
|---------|---------|---------|-------|
|쓰기    | 99.99    |99.99   |99.999|
|읽기     | 99.99    |99.999  |99.999|

> [!NOTE]
> 실제로, 제한된 부실, 세션, 일관된 접두사 및 결과적 일관성 모델의 실제 쓰기 가용성은 게시된 SLA보다 훨씬 높습니다. 또한 실제로 모든 일관성 수준에 대한 실제 읽기 가용성은 게시된 SLA보다 훨씬 높습니다.

## <a name="regional-outages"></a>지역 중단

지역 중단은 드물게 나타나며, Azure Cosmos DB는 사용자의 데이터베이스를 항상 사용할 수 있도록 합니다. 다음은 Cosmos 계정 구성에 따라 가동 중단 동안의 Cosmos DB 동작을 설명한 것입니다. 

- 다중 쓰기 지역으로 구성된 다중 지역 계정은 지역 중단 동안 쓰기 및 읽기 모두에 대해 높은 가용성이 유지됩니다. 지역별 장애 조치(failover)는 즉각적이며, 응용 프로그램에서 변경할 필요가 없습니다.

- 단일 쓰기 지역의 다중 지역 계정은 쓰기 지역 중단 동안에 읽기에 대해 높은 가용성이 유지됩니다. 단, 쓰기의 경우 영향을 받는 지역을 Cosmos 계정과 연결된 다른 지역으로 장애 조치(failover)하도록 Cosmos DB에 대한 Cosmos 계정에서 “자동 장애 조치를 활성화”해야 합니다. 장애 조치는 지정한 지역 우선 순위에 따라 발생합니다. 최종적으로, 영향을 받는 지역이 다시 온라인 상태가 되면 중단된 동안 영향을 받는 쓰기 지역의 복제되지 않은 데이터는 충돌 피드를 통해 사용할 수 있게 됩니다. 응용 프로그램은 충돌 피드를 읽고, 응용 프로그램별 논리에 따라 충돌을 해결하고, 업데이트된 데이터를 Cosmos 컨테이너에 적절히 쓸 수 있습니다. 이전에 영향을 받는 쓰기 지역이 복구되고 나면, 자동으로 읽기 지역으로 사용할 수 있게 됩니다. 수동 장애 조치(failover)를 호출하고 영향을 받는 지역을 쓰기 지역으로 다시 가져올 수 있습니다. Azure CLI 또는 Azure Portal을 사용하여 수동 장애 조치(failover)를 수행할 수 있습니다.  

- 단일 쓰기 지역의 다중 지역 계정은 쓰기 지역 중단 동안에 읽기 및 쓰기에 대해 높은 가용성이 유지됩니다. 영향을 받는 지역은 쓰기 지역에서 자동으로 연결이 해제되며 오프라인으로 표시됩니다. Cosmos DB SDK는 기본 지역 목록에서 사용 가능한 다음 지역으로 읽기 호출을 리디렉션합니다. 기본 지역 목록의 어느 지역도 사용할 수 없는 경우 호출은 현재 쓰기 지역으로 자동으로 대체됩니다. 읽기 지역 중단을 처리하기 위해 응용 프로그램 코드를 변경할 필요가 없습니다. 결국 영향을 받는 지역이 다시 온라인 상태가 되면 이전에 영향을 받는 읽기 지역이 자동으로 현재 쓰기 지역과 동기화되고 읽기를 제공하는 데 다시 사용할 수 있습니다. 후속 읽기는 응용 프로그램 코드를 변경하지 않고도 복구된 지역으로 리디렉션됩니다. 이전에 실패한 지역의 장애 조치(failover) 및 다시 조인 모두에서 읽기 일관성 보장은 Cosmos DB에 의해 계속 적용됩니다.

- 단일 지역 계정은 지역 중단으로 인해 가용성이 손실될 수도 있습니다. 항상 고가용성을 보장하기 위해 사용자의 Cosmos 계정에 최소한 두 개의 지역(가급적 쓰기 지역 두 개 이상)을 설정할 것을 강력히 권장합니다.

## <a name="building-highly-available-applications"></a>고가용성 응용 프로그램 빌드

- 높은 쓰기 및 읽기 가용성을 보장하려면 여러 쓰기 지역을 사용하여 두 개 이상의 지역을 포괄하도록 Cosmos 계정을 구성합니다. 이 구성은 SLA를 통해 읽기 및 쓰기 모두에서 최상의 가용성, 낮은 대기 시간 및 확장성을 보장합니다. [다중 쓰기 지역으로 Cosmos 계정을 구성](tutorial-global-distribution-sql-api.md)하는 방법을 참조하세요.

- 단일 쓰기 지역으로 구성된 다중 지역 Cosmos 계정의 경우 Azure CLI 또는 Azure Portal을 사용하여 “자동 장애 조치(failover)”를 활성화합니다.  자동 장애 조치(failover)를 사용하도록 설정하면, Cosmos DB는 지역 재해가 있을 때마다 자동으로 사용자 계정을 장애 조치(failover)합니다.  

- Cosmos 계정의 가용성이 높더라도 응용 프로그램이 고가용성을 유지하도록 올바르게 설계되지 않았을 수도 있습니다. 응용 프로그램에 대한 종단 간 고가용성을 보장하려면 Azure CLI 또는 Azure Portal을 사용하여 “수동 장애 조치(failover)”를 응용 프로그램 테스트 또는 DR(재해 복구) 훈련의 일부로 주기적으로 호출합니다. 자세한 내용은 Cosmos 계정의 지역 우선 순위 변경을 참조하세요.  

## <a name="next-steps"></a>다음 단계

다음으로, 다음 문서에서 처리량 조정에 대해 알아볼 수 있습니다.

* [처리량 조정](scaling-throughput.md)

* [다양한 일관성 수준의 가용성 및 성능 절충](consistency-levels-tradeoffs.md)

* [전역적으로 처리량 조정](scaling-throughput.md)

* [글로벌 배포 - 내부 살펴보기](global-dist-under-the-hood.md)

* [Azure Cosmos DB의 일관성 수준](consistency-levels.md)


