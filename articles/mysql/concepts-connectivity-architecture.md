---
title: 연결 아키텍처-Azure Database for MySQL
description: Azure Database for MySQL 서버에 대 한 연결 아키텍처를 설명 합니다.
author: Bashar-MSFT
ms.author: bahusse
ms.service: mysql
ms.topic: conceptual
ms.date: 2/11/2021
ms.openlocfilehash: b8ee1f22429c1002ba8c3db5c41f5a186cc59451
ms.sourcegitcommit: ed7376d919a66edcba3566efdee4bc3351c57eda
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/24/2021
ms.locfileid: "105046473"
---
# <a name="connectivity-architecture-in-azure-database-for-mysql"></a>Azure Database for MySQL의 연결 아키텍처
이 문서에서는 Azure 내부 및 외부의 클라이언트에서 Azure Database for MySQL 인스턴스로 트래픽이 전송 되는 방법 뿐만 아니라 Azure Database for MySQL 연결 아키텍처에 대해 설명 합니다.

## <a name="connectivity-architecture"></a>연결 아키텍처
들어오는 연결을 클러스터에 있는 서버의 실제 위치로 라우팅하는 게이트웨이를 통해 Azure Database for MySQL에 대 한 연결이 설정 됩니다. 다음 다이어그램은 트래픽 흐름을 보여 줍니다.

:::image type="content" source="./media/concepts-connectivity-architecture/connectivity-architecture-overview-proxy.png" alt-text="연결 아키텍처 개요":::

클라이언트가 데이터베이스에 연결 하면 서버에 대 한 연결 문자열은 게이트웨이 IP 주소로 확인 됩니다. 게이트웨이는 3306 포트에서 IP 주소를 수신 대기 합니다. 데이터베이스 클러스터 내에서 트래픽이 적절 한 Azure Database for MySQL 전달 됩니다. 따라서 회사 네트워크에서와 같이 서버에 연결 하기 위해 **클라이언트 쪽 방화벽을 열어 아웃 바운드 트래픽이 게이트웨이에 도달할 수 있도록** 해야 합니다. 아래에서 지역별 게이트웨이에서 사용 하는 IP 주소의 전체 목록을 찾을 수 있습니다.

## <a name="azure-database-for-mysql-gateway-ip-addresses"></a>게이트웨이 IP 주소 Azure Database for MySQL

게이트웨이 서비스는 IP 주소 뒤에 있는 상태 비저장 계산 노드 그룹에서 호스트 되며, Azure Database for MySQL 서버에 연결 하려고 할 때 클라이언트가 먼저 도달 하 게 됩니다. 

지속적인 서비스 유지 관리의 일환으로, 게이트웨이를 호스트 하는 계산 하드웨어를 주기적으로 새로 고쳐 가장 안전 하 고 성능이 뛰어난 환경을 제공 합니다. 게이트웨이 하드웨어를 새로 고치면 계산 노드의 새 링이 먼저 빌드됩니다. 이 새 링은 새로 생성 된 모든 Azure Database for MySQL 서버에 대 한 트래픽을 처리 하며, 트래픽을 구분 하기 위해 동일한 지역에 있는 이전 게이트웨이 링과 다른 IP 주소를 갖게 됩니다. 새 링이 완전 하 게 작동 하면 기존 서버를 처리 하는 이전 게이트웨이 하드웨어는 서비스 해제에 대해 계획 됩니다. 게이트웨이 하드웨어의 서비스를 해제 하기 전에 서버를 실행 하 고 이전 게이트웨이 링에 연결 하는 고객은 메일을 통해, Azure Portal 그리고 사용자가 서비스를 해제 하기 전에 3 개월 전에 미리 알림 메시지를 받을 수 있습니다. 게이트웨이를 서비스 해제 하면 서버에 대 한 연결에 영향을 줄 수 있습니다. 

* 응용 프로그램의 연결 문자열에 게이트웨이 IP 주소를 하드 코딩 합니다. **권장 되지 않습니다**. <servername>응용 프로그램에 대 한 연결 문자열에서 서버의 FQDN (정규화 된 도메인 이름)을 mysql.database.azure.com 형식으로 사용 해야 합니다. 
* 아웃 바운드 트래픽이 새 게이트웨이 링에 도달할 수 있도록 클라이언트 쪽 방화벽에서 최신 게이트웨이 IP 주소를 업데이트 하지 않습니다.

다음 표에서는 모든 데이터 영역에 대 한 Azure Database for MySQL 게이트웨이의 게이트웨이 IP 주소를 나열 합니다. 각 지역의 게이트웨이 IP 주소에 대 한 최신 정보는 아래 테이블에서 유지 관리 됩니다. 아래 표에서 열은 다음을 나타냅니다.

* **게이트웨이 IP 주소:** 이 열은 최신 하드웨어 세대에서 호스팅되는 게이트웨이의 현재 IP 주소를 나열 합니다. 새 서버를 프로 비전 하는 경우 클라이언트 쪽 방화벽을 열어이 열에 나열 된 IP 주소에 대 한 아웃 바운드 트래픽을 허용 하는 것이 좋습니다.
* **게이트웨이 IP 주소 (서비스 해제):** 이 열은 현재 서비스를 해제할 이전 하드웨어 세대에서 호스팅되는 게이트웨이의 IP 주소를 나열 합니다. 새 서버를 프로 비전 하는 경우 이러한 IP 주소를 무시할 수 있습니다. 기존 서버가 있는 경우 해당 IP 주소를 아직 서비스 해제 하지 않았으므로 방화벽에 대 한 아웃 바운드 규칙을 계속 유지 합니다. 이러한 IP 주소에 대 한 방화벽 규칙을 삭제 하면 연결 오류가 발생할 수 있습니다. 대신 서비스 해제에 대 한 알림을 받는 즉시 게이트웨이 IP 주소 열에 나열 된 새 IP 주소를 아웃 바운드 방화벽 규칙에 사전에 추가 해야 합니다. 이렇게 하면 서버가 최신 게이트웨이 하드웨어로 마이그레이션될 때 서버에 대 한 연결이 중단 되지 않습니다.
* **게이트웨이 IP 주소 (서비스 해제 됨):** 이 열에는 서비스 해제 되 고 더 이상 작동 하지 않는 게이트웨이 링의 IP 주소가 나열 됩니다. 아웃 바운드 방화벽 규칙에서 이러한 IP 주소를 안전 하 게 제거할 수 있습니다. 


| **영역 이름** | **게이트웨이 IP 주소** |**게이트웨이 IP 주소 (서비스 해제)** | **게이트웨이 IP 주소 (서비스 해제 됨)** |
|:----------------|:-------------------------|:-------------------------------------------|:------------------------------------------|
| 오스트레일리아 중부| 20.36.105.0  | | |
| 오스트레일리아 Central2     | 20.36.113.0  | | |
| 오스트레일리아 동부 | 13.75.149.87, 40.79.161.1     |  | |
| 오스트레일리아 동남부 |191.239.192.109, 13.73.109.251   |  | |
| 브라질 남부 |191.233.201.8, 191.233.200.16    |  | 104.41.11.5|
| 캐나다 중부 |40.85.224.249  | | |
| 캐나다 동부 | 40.86.226.166    | | |
| 미국 중부 | 23.99.160.139, 52.182.136.37, 52.182.136.38 | 13.67.215.62 | |
| 중국 동부 | 139.219.130.35    | | |
| 중국 동부 2 | 40.73.82.1  | | |
| 중국 북부 | 139.219.15.17    | | |
| 중국 북부 2 | 40.73.50.0     | | |
| 동아시아 | 191.234.2.139, 52.175.33.150, 13.75.33.20, 13.75.33.21     | | |
| 미국 동부 |40.71.8.203, 40.71.83.113 |40.121.158.30|191.238.6.43 |
| 미국 동부 2 | 40.70.144.38, 52.167.105.38  | 52.177.185.181 | |
| 프랑스 중부 | 40.79.137.0, 40.79.129.1  | | |
| 프랑스 남부 | 40.79.177.0     | | |
| 독일 중부 | 51.4.144.100     | | |
| 독일 북부 | 51.116.56.0 | |
| 독일 북동부 | 51.5.144.179  | | |
| 독일 중서부 | 51.116.152.0 | |
| 인도 중부 | 104.211.96.159     | | |
| 인도 남부 | 104.211.224.146  | | |
| 인도 서부 | 104.211.160.80    | | |
| 일본 동부 | 40.79.192.23, 40.79.184.8 | 13.78.61.196 | |
| 일본 서부 | 191.238.68.11, 40.74.96.6, 40.74.96.7     | 104.214.148.156 | |
| 한국 중부 | 52.231.17.13   | 52.231.32.42 | |
| 한국 남부 | 52.231.145.3     | 52.231.200.86 | |
| 미국 중북부 | 52.162.104.35, 52.162.104.36    | 23.96.178.199 | |
| 북유럽 | 52.138.224.6, 52.138.224.7  | 40.113.93.91 |191.235.193.75 |
| 남아프리카 북부  | 102.133.152.0    | | |
| 남아프리카 공화국 서부 | 102.133.24.0   | | |
| 미국 중남부 |104.214.16.39, 20.45.120.0  |13.66.62.124  |23.98.162.75 |
| 동남아시아 | 40.78.233.2, 23.98.80.12     | 104.43.15.0 | |
| 스위스 북부 | 51.107.56.0 ||
| 스위스 서부 | 51.107.152.0||
| 아랍에미리트 중부 | 20.37.72.64  | | |
| 아랍에미리트 북부 | 65.52.248.0    | | |
| 영국 남부 | 51.140.184.11   | | |
| 영국 서부 | 51.141.8.11  | | |
| 미국 중서부 | 13.78.145.25     | | |
| 서유럽 |13.69.105.208, 104.40.169.187 | 40.68.37.158 | 191.237.232.75 |
| 미국 서부 |13.86.216.212, 13.86.217.212 |104.42.238.205  | 23.99.34.75|
| 미국 서부 2 | 13.66.136.192 | 13.66.226.202  | | 
||||

## <a name="connection-redirection"></a>연결 리디렉션

Azure Database for MySQL은 클라이언트 응용 프로그램과 MySQL 서버 간의 네트워크 대기 시간을 줄이는 데 도움이 되는 추가 연결 정책 **리디렉션** 기능을 지원 합니다. 리디렉션을 사용 하면 초기 TCP 세션이 Azure Database for MySQL 서버에 설정 된 후 서버는 MySQL 서버를 호스트 하는 노드의 백 엔드 주소를 클라이언트에 반환 합니다. 이후에는 모든 후속 패킷이 서버에 직접 전달 되 고 게이트웨이는 무시 됩니다. 패킷이 서버에 직접 전달 되 면 대기 시간 및 처리량이 향상 됩니다.

이 기능은 엔진 버전이 5.6, 5.7 및 8.0 인 Azure Database for MySQL 서버에서 지원 됩니다.

리디렉션 지원은 Microsoft에서 개발한 PHP [mysqlnd_azure](https://github.com/microsoft/mysqlnd_azure) 확장에서 제공 되며 [PECL](https://pecl.php.net/package/mysqlnd_azure)에서 사용할 수 있습니다. 응용 프로그램에서 리디렉션을 사용 하는 방법에 대 한 자세한 내용은 [리디렉션 구성](./howto-redirection.md) 문서를 참조 하세요.


> [!IMPORTANT]
> PHP [mysqlnd_azure](https://github.com/microsoft/mysqlnd_azure) 확장의 리디렉션에 대한 지원은 현재 미리 보기 상태입니다.

## <a name="frequently-asked-questions"></a>질문과 대답

### <a name="what-you-need-to-know-about-this-planned-maintenance"></a>이 계획 된 유지 관리에 대해 알아야 할 사항은 무엇 인가요?
이는 클라이언트에 투명 하 게 만드는 DNS 변경 내용입니다. DNS 서버에서 FQDN의 IP 주소가 변경 되는 동안 로컬 DNS 캐시는 5 분 이내에 새로 고쳐지고 운영 체제에서 자동으로 수행 됩니다. 로컬 DNS 새로 고침이 완료 되 면 모든 새 연결이 새 IP 주소에 연결 되 고 기존 IP 주소를 완전히 해제할 때까지 모든 기존 연결은 이전 IP 주소에 연결 된 상태로 유지 됩니다. 이전 IP 주소는 서비스를 해제 하기 전에 약 3 ~ 4 주가 소요 됩니다. 따라서 클라이언트 응용 프로그램에는 영향을 주지 않아야 합니다.

### <a name="what-are-we-decommissioning"></a>서비스를 해제 하는 것은 무엇 인가요?
게이트웨이 노드만 서비스 해제 됩니다. 사용자가 서버에 연결 하는 경우 연결을 서버에 전달 하기 전에 먼저 게이트웨이 노드로 연결을 중지 합니다. 서버를 실행 하는 테 넌 트 링이 아닌 이전 게이트웨이 링의 서비스를 해제 하는 중입니다. 자세한 설명은 [연결 아키텍처](#connectivity-architecture) 를 참조 하세요.

### <a name="how-can-you-validate-if-your-connections-are-going-to-old-gateway-nodes-or-new-gateway-nodes"></a>연결이 이전 게이트웨이 노드나 새 게이트웨이 노드로 이동 하는지 어떻게 확인할 수 있나요?
서버의 FQDN을 Ping 합니다 (예:)  ``ping xxx.mysql.database.azure.com`` . 반환 된 IP 주소가 위의 문서에서 게이트웨이 IP 주소 (서비스 해제) 아래에 나열 된 ip 중 하나 이면 연결이 이전 게이트웨이를 통과 하는 것을 의미 합니다. 반면 반환 된 Ip 주소가 게이트웨이 IP 주소 아래에 나열 된 ip 중 하나 이면 연결이 새 게이트웨이를 통과 하는 것을 의미 합니다.

또한 포트 3306을 사용 하 여 클라이언트 응용 프로그램에서 데이터베이스 서버를 [Psping](/sysinternals/downloads/psping) 또는 tcpping으로 테스트 하 고, 반환 ip 주소가 서비스 해제 ip 주소 중 하나가 아닌지 확인 합니다.

### <a name="how-do-i-know-when-the-maintenance-is-over-and-will-i-get-another-notification-when-old-ip-addresses-are-decommissioned"></a>유지 관리가 초과 되는 경우를 확인 하 고 오래 된 IP 주소를 해제할 때 다른 알림을 받게 되나요? 어떻게 할까요?
유지 관리 작업을 시작 하는 경우 사용자에 게 알리는 전자 메일을 받게 됩니다. 유지 관리는 al 지역에서 마이그레이션해야 하는 서버 수에 따라 최대 1 개월이 걸릴 수 있습니다. FQDN을 사용 하거나 위의 표에서 새 IP 주소를 사용 하 여 데이터베이스 서버에 연결 하도록 클라이언트를 준비 하세요. 

### <a name="what-do-i-do-if-my-client-applications-are-still-connecting-to-old-gateway-server-"></a>클라이언트 응용 프로그램이 여전히 이전 게이트웨이 서버에 연결 하는 경우 어떻게 해야 하나요?
이는 응용 프로그램이 FQDN 대신 고정 IP 주소를 사용 하 여 서버에 연결 됨을 나타냅니다. 소스 코드에서 연결 문자열 및 연결 풀링 설정, AKS 설정 또는도 검토 합니다.

### <a name="is-there-any-impact-for-my-application-connections"></a>내 응용 프로그램 연결에 대 한 영향이 있나요?
이 유지 관리는 DNS 변경 내용 이므로 클라이언트에 투명 하 게 유지 됩니다. 클라이언트에서 DNS 캐시를 새로 고치면 (운영 체제에서 자동으로 수행 됨) 모든 새 연결은 새 IP 주소에 연결 되 고 기존 IP 주소는 완전히 서비스 해제 될 때까지 계속 작동 합니다 .이는 일반적으로 몇 주 후에 수행 됩니다. 이 경우 다시 시도 논리는 필요 하지 않지만 응용 프로그램에서 재시도 논리를 구성 하는 것을 확인 하는 것이 좋습니다. FQDN을 사용 하 여 데이터베이스 서버에 연결 하거나 응용 프로그램 연결 문자열에 새 ' 게이트웨이 IP 주소를 나열 하십시오. '를 사용 하도록 설정 하세요.
이 유지 관리 작업은 기존 연결을 삭제 하지 않습니다. 새 연결 요청만 새 게이트웨이 링으로 이동 합니다.

### <a name="can-i-request-for-a-specific-time-window-for-the-maintenance"></a>유지 관리를 위해 특정 기간에 대해 요청할 수 있나요? 
마이그레이션은 투명 하 고 고객의 연결에 영향을 주지 않으므로 대부분의 사용자에 게 아무런 문제가 없을 것입니다. 응용 프로그램을 미리 검토 하 고 응용 프로그램 연결 문자열에서 FQDN을 사용 하 여 데이터베이스 서버에 연결 하거나 새 ' 게이트웨이 IP 주소를 나열 합니다. '를 사용 하도록 설정 해야 합니다.

### <a name="i-am-using-private-link-will-my-connections-get-affected"></a>개인 링크를 사용 하 고 있는데, 연결이 영향을 받습니까?
아니요,이는 게이트웨이 하드웨어 서비스 해제 되 고 개인 링크 또는 개인 IP 주소와 관계 없이 서비스 해제 IP 주소에서 언급 된 공용 IP 주소에만 영향을 줍니다.



## <a name="next-steps"></a>다음 단계
* [Azure Portal를 사용 하 여 Azure Database for MySQL 방화벽 규칙 만들기 및 관리](./howto-manage-firewall-using-portal.md)
* [Azure CLI를 사용한 MySQL용 Azure Database 방화벽 규칙 만들기 및 관리](./howto-manage-firewall-using-cli.md)
* [Azure Database for MySQL를 사용 하 여 리디렉션 구성](./howto-redirection.md)