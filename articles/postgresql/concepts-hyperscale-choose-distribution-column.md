---
title: PostgreSQL – 대규모 (Citus) (미리 보기) 용 Azure Database에서 배포 열 선택
description: 일반적인 대규모 시나리오에서 배포 열에 대 한 적절 한 선택
author: jonels-msft
ms.author: jonels
ms.service: postgresql
ms.subservice: hyperscale-citus
ms.topic: conceptual
ms.date: 05/06/2019
ms.openlocfilehash: e9fba14b8979f739fd29bc277e32fb544221d08a
ms.sourcegitcommit: 0ae3139c7e2f9d27e8200ae02e6eed6f52aca476
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65078987"
---
# <a name="choose-distribution-columns-in-azure-database-for-postgresql--hyperscale-citus-preview"></a>PostgreSQL – 대규모 (Citus) (미리 보기) 용 Azure Database에서 배포 열 선택

각 테이블의 배포 열을 선택 하는 것 **가장 중요 한 중** 의사 결정을 모델링 합니다. 대규모 배포 열 행의 값을 기반으로 하는 분할 된 데이터베이스에 행을 저장 합니다.

적합 한 그룹 관련 데이터를 함께 하는 동일한 물리적 노드에서 모든 SQL 기능에 대 한 빠르고 추가 지원 쿼리 합니다. 잘못 선택 사용 하면 시스템에서 느리게 실행 됩니다 및 노드에서 모든 SQL 기능을 지원 하지 않습니다.

이 섹션에서는 가장 일반적인 두 가지 대규모 시나리오에 대 한 배포 열 팁을 제공 합니다.

### <a name="multi-tenant-apps"></a>다중 테 넌 트 앱

다중 테 넌 트 아키텍처 계층 데이터베이스를 서버 그룹의 노드 간에 쿼리를 분산 하려면 모델링의 형태를 사용 합니다.  데이터 계층의 최상위 라고 합니다 *테 넌 트 ID*, 각 테이블의 열에 저장 되어야 하 고 있습니다.

대규모를 포함 하며 일치 하는 테이블 분할 된 데이터베이스를 찾습니다는 테 넌 트 ID를 보려면 쿼리를 검사 합니다. 쿼리가 분할 된 데이터베이스를 포함 하는 단일 작업자 노드에 라우팅합니다. 동일한 노드에 배치 되는 모든 관련 데이터를 사용 하 여 쿼리를 실행 하면 공동 배치를 라고 합니다.

다음 다이어그램에서는 다중 테 넌 트 데이터 모델에 공동 배치를 보여 줍니다. 두 개의 테이블, 계정 및 캠페인 들어에서 각 배포 `account_id`합니다. 회색된 상자는 것을 포함 하는 작업자 노드를 나타내는 해당 색의 각 분할 된 데이터베이스를 나타냅니다. 녹색 분할 된 데이터베이스는 하나의 작업자 노드와 다른 파란색에 함께 저장 됩니다. 볼 수 있습니다 어떻게 계정 및 캠페인 간의 join 쿼리로 필요한 모든 데이터가 함께 한 노드에서 동일한 계정에 두 테이블을 제한 하는 경우\_id입니다.

![다중 테 넌 트 공동 배치](media/concepts-hyperscale-choosing-distribution-column/multi-tenant-colocation.png)

이 디자인에서 사용자 고유의 스키마를 적용 하려면 응용 프로그램에서 테 넌 트 구성 요소를 식별 합니다. 일반적인 인스턴스 회사, 계정, 조직 또는 고객을 포함합니다. 열 이름을 같이 표시 됩니다 `company_id` 또는 `customer_id`합니다. 각 쿼리를 검토 하 고 자신에 게 질문:이 작동할 경우 동일한 테 넌 트 ID 사용 하 여 행 관련 된 모든 테이블을 제한 하려면 WHERE 절을 추가?
Sales 또는 inventory에 대 한 쿼리는 특정 저장소 내에서 범위가 지정 예를 들어, 다중 테 넌 트 모델에서 쿼리 테 넌 트 한정 됩니다.

#### <a name="best-practices"></a>모범 사례

-   **파티션 분산을 일반적인 테 넌 트 별로 테이블\_id 열입니다.** 테 넌 트가 있는 회사의 경우 테 넌 트 SaaS 응용 프로그램의 예를 들어\_id에서 회사 작성해보게 됩니다\_id입니다.
-   **작은 테 넌 트 간 테이블 참조 테이블로 변환 합니다.** 여러 테 넌 트 작은 테이블의 정보를 공유 하는 경우 참조 테이블로 배포 합니다.
-   **테 넌 트에서 모든 응용 프로그램 쿼리 필터 제한\_id입니다.** 각 쿼리는 한 번에 하나의 테 넌 트에 대 한 정보를 요청 해야 합니다.

읽기를 [다중 테 넌 트 자습서](./tutorial-design-database-hyperscale-multi-tenant.md) 이 종류의 응용 프로그램을 구축 하는 예입니다.

### <a name="real-time-apps"></a>실시간 앱

다중 테 넌 트 아키텍처 계층 구조를 소개 하 고 쿼리를 라우팅하도록 테 넌 트 당 데이터 공동 배치를 사용 합니다. 반면, 실시간 아키텍처 높은 병렬 처리를 위해 해당 데이터의 특정 배포 속성에 따라 달라 집니다.

"엔터티 ID" 실시간 모델에서 배포 열에 대 한 기간으로 사용합니다. 일반적인 엔터티는 사용자, 호스트 또는 장치입니다.

실시간 쿼리는 일반적으로 날짜 또는 범주별으로 그룹화 하는 숫자 집계에 대 한 요청 합니다. 대규모 부분 결과 대 한 각 분할 된 데이터베이스에 이러한 쿼리를 보내고 코디네이터 노드에서 최종 해답을 조합 합니다. 쿼리 실행 빠른 경우 최대한 많은 노드 기여를 하면 없는 단일 노드는 많은 양의 작업을 수행 해야 합니다.

#### <a name="best-practices"></a>모범 사례

-   **배포 열으로 카디널리티가 높은 열을 선택 합니다.** 비교의 경우는 \"상태\" 값 "new"를 사용 하 여 주문 테이블에서 필드 "유료" 이며 "배송" 잘못 된 배포 열 선택 합니다. 데이터를 보유할 수 있는 분할 된 데이터베이스 수 및 처리할 수 있는 노드의 수를 제한 하는 몇 가지 값만을 가정 합니다. 카디널리티가 높은 열 간에 또한 조인 키 또는 group by 절에서 자주 사용 되는 것을 선택 하는 것이 좋습니다.
-   **균일 한 분포를 사용 하 여 열을 선택 합니다.** 일반적인 특정 값에 비대칭 열에 테이블을 배포 하려는 경우 테이블의 데이터는 특정 분할 된 데이터베이스에 누적 경향이 있습니다. 다른 노드보다 더 많은 작업을 수행 하는 해당 분할 된 데이터베이스를 보유 하는 노드 종료 됩니다.
-   **일반적인 열 기준 팩트 테이블과 차원 테이블을 배포 합니다.**
    팩트 테이블 배포 키가 하나만 있을 수 있습니다. 다른 키에 참여 하는 테이블은 팩트 테이블을 사용 하 여 공동 배치 되지 않습니다. 조인 되는 빈도 조인 하는 행의 크기에 따라 공동 배치할 수 이상의 차원을 선택 합니다.
-   **참조 테이블에 일부 차원 테이블을 변경 합니다.** 차원 테이블은 팩트 테이블을 사용 하 여 공동 배치할 수 없습니다, 하는 경우 참조 테이블의 형태로 노드의 모든 차원 테이블의 복사본을 배포 하 여 쿼리 성능을 개선할 수 있습니다.

읽기를 [실시간 대시보드 자습서](./tutorial-design-database-hyperscale-realtime.md) 이 종류의 응용 프로그램을 구축 하는 예입니다.

### <a name="timeseries-data"></a>시계열 데이터

시계열 워크 로드를 응용 프로그램 이전 정보를 보관 하는 동안 최신 정보를 쿼리 합니다.

대규모의 시계열 정보 모델링에서 가장 일반적인 실수는 배포 열으로 자체 타임 스탬프를 사용 합니다. 시간을 기준으로 하는 해시 배포는 배포 시간 보이는 임의로 분할 된 데이터베이스에 시간 범위를 함께 유지 하는 것이 아니라 다른 분할 된 데이터베이스에 합니다. 시간 범위를 참조 하는 일반적으로 시간과 관련 된 쿼리 (예: 가장 최근의 데이터) 하므로 이러한 해시 분산 시키는 네트워크 오버 헤드입니다.

#### <a name="best-practices"></a>모범 사례

-   **배포 열으로 타임 스탬프를 선택 하지 마십시오.** 다른 배포 열을 선택 합니다. 다중 테 넌 트 앱에서 테 넌 트 ID를 사용 하거나 실시간으로 앱에서 엔터티 ID를 사용 합니다.
-   **PostgreSQL 테이블 분할 시간 대신 사용 합니다.** 여러 상속 된 테이블을 각각 다른 시간 범위를 포함 하는 대형 테이블의 데이터 시간 순서가 지정 침입을 테이블 분할을 사용 합니다.  Postgres 분할 된 테이블의 대규모 배포 상속된 된 테이블에 대 한 분할 된 데이터베이스를 만듭니다.

읽기를 [시계열 자습서](https://aka.ms/hyperscale-tutorial-timeseries) 이 종류의 응용 프로그램을 구축 하는 예입니다.

## <a name="next-steps"></a>다음 단계
- 에 대해 알아봅니다 어떻게 [공동](concepts-hyperscale-colocation.md) 간의 분산된 데이터 쿼리는 빠르게 실행 하는 데 도움이 됩니다
