---
title: Azure Database for PostgreSQL 유연한 서버에서 백업 및 복원
description: Azure Database for PostgreSQL 유연한 서버를 사용한 백업 및 복원의 개념에 대해 알아봅니다.
author: sr-msft
ms.author: srranga
ms.service: postgresql
ms.topic: conceptual
ms.date: 09/22/2020
ms.openlocfilehash: bed196d1be101ffa75affc389d390ec0fa764b05
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/22/2020
ms.locfileid: "90937052"
---
# <a name="backup-and-restore-in-azure-database-for-postgresql---flexible-server"></a>Azure Database for PostgreSQL 유연한 서버에서 백업 및 복원

> [!IMPORTANT]
> Azure Database for PostgreSQL - 유연한 서버는 미리 보기로 제공됨

백업은 비즈니스 연속성 전략의 필수적인 부분을 형성 합니다. 실수로 손상 또는 삭제 되지 않도록 데이터를 보호 하는 데 도움이 됩니다. Azure Database for PostgreSQL 유연한 서버는 자동으로 서버를 백업 하 고 최대 35 일 동안 백업을 유지 합니다. 복원 하는 동안 보존 기간 내에 복원 하려는 날짜 및 시간을 지정할 수 있습니다. 복원 및 복구 하는 전체 시간은 데이터베이스 파일의 크기 및 수행할 복구의 양에 따라 달라 집니다. 

### <a name="backup-process-in-flexible-server"></a>유연한 서버에서의 백업 프로세스
첫 번째 스냅샷 백업은 유동 서버를 만든 후 즉시 예약됩니다. 그런 다음 데이터 파일의 일별 스냅숏 백업이 수행 됩니다. 백업은 지역 내의 영역 중복 저장소에 저장 됩니다. 트랜잭션 로그 (미리 쓰기 로그-WAL)도 지속적으로 보관 되므로 마지막으로 커밋된 트랜잭션으로 복원할 수 있습니다. 이러한 데이터 및 로그 백업을 사용하면 서버를 구성된 백업 보존 기간 내의 특정 시점으로 복원할 수 있습니다. 모든 백업은 AES 256비트 암호화를 사용하여 암호화됩니다.

데이터베이스가 고가용성으로 구성 된 경우 매일 스냅숏은 주 복제본에서 수행 되 고 연속 로그 백업은 대기 상태에서 수행 됩니다.

> [!IMPORTANT]
>중지 된 서버에 대해서는 백업이 수행 되지 않습니다. 그러나 데이터베이스가 7 일 후에 자동으로 시작 되거나 사용자에 의해 시작 되 면 백업이 다시 시작 됩니다.

백업은 유연한 서버 내의 복원 작업에만 사용할 수 있습니다. 유연한 서버에 데이터를 내보내거나 가져오려면 [덤프 및 복원](https://docs.microsoft.com/azure/postgresql/howto-migrate-using-dump-and-restore)   방법을 사용 합니다.


### <a name="backup-retention"></a>백업 보존

백업은 서버의 백업 보존 기간 설정에 따라 보존 됩니다. 7 일에서 35 일 사이의 보존 기간을 선택할 수 있습니다. 기본 보존 기간은 7 일입니다. 서버를 만드는 동안 보존 기간을 설정 하거나 나중에 업데이트할 수 있습니다. 중지 된 서버에 대해서도 백업이 유지 됩니다.

백업 보존 기간은 \' 사용 가능한 백업을 기반으로 하므로 특정 시점 복원을 검색할 수 있는 시간을 제어 합니다. 백업 보존 기간은 복원 관점에서 복구 기간으로 처리 될 수도 있습니다. 백업 보존 기간 내에 지정 시간 복원을 수행 하는 데 필요한 모든 백업은 백업 저장소에 유지 됩니다. 예를 들어 백업 보존 기간이 7 일로 설정 된 경우 복구 기간은 최근 7 일로 간주 됩니다. 이 시나리오에서는 지난 7 일 동안 서버를 복원 및 복구 하는 데 필요한 모든 데이터 및 로그가 보존 됩니다. 


### <a name="backup-storage-cost"></a>백업 스토리지 비용

유연한 서버는 프로 비전 된 서버 저장소의 최대 100%를 추가 비용 없이 백업 저장소로 제공 합니다. 사용 되는 추가 백업 저장소는 매달 GB 단위로 요금이 청구 됩니다. 예를 들어 250 GiB의 저장소를 제공 하는 서버를 프로 비전 한 경우 추가 비용 없이 250 GiB의 백업 저장소 용량을 사용할 수 있습니다. 매일 백업 사용량이 25 GiB 면 최대 10 일간의 무료 백업 저장소를 사용할 수 있습니다. 250 GiB을 초과 하는 백업 저장소 소비는 [가격 책정 모델](https://azure.microsoft.com/pricing/details/postgresql/)에 따라 요금이 청구 됩니다.

Azure Portal에서 [백업 저장소 사용](https://docs.microsoft.com/azure/postgresql/concepts-monitoring)메트릭을 사용 하 여   서버에서 사용 하는 백업 저장소를 모니터링할 수 있습니다. 사용된 백업 스토리지 메트릭은 서버에 대해 설정된 백업 보존 기간에 따라 유지되는 모든 데이터베이스 백업 및 로그 백업에서 사용하는 스토리지의 합계를 나타냅니다.  서버에서 과도한 트랜잭션 작업을 수행하면 전체 데이터베이스 크기에 관계없이 백업 스토리지 사용량이 증가할 수 있습니다.

백업 저장소 비용을 제어 하는 기본적인 방법은 적절 한 백업 보존 기간을 설정 하 고 원하는 복구 목표를 충족 하는 올바른 백업 중복성 옵션을 선택 하는 것입니다.

> [!IMPORTANT]
> 지리적 중복 백업은 현재 유연한 서버에서 지원 되지 않습니다.

## <a name="point-in-time-restore-overview"></a>지정 시간 복원 개요

유연한 서버에서 특정 시점 복원을 수행 하면 \' 원본 서버와 동일한 지역에 있는 유연한 서버 백업에서 새 서버가 만들어집니다. 가격 책정 계층, 계산 세대, vCores 수, 저장소 크기, 백업 보존 기간 및 백업 중복성 옵션에 대 한 원본 서버의 구성을 사용 하 여 만들어집니다. 또한 VNET 및 방화벽 설정과 같은 태그와 설정은 원본 서버에서 상속됩니다. 

 > [!IMPORTANT]
> 영역 중복 고가용성으로 구성 된 유연한 서버를 복원 하는 경우 복원 된 서버는 고가용성을 사용 하지 않고 주 서버와 동일한 지역에 구성 됩니다. 

 ### <a name="restore-process"></a>복원 프로세스

물리적 데이터베이스 파일은 먼저 스냅숏 백업에서 서버의 데이터 위치로 복원 됩니다. 원하는 시점 보다 이전에 수행 된 적절 한 백업이 자동으로 선택 되 고 복원 됩니다. 그런 다음 데이터를 일관 된 상태로 만들기 위해 WAL 파일을 사용 하 여 복구 프로세스를 시작 합니다. 

 예를 들어 매일 밤 오후 11 시에 백업이 수행 된다고 가정 하겠습니다. 복원 지점이 2020 년 8 월 15 일에 대 한 경우 10:00 년 8 월 2020 14 일 매일 백업이 복원 됩니다. 데이터베이스는 8 월 24 일 오전 11 시에서 오전 10 시까지 트랜잭션 로그 백업을 사용 하 여 2020 년 8 월 25 일 오전 10 시까지 복구 됩니다. 

 데이터베이스 서버를 복원 하려면 [다음 단계](./how-to-restore-server-portal.md) 를 참조 하세요.

> [!IMPORTANT]
> 유연한 서버에서 복원 작업을 수행 하면 새 데이터베이스 서버가 만들어지고 기존 데이터베이스 서버는 덮어쓰지 않습니다.

특정 시점 복원은 여러 시나리오에서 유용합니다. 예를 들어 사용자가 실수로 데이터를 삭제하거나 중요한 테이블 또는 데이터베이스를 삭제하는 경우, 또는 애플리케이션의 결함으로 인해 우연히 적절한 데이터를 잘못된 데이터로 덮어쓰는 경우가 있습니다. 트랜잭션 로그의 연속 백업으로 인해 마지막 트랜잭션으로 복원할 수 있습니다.

가장 빠른 복원 지점과 사용자 지정 복원 지점 중에서 선택할 수 있습니다.

-   **가장 빠른 복원 지점**: 보존 기간에 따라 가장 이른 시간을 복원할 수 있습니다. 가장 오래 된 백업 시간은 자동으로 선택 되며 포털에 표시 됩니다. 이는 특정 시점을 시작 하는 일부 테스트를 조사 하거나 수행 하려는 경우에 유용 합니다.

-   **사용자 지정 복원 지점**:이 옵션을 사용 하면이 유연한 서버에 대해 정의 된 보존 기간 내의 특정 시점을 선택할 수 있습니다. 기본적으로 UTC의 최근 시간은 자동으로 선택 되며 테스트 목적으로 마지막으로 커밋된 트랜잭션으로 복원 하려는 경우에 유용 합니다. 필요에 따라 다른 날짜와 시간을 선택할 수 있습니다. 

복구에 소요 되는 예상 시간은 데이터베이스 크기, 처리할 트랜잭션 로그의 볼륨, 네트워크 대역폭 및 동일한 지역에서 동시에 복구 되는 총 데이터베이스 수를 비롯 한 여러 가지 요소에 따라 달라 집니다. 일반적으로 전체 복구 시간은 몇 분에서 몇 시간까지 소요 됩니다.


> [!IMPORTANT]
> 삭제 된 서버는 복원할 수 **없습니다**   . 서버를 삭제하면 해당 서버에 속한 모든 데이터베이스도 삭제되고 복구할 수 없습니다. 서버 리소스를 보호 하기 위해 실수로 삭제 하거나 예기치 않은 변경에서 배포 후에는 관리자가 [관리 잠금을](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-lock-resources)활용할 수 있습니다.

## <a name="perform-post-restore-tasks"></a>복원 후 작업 수행

데이터베이스를 복원한 후 다음 작업을 수행 하 여 사용자 및 응용 프로그램을 백업 하 고 실행할 수 있습니다.

-   새 서버에서 원래 서버를 교체 하려는 경우 클라이언트와 클라이언트 응용 프로그램을 새 서버로 리디렉션합니다.

-   사용자가 연결할 수 있도록 적절 한 서버 수준 방화벽 및 VNet 규칙이 준비 되어 있는지 확인 합니다. 이러한 규칙은 원래 서버에서 복사 되지 않습니다.
  
-   복원 된 서버의 계산을 필요에 따라 확장/축소할 수 있습니다.

-   적절 한 로그인 및 데이터베이스 수준 권한이 있는지 확인 합니다.

-   적절 한 경고를 구성 합니다.
  
-  고가용성으로 구성 된 데이터베이스를 복원 하 고 고가용성으로 복원 된 서버를 구성 하려는 경우 다음 [단계를](./how-to-manage-high-availability-portal.md)수행할 수 있습니다.


## <a name="next-steps"></a>다음 단계

-   [비즈니스 연속성](./concepts-business-continuity.md) 에 대 한 자세한 정보
-    [영역 중복 고가용성](./concepts-high-availability.md) 에 대해 알아보기
-   [복원 하는 방법](./how-to-restore-server-portal.md) 알아보기

