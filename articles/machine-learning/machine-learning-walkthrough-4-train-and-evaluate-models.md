<properties 
	pageTitle="4단계: 예측 분석 모델 학습 및 평가 | Azure" 
	description="솔루션 연습 4단계: Azure 기계 학습 스튜디오에서 여러 모델 교육, 채점 및 평가" 
	services="machine-learning" 
	documentationCenter="" 
	authors="garyericson" 
	manager="paulettm" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="01/29/2015" 
	ms.author="garye"/>

[Azure 기계 학습을 사용한 예측 솔루션 개발][develop] 자습서의 4번째 단계입니다.

[개발]: ../machine-learning-walkthrough-develop-predictive-solution/

1.	[기계 학습 작업 영역 만들기][create-workspace]
2.	[기존 데이터 업로드][upload-data]
3.	[새로운 실험 만들기][create-new]
4.	**모델 학습 및 평가**
5.	[웹 서비스 게시][publish]
6.	[웹 서비스 액세스][access-ws]

[create-workspace]: ../machine-learning-walkthrough-1-create-ml-workspace/
[upload-data]: ../machine-learning-walkthrough-2-upload-data/
[create-new]: ../machine-learning-walkthrough-3-create-new-experiment/
[train-models]: ../machine-learning-walkthrough-4-train-and-evaluate-models/
[publish]: ../machine-learning-walkthrough-5-publish-web-service/
[access-ws]: ../machine-learning-walkthrough-6-access-web-service/

----------

# 4단계: 예측 분석 모델 학습 및 평가


이 실험에서는 예측 모델에 대한 다양한 알고리즘을 시도하려고 합니다. 두 가지 모델을 만들고 모델의 점수 매기기 결과를 비교하여 최종 실험에서 사용할 알고리즘을 결정합니다.  

다양한 모델을 선택할 수 있습니다. 사용할 수 있는 모델을 보려면 모듈 팔레트에서 **기계 학습** 노드를 확장하고 **모델 초기화** 및 그 아래 노드를 확장합니다. 이 실험에서는 SVM(Support Vector Machine) 및 2클래스 향상된 의사 결정 트리를 선택합니다. 적절한 모듈을 사용하여 학습 알고리즘을 초기화하고 **모델 학습** 모듈을 사용하여 모델을 학습합니다.   

##모델 학습
먼저 향상된 의사 결정 트리 모델을 설정해 보겠습니다.  

1.	모듈 팔레트에서 **2클래스 향상된 의사 결정 트리** 모듈을 찾고 캔버스로 끌어서 놓습니다.
2.	**모델 학습** 모듈을 찾고 캔버스로 끌고 나서 향상된 의사 결정 트리 모듈의 출력을 **모델 학습** 모듈의 왼쪽 입력 포트("학습되지 않은 모델")에 연결합니다.
3.	**R 스크립트 실행** 모듈의 출력을 **모델 학습** 모듈의 오른쪽 입력 포트("데이터 집합")에 연결합니다.

	>팁 - 이 실험에서는 **R 스크립트 실행** 모듈에 대한 입력 중 두 개와 출력 중 하나가 필요하지 않으므로 연결되지 않은 상태로 유지합니다. 몇몇 모듈에서는 이 상태가 일반적입니다.


4.	**모델 학습** 모듈을 선택합니다. **속성** 창에서 **열 선택기 시작**을 클릭하고, 첫 번째 드롭다운에서 "포함"을 선택하고, 두 번째 드롭다운에서 "열 인덱스"를 선택하고, 텍스트 필드에 "21"을 입력합니다("열 이름"을 선택하고 "신용 위험"을 입력할 수도 있음). 이는 모델에서 예측할 열로서 열 21, 신용 위험 값을 나타냅니다.


실험의 이 부분은 이제 다음과 같이 표시됩니다.  

![Training a model][1]
 
다음으로 SVM 모델을 설정합니다.  

향상된 의사 결정 트리는 모든 기능 유형에서 제대로 작동합니다. 그러나 SVM 모듈은 선형 분류자를 생성하므로 여기서 생성하는 모델에는 모든 숫자 기능의 크기가 같을 때 최적의 테스트 오류가 포함됩니다. 모든 숫자 기능을 같은 크기로 변환하려면 **데이터 정규화** 모듈을 Tanh 변환과 함께 사용하여 기능을 [0,1] 범위로 변환합니다. 문자열 기능은 SVM 모듈을 통해 범주 기능으로 변환되고 나서 이진 0/1 기능으로 변환되므로 문자열 기능을 수동으로 변환할 필요가 없습니다. 또한 신용 위험 열(열 21)을 변환하지 않으려고 합니다. 이 열은 숫자 값이지만 모델을 학습하여 예측할 값이므로 단독으로 유지해야 합니다.  

1.	모듈 팔레트에서 **2클래스 Support Vector Machine** 모듈을 찾고 캔버스로 끌어서 놓습니다.
2.	**모델 학습** 모듈을 마우스 오른쪽 단추로 클릭하고 **복사**를 선택하고 나서 캔버스를 마우스 오른쪽 단추로 클릭하고 **붙여넣기**를 선택합니다. **모델 학습** 모듈의 복사본에는 원래 모듈과 같은 열이 선택되어 있습니다.
3.	SVM 모듈의 출력을 **모델 학습** 모듈의 왼쪽 입력 포트("학습되지 않은 모델")에 연결합니다.
4.	**데이터 정규화** 모듈을 찾고 캔버스로 끌어옵니다.
5.	이 변환 모듈의 입력을 왼쪽 **R 스크립트 실행** 모듈의 출력에 연결합니다.
6.	변환 모듈의 왼쪽 출력 포트("변환된 데이터 집합")를 **모델 학습** 모듈의 오른쪽 입력 포트("데이터 집합")에 연결합니다.
7.	변환 모듈에 대한 **속성** 창에서 **변환 메서드** 매개 변수에 대해 "Tanh"을 선택합니다.
8.	**열 선택기 시작**을 클릭하고, 첫 번째 드롭다운에서 "포함"을 선택하고, 두 번째 드롭다운에서 "열 유형"을 선택하고, 세 번째 드롭다운에서 "숫자"를 선택합니다. 이렇게 하면 모든 숫자 열(및 숫자열만)이 변환되도록 지정됩니다.
9.	더하기 기호(+)를 클릭하여 새 드롭다운 행을 만듭니다. 첫 번째 드롭다운에서 "제외"를 선택하고, 두 번째 드롭다운에서 "열 인덱스"를 선택하고, 텍스트 필드에 "21"을 입력합니다. 이렇게 하면 열 21("신용 위험" 열)을 무시하도록 지정됩니다.
10.	**확인**을 클릭합니다.  


이제 **데이터 정규화** 모듈은 신용 위험 열을 제외한 모든 숫자 열에서 Tanh 변환을 수행하도록 설정됩니다.  

실험의 이 부분은 이제 다음과 같이 표시됩니다.  

![Training the second model][2]  

##모델 점수 매기기 및 평가
**분할** 모듈을 통해 구분된 점수 매기기 데이터를 사용하여 학습된 모듈의 점수를 매깁니다. 그리고 나서 두 모델의 결과를 비교하여 더 나은 결과를 생성한 모듈을 확인할 수 있습니다.  

1.	**모델 점수 매기기** 모듈을 찾고 캔버스로 끌어옵니다.
2.	이 모듈의 왼쪽 입력 포트를 향상된 의사 결정 트리 모델에 연결합니다. 즉, **2클래스 향상된 의사 결정 트리** 모듈에 연결된 **모델 학습** 모듈의 출력 포트에 연결합니다.
3.	**모델 점수 매기기** 모듈의 오른쪽 입력 포트를 오른쪽 **R 스크립트 실행** 모듈의 출력에 연결합니다. 모듈 출력이 여러 위치로 이동하는 것은 정상적입니다.
4.	**모델 점수 매기기** 모듈을 복사하고 붙여넣어 두 번째 복사본을 만들거나 새 모듈을 캔버스로 끌어서 놓습니다.
5.	이 모듈의 왼쪽 입력 포트를 SVM 모델에 연결합니다. 즉, **2클래스 Support Vector Machine** 모듈에 연결된 **모델 학습** 모듈의 출력 포트에 연결합니다.
6.	SVM 모델에서는 학습 데이터에 대해 수행한 것과 같은 변환을 테스트 데이터에 대해 수행해야 합니다. 따라서 **데이터 정규화** 모듈을 복사하고 붙여넣고 두 번째 복사본을 만들고 오른쪽 **R 스크립트 실행** 모듈의 출력에 연결합니다.
7.	**모델 점수 매기기** 모듈의 오른쪽 입력 포트를 오른쪽 **데이터 정규화** 모듈의 출력에 연결합니다.  

점수 매기기 결과 두 개를 평가하려면 **모델 평가** 모듈을 사용합니다.  

1.	**모델 평가** 모듈을 찾고 캔버스로 끌어옵니다.
2.	왼쪽 입력 포트를 향상된 의사 결정 트리 모델과 연결된 **모델 점수 매기기** 모듈의 출력 포트에 연결합니다.
3.	오른쪽 입력 포트를 다른 **모델 점수 매기기** 모듈에 연결합니다.  

이제 실험이 다음과 같이 표시됩니다.  

![Evaluating both models][3]
 
캔버스 아래에서 **실행** 단추를 클릭하여 실험을 실행합니다. 몇 분이 걸릴 수 있습니다. 각 모듈에 실행 중임을 나타내는 회전 표시기가 표시되고 나서 모듈이 완료되면 녹색 확인 표시가 표시됩니다.   

모든 모듈에 확인 표시가 있으면 실험 실행이 완료된 것입니다. 결과를 확인하려면 **모델 평가** 모듈의 출력 포트를 마우스 오른쪽 단추로 클릭하고 **시각화**를 선택합니다.  

**모델 평가** 모듈에서는 점수를 매긴 모델 두 개의 결과를 비교할 수 있는 곡선 및 메트릭 쌍을 생성합니다. 결과를 ROC(Receiver Operator Characteristic) 곡선, 정밀도/리콜 곡선 또는 리프트 곡선으로 볼 수 있습니다. 표시된 추가 데이터에는 혼동 행렬, 누적 AUC 값 및 기타 메트릭이 포함됩니다. 슬라이더를 왼쪽이나 오른쪽으로 이동하여 임계값을 변경하고 메트릭 집합에 어떤 영향을 미치는 확인할 수 있습니다.  

"점수를 매긴 데이터 집합" 또는 "비교할 점수를 매긴 데이터 집합"을 클릭하여 관련 곡선을 강조 표시하고 아래에 관련 메트릭을 표시합니다. 곡선 범례에서 "점수를 매긴 데이터 집합"은 **모델 평가** 모듈의 왼쪽 입력 포트(이 경우 향상된 의사 결정 트리 모델)에 해당합니다. "비교할 점수를 매긴 데이터 집합"은 오른쪽 입력 포트(이 경우 SVM 모델)에 해당합니다. 이러한 레이블의 하나를 클릭하면 해당 모델의 곡선이 강조 표시되고 아래에 해당 메트릭이 표시됩니다.  

![ROC curves for models][4]
 
이러한 값을 검토하여 찾고 있는 결과를 제공하는 것에 가장 가까운 모델을 결정할 수 있습니다. 돌아가서 다른 모델에서 값을 변경하여 실험을 반복할 수 있습니다.  

>팁 - 실험을 실행할 때마다 해당 반복에 대한 레코드가 실행 기록에서 유지됩니다. 이러한 반복을 확인하고 캔버스 아래에서 **실행 기록 보기**를 클릭하여 원하는 반복으로 돌아갈 수 있습니다. **속성** 창에서 **이전 실행**을 클릭하여 열었던 반복의 바로 이전 반복으로 돌아갈 수도 있습니다.  

캔버스 아래에서 **다른 이름으로 저장**을 클릭하여 실험에 대한 반복의 복사본을 만들 수도 있습니다. 이를 통해 새 실행 기록을 만들어 이 버전의 반복을 추적하는 실험 복제본을 만듭니다. 새 복사본은 **실험** 목록에 원본과 함께 표시됩니다. 실험 반복의 새 분기를 시작하려면 이 방법이 유용할 수 있습니다.  

모듈 매개 변수에 대한 변경을 추적하기 위한 다른 방법으로 실험 캔버스에서 모듈에 주석을 추가할 수도 있습니다. 모듈을 두 번 클릭하거나 마우스 오른쪽 단추를 클릭하고 **메모 편집**을 선택합니다. 이러한 주석은 실험 반복과 함께 저장되고 작업에 주석을 지정하는 데 도움이 될 수 있습니다.


----------

**다음: [웹 서비스 게시][publish]**

[1]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train1.png
[2]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train2.png
[3]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train3.png
[4]: ./media/machine-learning-walkthrough-4-train-and-evaluate-models/train4.png

<!--HONumber=46--> 
 