<properties 
	pageTitle="5단계: 기계 학습 웹 서비스 게시 | Azure" 
	description="솔루션 연습 5단계: Azure 기계 학습 스튜디오에서 채점 실험을 Azure 기계 학습 웹 서비스로 게시" 
	services="machine-learning" 
	documentationCenter="" 
	authors="garyericson" 
	manager="paulettm" 
	editor="cgronlun"/>

<tags 
	ms.service="machine-learning" 
	ms.workload="data-services" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="01/29/2015" 
	ms.author="garye"/>


[Azure 기계 학습을 사용한 예측 솔루션 개발][develop] 자습서의 5번째 단계입니다.

[develop]: ../machine-learning-walkthrough-develop-predictive-solution/


1.	[작업 영역 만들기][create-workspace]
2.	[데이터 업로드][upload-data]
3.	[새로운 실험 만들기][create-new]
4.	[모델 학습 및 평가][train-models]
5.	**웹 서비스 게시**
6.	[Access the web service][access-ws]

[create-workspace]: ../machine-learning-walkthrough-1-create-ml-workspace/
[upload-data]: ../machine-learning-walkthrough-2-upload-data/
[create-new]: ../machine-learning-walkthrough-3-create-new-experiment/
[train-models]: ../machine-learning-walkthrough-4-train-and-evaluate-models/
[publish]: ../machine-learning-walkthrough-5-publish-web-service/
[access-ws]: ../machine-learning-walkthrough-6-access-web-service/

----------

# 5단계: Azure 기계 학습 웹 서비스 게시

이 예측 모델을 다른 사용자가 사용할 수 있도록 Azure에 웹 서비스로 게시합니다. 사용자는 신용 확인 데이터 집합을 서비스에 보낼 수 있고 서비스에서는 신용 위험 예측을 반환합니다.

이 작업을 하려면 다음이 필요합니다.  

-	게시할 준비가 되도록 실험을 준비합니다.
-	실험을 테스트할 수 있는 스테이징 서버에 게시합니다.
-	준비가 되었다고 판단되면 라이브 서버로 실험 수준을 올립니다.  

계속 진행하기 전에 편집할 이 실험의 복사본을 만들어야 합니다. 이렇게 하면 모델에 대해 추가 작업을 해야 할 때 언제든지 학습 실험으로 돌아갈 수 있습니다.  

1.	캔버스 아래의 **다른 이름으로 저장**을 클릭합니다.
2.	실험 복사본에 도움이 되는 이름을 지정합니다. 기본값은 원래 실험 이름에 "- Copy"를 추가하는 것입니다. 이 경우 이름을 "신용 위험 예측 - 점수 매기기 실험"으로 지정합니다.
3.	**확인**을 클릭합니다.  


이제 기계 학습 스튜디오의 실험 목록에 원래 실험과 복사본이 둘 다 나열됩니다.  

![Experiments list][1]
 
##점수 매기기 실험 준비
모델을 웹 서비스로 게시할 준비를 하려면 두 가지 작업을 해야 합니다.  

먼저 실험을 *학습 실험*에서 *점수 매기기 실험*으로 변환해야 합니다. 이때까지는 모델을 학습하는 실험을 진행했습니다. 하지만 게시된 서비스는 더 이상 학습을 수행하지 않고 사용자 입력에 점수를 매깁니다. 따라서 학습했던 모델의 복사본을 저장하고 학습에만 사용된 실험의 모든 구성 요소를 제거합니다.  

다음으로 Azure 기계 학습 웹 서비스에서 사용자의 입력이 허용되고 결과가 표시되므로, 실험에서 해당 입력 및 출력 지점을 확인해야 합니다.  

###학습 실험에서 점수 매기기 실험으로 변환
향상된 트리 모델을 사용할 더 효율적인 모델로 결정했다고 가정합니다. 이에 따라 먼저 SVM 학습 모듈을 제거합니다.  

1.	**2클래스 Support Vector Machine**을 삭제합니다.
2.	연결된 **모델 학습** 및 모**델 점수 매기기** 모듈을 삭제합니다.
3.	**크기 조정으로 데이터 변환** 모듈을 삭제합니다.  

이제 학습한 향상된 모델을 저장합니다. 그리고 나서 학습에 사용한 실험의 나머지 모듈을 제거하고 학습된 모델로 바꿉니다.  

1.	나머지 **모델 학습** 모듈의 출력 포트를 마우스 오른쪽 단추로 클릭하고 **학습된 모델로 저장**을 선택합니다.
2.	학습된 모델에 대한 이름과 설명을 입력합니다. 이 예제에서는 이름을 "신용 위험 예측"으로 지정합니다.

	>**참고**: 이 학습된 모델을 저장하고 나면 모델이 모듈 팔레트에 나타나고 다른 실험에서 사용할 수 있습니다.

3.	**검색** 상자에 "신용 위험"을 입력하여 모듈 팔레트에서 이 모델을 찾고 **신용 위험 예측** 학습된 모델을 실험 캔버스로 끕니다.
4.	**2클래스 향상된 의사 결정 트리** 및 **모델 학습** 모듈을 삭제합니다.
5.	**신용 위험 예측** 모델의 출력을 **모델 점수 매기기** 모듈의 왼쪽 입력에 연결합니다.   

이제 실험에는 원래 학습 모듈 대신에 저장된 학습된 모델 버전이 있습니다.  

실험에는 학습 및 두 개의 모델 알고리즘 평가를 위해서만 추가한 다른 구성 요소가 있습니다. 이러한 구성 요소도 제거할 수 있습니다.  

-	**분할**
-	**R 스크립트 실행** 모듈 둘 다
-	**모델 평가**  

다음 한 가지 항목이 더 있습니다. 원래 신용 카드 데이터에는 신용 위험 열이 포함되었습니다. 모델을 학습하여 해당 값을 예측할 수 있도록 이 열을 **모델 학습** 모듈로 전달했습니다. 하지만 이제 모델이 학습되었으므로 해당 열을 계속 전달할 필요가 없습니다. 학습된 모델이 해당 값을 예측할 것입니다. 데이터 흐름에서 해당 열을 제거하려면 **프로젝트 열** 모듈을 사용합니다.  

1.	**프로젝트 열** 모듈을 찾아 캔버스로 끌어서 놓습니다.
2.	이 모듈을 **메타데이터 편집기** 모듈의 출력에 연결합니다(**분할** 및 **R 스크립트 실행** 모듈이 제거되었으므로).
3.	**프로젝트 열** 모듈을 선택하고 **열 선택기 시작**을 클릭합니다.
4.	드롭다운에서 "모든 열"을 그대로 유지합니다.
5.	더하기 기호(+)를 클릭하여 새 드롭다운 행을 만듭니다.
6.	이 새 드롭다운에서 "열 이름 제외"를 선택하고 텍스트 필드에 "신용 위험"을 입력합니다(열 번호 21로 열을 지정할 수도 있음).
7.	**확인**을 클릭합니다.

	>팁 - 열 선택기는 드롭다운이 나타나는 시퀀스에서 드롭다운 논리를 따릅니다. 이 경우 **프로젝트 열** 모듈이 "'신용 위험' 열을 제외한 모든 열을 통과"하도록 지시했습니다. 첫 번째 드롭다운을 유지한 경우에는 모듈이 열을 전달하지 않습니다.

8.	**프로젝트 열** 모듈의 출력을 **모델 점수 매기기** 모듈의 오른쪽 입력에 연결합니다.  

이제 실험은 다음과 같이 표시됩니다.  

![Scoring the trained model][2]  

###서비스 입력 및 출력 선택
원래 모델에서 점수를 매길 데이터가 **모델 점수 매기기** 모듈의 오른쪽 입력 포트("데이터 집합")로 전달되었고 두 번째 결과가 출력 포트("점수를 매긴 데이터 집합")에 나타났습니다. 서비스가 실행 중일 때 사용자 데이터와 결과에서 이러한 같은 포트를 사용하려고 합니다.  

1.	**모델 점수 매기기** 모듈의 오른쪽 입력 포트를 마우스 오른쪽 단추로 클릭하고 **게시 입력으로 설정**을 선택합니다. 사용자 데이터에는 기능 벡터의 모든 데이터를 포함해야 합니다.

	>**팁** - 점수 매기기 모듈에 전달하기 전에 사용자 데이터의 조작을 수행해야 하면(예: **크기 조정으로 데이터 변환** 모듈을 사용하여 SVM 모델에 대한 데이터 준비한 방법) 웹 서비스에서 모듈을 남겨 두고 서비스 입력을 해당 모듈의 입력 포트로 설정합니다.

2.	출력 포트를 마우스 오른쪽 단추로 클릭하고 **게시 출력으로 설정**을 선택합니다. 서비스에서 모델 점수 매기기 모듈의 출력이 반환됩니다. 여기에는 기능 벡터와 신용 위험 예측 및 점수 매기기 확률 값이 포함됩니다.

	>**팁** - 웹 서비스에서 이 데이터의 일부만 반환하려면, 예를 들어 전체 기능 벡터를 반환하지 않으려면 **모델 점수 매기기** 모듈 뒤에 **프로젝트 열** 모듈을 추가하고 원하지 않는 열을 실행하도록 구성하고 나서 **프로젝트 열** 모듈의 출력을 웹 서비스 출력으로 설정할 수 있습니다.  
  

>**참고** - UCI 독일 신용 카드 데이터 데이터 집합과 관련 모듈을 **모델 점수 매기기** 모듈에 연결된 상태로 두는 이유를 궁금해 할 수 있습니다. 서비스에서는 원래 데이터 집합이 아니라 사용자 데이터를 사용하려고 하는데 연결된 상태로 두는 이유는 무엇인가요?

서비스에 원래 신용 카드 데이터가 필요하지 않은 것은 사실입니다. 하지만 열 수 및 숫자인 열 같은 정보가 포함된 해당 데이터에 대한 스키마는 필요하지 않습니다. 이 스키마 정보는 사용자 데이터를 해석하기 위해 필요합니다. 서비스가 실행 중일 때 점수 매기기 모듈에 데이터 집합 스키마가 포함되도록 이러한 구성 요소를 연결된 상태로 유지합니다. 데이터는 사용되지 않고 스키마만 사용됩니다.  

마지막으로 실험을 한 번 실행합니다(**실행** 클릭). 모델이 작동 중인지 확인하려면 **모델 점수 매기기** 모듈의 출력을 마우스 오른쪽 단추로 클릭하고 **시각화**를 선택합니다. 원래 데이터가 신용 위험 값("점수를 매긴 레이블") 및 점수 매기기 확률 값("점수를 매긴 확률")과 함께 표시됩니다.  

##웹 서비스 게시
실험에서 파생된 웹 서비스를 게시하려면 캔버스 아래에서 **웹 서비스 게시**를 클릭하고 메시지가 표시되면 **예**를 클릭합니다. 기계 학습 스튜디오에서 실험을 기계 학습 스테이징 서버에 웹 서비스로 게시하고 서비스 대시보드로 이동됩니다.   

>**팁** - 웹 서비스를 게시하고 나서 업데이트할 수 있습니다. 예를 들어 모델을 변경하려면 이전에 저장한 학습 실험을 편집하고 모델 매개 변수를 약간 수정하고 학습된 모델을 저장합니다(이전에 저장한 모델 덮어쓰기). 점수 매기기 실험을 다시 열면 학습된 모델이 될 항목이 변경되었음을 알리는 알림이 표시되고 실험을 업데이트할 수 있습니다. 실험을 다시 게시하면 이 실험이 웹 서비스를 대체하고 이제 업데이트된 모델을 사용합니다.  

**구성** 탭을 클릭하여 서비스를 구성할 수 있습니다. 여기서 서비스 이름(기본적으로 실험 이름이 지정됨)을 수정하고 설명을 제공할 수 있습니다. 입력 및 출력 열에 대해 더 친숙한 레이블을 제공할 수도 있습니다.  

**프로덕션 준비 완료?** 스위치는 뒷부분에서 처리합니다.  

##웹 서비스 테스트
**대시보드** 페이지에서 **스테이징 서비스** 아래의 **테스트** 링크를 클릭합니다. 서비스에 대한 입력 데이터를 요청하는 대화 상자가 나타납니다. 이는 원래 독일 신용 위험 데이터 집합에 나타난 열과 같습니다.  

데이터 집합을 입력하고 **확인**을 클릭합니다.  

웹 서비스에서 생성된 결과가 대시보드 아래쪽에 표시됩니다. 서비스를 구성한 대로 표시된 결과는 점수 매기기 모듈에서 생성됩니다.   

##라이브 서버로 웹 서비스 수준 올리기
지금까지 서비스는 기계 학습 스테이징 서버에서 실행 중이었습니다. 배포할 준비가 되면 라이브 서버로 수준을 올리도록 요청할 수 있습니다.  

**구성** 탭에서 **프로덕션 준비 완료?** 옆에 있는 "예"를 클릭합니다. 그러면 IT 관리자에게 이 웹 서비스를 배포할 준비가 되었음을 알리는 알림이 전송됩니다. 관리자가 라이브 서버로 수준을 올릴 수 있습니다.

![Promoting the service to the live environment][4]  

----------

**다음: [Access the web service][access-ws]**

[1]: ./media/machine-learning-walkthrough-5-publish-web-service/publish1.png
[2]: ./media/machine-learning-walkthrough-5-publish-web-service/publish2.png
[4]: ./media/machine-learning-walkthrough-5-publish-web-service/publish3.png

<!--HONumber=46--> 
 