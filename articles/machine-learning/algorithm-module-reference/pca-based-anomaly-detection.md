---
title: 'PCA 기반 변칙 검색: 모듈 참조'
titleSuffix: Azure Machine Learning
description: PCA 기반 변칙 검색 모듈을 사용 하 여 PCA (주 구성 요소 분석)를 기반으로 변칙 검색 모델을 만드는 방법에 대해 알아봅니다.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 02/22/2020
ms.openlocfilehash: 0672b9769feae65c73a6f752a268968a7bad9e4b
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/28/2020
ms.locfileid: "79502985"
---
# <a name="pca-based-anomaly-detection"></a>PCA 기반 변칙 검색

이 문서에서는 Azure Machine Learning designer (미리 보기)에서 **Pca 기반 변칙 검색** 모듈을 사용 하 여 Pca (주 구성 요소 분석)를 기반으로 변칙 검색 모델을 만드는 방법을 설명 합니다.

이 모듈을 사용 하면 유효한 트랜잭션과 같은 한 클래스에서 학습 데이터를 쉽게 가져올 수 있지만 대상 변칙의 충분 한 샘플을 얻는 것이 어려운 시나리오에서 모델을 빌드할 수 있습니다. 

예를 들어 사기성 트랜잭션을 검색 하기 위해 학습을 위한 충분 한 사기 예가 많지 않지만 좋은 트랜잭션의 예는 많이 있습니다. **PCA 기반 변칙 검색** 모듈은 사용 가능한 기능을 분석 하 여 "일반" 클래스를 구성 하는 항목을 확인 하 고, 시외 메트릭을 나타내는 사례를 식별 하는 거리 메트릭을 적용 하 여 문제를 해결 합니다. 이렇게 하면 기존 불균형 데이터를 사용 하 여 모델을 학습 시킬 수 있습니다.

## <a name="more-about-principal-component-analysis"></a>PCA(Principal Component Analysis)에 대한 자세한 내용

주로 PCA로 축약 되는 *주 구성 요소 분석*은 기계 학습에 설정 된 기술입니다. PCA는 데이터의 내부 구조를 공개하고 데이터의 변화를 설명하므로 예비 데이터 분석에서 자주 사용됩니다.

PCA는 여러 변수를 포함하는 데이터를 분석하여 작동합니다. 변수 간의 상관 관계를 찾고 결과에서 차이점을 가장 잘 캡처하는 값의 조합을 확인합니다. 이러한 결합 된 기능 값을 사용 하 여 *주요 구성 요소*라는 보다 간결한 기능 공간을 만들 수 있습니다.

변칙 검색의 경우 각 새 입력이 분석 되 고 변칙 검색 알고리즘은 정규화 된 재구성 오류와 함께 고유 벡터의 프로젝션을 계산 합니다. 정규화 된 오류는 변칙 성과로 사용 됩니다. 오류가 높을수록 인스턴스가 더 이상한 것입니다.

PCA 작동 방식에 대 한 자세한 내용과 변칙 검색의 구현에 대 한 자세한 내용은 다음 백서를 참조 하세요.

- [주 구성 요소 분석을 위한 임의 알고리즘](https://arxiv.org/abs/0809.2274)입니다. Rokhlin, Szlan 및 Tygert

- [임의성을 사용 하 여 구조 찾기: 확률 알고리즘을 사용 하 여 대략적인 행렬 Decompositions](http://users.cms.caltech.edu/~jtropp/papers/HMT11-Finding-Structure-SIREV.pdf) (PDF 다운로드)를 생성 합니다. Halko, Martinsson 및 Tropp입니다.

## <a name="how-to-configure-pca-anomaly-detection"></a>PCA 변칙 검색을 구성 하는 방법

1. 디자이너에서 사용자의 파이프라인에 **PCA 기반 변칙 검색** 모듈을 추가 합니다. **변칙 검색** 범주에서이 모듈을 찾을 수 있습니다.

2. **PCA 기반 변칙 검색** 모듈의 오른쪽 패널에서 **학습 모드** 옵션을 클릭 하 고, 특정 매개 변수 집합을 사용 하 여 모델을 학습 시킬 것인지 아니면 매개 변수 비우기를 사용 하 여 최상의 매개 변수를 찾을 지를 나타냅니다.

    - **단일 매개 변수**: 모델을 구성 하는 방법을 알고 있으며 특정 값 집합을 인수로 제공 하는 경우이 옵션을 선택 합니다.

3. **PCA에서 사용할 구성 요소 수**: 출력 하려는 출력 기능 또는 구성 요소 수를 지정 합니다.

    포함할 구성 요소 수를 결정 하는 것은 PCA를 사용 하는 실험 디자인의 중요 한 부분입니다. 일반적인 지침은 변수와 동일한 수의 PCA 구성 요소를 포함 하면 안 됩니다. 대신 몇 가지 구성 요소를 사용 하 여 시작 하 고 일부 조건이 충족 될 때까지 늘려야 합니다.

    최상의 결과는 출력 구성 요소 수가 데이터 집합에서 사용할 수 있는 기능 열 **수보다 적을** 때 얻을 수 있습니다.

4. 임의 PCA 학습 중에 수행할 과다 샘플링의 양을 지정 합니다. 변칙 검색 문제에서 불균형 데이터를 사용 하면 표준 PCA 기술을 적용 하기가 어려워집니다. 과다 샘플링를 지정 하 여 대상 인스턴스 수를 늘릴 수 있습니다.

    1을 지정 하면 과다 샘플링가 수행 되지 않습니다. 1 보다 큰 값을 지정 하면 모델을 학습 하는 데 사용 하는 샘플이 추가로 생성 됩니다.

    매개 변수 비우기를 사용 하는지 여부에 따라 다음과 같은 두 가지 옵션이 있습니다.

    - **임의 PCA에 대 한 과다 샘플링 매개 변수**: 일반 클래스에서의 소주주 클래스 과다 샘플링 비율을 나타내는 단일 정수를 입력 합니다. **단일 매개 변수** 학습 방법을 사용 하는 경우 사용할 수 있습니다.

    > [!NOTE]
    > Oversampled 데이터 집합은 볼 수 없습니다. 과다 샘플링를 PCA와 함께 사용 하는 방법에 대 한 자세한 내용은 [기술 참고 사항](#technical-notes)을 참조 하세요.

5. **입력 기능 평균 정규화 사용**: 모든 입력 기능을 평균 0으로 정규화 하려면이 옵션을 선택 합니다. PCA의 목표는 변수 간의 차이를 최대화 하기 때문에, 정규화 또는 0으로의 크기 조정은 일반적으로 PCA에 권장 됩니다.

     이 옵션은 기본적으로 선택됩니다. 다른 방법이 나 소수 자릿수를 사용 하 여 값이 이미 정규화 된 경우이 옵션의 선택을 취소 합니다.

6. 태그가 지정 된 학습 데이터 집합 및 학습 모듈 중 하나를 연결 합니다.

    - **강사 모드 만들기** 옵션을 **단일 매개 변수로**설정한 경우 [변칙 검색 모델 학습](train-anomaly-detection-model.md) 모듈을 사용 합니다.

7. 파이프라인을 제출 합니다.

## <a name="results"></a>결과

학습을 완료 하면 학습 된 모델을 저장 하거나 [모델 점수 매기기](score-model.md) 모듈에 연결 하 여 변칙 점수를 예측할 수 있습니다.

변칙 검색 모델의 결과를 평가 하려면 몇 가지 추가 단계가 필요 합니다.

1. 두 데이터 집합에서 점수 열을 사용할 수 있는지 확인

    변칙 검색 모델을 평가 하려고 시도 하 고 "비교할 점수가 매겨진 데이터 집합에 점수 열이 없습니다" 라는 오류 메시지가 표시 되 면 레이블 열을 포함 하지만 확률 점수가 없는 일반적인 계산 데이터 집합을 사용 하는 것입니다. **점수가 매겨진 레이블** 및 **점수가 매겨진 확률** 열을 포함 하는 변칙 검색 모델의 스키마 출력과 일치 하는 데이터 집합을 선택 해야 합니다.

2. 레이블 열이로 표시 되어 있는지 확인 합니다.

    경우에 따라 레이블 열과 연결 된 메타 데이터가 파이프라인 그래프에서 제거 됩니다. 이 경우 [모델 평가](evaluate-model.md) 모듈을 사용 하 여 두 변칙 검색 모델의 결과를 비교할 때 "점수가 매겨진 데이터 집합에 레이블 열이 없습니다." 또는 "비교할 점수가 매겨진 데이터 집합에 레이블 열이 없습니다" 라는 오류가 나타날 수 있습니다.

    [모델 평가](evaluate-model.md) 모듈 전에 [메타 데이터 편집](edit-metadata.md) 모듈을 추가 하 여이 오류를 방지할 수 있습니다. 열 선택기를 사용 하 여 클래스 열을 선택 하 고 **필드** 드롭다운 목록에서 **레이블**을 선택 합니다.

3. [Python 스크립트 실행](execute-python-script.md) 을 사용 하 여 레이블 열 범주를 1 (긍정, 보통) 및 0 (음수, 비정상)으로 조정 합니다.

    ````
    label_column_name = 'XXX'
    anomaly_label_category = YY
    dataframe1[label_column_name] = dataframe1[label_column_name].apply(lambda x: 0 if x == anomaly_label_category else 1)
    ````

    
## <a name="technical-notes"></a>기술 정보

이 알고리즘은 PCA를 사용 하 여 일반 클래스를 포함 하는 하위 공간을 대략적으로 사용 합니다. 하위 공간은 데이터 공분산 행렬의 최고 고유 값와 연결 된 고유 벡터에 의해 확장 됩니다. 각 새 입력에 대해 변칙 탐지기는 먼저 고유 벡터의 프로젝션을 계산한 다음 정규화 된 재구성 오류를 계산 합니다. 이 오류는 변칙 점수입니다. 오류가 높을수록 인스턴스가 더 비정상입니다. 일반 공간을 계산 하는 방법에 대 한 자세한 내용은 위키백과: [주요 구성 요소 분석](https://wikipedia.org/wiki/Principal_component_analysis) 을 참조 하세요. 


## <a name="next-steps"></a>다음 단계

Azure Machine Learning [사용할 수 있는 모듈 집합](module-reference.md) 을 참조 하세요. 

디자이너 모듈에 특정 한 오류 목록은 [디자이너 (미리 보기)에 대 한 예외 및 오류 코드](designer-error-codes.md) 를 참조 하세요. ' '