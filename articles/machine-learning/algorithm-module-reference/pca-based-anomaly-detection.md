---
title: 'PCA 기반 변칙 감지: 모듈 참조'
titleSuffix: Azure Machine Learning
description: PCA 기반 변칙 검색 모듈을 사용하여 PCA(주 성분 분석)를 기반으로 변칙 검색 모델을 만드는 방법을 알아봅니다.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 02/22/2020
ms.openlocfilehash: 0672b9769feae65c73a6f752a268968a7bad9e4b
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/28/2020
ms.locfileid: "79502985"
---
# <a name="pca-based-anomaly-detection"></a>PCA 기반 비정상 검색

이 문서에서는 Azure 기계 학습 디자이너(미리 보기)에서 **PCA 기반 변칙 검색** 모듈을 사용하여 PCA(주성분 분석)를 기반으로 변칙 검색 모델을 만드는 방법을 설명합니다.

이 모듈에서는 유효한 트랜잭션과 같은 한 클래스에서 학습 데이터를 쉽게 얻을 수 있지만 대상 이상에 대한 충분한 샘플을 얻기어려운 시나리오에서 모델을 빌드하는 데 도움이 됩니다. 

예를 들어, 사기 거래를 탐지하기 위해, 당신은 매우 자주 에 훈련 사기의 충분한 예가 없는, 하지만 좋은 거래의 많은 예가. **PCA 기반 변칙 검색** 모듈은 사용 가능한 기능을 분석하여 "일반" 클래스를 구성하는 항목을 결정하고 거리 메트릭을 적용하여 이상 징후를 나타내는 사례를 식별하여 문제를 해결합니다. 이렇게 하면 기존 불균형 데이터를 사용하여 모델을 학습할 수 있습니다.

## <a name="more-about-principal-component-analysis"></a>PCA(Principal Component Analysis)에 대한 자세한 내용

PCA로 자주 축약되는 *주 성분 분석은*기계 학습에서 확립된 기술입니다. PCA는 데이터의 내부 구조를 공개하고 데이터의 변화를 설명하므로 예비 데이터 분석에서 자주 사용됩니다.

PCA는 여러 변수를 포함하는 데이터를 분석하여 작동합니다. 변수 간의 상관 관계를 찾고 결과에서 차이점을 가장 잘 캡처하는 값의 조합을 확인합니다. 이러한 결합된 피쳐 값은 *주 구성요소라는*보다 컴팩트한 피쳐 공간을 만드는 데 사용됩니다.

변칙 검색의 경우 각 새 입력을 분석하고 변칙 검색 알고리즘은 정규화된 재구성 오류와 함께 고유 벡터에 대한 프로젝션을 계산합니다. 정규화된 오류는 변칙 점수로 사용됩니다. 오류가 높을수록 인스턴스가 더 이상한 것입니다.

PCA 작동 방식 및 변칙 검색을 위한 구현에 대한 자세한 내용은 다음 을 참조하십시오.

- [주 성분 분석을 위한 무작위 알고리즘.](https://arxiv.org/abs/0809.2274) 로크린, 스즐란, 타이거트

- [임의성을 가진 구조 찾기: 대략적인 매트릭스 분해(PDF 다운로드)를 생성하기 위한 확률적 알고리즘.](http://users.cms.caltech.edu/~jtropp/papers/HMT11-Finding-Structure-SIREV.pdf) 할코, 마틴슨, 트롭.

## <a name="how-to-configure-pca-anomaly-detection"></a>PCA 변칙 검색을 구성하는 방법

1. 디자이너의 파이프라인에 **PCA 기반 변칙 검색** 모듈을 추가합니다. 이 모듈은 **변칙 검색** 범주에서 찾을 수 있습니다.

2. **PCA 기반 변칙 감지** 모듈의 오른쪽 패널에서 **학습 모드** 옵션을 클릭하고 특정 매개변수 집합을 사용하여 모델을 학습할지 또는 매개 변수 스윕을 사용하여 최적의 매개 변수를 찾을지 여부를 나타냅니다.

    - **단일 매개 변수**: 모델을 구성하는 방법을 알고 있는 경우 이 옵션을 선택하고 특정 값 집합을 인수로 제공합니다.

3. **PCA에서 사용할 구성 요소 수**: 출력할 출력 피쳐 또는 구성 요소 수를 지정합니다.

    포함할 구성 요소 수를 결정하는 것은 PCA를 사용하는 실험 설계의 중요한 부분입니다. 일반적인 지침은 변수가 있는 것과 동일한 수의 PCA 구성 요소를 포함해서는 안 됩니다. 대신 몇 가지 수의 구성 요소로 시작하여 일부 기준이 충족될 때까지 구성 요소를 늘려야 합니다.

    최상의 결과는 출력 구성 요소 수가 데이터 집합에서 사용할 수 있는 피쳐 열 **수보다 적을** 때 얻을 수 있습니다.

4. 무작위 PCA 교육 중에 수행할 오버샘플링 양을 지정합니다. 변칙 검색 문제에서는 불균형한 데이터를 사용하여 표준 PCA 기술을 적용하기가 어렵습니다. 일부 오버샘플링 양을 지정하여 대상 인스턴스 수를 늘릴 수 있습니다.

    1을 지정하면 오버샘플링이 수행되지 않습니다. 값을 1보다 높게 지정하면 모델을 학습하는 데 사용할 추가 샘플이 생성됩니다.

    매개 변수 스윕을 사용하는지 여부에 따라 두 가지 옵션이 있습니다.

    - **무작위 PCA에 대한 오버샘플링 매개변수**: 일반 클래스에 대한 소수 민족 클래스의 오버샘플링 비율을 나타내는 단일 정수를 입력합니다. (단일 매개 **변수** 학습 방법을 사용할 때 사용할 수 있습니다.)

    > [!NOTE]
    > 오버샘플링된 데이터 집합은 볼 수 없습니다. PCA에서 오버샘플링을 사용하는 방법에 대한 자세한 내용은 [기술 노트를](#technical-notes)참조하십시오.

5. **입력 피쳐 평균 정규화 사용**: 이 옵션을 선택하여 모든 입력 피쳐를 0의 평균으로 정규화합니다. PCA의 목표는 변수 간의 분산을 최대화하는 것이기 때문에 일반적으로 PCA에 정규화 또는 크기 조정을 사용하는 것이 좋습니다.

     이 옵션은 기본적으로 선택되어 있습니다. 다른 메서드 또는 축척을 사용하여 값이 이미 정규화된 경우 이 옵션을 선택 해제합니다.

6. 태그가 지정된 학습 데이터 집합과 교육 모듈 중 하나를 연결합니다.

    - 트레이너 만들기 **모드** 만들기 옵션을 **단일 매개 변수로**설정한 경우 [학습 변칙 감지 모델](train-anomaly-detection-model.md) 모듈을 사용합니다.

7. 파이프라인을 제출합니다.

## <a name="results"></a>결과

교육이 완료되면 학습된 모델을 저장하거나 [모델 점수 매기기](score-model.md) 모듈에 연결하여 이상 점수를 예측할 수 있습니다.

변칙 검색 모델의 결과를 평가하려면 몇 가지 추가 단계가 필요합니다.

1. 두 데이터 집합모두에서 점수 열을 사용할 수 있는지 확인

    변칙 검색 모델을 평가하고 "비교할 점수가 매겨진 데이터 집합에 점수 열이 없습니다"라는 오류가 발생하면 레이블 열이 포함되어 있지만 확률 점수가 없는 일반적인 평가 데이터 집합을 사용하고 있음을 의미합니다. **점수가 매겨진 레이블** 및 **점수가 매겨진 확률** 열이 포함된 변칙 검색 모델의 스키마 출력과 일치하는 데이터 집합을 선택해야 합니다.

2. 레이블 열이 표시되어 있는지 확인

    레이블 열과 연결된 메타데이터가 파이프라인 그래프에서 제거되는 경우가 있습니다. 이 경우 [모델 평가](evaluate-model.md) 모듈을 사용하여 두 변칙 검색 모델의 결과를 비교할 때 "점수가 매겨진 데이터 집합에 레이블 열이 없습니다"또는 "점수가 매겨진 데이터 집합에 레이블 열이 없습니다"라는 오류가 발생할 수 있습니다.

    [모델 평가](evaluate-model.md) 모듈 앞에 [메타데이터 편집](edit-metadata.md) 모듈을 추가하여 이 오류를 방지할 수 있습니다. 열 선택기를 사용하여 클래스 열을 선택하고 **필드** 드롭다운 목록에서 **레이블을**선택합니다.

3. [파이썬 스크립트 실행을](execute-python-script.md) 사용하여 레이블 열 범주를 1 (양수, 정상) 및 0 (음수, 비정상)으로 조정합니다.

    ````
    label_column_name = 'XXX'
    anomaly_label_category = YY
    dataframe1[label_column_name] = dataframe1[label_column_name].apply(lambda x: 0 if x == anomaly_label_category else 1)
    ````

    
## <a name="technical-notes"></a>기술 정보

이 알고리즘은 PCA를 사용하여 일반 클래스를 포함하는 하위 공간을 근사화합니다. 하위 공간은 데이터 공분산 행렬의 최상위 고유 값과 연관된 고유 벡터로 스팬됩니다. 각 새 입력에 대해 변칙 검출기는 먼저 고유 벡터에 대한 투영을 계산한 다음 정규화된 재구성 오류를 계산합니다. 이 오류는 이상 점수입니다. 오류가 높을수록 인스턴스가 더 비정상적이됩니다. 일반 공간을 계산하는 방법에 대한 자세한 내용은 위키백과: [주 성분 분석을](https://wikipedia.org/wiki/Principal_component_analysis) 참조하십시오. 


## <a name="next-steps"></a>다음 단계

Azure 기계 학습에 사용할 수 있는 [모듈 집합을](module-reference.md) 참조하십시오. 

디자이너 모듈과 관련된 오류 목록은 [디자이너의 예외 및 오류 코드(미리 보기)를](designer-error-codes.md) 참조하십시오.'