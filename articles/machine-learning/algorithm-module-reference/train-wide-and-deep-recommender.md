---
title: 열차 Wide & Deep 추천 모듈 사용
titleSuffix: Azure Machine Learning
description: 전체 & 학습 추천 모듈을 사용 하 여 권장 사항 모델을 학습 하는 방법에 대해 알아봅니다.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 06/12/2020
ms.openlocfilehash: bb213776d41c07238fcaba1ccdd4e06f5d5bbb5f
ms.sourcegitcommit: e71da24cc108efc2c194007f976f74dd596ab013
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/29/2020
ms.locfileid: "87420892"
---
# <a name="train-wide--deep-recommender"></a>넓은 & 심층적 추천 학습
이 문서에서는 Azure Machine Learning 디자이너 (미리 보기)에서 **전체 & 심층 추천** 모듈을 사용 하 여 권장 사항 모델을 학습 하는 방법을 설명 합니다. 이 모듈은 Google에서 제안 하는 넓은 & 심층 학습을 기반으로 합니다.

**열차 Wide & Deep 추천** 모듈은 사용자-항목-등급 삼중 쌍의 데이터 집합을 읽고, 선택적으로 일부 사용자 및 항목 기능을 읽습니다. 학습 된 넓은 & 심층 추천을 반환 합니다.  그런 다음 학습 된 모델을 사용 하 여 [전체 점수 및 심층 추천](score-wide-and-deep-recommender.md) 모듈을 사용 하 여 등급 예측 또는 권장 사항을 생성할 수 있습니다.  

## <a name="more-about-recommendation-models-and-the-wide--deep-recommender"></a>권장 사항 모델 및 광범위 한 & 심층 추천에 대 한 자세한 정보  

권장 사항 시스템의 주요 목적은 시스템 *사용자* 에 게 하나 이상의 *항목* 을 권장 하는 것입니다. 항목에는 영화, 식당, 책, 노래 등이 포함될 수 있습니다. 그리고 사용자는 사람, 사람 그룹 또는 항목 기본 설정이 지정된 기타 엔터티일 수 있습니다.  

추천 시스템에는 두 가지 기본 접근 방식이 사용됩니다. 

+ 그 중 첫 번째는 사용자와 항목 둘 다에 대해 기능을 사용하는 **콘텐츠 기반** 방식입니다. 사용자는 연령/성별 등의 속성으로 설명할 수 있고 항목은 작성자/제조업체 등의 속성으로 설명할 수 있습니다. 콘텐츠 기반 추천 시스템의 일반적인 예는 소셜 매치메이킹 사이트에서 확인할 수 있습니다. 
+ 두 번째 방식은 **공동 작업 필터링**입니다. 이 방식에서는 사용자와 항목의 식별자만을 사용하며, 사용자가 항목에 지정한 등급의 스파스 행렬에서 이러한 엔터티와 관련된 암시적 정보를 가져옵니다. 특정 사용자에 대한 정보는 해당 사용자가 등급을 지정한 항목과 같은 항목에 등급을 지정한 다른 사용자로부터 파악할 수 있습니다.  

광범위 한 & 심층 추천는 콘텐츠 기반 접근 방식으로 공동 작업 필터링을 사용 하 여 이러한 접근 방식을 결합 합니다. **하이브리드 추천**이라고 할 수 있습니다. 

작동 방식: 사용자가 시스템을 비교적 새로 사용 하는 경우 사용자에 대 한 기능 정보를 활용 하 여 예측을 개선 하 여 잘 알려진 "콜드 부팅" 문제를 해결 합니다. 그러나 특정 사용자의 등급 정보가 충분히 수집되면 기능뿐이 아니라 사용자의 특정 등급에 따라 해당 사용자에 대해 완전히 개인 설정된 예측을 할 수 있습니다. 따라서 추천 방식이 콘텐츠 기반 추천에서 공동 작업 필터링 기반 추천으로 원활하게 전환됩니다. 사용자 또는 항목 기능을 사용할 수 없는 경우에도 넓은 & 딥 추천는 공동 작업 필터링 모드에서 계속 작동 합니다.  

광범위 한 & 심층 추천 및 기본 확률 알고리즘에 대 한 자세한 내용은 관련 리서치 백서 ( [추천 시스템에 대 한 wide & 심층 학습](https://arxiv.org/pdf/1606.07792.pdf))에서 찾을 수 있습니다.  

## <a name="how-to-configure-train-wide--deep-recommender"></a>열차 Wide & Deep 추천을 구성 하는 방법  

+ [학습 데이터 준비](#prepare-data)
+ [모델 학습](#train-the-model)

### <a name="prepare-data"></a>데이터 준비

모듈을 사용 하기 전에 데이터를 권장 모델에 필요한 형식으로 지정 해야 합니다. **사용자-항목-등급 삼중 쌍** 의 학습 데이터 집합은 필수 이지만 별도의 데이터 집합에 사용자 기능 및 항목 기능 (사용 가능한 경우)을 포함할 수도 있습니다.

#### <a name="required-dataset-of-user-item-ratings"></a>사용자-항목-등급의 필수 데이터 집합

학습에 사용 되는 입력 데이터는 올바른 형식의 데이터를 올바른 형식으로 포함 해야 합니다. 

+ 첫 번째 열에는 사용자 식별자가 포함 되어야 합니다.
+ 두 번째 열에는 항목 식별자가 포함 되어야 합니다.
+ 세 번째 열은 사용자-항목 쌍의 등급을 포함 합니다. 등급 값은 숫자 형식 이어야 합니다. 

예를 들어 일반적인 사용자-항목 등급 집합은 다음과 같습니다.

|UserId|MovieId|등급|
|------------|-------------|------------|
|1|68646|10|
|223|31381|10|

#### <a name="user-features-dataset-optional"></a>사용자 기능 데이터 집합 (옵션)

사용자 **기능의** 데이터 집합은 사용자에 대 한 식별자를 포함 하 고 사용자-항목-등급 데이터 집합의 첫 번째 열에 제공 된 것과 동일한 식별자를 사용 해야 합니다. 나머지 열은 사용자를 설명 하는 다양 한 기능을 포함할 수 있습니다.  

예를 들어 일반적인 사용자 기능 집합은 다음과 같습니다. 

|UserId|나이|성별|Interest|위치|
|------------|--------------|-----------------------|---------------|------------|
|1|25|male| 드라마    |유럽|
|223|40|female|테두리|아시아|

#### <a name="item-features-dataset-optional"></a>항목 기능 데이터 집합 (옵션)

항목 기능 데이터 집합의 첫 번째 열에는 항목 식별자가 포함되어 있어야 합니다. 나머지 열에는 항목에 대 한 설명 기능이 개수에 제한 없이 포함 될 수 있습니다.  

예를 들어 일반적인 항목 기능 집합은 다음과 같습니다.  

|MovieId|제목|원래 언어|장르|년|
|-------------|-------------|-------------------|-----------|---------------|
|68646|Godfather|영어|드라마|1972|
|31381|바람에 사라졌습니다.|영어|기록|1939|

### <a name="train-the-model"></a>모델 학습

1.  Designer의 실험 (미리 보기)에 **전체 학습 및 심층 추천** 모듈을 추가 하 고 학습 데이터 집합에 연결 합니다.  
  
2. 사용자 기능 및/또는 항목 기능 중 하나에 대 한 별도의 데이터 집합을 사용 하는 경우에는이를 **학습 Wide And Deep 추천** 모듈에 연결 합니다.  
  
    - **사용자 기능 데이터 집합**: 사용자를 설명 하는 데이터 집합을 두 번째 입력에 연결 합니다.
    - **항목 기능 데이터 집합**: 항목을 설명 하는 데이터 집합을 세 번째 입력에 연결 합니다.  
    
3.  **Epoch**: 알고리즘이 전체 학습 데이터를 처리 해야 하는 횟수를 표시 합니다. 

    이 수가 높을수록 교육에 보다 적합 합니다. 그러나 더 많은 시간을 학습 하 고 과잉 맞춤 발생할 수 있습니다.

4. **일괄 처리 크기**: 한 학습 단계에서 사용한 학습 예의 수를 입력 합니다. 

     이 하이퍼 매개 변수는 학습 속도에 영향을 줄 수 있습니다. 일괄 처리 크기가 높으면 시간에 드는 비용을 줄일 수 있지만 수렴 시간이 늘어날 수 있습니다. 일괄 처리가 너무 커서 GPU/CPU에 맞지 않는 경우 메모리 오류가 발생할 수 있습니다.

5.  **전체 부분 최적화 프로그램**: 모델의 광범위 한 부분에 그라데이션을 적용 하려면 최적화 프로그램 하나를 선택 합니다.

6.  **광범위 한 최적화 프로그램 학습 률**: wide part 최적화 프로그램의 학습 률을 정의 하는 0.0에서 2.0 사이의 숫자를 입력 합니다.

    이 하이퍼 매개 변수는 최소 손실 함수를 향해 이동 하는 동안 각 학습 단계의 단계 크기를 결정 합니다. 너무 큰 학습 률로 인해 최소에 대 한 학습이 이동 될 수 있지만, 너무 작은 학습 률로 인해 수렴 문제가 발생할 수 있습니다.

7.  **교차 기능 차원**: 원하는 사용자 id 및 항목 id 기능을 입력 하 여 차원을 입력 합니다. 

    넓은 & 심층 추천는 기본적으로 사용자 id 및 항목 id 기능에 대 한 제품 간 변환을 수행 합니다. 이 숫자에 따라 십자 결과가 해시 되어 차원이 확인 됩니다.

8.  **전체 부분 최적화 프로그램**: 모델의 전체 부분에 그라데이션을 적용 하려면 최적화 프로그램 하나를 선택 합니다.

9.  **심층 최적화 학습 률**: 심층 파트 최적화 프로그램의 학습 률을 정의 하는 0.0에서 2.0 사이의 숫자를 입력 합니다.

10.  **사용자 포함 차원**: 사용자 id 포함의 차원을 지정 하는 정수를 입력 합니다.

     넓은 & 딥 추천는 전체 부분과 전체 부분에 대해 공유 사용자 id 포함 및 항목 id 포함를 만듭니다.

11.  **항목 포함 차원**: 항목 id 포함의 차원을 지정 하는 정수를 입력 합니다.

12.  **범주 기능 포함 차원**: 범주 기능 포함의 차원을 지정 하려면 정수를 입력 합니다.

     넓은 & 심층 추천의 심층 구성 요소에서 포함 벡터는 각 범주 기능에 대해 학습 됩니다. 이러한 포함 벡터는 동일한 차원을 공유 합니다.

13.  **숨겨진 단위**: 심층 구성 요소의 숨겨진 노드 수를 입력 합니다. 각 계층의 노드 번호는 쉼표로 구분 됩니다. 예를 들어 "1000500100" 형식에 따라 딥 구성 요소에는 세 개의 계층이 있고, 첫 번째 계층에는 각각 1000 노드, 500 노드 및 100 노드가 있습니다.

14.  **활성화 함수**: 각 계층에 적용 되는 활성화 함수 하나를 선택 합니다. 기본값은 u t u입니다.

15.  **드롭아웃**: 0.0과 1.0 사이의 숫자를 입력 하 여 학습 중에 각 계층에서 출력이 삭제 될 확률을 결정 합니다.

     드롭아웃는 과잉 맞춤에서 신경망을 방지 하는 정규화 메서드입니다. 이 값에 대 한 일반적인 결정은 0.5부터 시작 하는 것입니다 .이는 광범위 한 네트워크 및 작업에 가장 적합 한 것으로 보입니다.

16.  **일괄 처리 정규화**: 심층 구성 요소에서 숨겨진 각 계층 후에 일괄 처리 정규화를 사용 하려면이 옵션을 선택 합니다.

     일괄 처리 정규화는 네트워크 학습 중에 내부 전환 문제를 해결 하는 기술입니다. 일반적으로 네트워크의 속도, 성능 및 안정성을 향상 시키는 데 도움이 될 수 있습니다. 

17.  파이프라인을 실행합니다.

##  <a name="technical-notes"></a>기술 정보

넓은 & 심층 선형 모델 및 심층 신경망을 학습 하 여 기억할 및 일반화의 장점을 결합 합니다. 전체 구성 요소는 원시 기능 집합을 허용 하 고 기능 변환을 기억 기능 상호 작용을 제공 합니다. 더 적은 기능 엔지니어링을 사용 하 여 심층 구성 요소는 낮은 차원의 조밀한 기능 포함을 통해 보이지 않는 기능 조합으로 일반화 되었습니다. 

넓은 & 심층 추천 구현에서 모듈은 기본 모델 구조를 사용 합니다. Wide component는 사용자 포함, 항목 포함 및 사용자 id와 항목 id의 제품 간 변환을 입력으로 사용 합니다. 모델의 전체 부분에서 포함 벡터는 각 범주 기능에 대해 학습 됩니다. 이러한 벡터는 다른 숫자 기능 벡터와 함께 전체 피드-전달 신경망에 제공 됩니다. 최종 출력 로그의 합계를 예측으로 합산 하 여 광범위 한 부분 및 전체 부분을 결합 하 여 최종적으로 공동 학습을 위한 하나의 일반적인 손실 기능으로 이동 합니다.


## <a name="next-steps"></a>다음 단계

Azure Machine Learning [사용할 수 있는 모듈 집합](module-reference.md) 을 참조 하세요. 
