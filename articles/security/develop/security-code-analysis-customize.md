---
title: Microsoft Azure 보안 코드 분석 작업 사용자 지정 가이드
description: 이 문서에서는 보안 코드 분석 확장에서 작업을 사용자 지정 하는 방법에 대해 설명 합니다.
author: vharindra
manager: sukhans
ms.author: terrylan
ms.date: 07/31/2019
ms.topic: article
ms.service: security
services: azure
ms.assetid: 521180dc-2cc9-43f1-ae87-2701de7ca6b8
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.openlocfilehash: ab219b71eb8cd6f6172b7d02a639301c67811b49
ms.sourcegitcommit: a52f17307cc36640426dac20b92136a163c799d0
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/01/2019
ms.locfileid: "68718354"
---
# <a name="how-to-configure--customize-the-build-tasks"></a>방법: 빌드 작업 구성 & 사용자 지정

이 페이지에서는 각 빌드 작업에서 사용할 수 있는 구성 옵션에 대해 자세히 설명 합니다. 이러한 구성 옵션에 대 한 자세한 내용은 보안 코드 분석 도구에 대 한 작업 후 사후 처리 작업을 수행 합니다.

## <a name="anti-malware-scanner-task"></a>맬웨어 방지 스캐너 작업

> [!NOTE]
> 맬웨어 방지 빌드 작업을 수행 하려면 Windows Defender를 사용 하는 빌드 에이전트가 필요 하며,이는 "Hosted VS2017" 이상 빌드 에이전트에 적용 됩니다. (레거시/VS2015 "호스팅된" 에이전트에서 실행 되지 않습니다.) 이러한 에이전트에서는 시그니처를 업데이트할 수 없지만 서명이 3 시간 미만인 경우 항상 상대적으로 최신 이어야 합니다.

아래 구성에 대 한 스크린샷 및 세부 정보입니다.

![맬웨어 방지 스캐너 빌드 작업 사용자 지정](./media/security-tools/5-add-anti-malware-task600.png) 

- 유형 = **기본** 설정
- Type = **Custom**을 사용 하면 검색을 사용자 지정할 수 있는 명령줄 인수를 제공할 수 있습니다.

Windows Defender는 Windows 업데이트 클라이언트를 사용 하 여 서명을 다운로드 하 고 설치 합니다. 빌드 에이전트에서 서명 업데이트가 실패할 경우 HRESULT 오류 코드는 Windows 업데이트에서 발생할 수 있습니다. Windows 업데이트 오류 및 완화에 대 한 자세한 내용은이 [페이지](https://docs.microsoft.com/windows/deployment/update/windows-update-error-reference) 및 [technet 페이지](https://social.technet.microsoft.com/wiki/contents/articles/15260.windows-update-agent-error-codes.aspx) 를 참조 하세요.

## <a name="binskim-task"></a>BinSkim 작업

> [!NOTE]
> BinSkim 작업을 실행 하기 위한 필수 구성 요소인 빌드는 아래 조건 중 하나를 충족 해야 합니다.
>    - 빌드는 관리 코드에서 이진 아티팩트를 생성 합니다.
>    - BinSkim를 사용 하 여 분석 하려는 이진 아티팩트를 커밋 했습니다.

아래 구성에 대 한 스크린샷 및 세부 정보입니다. 

![BinSkim 설정](./media/security-tools/7-binskim-task-details.png)  
1. 빌드 구성을 디버그로 설정 하 여 * **.pdb** 디버그 파일을 생성 합니다. BinSkim에서 출력 이진에 있는 문제를 소스 코드로 다시 매핑하기 위해 사용 됩니다. 
2. Type = **Basic** & Function = **Analyze** 를 선택 하 여 직접 작성 한 명령줄을 작성 하지 않도록 합니다. 
3. **대상** -분석할 이진 파일 하나 이상으로 확인 되는 파일, 디렉터리 또는 필터 패턴에 대 한 하나 이상의 지정자입니다. 
    - 여러 대상을 **세미콜론 (;)** 으로 구분 해야 합니다. 
    - 단일 파일 이거나 와일드 카드를 포함할 수 있습니다.
    - 디렉터리는 항상로 끝나야 합니다.\*
    - 예를 들면 다음과 같습니다.

           *.dll;*.exe
           $(BUILD_STAGINGDIRECTORY)\*
           $(BUILD_STAGINGDIRECTORY)\*.dll;$(BUILD_STAGINGDIRECTORY)\*.exe;
4. Type = **명령줄**을 선택 하는 경우 
     - **BinSkim** 에 대 한 첫 번째 인수는 전체 경로를 사용 하 여 동사를 **분석** 하거나 원본 디렉터리를 기준으로 하는 경로를 사용 해야 합니다.
     - **명령줄** 입력의 경우 여러 대상을 공백으로 구분 해야 합니다.
     - **/O** 또는 **/output** 파일 매개 변수를 생략할 수 있습니다. 사용자를 위해 추가 되거나 교체 됩니다. 
     - **표준 명령줄 구성** 

           analyze $(Build.StagingDirectory)\* --recurse --verbose
           analyze *.dll *.exe --recurse --verbose
          > [!NOTE]
          > 대상에 \* 대 한 디렉터리를 지정 하는 경우에는 후행이 매우 중요 합니다. 

BinSkim에 대 한 자세한 내용은 명령줄 인수, ID 또는 종료 코드 규칙에 대 한 자세한 내용은 [BinSkim 사용자 가이드](https://github.com/Microsoft/binskim/blob/master/docs/UserGuide.md) 를 참조 하세요.

## <a name="credential-scanner-task"></a>자격 증명 스캐너 작업
아래 구성에 대 한 스크린샷 및 세부 정보입니다.
 
![자격 증명 스캐너 사용자 지정](./media/security-tools/3-taskdetails.png)

사용 가능한 옵션은 다음과 같습니다. 
  - **출력 형식** – TSV/CSV/SARIF/PREfast
  - **도구 버전** 바람직하지 마지막
  - **검색 폴더** – 검색할 리포지토리의 폴더입니다.
  - **Searchers 파일 형식** -검색에 사용 되는 Searchers 파일을 찾는 옵션입니다.
  - **비 표시 파일** – [JSON](https://json.org/) 파일을 사용 하 여 출력 로그의 문제를 억제할 수 있습니다 (리소스 섹션의 자세한 내용 참조). 
  - **자세한 정보 출력** -자체 설명 
  - **일괄 처리 크기** -동시에 자격 증명 스캐너를 실행 하는 데 사용 되는 동시 스레드 수입니다. 기본값은 20 (값은 1에서 2147483647 사이 여야 함)입니다.
  - **일치 제한 시간** -검사를 포기 하기 전에 검색 자가 일치를 시도 하는 데 소요 되는 시간입니다. 
  - **파일 검색 읽기 버퍼 크기** -콘텐츠를 읽는 동안 버퍼 크기 (바이트)입니다. (기본값은 524288) 
  - **최대 파일 검색 읽기 바이트** -콘텐츠를 분석 하는 동안 지정 된 파일에서 읽을 최대 바이트 수입니다. (기본값은 104857600) 
  - **이 작업 실행** ( **제어 옵션**아래)-태스크를 실행 해야 하는 경우를 지정 합니다. 더 복잡 한 조건을 지정 하려면 "사용자 지정 조건"을 선택 합니다. 
  - **버전** -Azure devops 내의 빌드 작업 버전입니다. 자주 사용 되지 않습니다. 

## <a name="microsoft-security-risk-detection-task"></a>Microsoft 보안 위험 검색 작업
> [!NOTE]
> 이 작업을 사용 하려면 먼저 위험 검색 서비스를 사용 하 여 계정을 만들고 구성 해야 합니다. 이 서비스에는 별도의 온 보 딩 프로세스가 필요 합니다. 이 확장의 다른 작업 대부분은 ' 플러그 앤 플레이 '가 아닙니다. [Microsoft 보안 위험 검색](https://aka.ms/msrddocs) 및 [microsoft 보안 위험 검색을 참조 하세요. ](https://docs.microsoft.com/security-risk-detection/how-to/) 방법에 대 한 지침을 참조 하세요.

아래 구성에 대 한 세부 정보입니다.

필요한 데이터를 입력 합니다. 각 옵션에는 가리키기 텍스트 도움말이 있습니다.
   - **MSRD의 Azure DevOps 서비스 끝점 이름**: MSRD 인스턴스 URL (등록) 및 REST API 액세스 토큰을 저장할 Azure DevOps 서비스 끝점의 제네릭 형식을 만든 경우 해당 서비스 끝점을 선택할 수 있습니다. 그렇지 않은 경우 관리 링크를 클릭 하 여이 MSRD 작업의 새 서비스 끝점을 만들고 구성 합니다. 
   - **계정 ID**: MSRD 계정 URL에서 검색할 수 있는 GUID입니다.
   - **이진 파일에 대 한 url**: 퍼지 컴퓨터에서 이진 파일을 다운로드 하는 데 사용 되는 공개적으로 사용할 수 있는 Url의 세미콜론으로 구분 된 목록입니다.
   - **초기값 파일의 url**: 퍼지 컴퓨터에서 시드를 다운로드 하는 데 사용 하는, 공개적으로 사용 가능한 Url의 세미콜론으로 구분 된 목록입니다. 초기값 파일이 이진 파일과 함께 다운로드 되는 경우이 필드는 선택 사항입니다.
   - **OS 플랫폼 유형**: 퍼징 작업을 실행할 컴퓨터의 OS 플랫폼 유형 (Windows 또는 Linux)입니다.
   - **Windows edition/Linux 버전**: 퍼징 작업을 실행할 컴퓨터의 OS 버전입니다. 컴퓨터에 다른 OS 버전이 있는 경우 기본값을 덮어쓸 수 있습니다.
   - **패키지 설치 스크립트**: 테스트 컴퓨터에서 실행할 스크립트를 제공 하 여 테스트 대상 프로그램 및 해당 종속성을 설치 하 고, 퍼지 작업을 제출 합니다.
   - **작업 제출 매개 변수**:
       - **시드 디렉터리**: 시드를 포함 하는 퍼지 컴퓨터의 디렉터리 경로입니다.
       - **초기값 확장**: 초기값의 파일 확장명입니다.
       - **테스트 드라이버 실행 파일**: 퍼지 컴퓨터에서 대상 실행 파일의 경로입니다.
       - **테스트 드라이버 실행 파일 아키텍처**: 대상 실행 파일 아키텍처 (x86 또는 amd64)입니다.
       - **테스트 드라이버 인수**: 테스트 대상 실행 파일에 전달 되는 명령줄 인수입니다. 큰따옴표를 포함 하 여 "% testfile%" 기호는 테스트 드라이버가 구문 분석 해야 하는 대상 파일의 전체 경로로 자동으로 대체 됩니다.
       - 테스트를 **완료 하면 테스트 드라이버 프로세스가 종료**됩니다. 완료 시 테스트 드라이버를 종료 하려면 선택 합니다. 테스트 드라이버를 강제로 닫아야 하는지 여부를 선택 취소 합니다.
       - **최대 기간 (초)** : 대상 프로그램에서 입력 파일을 구문 분석 하는 데 필요한 가장 긴 예상 시간을 예측 하 여 제공 합니다. 이러한 예측을 보다 정확 하 게 하면 퍼지 실행이 더 효율적입니다.
       - **테스트 드라이버를 반복 해 서 실행할 수 있습니다**. 지속형/공유 전역 상태에 따라 테스트 드라이버를 반복 해 서 실행할 수 있는지 확인 합니다.
       - **테스트 드라이버의 이름을 바꿀 수 있습니다**. 테스트 드라이버 실행 파일의 이름을 바꿀 수 있고 제대로 작동할 수 있는지 확인 합니다.
       - **퍼지 응용 프로그램은 단일 OS 프로세스로 실행 됩니다**. 단일 OS 프로세스에서 테스트 드라이버가 실행 되는지 확인 합니다. 테스트 드라이버가 추가 프로세스를 생성 하는지 확인 합니다.


## <a name="roslyn-analyzers-task"></a>Roslyn 분석기 작업
> [!NOTE]
> Roslyn Analyzer 작업을 실행 하기 위한 필수 구성 요소인 빌드는 다음 조건을 충족 해야 합니다.
>  - 빌드 정의에는 (또는 VB) 코드를 컴파일하 C# 는 기본 제공 MSBuild 또는 vsbuild 빌드 작업이 포함 되어 있습니다. 이 작업은 특정 빌드 작업의 입력 및 출력을 사용 하 여 Roslyn 분석기를 사용 하는 MSBuild 컴파일을 다시 실행 합니다.
>  - 이 빌드 작업을 실행 하는 빌드 에이전트에 Visual Studio 2017 v 15.5 이상 버전이 설치 되어 있습니다 (컴파일러 버전 2.6. x).
>

아래 구성에 대 한 세부 정보입니다.

사용 가능한 옵션은 다음과 같습니다. 
- **규칙 집합** -sdl 필수, sdl 권장 또는 고유한 사용자 지정 규칙 집합을 사용할 수 있습니다.
- **분석기 버전** 바람직하지 마지막
- **컴파일러 경고 비** 표시 오류 (Suppression) 파일-표시 하지 않아야 하는 경고 id 목록이 포함 된 텍스트 파일입니다. 
- **이 작업 실행** ( **제어 옵션**아래)-태스크를 실행 해야 하는 경우를 지정 합니다. 더 복잡 한 조건을 지정 하려면 "**사용자 지정 조건**"을 선택 합니다. 

> [!NOTE]
> - Roslyn 분석기는 컴파일러 통합 이며 CSC.EXE 컴파일의 일부로만 실행할 수 있습니다. 따라서이 작업을 수행 하려면 이전에 빌드에서 실행 된 컴파일러 명령을 재생 하거나 다시 실행 해야 합니다. 이렇게 하려면 MSBuild 빌드 작업 로그에 대해 VSTS를 쿼리 합니다 .이 작업은 빌드 정의에서 MSBuild 컴파일 명령줄을 안정적으로 가져올 수 있는 다른 방법이 없습니다. 사용자가 명령줄을 입력할 수 있도록 자유 텍스트 상자를 추가 하는 것이 좋습니다. 하지만이를 최신 상태로 유지 하 고 주 빌드와 동기화 하는 것은 어려울 수 있습니다. 사용자 지정 빌드는 컴파일러 명령 뿐만 아니라 전체 명령 집합을 재생 해야 하며, 이러한 경우 Roslyn 분석기를 사용 하도록 설정 하는 것은 간단 하 고 안정적이 지 않습니다. 
> - Roslyn 분석기는 컴파일러와 통합 되며 컴파일을 호출 해야 합니다. 이 빌드 작업은 동일한 빌드/ C# 빌드 정의에서 MSBuild/vsbuild 빌드 작업만 사용 하 여 이미 빌드된 프로젝트를 다시 컴파일하거나이 경우 분석기를 사용 하도록 설정 하 여 구현 됩니다. 이 빌드 작업이 원래 빌드 작업과 동일한 에이전트에서 실행 되는 경우이 빌드 작업의 출력을 통해 원래 MSBuild/VSBuild 빌드 작업의 출력이의 ' sources 폴더 '로 덮어쓰여집니다. 빌드 출력은 동일 하지만 MSBuild를 실행 하 고 출력을 아티팩트 스테이징 디렉터리에 복사한 다음 Roslyn를 실행 하는 것이 좋습니다.
>

Roslyn 분석기에 대 한 추가 리소스는 [Microsoft Docs의 Roslyn 분석기에서](https://docs.microsoft.com/dotnet/standard/analyzers/) 작업을 확인 합니다.

이 빌드 작업에서 설치 하 고 사용 하는 분석기 패키지는 [여기](https://www.nuget.org/packages/Microsoft.CodeAnalysis.FxCopAnalyzers) 에서 찾을 수 있습니다. 

## <a name="tslint-task"></a>TSLint 작업

TSLint에 대 한 자세한 내용은 [TSLint GitHub 리포지토리](https://github.com/palantir/tslint) 를 참조 하세요.
>[!NOTE] 
>이에 대 한 이해를 TSLint 때 2019 (원본: [TSLint GitHub 리포지토리](https://github.com/palantir/tslint)) 팀에서 현재 [Eslint](https://github.com/eslint/eslint) 를 조사 하 고 있으며 eslint에 대 한 새 작업을 만드는 작업은 로드맵에 있습니다.

## <a name="publish-security-analysis-logs-task"></a>보안 분석 로그 게시 태스크
아래 구성에 대 한 스크린샷 및 세부 정보입니다.

![보안 분석 게시 사용자 지정](./media/security-tools/9-publish-security-analsis-logs600.png)  

- **아티팩트 이름** -임의의 문자열 식별자를 사용할 수 있습니다.
- **아티팩트 유형** -로그를 Azure devops 서버 또는 빌드 에이전트에서 액세스할 수 있는 파일 공유에 게시할 수 있습니다. 
- **도구** -개별/특정 도구에 대 한 로그를 유지 하거나 모든 **도구** 를 선택 하 여 모든 로그를 유지 하도록 선택할 수 있습니다. 

## <a name="security-report-task"></a>보안 보고서 작업
아래 구성에 대 한 스크린샷 및 세부 정보입니다.  
![사후 분석 설정](./media/security-tools/4-createsecurityanalysisreport600.png) 
- **보고서** -만들 보고서 파일을 선택 합니다. 하나는 **콘솔**, **TSV**및/또는 **HTML** 형식으로 만들어집니다. 
- **도구** -검색 된 문제에 대 한 요약을 원하는 빌드 정의의 도구를 선택 합니다. 선택한 각 도구에 대해 오류만 표시할지 아니면 보고서에 오류 및 경고를 모두 표시할지를 선택 하는 옵션이 있을 수 있습니다. 
- **고급 옵션** -선택한 도구 중 하나에 대 한 로그가 없는 경우 경고 또는 오류를 기록 하 고 작업을 실패 하도록 선택할 수 있습니다.
로그가 있는 기본 로그 폴더를 사용자 지정할 수 있지만 일반적인 시나리오는 아닙니다. 

## <a name="post-analysis-task"></a>사후 분석 작업
아래 구성에 대 한 스크린샷 및 세부 정보입니다.

![사후 분석 사용자 지정](./media/security-tools/a-post-analysis600.png) 
- **도구** -결과에 따라 빌드 중단을 삽입 하려는 빌드 정의의 도구를 선택 합니다. 선택한 각 도구에 대해 오류만 중단할지, 오류 및 경고를 모두 중단할지를 선택 하는 옵션이 있을 수 있습니다. 
- **보고서** -검색 된 결과를 선택적으로 작성 하 여 Azure devops 콘솔 창 및 로그 파일에 빌드 중단을 일으킬 수 있습니다. 
- **고급 옵션** -선택한 도구 중 하나에 대 한 로그가 없는 경우 경고 또는 오류를 기록 하 고 작업을 실패 하도록 선택할 수 있습니다.

## <a name="next-steps"></a>다음 단계

확장 및 제공 된 도구에 대 한 추가 질문이 있는 경우 [faq 페이지](security-code-analysis-faq.md) 를 참조 하세요.


