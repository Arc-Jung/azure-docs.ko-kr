---
title: "Azure AD 응용 프로그램 프록시를 사용하여 앱에 원격으로 액세스할 때 보안 고려 사항 | Microsoft Docs"
description: "Azure AD 응용 프로그램 프록시를 사용할 때 보안 고려 사항에 대해 다룹니다."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/12/2017
ms.author: kgremban
translationtype: Human Translation
ms.sourcegitcommit: 67650676117fef834ea819da2fc45ca66ed15493
ms.openlocfilehash: 1b713e015f48b044c6c9d8ff6a0d8669d4532a9f


---

# <a name="security-considerations-when-accessing-apps-remotely-using-azure-ad-application-proxy"></a>Azure AD 응용 프로그램 프록시를 사용하여 앱에 원격으로 액세스할 때 보안 고려 사항

>[!NOTE]
>응용 프로그램 프록시는 Premium 또는 Basic 버전의 Azure Active Directory로 업그레이드하는 경우에만 사용할 수 있는 기능입니다. 자세한 내용은 [Azure Active Directory 버전](active-directory-editions.md)을 참조하세요.
>  

이 문서에서는 Azure AD 응용 프로그램 서비스에서 응용 프로그램을 원격으로 게시 및 액세스하기 위한 안전한 서비스를 어떻게 제공하는지 설명합니다. 

Azure AD 응용 프로그램 프록시는 다음과 같은 보안 이점을 제공합니다.

**인증된 액세스:** 인증된 연결만 네트워크에 액세스할 수 있습니다.

* Azure AD 앱 프록시는 모든 인증에 대해 Azure AD STS를 사용합니다. 사전 인증으로 게시된 응용 프로그램인 경우 유효한 STS 토큰이 없으면 트래픽이 사용자 환경에 대해 앱 프록시 서비스를 통과할 수 없습니다.
* 사전 인증은 인증된 ID만 백 엔드 응용 프로그램에 액세스할 수 있도록 하므로 본질적으로 많은 수의 익명 공격을 차단합니다.

**조건부 액세스:** 네트워크에 대한 연결이 설정되기 전에 더 풍부한 정책 제어를 적용합니다.

* 조건부 액세스에서는 백 엔드 응용 프로그램에 어떤 트래픽을 허용할지에 대한 제한 사항을 추가로 정의할 수 있습니다. 위치, 인증 강도 및 사용자 위험 프로필에 따라 제한 사항을 정의할 수 있습니다.
* 이 기능을 통해 공격자에 대한 추가적인 장벽을 만들 수 있습니다. 조건부 액세스에 대한 자세한 내용은 [Azure Active Directory 조건부 액세스 시작](https://azure.microsoft.com/en-us/documentation/articles/active-directory-conditional-access-azuread-connected-apps)을 참조하세요.

**트래픽 종료:** 모든 트래픽이 클라우드에서 종료됩니다.

* Azure AD 앱 프록시는 역방향 프록시이므로 백 엔드 응용 프로그램으로 전송되는 모든 트래픽인 서비스에서 종료됩니다. 백 엔드 서버와 이 세션을 다시 설정할 수만 있습니다. 따라서 백 엔드 서버는 직접 HTTP 트래픽에 노출되지 않습니다. 예를 들어 대상 지정된 공격을 보다 쉽게 해결할 수 있습니다.

**모든 액세스가 아웃바운드임:** 회사 네트워크에 대해 열어야 하는 인바운드 연결이 없음

* Azure AD 커넥터는 Azure AD 앱 프록시 서비스에 대해 아웃바운드 연결을 유지합니다. 따라서 들어오는 연결에 대해 방화벽 포트를 열 필요가 없습니다. 
* 기존의 방식에서는 네트워크 가장자리에서 DMZ와 인증되지 않은 연결에 대한 열기 액세스가 필요했습니다. 그 결과, 트래픽을 분석하고 환경에 추가 보호를 제공하는 WAF 제품에 상당한 투자가 필요했습니다. 앱 프록시에서는 이러한 시나리오를 방지할 수 있습니다. 모든 연결은 아웃바운드이고 보안 채널을 통하기 때문에 DMZ 없이 진행하는 것도 고려할 수 있습니다.

**보안 분석 및 컴퓨터 언어 기반 인텔리전스:** 최첨단 보호 기능

* Azure AD ID 보호는 기계 학습 기반 인텔리전스와 Digital Crimes Unit 및 Microsoft 보안 대응 센터로부터 데이터 피드를 포함합니다. 따라서 손상된 계정을 사전에 식별하고 위험도 높은 로그인으로부터 실시간 보호를 제공합니다. 감염된 장치에서 익명의 네트워크를 통한 액세스, 일반적이고 가능성이 적은 위치 등 다양한 요소를 고려합니다.
* 이러한 많은 보고서 및 이벤트는 SIEM 시스템과 통합을 위해 API를 통해 이미 제공됩니다.
* Azure AD ID 보호에 대한 자세한 내용은 [Azure Active Directory ID 보호](https://azure.microsoft.com/en-us/documentation/articles/active-directory-identityprotection)를 참조하세요.
!
**원격 액세스 서비스:** 온-프레미스 서버의 유지 관리 및 패치 적용에 대해 걱정하지 않아도 됩니다.

* Azure AD 앱 프록시는 Microsoft가 소유한 인터넷 규모 서비스이므로 항상 최신 보안 패치 및 업그레이드가 제공된다는 사실에 안심할 수 있습니다. 따라서 네트워크의 보안이 해결됩니다.
* 패치가 적용되지 않은 소프트웨어는 여전히 다수의 공격 대상입니다. 당사의 서비스 모델에서는 에지 서버를 관리해야 하는 부담으로부터 벗어날 수 있습니다. 

Azure AD와 함께 제공되는 원격 액세스 서비스는 [Azure 보안 센터](https://azure.microsoft.com/en-us/support/trust-center)에 명시된 지침과 표준에 따라 작동합니다. 

아래 다이어그램은 Azure AD를 통해 온-프레미스 응용 프로그램에 어떻게 안전하게 원격으로 액세스할 수 있는지를 보여 줍니다.

 ![AzureAD 응용 프로그램 프록시 커넥터](./media/application-proxy-security-considerations/secure-remote-access.png)

>[!NOTE] 
>Azure AD 응용 프로그램 프록시에 의해 게시된 응용 프로그램의 보안을 개선하기 웹 크롤러 로봇이 응용 프로그램을 인덱싱하고 보관하지 못하도록 합니다. 웹 크롤러 로봇이 게시된 앱에 대한 로봇 설정을 검색하려 할 때마다 앱 프록시는 다음을 포함하는 robots.txt 파일로 응답합니다. <br>
>   _User-agent: *_<br>
>   _Disallow: /_
>

## <a name="components-of-the-azure-ad-app-proxy-solution"></a>Azure AD 앱 프록시 솔루션의 구성 요소

Azure AD 응용 프로그램 프록시는 두 부분으로 구성됩니다.

* 클라우드 기반 서비스(AAD AP). 외부 클라이언트/사용자 연결이 여기에서 이루어집니다.
* AAD 앱 프록시 커넥터라고 하는 온-프레미스 구성 요소.  커넥터는 AAD AP 서비스에서 요청을 수신하고 SSO용 KCD(Kerberos Constrained Delegation)와 같은 항목 처리를 포함한, 내부 응용 프로그램에 대한 연결을 처리합니다.

### <a name="traffic-flowsand-how-they-are-secured"></a>트래픽 흐름 및 보안을 유지하는 방법
이 섹션에서는 흐름에 대해 보안을 유지하는 방법을 설명합니다. 커넥터와 앱 프록시 서비스 간 흐름은 다음과 같은 경우 설정됩니다. 

* 커넥터 먼저 설정됩니다.
* 커넥터는 각 커넥터가 멤버로 속하는 커넥터 그룹을 비롯하여 앱 프록시 서비스에서 구성 정보를 가져옵니다.
* 사용자는 게시된 응용 프로그램에 액세스합니다.

>[!NOTE]
>모든 통신은 SSL을 통해 발생하고 항상 커넥터에서 앱 프록시 서비스로 이루어집니다. 이 서비스는 아웃바운드 전용입니다.
>

커넥터는 모든 호출에 대해 앱 프록시 서비스를 인증하는 데 클라이언트 인증서를 사용합니다. 유일한 예외는 클라이언트 인증서가 설정되는 초기 설치 단계입니다.

#### <a name="install-the-connector"></a>커넥터 설치

커넥터를 처음 설치할 때 다음과 같은 흐름이 발생합니다.

1. 커넥터 설치 과정의 일부로 서비스에 커넥터 등록이 발생합니다. 이때 사용자에게 Azure AD 관리자 자격 증명을 입력하라는 메시지가 표시됩니다. 그러면 획득한 토큰이 Azure AD 앱 프록시 서비스에 제공됩니다.
2. 앱 프록시는 사용자가 토큰이 발급된 테넌트 내에 있는 회사 관리자 역할의 멤버인지 확인하기 위해 토큰을 평가합니다. 멤버가 아니면 프로세스가 종료됩니다.
3. 커넥터는 클라이언트 인증서 요청을 생성하고 토큰과 함께 요청을 앱 프록시 서비스로 전달합니다. 그런 다음 토큰을 검증하고 클라이언트 인증서 요청에 서명합니다. 
4. 커넥터는 앱 프록시 서비스와 나중에 통신하는 데 이 클라이언트 인증서를 사용합니다.
4. 커넥터는 해당 클라이언트 인증서를 사용하여 처음으로, 서비스로부터 시스템 구성 데이터 끌어오기를 수행하며 요청을 받을 준비가 됩니다.

#### <a name="periodic-configuration-updates"></a>정기적인 구성 업데이트

다음 흐름은 앱 프록시 서비스에서 구성 설정을 업데이트할 때마다 정기적으로 발생합니다.

1. 커넥터는 해당 클라이언트 인증서를 사용하여 앱 프록시 서비스 내의 구성 끝점에 연결됩니다.
2. 클라이언트 인증서의 유효성이 검사되면 앱 프록시 서비스가 구성 데이터를 커넥터에 반환합니다. 예를 들어 커넥터가 속하게 될 커넥터 그룹입니다.
3. 커넥터는 현재 인증서가 30일 이상 경과된 경우 새 인증서 요청을 생성하여 클라이언트 인증서를 30일마다 효과적으로 롤링합니다.

#### <a name="accesss-published-applications"></a>게시된 응용 프로그램 액세스

다음 흐름은 사용자가 게시된 응용 프로그램에 액세스할 때 발생합니다.

1. 사용자가 게시된 응용 프로그램에 액세스하면 앱 프록시 서비스가 앱에 대한 구성 설정을 확인합니다.  앱이 Azure AD에서 사전 인증을 사용하도록 구성된 경우 사용자는 인증을 위해 Azure AD STS로 리디렉션됩니다.  통과를 사용하여 앱을 게시한 경우 이 과정을 건너뜁니다.
 * Azure AD로 인증하는 동안 특정 응용 프로그램에 대한 조건부 액세스 정책 요구 사항을 확인합니다. 이렇게 하면 사용자가 응용 프로그램에 할당되었는지 확인할 수 있습니다. 예를 들어 MFA가 필요한 경우 인증 시퀀스에서 사용자에게 두 번째 단계 인증을 묻는 메시지가 표시됩니다.
 * 모든 확인을 거쳤으면 Azure AD STS에서 응용 프로그램에 대해 서명된 토큰을 발급하고 사용자를 다시 앱 프록시 서비스로 리디렉션합니다.
 * 그러면 앱 프록시는 사용자가 액세스를 요청한 응용 프로그램에 토큰이 발급되었는지 확인하기 위해 토큰의 유효성을 검사합니다. 토큰이 Azure AD에 의해 서명되었는지, 계속 유효한 기간 내에 있는지 등을 확인하는 다른 확인 작업을 함께 수행합니다.
 * 앱 프록시는 암호화된 인증 쿠키(예: 비지속형 쿠키)를 설정하여 응용 프로그램에 대한 인증이 발생했음을 나타냅니다.  이 쿠키에는 Azure AD의 토큰 및 인증 기준이 되는 사용자 이름과 같은 다른 데이터를 기반으로 하는 만료 타임스탬프가 포함됩니다.  이 쿠키는 앱 프록시 서비스에만 알려진 개인 키를 사용하여 암호화됩니다.
 * 앱 프록시는 사용자를 원래 요청된 URL로 다시 리디렉션합니다.
 >[!NOTE] 
 >사전 인증 단계 중 일부가 실패하면 사용자 요청이 거부되고 사용자에게 문제 원인을 나타내는 메시지가 표시됩니다.
 >

2. 클라이언트로부터 요청을 수신하면 앱 프록시가 사전 인증 조건이 충족되었는지 쿠키가 여전히 유효한지 필요에 따라 확인합니다. 그런 다음 온-프레미스 커넥터에 대한 적절한 큐에 요청을 배치하여 처리합니다. 

 >[!NOTE]
 >커넥터의 모든 요청은 앱 프록시 서비스로 아웃바운드됩니다. 커넥터는 앱 프록시에 대해 아웃바운드 연결을 열린 상태로 유지합니다. 앱 프록시는 요청이 들어오면 선택할 커넥터에 대해 열린 연결 중 하나에 요청을 나열합니다.
 >

 * 요청에는 암호화된 쿠키의 요청 및 데이터의 헤더, 요청을 하는 사용자 및 요청 ID 등 응용 프로그램의 항목이 포함됩니다.  그러나 암호화된 인증 쿠키는 커넥터에 전송되지 않습니다.
3. 커넥터는 수명이 긴 아웃바운드 연결에 따라 큐에서 요청을 받습니다. 앱 프록시는 요청에 따라 다음 중 하나를 수행합니다.
 * 커넥터는 응용 프로그램을 식별할 수 있는지 여부를 확인합니다.  그렇지 않은 경우 커넥터는 앱 프록시 서비스에 대해 연결을 설정하여 응용 프로그램에 대한 세부 정보를 수집하고 로컬로 캐시합니다.
 * 요청이 RESTful "GET" 요청과 함께 그대로 사용하는, 본문 내에 데이터가 없는 것처럼 간단한 작업인 경우 커넥터는 대상 내부 리소스에 대한 연결을 만들고 응답을 기다립니다.
 * 요청에 본문에 있는 내용과 연결된 데이터가 있는 경우(예: RESTful "POST" 작업) 커넥터는 클라이언트 인증서를 사용하여 앱 프록시 인스턴스로 아웃바운드 연결을 만듭니다. 이 작업으로 데이터를 요청하고 내부 리소스에 대한 연결을 엽니다.  커넥터에서 요청을 받으면 앱 프록시 서비스는 사용자로부터 콘텐츠를 수락하고 커넥터에 전달합니다.  그러면 커넥터가 데이터를 내부 리소스에 전달합니다.
4. 백 엔드로 모든 콘텐츠의 요청/전송이 완료되면 커넥터가 응답을 기다립니다.
5. 응답이 수신되면 커넥터가 앱 프록시 서비스로 아웃바운드 연결을 만들어 헤더 세부 정보를 반환하고 반환 데이터의 스트리밍을 시작합니다.
6. 앱 프록시는 사용자에게 데이터를 "스트림"합니다.  필요에 따라, 응용 프로그램에 정의된 대로 몇 가지 헤더 처리가 여기에서 이루어질 수 있습니다.

클라우드 브라우저를 통해 Azure 웹 응용 프로그램에서 온-프레미스 Windows 인증 SOAP(Simple Object Access Protocal) 끝점으로 통신하는 데 도움이 필요한 경우 이 [Azure 현장 노트 블로그](http://www.azurefieldnotes.com/2016/12/02/claims-to-windows-identity-translation-solutions-and-its-flaws-when-using-azure-ad-application-proxy)(영문)를 참조하세요. 

##<a name="next-steps"></a>다음 단계
[Azure AD 응용 프로그램 프록시 커넥터 이해](application-proxy-understand-connectors.md)




<!--HONumber=Feb17_HO2-->


