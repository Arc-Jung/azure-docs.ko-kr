---
title: ADAL 클라이언트 앱 오류 처리 모범 사례 | Microsoft
description: ADAL 클라이언트 응용 프로그램에 대 한 오류 처리 지침 및 모범 사례를 제공 합니다.
services: active-directory
author: rwike77
manager: CelesteDG
ms.author: ryanwi
ms.service: active-directory
ms.subservice: develop
ms.custom: aaddev
ms.topic: conceptual
ms.workload: identity
ms.date: 02/27/2017
ms.collection: M365-identity-device-management
ms.openlocfilehash: f4e0f434831f624dbd8c9c1302aab6816cd3d148
ms.sourcegitcommit: 5ab4f7a81d04a58f235071240718dfae3f1b370b
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/10/2019
ms.locfileid: "74966166"
---
# <a name="error-handling-best-practices-for-azure-active-directory-authentication-library-adal-clients"></a>ADAL (Azure Active Directory Authentication Library) 클라이언트에 대 한 오류 처리 모범 사례

이 문서에서는 ADAL을 사용 하 여 사용자를 인증할 때 개발자가 경험할 수 있는 오류 유형에 대 한 지침을 제공 합니다. ADAL을 사용 하는 경우 개발자가 오류를 한 단계씩 실행 하 고 오류를 처리 해야 하는 여러 가지 경우가 있습니다. 적절 한 오류 처리는 뛰어난 최종 사용자 환경을 보장 하 고 최종 사용자가 로그인 해야 하는 횟수를 제한 합니다.

이 문서에서는 ADAL에서 지 원하는 각 플랫폼에 대 한 특정 사례와 응용 프로그램에서 각 사례를 올바르게 처리 하는 방법을 살펴봅니다. 오류 지침은 ADAL Api에서 제공 하는 토큰 획득 패턴을 기반으로 하는 두 가지 더 광범위 한 범주로 분할 됩니다.

- **AcquireTokenSilent**: 클라이언트에서 자동으로 토큰을 가져오려고 시도 하며 (UI 없음) ADAL이 실패 하면 실패할 수 있습니다. 
- **AcquireToken**: 클라이언트는 자동 획득을 시도할 수 있지만 로그인이 필요한 대화형 요청을 수행할 수도 있습니다.

> [!TIP]
> ADAL 및 Azure AD를 사용 하는 경우 모든 오류 및 예외를 기록 하는 것이 좋습니다. 로그는 응용 프로그램의 전반적인 상태를 이해 하는 데에는 유용 하지 않지만 광범위 한 문제를 디버깅 하는 경우에도 중요 합니다. 응용 프로그램이 특정 오류 로부터 복구 될 수 있지만 문제를 해결 하기 위해 코드를 변경 해야 하는 광범위 한 디자인 문제를 힌트 할 수 있습니다. 
> 
> 이 문서에서 설명 하는 오류 조건을 구현할 때 앞에서 설명한 이유에 대 한 오류 코드 및 설명을 기록해 야 합니다. 로깅 코드의 예제는 [오류 및 로깅 참조](#error-and-logging-reference) 를 참조 하세요. 
>

## <a name="acquiretokensilent"></a>AcquireTokenSilent

AcquireTokenSilent는 최종 사용자에 게 UI (사용자 인터페이스)가 표시 되지 않도록 보장 하는 토큰을 가져오려고 시도 합니다. 자동 획득이 실패 하 고 대화형 요청 또는 기본 처리기를 통해 처리 해야 하는 여러 가지 경우가 있습니다. 다음 섹션에서 각 사례를 사용 하는 시기와 방법을 자세히 살펴보겠습니다.

운영 체제에 의해 생성 된 오류 집합이 있으며,이로 인해 응용 프로그램에 특정 한 오류 처리가 필요할 수 있습니다. 자세한 내용은 [오류 및 로깅 참조](#error-and-logging-reference)의 "운영 체제" 오류 섹션을 참조 하세요. 

### <a name="application-scenarios"></a>Alkalmazáshasználati helyzetek

- [네이티브 클라이언트](developer-glossary.md#native-client) 응용 프로그램 (IOS, Android, .net 데스크톱 또는 Xamarin)
- [리소스](developer-glossary.md#resource-server) 를 호출 하는 [웹 클라이언트](developer-glossary.md#web-client) 응용 프로그램 (.net)

### <a name="error-cases-and-actionable-steps"></a>오류 사례 및 실행 가능한 단계

기본적으로 AcquireTokenSilent 오류에는 두 가지 사례가 있습니다.

| 사례 | Leírás |
|------|-------------|
| **사례 1**: 대화형 로그인으로 오류를 확인할 수 있습니다. | 유효한 토큰이 부족 하 여 발생 하는 오류의 경우 대화형 요청이 필요 합니다. 특히 캐시 조회와 잘못 된/만료 된 새로 고침 토큰을 확인 하려면 AcquireToken를 호출 해야 합니다.<br><br>이러한 경우 최종 사용자에 게 로그인 하 라는 메시지가 표시 되어야 합니다. 응용 프로그램은 최종 사용자 상호 작용 (예: 로그인 단추 적중) 이상 후 대화형 요청을 즉시 수행 하도록 선택할 수 있습니다. 선택은 응용 프로그램의 원하는 동작에 따라 달라 집니다.<br><br>이 특정 사례와 진단 오류에 대해서는 다음 섹션의 코드를 참조 하세요.|
| **사례 2**: 대화형 로그인으로 오류를 확인할 수 없음 | 네트워크 및 임시/임시 오류가 발생 하거나 기타 오류가 발생 하는 경우 대화형 AcquireToken 요청을 수행 해도 문제가 해결 되지 않습니다. 불필요 한 대화형 로그인 프롬프트는 최종 사용자를 불편 수도 있습니다. ADAL은 AcquireTokenSilent 실패 시 대부분의 오류에 대해 자동으로 단일 재시도를 시도 합니다.<br><br>클라이언트 응용 프로그램은 나중에 다시 시도를 시도할 수도 있지만 응용 프로그램 동작 및 원하는 최종 사용자 환경에 따라가 달라 지는 시기와 방법을 보여 줍니다. 예를 들어 응용 프로그램은 몇 분 후 또는 일부 최종 사용자 동작에 대 한 응답으로 AcquireTokenSilent을 다시 시도할 수 있습니다. 즉시 다시 시도 하면 응용 프로그램이 제한 되며 시도 하지 않아야 합니다.<br><br>동일한 오류가 발생 해도 후속 재시도는 오류를 해결 하지 않으므로 클라이언트가 AcquireToken를 사용 하 여 대화형 요청을 수행 해야 한다는 것을 의미 하지는 않습니다.<br><br>이 특정 사례와 진단 오류에 대해서는 다음 섹션의 코드를 참조 하세요. |

### <a name="net"></a>.NET

다음 지침에서는 ADAL 메서드와 함께 오류 처리에 대 한 예제를 제공 합니다. 

- acquireTokenSilentAsync(...)
- acquireTokenSilentSync(...) 
- [사용 되지 않음] acquireTokenSilent (...)
- [사용 되지 않음] acquireTokenByRefreshToken (...) 

코드는 다음과 같이 구현 됩니다.

```csharp
try{
    AcquireTokenSilentAsync(…);
} 

catch (AdalSilentTokenAcquisitionException e) {
    // Exception: AdalSilentTokenAcquisitionException
    // Caused when there are no tokens in the cache or a required refresh failed. 

    // Action: Case 1, resolvable with an interactive request. 
} 

catch(AdalServiceException e) {
    // Exception: AdalServiceException 
    // Represents an error produced by the STS. 
    // e.ErrorCode contains the error code and description, which can be used for debugging. 
    // NOTE: Do not code a dependency on the contents of the error description, as it can change over time.

    // Action: Case 2, not resolvable with an interactive request.
    // Attempt retry after a timed interval or user action.
} 
    
catch (AdalException e) {
    // Exception: AdalException 
    // Represents a library exception generated by ADAL .NET. 
    // e.ErrorCode contains the error code. 

    // Action: Case 2, not resolvable with an interactive request.
    // Attempt retry after a timed interval or user action.
    // Example Error: network_not_available, default case.
}
```

### <a name="android"></a>Android

다음 지침에서는 ADAL 메서드와 함께 오류 처리에 대 한 예제를 제공 합니다. 

- acquireTokenSilentSync(...)
- acquireTokenSilentAsync(...)
- [사용 되지 않음] acquireTokenSilent (...)

코드는 다음과 같이 구현 됩니다.

```java
// *Inside callback*
public void onError(Exception e) {

    if (e instanceof AuthenticationException) {
        // Exception: AdalException
        // Represents a library exception generated by ADAL Android.
        // Error Code: e.getCode().

        // Errors: ADALError.ERROR_SILENT_REQUEST,
        // ADALError.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED,
        // ADALError.INVALID_TOKEN_CACHE_ITEM
        // Description: Request failed due to no tokens in
        // cache or failed a required refresh. 

        // Action: Case 1, resolvable with an interactive request. 

        // Action: Case 2, not resolvable with an interactive request.
        // Attempt retry after a timed interval or user action.
        // Example Errors: default case,
        // DEVICE_CONNECTION_IS_NOT_AVAILABLE, 
        // BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN,
    }
}
```

### <a name="ios"></a>iOS

다음 지침에서는 ADAL 메서드와 함께 오류 처리에 대 한 예제를 제공 합니다. 

- acquireTokenSilentWithResource(...)

코드는 다음과 같이 구현 됩니다.

```objc
[context acquireTokenSilentWithResource:[ARGS], completionBlock:^(ADAuthenticationResult *result) {
    if (result.status == AD_FAILED) {
        if ([error.domain isEqualToString:ADAuthenticationErrorDomain]){
            // Exception: AD_FAILED 
            // Represents a library error generated by ADAL Objective-C.
            // Error Code: result.error.code

            // Errors: AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED, AD_ERROR_CACHE_NO_REFRESH_TOKEN
            // Description: No tokens in cache or failed a required token refresh failed. 
            // Action: Case 1, resolvable with an interactive request. 

            // Error: AD_ERROR_CACHE_MULTIPLE_USERS
            // Description: There was ambiguity in the silent request resulting in multiple cache items.
            // Action: Special Case, application should perform another silent request and specify the user using ADUserIdentifier. 
            // Can be caused in cases of a multi-user application. 

            // Action: Case 2, not resolvable with an interactive request.
            // Attempt retry after some time or user action.
            // Example Errors: default case,
            // AD_ERROR_CACHE_BAD_FORMAT
        }
    }
}]
```

## <a name="acquiretoken"></a>AcquireToken

AcquireToken는 토큰을 가져오는 데 사용 되는 기본 ADAL 메서드입니다. 사용자 id가 필요한 경우 AcquireToken는 먼저 토큰을 자동으로 가져오려고 시도한 다음 필요한 경우 UI를 표시 합니다 (PromptBehavior가 전달 되지 않는 경우). 응용 프로그램 id가 필요한 경우 AcquireToken는 토큰을 가져오려고 시도 하지만 최종 사용자가 없기 때문에 UI를 표시 하지 않습니다. 

AcquireToken 오류를 처리할 때 오류 처리는 응용 프로그램이 얻으려는 플랫폼과 시나리오에 따라 달라 집니다. 

운영 체제는 특정 응용 프로그램에 종속 된 오류를 처리 해야 하는 오류 집합을 생성할 수도 있습니다. 자세한 내용은 [오류 및 로깅 참조](#error-and-logging-reference)의 "운영 체제 오류"를 참조 하십시오. 

### <a name="application-scenarios"></a>Alkalmazáshasználati helyzetek

- 네이티브 클라이언트 응용 프로그램 (iOS, Android, .NET 데스크톱 또는 Xamarin)
- 리소스 API를 호출 하는 웹 응용 프로그램 (.NET)
- 단일 페이지 응용 프로그램 (JavaScript)
- 서비스 간 응용 프로그램 (.NET, Java)
  - 다음을 포함 하 여 모든 시나리오
  - 특정 시나리오를 대신해 서

### <a name="error-cases-and-actionable-steps-native-client-applications"></a>오류 사례 및 실행 가능한 단계: Native client 응용 프로그램

Native client 응용 프로그램을 빌드하는 경우 네트워크 문제, 일시적인 오류 및 기타 플랫폼별 오류와 관련 된 몇 가지 오류 처리 사례를 고려해 야 합니다. 대부분의 경우 응용 프로그램은 즉시 다시 시도를 수행 하지 않고 로그인을 요청 하는 최종 사용자 조작이 대기 합니다. 

한 번의 재시도로 문제를 해결할 수 있는 몇 가지 특수 한 경우가 있습니다. 예를 들어 사용자가 장치에서 데이터를 사용 하도록 설정 하거나 초기 실패 후 Azure AD broker 다운로드를 완료 해야 하는 경우입니다. 

오류가 발생 하는 경우 응용 프로그램은 최종 사용자가 재시도를 요청 하는 일부 상호 작용을 수행할 수 있도록 UI를 제공할 수 있습니다. 예를 들어 장치에서 오프 라인 오류로 인해 실패 한 경우 오류를 즉시 다시 시도 하지 않고 AcquireToken 재시도를 표시 하는 "다시 로그인 해 보세요." 단추를 표시 합니다. 

네이티브 응용 프로그램의 오류 처리는 다음 두 가지 경우에 정의 될 수 있습니다.

|  |  |
|------|-------------|
| **사례 1**:<br>다시 시도할 수도 없는 오류 (대부분의 경우) | 1. 즉각적인 재시도를 시도 하지 않습니다. 다시 시도를 호출 하는 특정 오류 (예: "다시 로그인 시도" 또는 "Azure AD broker 응용 프로그램 다운로드")를 기반으로 최종 사용자 UI를 표시 합니다. |
| **사례 2**:<br>다시 시도 가능한 오류 | 1. 최종 사용자가 성공 하는 상태를 입력 했을 수 있으므로 단일 재시도를 수행 합니다.<br><br>2. 다시 시도에 실패 하는 경우 다시 시도를 호출 하는 특정 오류 ("다시 로그인 시도", "Azure AD broker 앱 다운로드" 등)를 기반으로 최종 사용자 UI를 표시 합니다. |

> [!IMPORTANT]
> 자동 호출에서 ADAL에 사용자 계정이 전달 되 고 오류가 발생 하는 경우 후속 대화형 요청을 통해 최종 사용자는 다른 계정을 사용 하 여 로그인 할 수 있습니다. 사용자 계정을 사용 하 여 성공적으로 AcquireToken 된 후 응용 프로그램에서 로그인 한 사용자가 응용 프로그램의 로컬 사용자 개체와 일치 하는지 확인 해야 합니다. 불일치는 예외를 생성 하지 않습니다 (목표 C에서는 제외). 하지만 인증 요청 이전에 사용자가 로컬로 알려진 경우 (예: 실패 한 자동 호출) 고려해 야 합니다.
>

#### <a name="net"></a>.NET

다음 지침에서는 모든 비 자동 AcquireToken (...)와 함께 오류 처리에 대 한 예제를 제공 합니다. 다음을 *제외한*ADAL 메서드: 

- AcquireTokenAsync (..., IClientAssertionCertification, ...)
- AcquireTokenAsync (..., ClientCredential, ...)
- AcquireTokenAsync (..., ClientAssertion, ...)
- AcquireTokenAsync (..., UserAssertion,...)   

코드는 다음과 같이 구현 됩니다.

```csharp
try {
    AcquireTokenAsync(…);
} 
    
catch(AdalServiceException e) {
    // Exception: AdalServiceException 
    // Represents an error produced by the STS. 
    // e.ErrorCode contains the error code and description, which can be used for debugging. 
    // NOTE: Do not code a dependency on the contents of the error description, as it can change over time.
    
    // Design time consideration: Certain errors may be caused at development and exposed through this exception. 
    // Looking inside the description will give more guidance on resolving the specific issue. 

    // Action: Case 1: Non-Retryable 
    // Do not perform an immediate retry. Only retry after user action. 
    // Example Errors: default case

    } 

catch (AdalException e) {
    // Exception: AdalException 
    // Represents a library exception generated by ADAL .NET.
    // e.ErrorCode contains the error code

    // Action: Case 1, Non-Retryable 
    // Do not perform an immediate retry. Only retry after user action. 
    // Example Errors: network_not_available, default case
}
```

> [!NOTE]
> ADAL .NET은 AcquireTokenSilent와 같은 동작을 포함 하는 PromptBehavior를 지원 하므로 추가 고려 사항이 있습니다.
>

다음 지침에서는 ADAL 메서드와 함께 오류 처리에 대 한 예제를 제공 합니다. 

- acquireToken (..., PromptBehavior)

코드는 다음과 같이 구현 됩니다.

```csharp
    try {acquireToken(…, PromptBehavior.Never);
    } 

catch(AdalServiceException e) {
    // Exception: AdalServiceException represents 
    // Represents an error produced by the STS. 
    // e.ErrorCode contains the error code and description, which can be used for debugging. 
    // NOTE: Do not code a dependency on the contents of the error description, as it can change over time.

    // Action: Case 1: Non-Retryable 
    // Do not perform an immediate retry. Only retry after user action. 
    // Example Errors: default case

} catch (AdalException e) {
    // Error Code: e.ErrorCode == "user_interaction_required"
    // Description: user_interaction_required indicates the silent request failed 
    // in a way that's resolvable with an interactive request.
    // Action: Resolvable with an interactive request. 

    // Action: Case 1, Non-Retryable 
    // Do not perform an immediate retry. Only retry after user action. 
    // Example Errors: network_not_available, default case
}
```

#### <a name="android"></a>Android

다음 지침에서는 모든 비 자동 AcquireToken (...)와 함께 오류 처리에 대 한 예제를 제공 합니다. ADAL 메서드. 

코드는 다음과 같이 구현 됩니다.

```java
AcquireTokenAsync(…);

// *Inside callback*
public void onError(Exception e) {
    if (e instanceof AuthenticationException) {
        // Exception: AdalException 
        // Represents a library exception generated by ADAL Android.
        // Error Code: e.getCode();

        // Error: ADALError.BROKER_APP_INSTALLATION_STARTED
        // Description: Broker app not installed, user will be prompted to download the app. 

        // Action: Case 2, Retriable Error 
        // Perform a single retry. If that fails, only try again after user action. 

        // Action: Case 1, Non-Retriable 
        // Do not perform an immediate retry. Only retry after user action. 
        // Example Errors: default case, DEVICE_CONNECTION_IS_NOT_AVAILABLE
    }
}
```

#### <a name="ios"></a>iOS

다음 지침에서는 모든 비 자동 AcquireToken (...)와 함께 오류 처리에 대 한 예제를 제공 합니다. ADAL 메서드. 

코드는 다음과 같이 구현 됩니다.

```objc
[context acquireTokenWithResource:[ARGS], completionBlock:^(ADAuthenticationResult *result) {
    if (result.status == AD_FAILED) {
        if ([error.domain isEqualToString:ADAuthenticationErrorDomain]){
            // Exception: AD_FAILED 
            // Represents a library error generated by ADAL ObjC.
            // Error Code: result.error.code 

            // Error: AD_ERROR_SERVER_WRONG_USER
            // Description: App passed a user into ADAL and the end user signed in with a different account. 
            // Action: Case 1, Non-retriable (as is) and up to the application on how to handle this case. 
            // It can attempt a new request without specifying the user, or use UI to clarify the user account to sign in. 

            // Action: Case 1, Non-Retriable 
            // Do not perform an immediate retry. Only retry after user action. 
            // Example Errors: default case
        }
    }
}]
```

### <a name="error-cases-and-actionable-steps-web-applications-that-call-a-resource-api-net"></a>오류 사례 및 실행 가능한 단계: 리소스 API를 호출 하는 웹 응용 프로그램 (.NET)

를 호출 하는 .NET 웹 앱을 빌드하는 경우 리소스에 대 한 권한 부여 코드를 사용 하 여 토큰을 가져옵니다. 필요한 유일한 코드는 일반 사례에 대 한 기본 처리기입니다. 

다음 지침에서는 ADAL 메서드와 함께 오류 처리에 대 한 예제를 제공 합니다. 

- AcquireTokenByAuthorizationCodeAsync(...)

코드는 다음과 같이 구현 됩니다.

```csharp
try {
    AcquireTokenByAuthorizationCodeAsync(…);
} 

catch (AdalException e) {
    // Exception: AdalException
    // Represents a library exception generated by ADAL .NET.
    // Error Code: e.ErrorCode

    // Action: Do not perform an immediate retry. Only try again after user action or wait until much later. 
    // Example Errors: default case
}
```

### <a name="error-cases-and-actionable-steps-single-page-applications-adaljs"></a>오류 사례 및 실행 가능한 단계: 단일 페이지 응용 프로그램 (adal .js)

AcquireToken를 통해 adal을 사용 하 여 단일 페이지 응용 프로그램을 빌드하는 경우 오류 처리 코드는 일반적인 자동 호출의 경우와 비슷합니다. 특히 adal에서 AcquireToken는 UI를 표시 하지 않습니다. 

실패 한 AcquireToken에는 다음과 같은 경우가 있습니다.

|  |  |
|------|-------------|
| **사례 1**:<br>대화형 요청으로 확인할 때 확인 가능 | 1. 로그인 ()이 실패 하면 즉시 다시 시도 하지 마십시오. 사용자 작업 후 다시 시도만 다시 시도 하 라는 메시지를 표시 합니다.|
| **사례 2**:<br>대화형 요청을 통해 확인할 수 없습니다. 오류를 다시 시도할 수 있습니다. | 1. 최종 사용자의 주요 작업이 성공 하는 상태를 입력 하 여 한 번의 재시도를 수행 합니다.<br><br>2. 다시 시도에 실패 하는 경우 다시 시도를 호출할 수 있는 특정 오류에 따라 최종 사용자에 게 작업을 표시 합니다 ("다시 로그인 시도"). |
| **사례 3**:<br>대화형 요청을 통해 확인할 수 없습니다. 오류를 다시 시도할 수 없습니다. | 1. 즉각적인 재시도를 시도 하지 않습니다. 다시 시도를 호출할 수 있는 특정 오류에 따라 작업을 최종 사용자에 게 표시 합니다 ("다시 로그인 시도"). |

코드는 다음과 같이 구현 됩니다.

```javascript
AuthContext.acquireToken(…, function(error, errorDesc, token) {
    if (error || errorDesc) {
        // Represents any token acquisition failure that occurred. 
        // Error Code: error.indexOf("<ERROR_STRING>")

        // Errors: if (error.indexOf("interaction_required"))
        //         if (error.indexOf("login required"))
        // Description: ADAL wasn't able to silently acquire a token because of expire or fresh session. 
        // Action: Case 1, Resolvable with an interactive login() request. 

        // Error: if (error.indexOf("Token Renewal Failed")) 
        // Description: Timeout when refreshing the token.
        // Action: Case 2, Not resolvable interactively, error is retriable.
        // Perform a single retry. Only try again after user action.

        // Action: Case 3, Not resolvable interactively, error is not retriable. 
        // Do not perform an immediate retry. Only retry after user action.
        // Example Errors: default case
    }
}
```

### <a name="error-cases-and-actionable-steps-service-to-service-applications-net-only"></a>오류 사례 및 실행 가능한 단계: 서비스 간 응용 프로그램 (.NET만 해당)

AcquireToken를 사용 하는 서비스 간 응용 프로그램을 작성 하는 경우 코드에서 처리 해야 하는 몇 가지 주요 오류가 있습니다. 오류 못해 유일한 방법은 호출 하는 앱으로 오류를 반환 하거나 (사례를 대신해 서) 다시 시도 전략을 적용 하는 것입니다. 

#### <a name="all-scenarios"></a>Az összes forgatókönyv

*모든* 서비스 간 응용 프로그램 시나리오의 경우:

- 즉시 재시도를 시도 하지 마세요. ADAL은 실패 한 특정 요청에 대해 단일 재시도를 시도 합니다. 
- 사용자 또는 앱 작업에 다시 시도 하 라는 메시지가 표시 된 후에만 계속 다시 시도 합니다. 예를 들어 일부 설정 된 간격에 대해 작업을 수행 하는 디먼 응용 프로그램은 다시 시도할 다음 간격까지 대기 해야 합니다.

다음 지침에서는 ADAL 메서드와 함께 오류 처리에 대 한 예제를 제공 합니다. 

- AcquireTokenAsync (..., IClientAssertionCertification, ...)
- AcquireTokenAsync (..., ClientCredential, ...)
- AcquireTokenAsync (..., ClientAssertion, ...)
- AcquireTokenAsync (..., UserAssertion, ...)

코드는 다음과 같이 구현 됩니다.

```csharp
try {
    AcquireTokenAsync(…);
} 

catch (AdalException e) {
    // Exception: AdalException
    // Represents a library exception generated by ADAL .NET.
    // Error Code: e.ErrorCode

    // Action: Do not perform an immediate retry. Only try again after user action (if applicable) or wait until much later. 
    // Example Errors: default case
}  
```

#### <a name="on-behalf-of-scenarios"></a>시나리오를 대신해 서

서비스 간 응용 프로그램 시나리오를 *대신해* 서

다음 지침에서는 ADAL 메서드와 함께 오류 처리에 대 한 예제를 제공 합니다. 

- AcquireTokenAsync (..., UserAssertion, ...)

코드는 다음과 같이 구현 됩니다.

```csharp
try {
AcquireTokenAsync(…);
} 

catch (AdalServiceException e) {
    // Exception: AdalServiceException 
    // Represents an error produced by the STS. 
    // e.ErrorCode contains the error code and description, which can be used for debugging. 
    // NOTE: Do not code a dependency on the contents of the error description, as it can change over time.

    // Error: On-Behalf-Of Error Handler
    if (e.ErrorCode == "interaction_required") {
        // Description: The client needs to perform some action due to a config from admin. 
        // Action: Capture `claims` parameter inside ex.InnerException.InnerException.
        // Generate HTTP error 403 with claims, throw back HTTP error to client.
        // Wait for client to retry. 
    }
} 
        
catch (AdalException e) {
    // Exception: AdalException 
    // Represents a library exception generated by ADAL .NET.
    // Error Code: e.ErrorCode

    // Action: Do not perform an immediate retry. Only try again after user action (if applicable) or wait until much later. 
    // Example Error: default case
}
```

이 시나리오를 보여 주는 [전체 샘플](https://github.com/Azure-Samples/active-directory-dotnet-webapi-onbehalfof-ca) 을 빌드 했습니다.

## <a name="error-and-logging-reference"></a>오류 및 로깅 참조

### <a name="logging-personal-identifiable-information--organizational-identifiable-information"></a>조직에서 식별 가능한 정보 & 개인 식별이 가능한 정보 로깅 
기본적으로 ADAL 로깅은 개인 식별이 가능한 정보나 조직에서 식별할 수 있는 정보를 캡처하거나 기록 하지 않습니다. 라이브러리를 사용 하면 앱 개발자가로 거 클래스의 setter를 통해이를 설정할 수 있습니다. 개인 식별이 가능한 정보 또는 조직의 식별 가능한 정보를 기록 하 여 앱은 매우 중요 한 데이터를 안전 하 게 처리 하 고 규정 요구 사항을 준수 합니다.

### <a name="net"></a>.NET

#### <a name="adal-library-errors"></a>ADAL 라이브러리 오류

특정 ADAL 오류를 탐색 하기 위해 [azure-activedirectory 리포지토리](https://github.com/AzureAD/azure-activedirectory-library-for-dotnet/blob/8f6d560fbede2247ec0e217a21f6929d4375dcaa/src/ADAL.PCL/Utilities/Constants.cs#L58) 의 소스 코드는 최상의 오류 참조입니다.

#### <a name="guidance-for-error-logging-code"></a>오류 로깅 코드에 대 한 지침

ADAL .NET 로깅은 작업 중인 플랫폼에 따라 달라 집니다. 로깅을 사용 하도록 설정 하는 방법에 대 한 코드는 [로깅 wiki](https://github.com/AzureAD/azure-activedirectory-library-for-dotnet/wiki/Logging-in-ADAL.Net) 를 참조 하세요.

### <a name="android"></a>Android

#### <a name="adal-library-errors"></a>ADAL 라이브러리 오류

특정 ADAL 오류를 탐색 하기 위해 [azure-activedirectory 리포지토리의](https://github.com/AzureAD/azure-activedirectory-library-for-android/blob/dev/adal/src/main/java/com/microsoft/aad/adal/ADALError.java#L33) 소스 코드는 최상의 오류 참조입니다.

#### <a name="operating-system-errors"></a>운영 체제 오류

Android OS 오류는 ADAL의 AuthenticationException을 통해 노출 되 고, "SERVER_INVALID_REQUEST"로 식별 되며, 오류 설명을 통해 보다 세분화 할 수 있습니다. 

일반적인 오류의 전체 목록과 앱 또는 최종 사용자가 발견할 때 수행할 단계는 [ADAL Android Wiki](https://github.com/AzureAD/azure-activedirectory-library-for-android/wiki)를 참조 하세요. 

#### <a name="guidance-for-error-logging-code"></a>오류 로깅 코드에 대 한 지침

```java
// 1. Configure Logger
Logger.getInstance().setExternalLogger(new ILogger() {    
    @Override   
    public void Log(String tag, String message, String additionalMessage, LogLevel level, ADALError errorCode) { 
    // …
    // You can write this to logfile depending on level or errorcode. 
    writeToLogFile(getApplicationContext(), tag +":" + message + "-" + additionalMessage);    
    }
}

// 2. Set the log level
Logger.getInstance().setLogLevel(Logger.LogLevel.Verbose);

// By default, the `Logger` does not capture any PII or OII

// PII or OII will be logged
Logger.getInstance().setEnablePII(true);

// To STOP logging PII or OII, use the following setter
Logger.getInstance().setEnablePII(false);


// 3. Send logs to logcat.
adb logcat > "C:\logmsg\logfile.txt";
```

### <a name="ios"></a>iOS

#### <a name="adal-library-errors"></a>ADAL 라이브러리 오류

특정 ADAL 오류를 탐색 하기 위해 [azure-activedirectory-objc 리포지토리의](https://github.com/AzureAD/azure-activedirectory-library-for-objc/blob/dev/ADAL/src/ADAuthenticationError.m#L295) 소스 코드는 최상의 오류 참조입니다.

#### <a name="operating-system-errors"></a>운영 체제 오류

사용자가 웹 보기를 사용 하 고 인증의 특성을 사용 하는 경우 로그인 중에 iOS 오류가 발생할 수 있습니다. 이 오류는 SSL 오류, 시간 초과 또는 네트워크 오류와 같은 조건으로 인해 발생할 수 있습니다.

- 자격 공유의 경우 로그인이 영구적이 지 않으며 캐시가 비어 있는 것으로 나타납니다. 키 집합에 다음 코드 줄을 추가 하 여 해결할 수 있습니다. `[[ADAuthenticationSettings sharedInstance] setSharedCacheKeychainGroup:nil];`
- NsUrlDomain 오류 집합의 경우 앱 논리에 따라 작업이 변경 됩니다. 처리할 수 있는 특정 인스턴스에 대 한 [NSURLErrorDomain 참조 설명서](https://developer.apple.com/documentation/foundation/nsurlerrordomain#declarations) 를 참조 하세요.
- Adal 목표-C 팀에서 유지 관리 하는 일반적인 오류 목록은 [Adal Obj-c 일반적인 문제](https://github.com/AzureAD/azure-activedirectory-library-for-objc#adauthenticationerror) 를 참조 하세요.

#### <a name="guidance-for-error-logging-code"></a>오류 로깅 코드에 대 한 지침

```objc
// 1. Enable NSLogging
[ADLogger setNSLogging:YES];

// 2. Set the log level (if you want verbose)
[ADLogger setLevel:ADAL_LOG_LEVEL_VERBOSE];

// 3. Set up a callback block to simply print out
[ADLogger setLogCallBack:^(ADAL_LOG_LEVEL logLevel, NSString *message, NSString *additionalInformation, NSInteger errorCode, NSDictionary *userInfo) {
     NSString* log = [NSString stringWithFormat:@"%@ %@", message, additionalInformation];    
     NSLog(@"%@", log);
}];
```

### <a name="guidance-for-error-logging-code---javascript"></a>오류 로깅 코드에 대 한 지침-JavaScript 

```javascript
0: Error1: Warning2: Info3: Verbose
window.Logging = {
    level: 3,
    log: function (message) {
        console.log(message);
    }
};
```

## <a name="related-content"></a>관련 내용

* [Azure AD 개발자 가이드][AAD-Dev-Guide]
* [Azure AD 인증 라이브러리][AAD-Auth-Libraries]
* [Azure AD 인증 시나리오][AAD-Auth-Scenarios]
* [Azure Active Directory와 응용 프로그램 통합][AAD-Integrating-Apps]

다음 설명 섹션을 사용 하 여 피드백을 제공 하 고 콘텐츠를 구체화 하 고 모양을 돕습니다.

[!["Microsoft에 로그인" 단추를 표시 합니다.][AAD-Sign-In]][AAD-Sign-In]
<!--Reference style links -->

[AAD-Auth-Libraries]: ./active-directory-authentication-libraries.md
[AAD-Auth-Scenarios]:v1-authentication-scenarios.md
[AAD-Dev-Guide]:azure-ad-developers-guide.md
[AAD-Integrating-Apps]:quickstart-v1-integrate-apps-with-azure-ad.md
[AZURE-portal]: https://portal.azure.com

<!--Image references-->
[AAD-Sign-In]:./media/active-directory-devhowto-multi-tenant-overview/sign-in-with-microsoft-light.png

