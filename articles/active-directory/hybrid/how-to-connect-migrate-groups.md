---
title: 'Azure AD Connect: 한 포리스트에서 다른 포리스트로 그룹 마이그레이션'
description: 이 문서에서는 Azure AD Connect 위해 한 포리스트에서 다른 포리스트로 그룹을 성공적으로 마이그레이션하는 데 필요한 단계를 설명 합니다.
services: active-directory
author: billmath
manager: daveba
ms.service: active-directory
ms.topic: how-to
ms.workload: identity
ms.date: 04/02/2020
ms.subservice: hybrid
ms.author: billmath
ms.collection: M365-identity-device-management
ms.openlocfilehash: 5ef693a48dc52854e4e1fd8359ef24f65ce236f7
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 10/09/2020
ms.locfileid: "85358585"
---
# <a name="migrate-groups-from-one-forest-to-another-for-azure-ad-connect"></a>Azure AD Connect 위해 한 포리스트에서 다른 포리스트로 그룹 마이그레이션

이 문서에서는 마이그레이션된 그룹 개체가 클라우드의 기존 개체와 일치 하도록 한 포리스트에서 다른 포리스트로 그룹을 마이그레이션하는 방법을 설명 합니다.

## <a name="prerequisites"></a>사전 요구 사항

- Azure AD Connect 버전 1.5.18.0 이상
- 원본 앵커 특성이로 설정 됩니다. `mS-DS-ConsistencyGuid`

## <a name="migrate-groups"></a>그룹 마이그레이션

1.5.18.0 버전부터 Azure AD Connect는 `mS-DS-ConsistencyGuid` 그룹에 대 한 특성 사용을 지원 합니다. 를 `mS-DS-ConsistencyGuid` 원본 앵커 특성으로 선택 하 고 값이 Active Directory 채워진 경우 Azure AD Connect는 값을로 사용 합니다 `mS-DS-ConsistencyGuid` `immutableId` . 그렇지 않으면를 사용 하는 것으로 대체 `objectGUID` 됩니다. 그러나 Azure AD Connect는 Active Directory의 특성에 값을 다시 쓰지 않습니다 `mS-DS-ConsistencyGuid` .

크로스 포리스트 이동 중에 그룹 개체가 한 포리스트 (예를 들어, F1)에서 다른 포리스트 (F2)로 이동 하는 경우 `mS-DS-ConsistencyGuid` 값 (있는 경우) 또는 `objectGUID` 포리스트 F1의 개체 값을 `mS-DS-ConsistencyGuid` f2의 개체 특성에 복사 해야 합니다.

다음 스크립트를 지침으로 사용 하 여 한 포리스트에서 다른 포리스트로 단일 그룹을 마이그레이션하는 방법을 알아봅니다. 이러한 스크립트를 여러 그룹의 마이그레이션에 대 한 지침으로 사용할 수도 있습니다. 스크립트는 원본 포리스트에 대해 포리스트 이름 F1를 사용 하 고 대상 포리스트에는 F2를 사용 합니다.

먼저 `objectGUID` `mS-DS-ConsistencyGuid` 포리스트 F1에서 group 개체의 및를 가져옵니다. 이러한 특성은 CSV 파일로 내보내집니다.
```
<#
DESCRIPTION
============
This script will take DN of a group as input.
It then copies the objectGUID and mS-DS-ConsistencyGuid values along with other attributes of the given group to a CSV file.

This CSV file can then be used as input to the Export-Group script.
#>
Param(
       [ValidateNotNullOrEmpty()]
       [string]
       $dn,

       [ValidateNotNullOrEmpty()]
       [string]
       $outputCsv
)

$defaultProperties = @('samAccountName', 'distinguishedName', 'objectGUID', 'mS-DS-ConsistencyGuid')
$group  = Get-ADGroup -Filter "DistinguishedName -eq '$dn'" -Properties $defaultProperties -ErrorAction Stop
$results = @()
if ($group -eq $null)
{
       Write-Error "Group not found"
}
else
{
       $objectGUIDValue = [GUID]$group.'objectGUID'
       $mSDSConsistencyGuidValue = "N/A"
       if ($group.'mS-DS-ConsistencyGuid' -ne $null)
       {
              $mSDSConsistencyGuidValue = [GUID]$group.'mS-DS-ConsistencyGuid'
       }
       $adgroup = New-Object -TypeName PSObject
       $adgroup | Add-Member -MemberType NoteProperty -Name samAccountName -Value $($group.'samAccountName')
       $adgroup | Add-Member -MemberType NoteProperty -Name distinguishedName -Value $($group.'distinguishedName')
       $adgroup | Add-Member -MemberType NoteProperty -Name objectGUID -Value $($objectGUIDValue)
       $adgroup | Add-Member -MemberType NoteProperty -Name mS-DS-ConsistencyGuid -Value $($mSDSConsistencyGuidValue)
       $results += $adgroup
}

Write-Host "Exporting group to output file"
$results | Export-Csv "$outputCsv" -NoTypeInformation

```

그런 다음 생성 된 출력 CSV 파일을 사용 하 여 `mS-DS-ConsistencyGuid` 포리스트 F2의 대상 개체에 대 한 특성을 스탬프 합니다.


```
<#
DESCRIPTION
============
This script will take DN of a group as input and the CSV file that was generated by the Import-Group script.
It copies either the objectGUID or the mS-DS-ConsistencyGuid value from the CSV file to the given object.

#>
Param(
       [ValidateNotNullOrEmpty()]
       [string]
       $dn,

       [ValidateNotNullOrEmpty()]
       [string]
       $inputCsv
)

$group  = Get-ADGroup -Filter "DistinguishedName -eq '$dn'" -ErrorAction Stop
if ($group -eq $null)
{
       Write-Error "Group not found"
}

$csvFile = Import-Csv -Path $inputCsv -ErrorAction Stop
$msDSConsistencyGuid = $csvFile.'mS-DS-ConsistencyGuid'
$objectGuid = [GUID] $csvFile.'objectGUID'
$targetGuid = $msDSConsistencyGuid

if ($msDSConsistencyGuid -eq "N/A")
{
       $targetGuid = $objectGuid
}

Set-ADGroup -Identity $dn -Replace @{'mS-DS-ConsistencyGuid'=$targetGuid} -ErrorAction Stop

```

## <a name="next-steps"></a>다음 단계
[Azure Active Directory와 온-프레미스 id 통합](whatis-hybrid-identity.md)에 대해 자세히 알아보세요.
