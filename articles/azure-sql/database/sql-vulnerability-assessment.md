---
title: SQL 취약성 평가
titleSuffix: Azure SQL Database & SQL Managed Instance & Azure Synapse Analytics
description: SQL 취약성 평가를 구성 하 고 Azure SQL Database, Azure SQL Managed Instance 및 Azure Synapse 분석에 대 한 평가 보고서를 해석 하는 방법에 대해 알아봅니다.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=3
ms.devlang: ''
ms.topic: how-to
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 09/21/2020
tags: azure-synapse
ms.openlocfilehash: 67258a19d1efe605a3a0b2227f107cc1928a207a
ms.sourcegitcommit: 8245325f9170371e08bbc66da7a6c292bbbd94cc
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/07/2021
ms.locfileid: "99806395"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>SQL 취약성 평가는 데이터베이스 취약성을 식별 하는 데 도움이 됩니다.
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

SQL 취약성 평가는 잠재적인 데이터베이스 취약성을 검색, 추적 및 수정할 수 있는 간편한 구성 서비스입니다. 이 도구를 사용하여 데이터베이스 보안을 사전에 강화하세요.

취약성 평가는 고급 SQL 보안 기능을 위한 통합 패키지인 [sql 용 Azure Defender](azure-defender-for-sql.md) 제공의 일부입니다. 취약성 평가는 SQL 포털의 중앙 Azure Defender를 통해 액세스 하 고 관리할 수 있습니다.

> [!NOTE]
> 취약점 평가는 Azure SQL Database, Azure SQL Managed Instance 및 Azure Synapse Analytics에 대해 지원 됩니다. Azure SQL Database, Azure SQL Managed Instance 및 Azure Synapse Analytics의 데이터베이스는이 문서의 나머지 부분에서 전체적으로 참조 되며 서버는 Azure SQL Database 및 Azure Synapse에 대 한 데이터베이스를 호스트 하는 [서버](logical-servers.md) 를 참조 합니다.

## <a name="what-is-sql-vulnerability-assessment"></a>SQL 취약성 평가 란?

SQL 취약성 평가는 보안 상태에 대 한 가시성을 제공 하는 서비스입니다. 취약성 평가에는 보안 문제를 해결 하 고 데이터베이스 보안을 향상 시키기 위한 조치 가능한 단계가 포함 됩니다. 이를 통해 변경 내용을 추적 하 고 SQL 보안 상태를 개선 하기 어려운 동적 데이터베이스 환경을 모니터링할 수 있습니다.

취약성 평가는 Azure SQL Database에 기본 제공 되는 검색 서비스입니다. 서비스는 보안 취약성에 플래그를 지정 하는 규칙의 기술 자료를 채택 합니다. 잘못 된 오류, 과도 한 권한 및 보호 되지 않는 중요 데이터와 같은 모범 사례의 차이를 강조 표시 합니다.

규칙은 Microsoft의 모범 사례를 기반으로 하며 데이터베이스와 중요 한 데이터에 가장 큰 위험을 제시 하는 보안 문제에 중점을 둡니다. 데이터베이스 수준 문제와 서버 수준 보안 문제 (예: 서버 방화벽 설정 및 서버 수준 권한)를 다룹니다.

검색 결과에는 각 문제를 해결하는 실행 가능한 단계가 포함되며 해당하는 경우 사용자 지정된 재구성 스크립트가 제공됩니다. 에 대해 허용 가능한 기준을 설정 하 여 사용자 환경에 대 한 평가 보고서를 사용자 지정할 수 있습니다.

- 권한 구성
- 기능 구성
- 데이터베이스 설정

## <a name="configure-vulnerability-assessment"></a>취약성 평가 구성

다음 단계는 취약성 평가를 구성 합니다.

1. [Azure Portal](https://portal.azure.com)에서 AZURE SQL DATABASE, SQL Managed Instance 데이터베이스 또는 Azure Synapse 리소스로 이동 합니다.

2. **보안** 제목 아래에서 **Security Center** 를 선택 합니다.

3. 그런 다음 링크에서 **구성** 을 클릭 하 여 전체 서버 또는 관리 되는 인스턴스에 대해 Azure DEFENDER for SQL 설정 창을 엽니다.

    > [!NOTE]
    > SQL 취약성 평가를 위해서는 **sql 용 Azure Defender** 계획이 검색을 실행할 수 있어야 합니다. SQL 용 Azure Defender를 사용 하도록 설정 하는 방법에 대 한 자세한 내용은 [sql 용 Azure defender](azure-defender-for-sql.md)를 참조 하세요.

4. 서버 또는 관리 되는 인스턴스의 모든 데이터베이스에 대 한 검사 결과가 저장 되는 저장소 계정을 구성 합니다. 스토리지 계정에 대한 자세한 내용은 [Azure Storage 계정 정보](../../storage/common/storage-account-create.md)를 참조하세요.

    > [!NOTE]
    > 방화벽 및 Vnet의 취약성 평가 검사를 저장 하는 방법에 대 한 자세한 내용은 [저장소 취약성 평가 검사 결과, 방화벽 및 vnet 뒤에 액세스할 수 있는 저장소 계정](sql-database-vulnerability-assessment-storage.md)을 참조 하세요.

5. 일주일에 한 번씩 정기적 되풀이 검색을 자동으로 실행 하 여 변경 보안 구성 오류를 자동으로 검색 하도록 SQL 취약성 평가를 구성 합니다. 이렇게 하려면 저장소 계정 선택에서 **정기적인 되풀이 검색** 을 사용 하도록 설정 합니다. 검색 결과 요약은 **검색 보고서 보내기** 에서 제공 하는 전자 메일 주소로 전송 됩니다. 또한 **관리자 및 구독 소유자에 게 전자 메일 알림을 보내도록** 설정 하 여 관리자 및 구독 소유자에 게 전자 메일 알림을 보낼 수 있습니다.

6. SQL 취약성 평가는 필요할 때 검색을 실행할 수 있습니다. SQL 취약성 평가를 구성한 후에는 **검색** 을 선택 하 여 데이터베이스에서 취약성을 검색 합니다.

![데이터베이스 검색](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > 검색 작업은 간단하며 안전합니다. 실행 하는 데 몇 초 정도 걸리며 완전히 읽기 전용입니다. 데이터베이스를 변경 하지 않습니다.

## <a name="remediate-vulnerabilities"></a>취약성 해결

1. 검색이 완료 되 면 검색 보고서가 Azure Portal에 자동으로 표시 됩니다. 이 보고서는 보안 상태에 대 한 개요를 제공 합니다. 발견 된 문제 수 및 해당 심각도를 나열 합니다. 결과에는 모범 사례의 편차에 대 한 경고 및 데이터베이스 보안 주체 및 역할과 같은 보안 관련 설정의 스냅숏과 연결 된 사용 권한이 포함 됩니다.

![보고서 보기](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

2. 결과를 검토하고 보고서에서 환경의 실제 보안 문제를 나타내는 결과를 확인합니다. 실패 한 각 결과를 드릴 다운 하 여 결과의 영향과 각 보안 검사가 실패 한 이유를 파악 합니다. 보고서에서 제공 하는 조치 가능한 재구성 정보를 사용 하 여 문제를 해결 합니다.

![보고서 분석](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

3. 평가 결과를 검토할 때 사용자 환경에서 특정 결과를 허용 가능한 *기준* 으로 표시할 수 있습니다. 기준은 기본적으로 결과를 보고하는 방법의 사용자 지정입니다. 기준과 일치하는 결과는 후속 검색을 통과하는 것으로 간주합니다. 기준 보안 상태를 설정한 후에는 취약성 평가에서 기준의 편차만 보고 합니다. 이러한 방식으로 관련 문제에 집중할 수 있습니다.

![기준 설정](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

4. **규칙 기준** 설정을 완료 한 후 새 검색을 실행 하 여 사용자 지정 된 보고서를 봅니다. 이제 취약점 평가는 승인 된 기준 상태에서 벗어난 보안 문제만 보고 합니다.

![사용자 지정 보고서 보기](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

이제 취약성 평가를 사용하여 데이터베이스가 항상 높은 수준의 보안을 유지하고 조직 정책을 충족하는지 모니터링할 수 있습니다. 

## <a name="advanced-capabilities"></a>고급 기능

### <a name="export-an-assessment-report"></a>평가 보고서 내보내기

검색 결과에 대 한 다운로드 가능한 Excel 보고서를 만들려면 **검색 결과 내보내기** 를 선택 합니다. 이 보고서에는 평가 요약이 표시 되는 요약 탭이 포함 되어 있습니다. 보고서에는 실패 한 검사가 모두 포함 됩니다. 검색 결과의 전체 집합을 포함 하는 **결과** 탭도 포함 됩니다. 결과에는 실행 된 모든 검사와 각 검사에 대 한 결과 정보가 포함 됩니다.

### <a name="view-scan-history"></a>검색 기록 보기

이 데이터베이스에서 이전에 실행 한 모든 검색 기록을 보려면 취약성 평가 창에서 **검색 기록** 을 선택 합니다. 자세한 검색 결과를 보려면 목록에서 특정 검색을 선택합니다.

## <a name="manage-vulnerability-assessments-programmatically"></a>프로그래밍 방식으로 취약성 평가 관리

### <a name="using-azure-powershell"></a>Azure PowerShell 사용

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> PowerShell Azure Resource Manager 모듈은 계속 지원 되지만 모든 향후 개발은 Az. Sql 모듈에 대 한 것입니다. 이러한 cmdlet은 [AzureRM.Sql](/powershell/module/AzureRM.Sql/)을 참조하세요. Az 모듈 및 AzureRm 모듈의 명령에 대한 인수는 실질적으로 동일합니다.

Azure PowerShell cmdlet을 사용하여 취약성 평가를 프로그래밍 방식으로 관리할 수 있습니다. 지원되는 cmdlet은 다음과 같습니다.

| 링크로 서의 Cmdlet 이름 | 설명 |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | 취약성 평가 규칙 기준을 지웁니다.<br/>먼저이 cmdlet을 사용 하 여 선택을 취소 하기 전에 기준선을 설정 합니다. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | 데이터베이스의 취약성 평가 설정을 지웁니다. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | 관리 되는 데이터베이스의 취약성 평가 규칙 기준을 지웁니다.<br/>먼저이 cmdlet을 사용 하 여 선택을 취소 하기 전에 기준선을 설정 합니다. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | 관리 되는 데이터베이스의 취약성 평가 설정을 지웁니다. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | 관리 되는 인스턴스의 취약성 평가 설정을 지웁니다. |
| [변환-AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | 데이터베이스의 취약성 평가 검사 결과를 Excel 파일로 변환 합니다. |
| [변환-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | 관리 되는 데이터베이스의 취약성 평가 검사 결과를 Excel 파일로 변환 합니다. |
| [AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | 지정 된 규칙에 대 한 데이터베이스의 취약성 평가 규칙 기준을 가져옵니다. |
| [AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | 지정 된 규칙에 대 한 관리 되는 데이터베이스의 취약성 평가 규칙 기준을 가져옵니다. |
| [AzSqlDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | 지정 된 데이터베이스와 연결 된 모든 취약성 평가 검사 레코드를 가져옵니다. |
| [AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | 지정 된 관리 되는 데이터베이스와 연결 된 모든 취약성 평가 검사 레코드를 가져옵니다. |
| [AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | 데이터베이스의 취약성 평가 설정을 반환 합니다. |
| [AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | 관리 되는 데이터베이스의 취약성 평가 설정을 반환 합니다. |
| [AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | 취약성 평가 규칙 기준을 설정 합니다. |
| [AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | 관리 되는 데이터베이스에 대 한 취약성 평가 규칙 기준을 설정 합니다. |
| [AzSqlDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | 데이터베이스에 대 한 취약성 평가 검사의 시작을 트리거합니다. |
| [AzSqlInstanceDatabaseVulnerabilityAssessmentScan](/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | 관리 되는 데이터베이스에 대 한 취약성 평가 검색의 시작을 트리거합니다. |
| [업데이트-AzSqlDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | 데이터베이스의 취약성 평가 설정을 업데이트 합니다. |
| [업데이트-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | 관리 되는 데이터베이스의 취약성 평가 설정을 업데이트 합니다. |
| [업데이트-AzSqlInstanceVulnerabilityAssessmentSetting](/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | 관리 되는 인스턴스의 취약성 평가 설정을 업데이트 합니다. |
| &nbsp; | &nbsp; |

스크립트 예제를 보려면 [Azure SQL 취약성 평가 PowerShell 지원](/archive/blogs/sqlsecurity/azure-sql-vulnerability-assessment-now-with-powershell-support)을 참조하세요.

### <a name="using-resource-manager-templates"></a>Resource Manager 템플릿 사용

Azure Resource Manager 템플릿을 사용 하 여 취약성 평가 기준을 구성 하려면 해당 `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` 유형을 사용 합니다.

기준을 추가 하기 전에를 사용 하도록 설정 했는지 확인 `vulnerabilityAssessments` 합니다.

다음은 데이터베이스에 대 한 기준 규칙 VA2065을 정의 하 `master` 고 `user` 리소스 관리자 템플릿에서 리소스로 데이터베이스를 VA1143 하는 예입니다.

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

`master`데이터베이스 및 데이터베이스의 경우 `user` 리소스 이름은 다음과 같이 다르게 정의 됩니다.

- Master 데이터베이스-"name": "[concat (parameters (' server_name '), '/', parameters (' database_name '), '/default/VA2065/<b>master</b>')]",
- 사용자 데이터베이스-"name": "[concat (parameters (' server_name '), '/', 매개 변수 (' database_name '), '/default/VA2065/<b>default</b>')]",

부울 형식을 true/false로 처리 하려면 이진 입력 (예: "1"/"0")을 사용 하 여 기준 결과를 설정 합니다.

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>다음 단계  

- [Azure Defender for SQL](azure-defender-for-sql.md)에 대해 자세히 알아봅니다.
- [데이터 검색 및 분류](data-discovery-and-classification-overview.md)에 대해 자세히 알아보세요.
- [방화벽 및 vnet으로 액세스할 수 있는 저장소 계정에서 취약성 평가 검사 결과를 저장 하는](sql-database-vulnerability-assessment-storage.md)방법에 대해 알아봅니다.
