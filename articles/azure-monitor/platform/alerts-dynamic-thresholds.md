---
title: Azure Monitor에서 동적 임계값을 사용하여 경고 만들기
description: 기계 학습 기반 동적 임계값을 사용한 경고 만들기
author: yanivlavi
ms.author: yalavi
ms.topic: conceptual
ms.date: 01/04/2021
ms.openlocfilehash: 92fafc9357ca08cd31c9ba7badbf7f6433f44f86
ms.sourcegitcommit: aeba98c7b85ad435b631d40cbe1f9419727d5884
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 01/04/2021
ms.locfileid: "97862573"
---
# <a name="metric-alerts-with-dynamic-thresholds-in-azure-monitor"></a>Azure Monitor에서 동적 임계값을 사용 하는 메트릭 경고

동적 임계값 검색을 사용하는 메트릭 경고는 고급 ML(기계 학습)을 사용하여 메트릭의 과거 동작을 학습하고, 가능한 서비스 문제를 나타내는 패턴과 변칙을 식별합니다. 이 기능은 사용자가 완전 자동화 방식으로 Azure Resource Manager API를 통해 경고 규칙을 구성할 수 있도록 하여 간단한 UI와 대규모 작업을 지원합니다.

경고 규칙을 만들면 모니터링된 메트릭이 조정된 임계값을 기준으로 예상대로 동작하지 않을 때만 경고를 발생합니다.

여러분의 의견을 환영합니다. <azurealertsfeedback@microsoft.com>으로 의견을 보내주세요.

## <a name="why-and-when-is-using-dynamic-condition-type-recommended"></a>동적 조건 형식은 언제 어떤 이유로 권장되나요?

1. **확장 가능한 경고** – 동적 임계값 경고 규칙은 한 번에 수백 개의 메트릭 시리즈에 대 한 맞춤형 임계값을 만들 수 있지만, 단일 메트릭에 경고 규칙을 정의 하는 것과 동일한 용이성을 제공 합니다. 이를 통해 만들고 관리 하는 경고의 수를 줄일 수 있습니다. Azure Portal 또는 Azure Resource Manager API를 사용 하 여 만들 수 있습니다. 확장 가능한 접근 방식은 모든 구독 리소스와 같은 여러 리소스에 적용 될 때 또는 메트릭 차원을 처리할 때 특히 유용 합니다.  [템플릿을 사용하여 동적 임계값으로 메트릭 경고를 구성하는 방법에 자세히 알아봅니다](alerts-metric-create-templates.md).

1. **스마트 메트릭 패턴 인식** – ML 기술을 사용 하 여 메트릭 패턴을 자동으로 감지 하 고 시간에 따른 메트릭 변화에 맞게 조정할 수 있습니다. 여기에는 계절성 (매시간/일별/주별)이 포함 될 수 있습니다. 시간에 따른 메트릭 동작 및 해당 패턴의 편차를 기준으로 경고에 대 한 적응은 각 메트릭에 대 한 "오른쪽" 임계값을 알아내는 부담을 완화 합니다. 동적 임계값에 사용되는 ML 알고리즘은 예상되는 패턴을 따르지 않는 노이즈(낮은 정밀도) 또는 넓은(낮은 재현율) 임계값을 방지하도록 디자인되었습니다.

1. **직관적인 구성** – 동적 임계값을 사용 하면 개략적인 개념을 사용 하 여 메트릭 경고를 설정할 수 있으므로 메트릭에 대 한 광범위 한 도메인 지식이 없어도 됩니다.

## <a name="how-to-configure-alerts-rules-with-dynamic-thresholds"></a>동적 임계값을 사용하여 경고 규칙을 구성하는 방법

동적 임계값을 사용한 경고는 Azure Monitor의 메트릭 경고를 통해 구성할 수 있습니다. [메트릭 경고를 구성하는 방법에 대해 자세히 알아봅니다](alerts-metric.md).

## <a name="how-are-the-thresholds-calculated"></a>임계값은 어떻게 계산되나요?

동적 임계값은 메트릭 시리즈의 데이터를 지속적으로 학습하고, 일단의 알고리즘과 메서드를 사용하여 이를 모델링하려고 합니다. 이 기능은 계절성(매시간/매일/매주)과 같은 데이터의 패턴을 검색하고, 분산이 낮은 메트릭(예: 가용성 및 오류 비율) 뿐만 아니라 노이즈 메트릭(예: 컴퓨터 CPU 또는 메모리)을 처리할 수 있습니다.

이러한 임계값에서의 편차가 메트릭 동작의 변칙을 나타내는 방식으로 임계값이 선택됩니다.

> [!NOTE]
> 동적 임계값은 매시간, 매일 또는 매주 패턴에 대 한 계절성를 검색할 수 있습니다. 1 시간 또는 반 주간 계절성 같은 다른 패턴은 검색 되지 않을 수 있습니다. 주간 계절성을 검색 하려면 최소 3 주가 기록 데이터가 필요 합니다. 

## <a name="what-does-sensitivity-setting-in-dynamic-thresholds-mean"></a>동적 임계값에서 '민감도' 설정은 무엇을 의미하나요?

경고 임계값 민감도는 경고를 트리거하는 데 필요한 메트릭 동작에서의 편차 크기를 제어하는 고급 개념입니다.
이 옵션을 사용하면 메트릭에 대한 도메인 지식(예: 정적 임계값)이 필요하지 않습니다. 제공되는 옵션은 다음과 같습니다.

- 높음 – 임계값이 좀 더 조밀하고 메트릭 시리즈 패턴에 근접합니다. 경고 규칙은 가장 작은 편차에 대해 트리거되고 더 많은 경고가 발생 합니다.
- 중간 - 높음 민감도(기본값)보다 임계값은 덜 조밀하고 좀 더 균일하며 경고 횟수는 더 적습니다.
- 낮음 - 임계값은 메트릭 시리즈 패턴에서 느슨하게 더 멀리 떨어져 있습니다. 경고 규칙은 매우 많은 편차를 트리거하기 때문에 경고 수가 줄어듭니다.

## <a name="what-are-the-operator-setting-options-in-dynamic-thresholds"></a>동적 임계값에서 '작업자' 설정 옵션이란 무엇인가요?

동적 임계값 경고 규칙은 동일한 경고 규칙을 사용하여 상한 및 하한 둘 다에 대해 메트릭 동작을 토대로 조정된 임계값을 만들 수 있습니다.
다음 세 가지 조건 중 하나에서 경고가 트리거되도록 선택할 수 있습니다.

- 상한 임계값보다 크거나 하한 임계값보다 낮습니다(기본값).
- 상한 임계값보다 큽니다.
- 하한 임계값보다 낮습니다.

## <a name="what-do-the-advanced-settings-in-dynamic-thresholds-mean"></a>동적 임계값의 고급 설정은 무엇을 의미하나요?

**실패 기간** -동적 임계값을 사용 하면 시스템에서 경고를 발생 시키기 위해 특정 기간 내에 필요한 최소한의 편차의 "경고를 트리거하기 위한 숫자 위반"을 구성할 수도 있습니다 (기본 기간은 20 분의 네 가지 편차 임). 사용자는 실패 기간 및 시간 범위를 변경하여 실패 기간을 구성하고, 경고할 대상을 선택할 수 있습니다. 이 기능은 일시적인 스파이크에 의해 생성된 경고 노이즈를 줄여줍니다. 예를 들면 다음과 같습니다.

문제가 주어진 5분씩 4번 연속해서 20분간 지속되는 경우 경고를 트리거하려면 다음 설정을 사용합니다.

![주어진 5분씩 4번 연속해서 20분간 지속되는 문제에 대한 실패 기간 설정](media/alerts-dynamic-thresholds/0008.png)

기간이 5분일 때 지난 30분 중 20분 동안 동적 임계값 위반이 발생한 경우 경고를 트리거하려면 다음 설정을 사용합니다.

![5분씩 묶은 지난 30분 중에서 20분 동안 지속되는 문제에 대한 실패 기간 설정](media/alerts-dynamic-thresholds/0009.png)

**다음 이전의 데이터 무시:** -사용자는 경우에 따라 시스템에서 임계값 계산을 시작하는 시작 날짜를 정의할 수도 있습니다. 일반적인 사용 사례는 리소스가 테스트 모드에서 실행되고 있었으나 이제 프로덕션 워크로드를 제공하도록 승격되므로, 테스트 단계 동안의 메트릭 동작을 무시해야 하는 경우일 수 있습니다.

## <a name="how-do-you-find-out-why-a-dynamic-thresholds-alert-was-triggered"></a>동적 임계값 경고가 트리거되는 이유를 어떻게 알 수 있나요?

전자 메일 또는 문자 메시지의 링크를 클릭 하 여 경고 보기에서 트리거된 경고 인스턴스를 탐색 하거나 브라우저를 클릭 하 여 Azure Portal에서 경고 보기를 볼 수 있습니다. [경고 보기에 대해 자세히 알아보세요](alerts-overview.md#alerts-experience).

경고 보기는 다음을 표시 합니다.

- 동적 임계값 경고가 발생 한 순간의 모든 메트릭 세부 정보입니다.
- 해당 시점에 사용 되는 동적 임계값을 포함 하 여 경고가 트리거된 기간의 차트입니다.
- 동적 임계값 경고 및 경고 보기 환경에 대 한 피드백을 제공 하 여 향후 검색을 향상 시킬 수 있습니다.

## <a name="will-slow-behavior-changes-in-the-metric-trigger-an-alert"></a>메트릭에 대 한 동작 변경 내용이 경고를 트리거합니다.

그렇지 않을 가능성이 있습니다. 동적 임계값은 느리게 진화하는 문제보다는 상당한 편차를 검색하는 데 유용합니다.

## <a name="how-much-data-is-used-to-preview-and-then-calculate-thresholds"></a>임계값을 미리 본 다음, 계산하는 데 사용하는 데이터 양은 얼마나 되나요?

경고 규칙을 처음 만들 때 차트에 나타나는 임계값은 시간 또는 일별 계절 패턴 (10 일)을 계산 하는 데 충분 한 기록 데이터를 기반으로 계산 됩니다. 경고 규칙이 만들어지면 동적 임계값은 사용 가능한 모든 기록 데이터를 사용 하며, 임계값을 보다 정확 하 게 만들기 위해 새 데이터를 기반으로 지속적으로 학습 하 고 조정 합니다. 이는이 계산 후 차트에 주간 패턴도 표시 됨을 의미 합니다.

## <a name="how-much-data-is-needed-to-trigger-an-alert"></a>경고를 트리거하는 데 필요한 데이터는 얼마 인가요?

새 리소스 또는 누락 된 메트릭 데이터가 있는 경우 동적 임계값은 3 일 전에 경고를 트리거하지 않고 정확한 임계값을 보장 하기 위해 메트릭 데이터의 30 개 이상의 샘플을 사용할 수 있습니다.
메트릭 데이터가 충분 한 기존 리소스의 경우 동적 임계값으로 즉시 경고를 트리거할 수 있습니다.

## <a name="dynamic-thresholds-best-practices"></a>동적 임계값 모범 사례

동적 임계값은 Azure Monitor의 대부분의 플랫폼과 사용자 지정 메트릭에 적용할 수 있으며, 일반적인 응용 프로그램 및 인프라 메트릭에 대해서도 조정 되었습니다.
다음 항목은 동적 임계값을 사용하여 이러한 메트릭 중 일부에 대한 경고를 구성하는 방법에 대한 모범 사례입니다.

### <a name="dynamic-thresholds-on-virtual-machine-cpu-percentage-metrics"></a>가상 머신 CPU 백분율 메트릭의 동적 임계값

1. [Azure Portal](https://portal.azure.com)에서 **모니터** 를 클릭 합니다. [모니터] 보기는 모든 모니터링 설정과 데이터를 하나의 보기로 통합합니다.

2. **경고** 를 클릭한 다음, **+ 새로운 경고 규칙** 을 클릭합니다.

    > [!TIP]
    > 대부분의 리소스 블레이드도 **모니터링** 아래의 리소스 메뉴에 **경고** 가 있으며, 여기서 경고를 만들 수 있습니다.

3. **대상 선택** 을 클릭하고, 로드되는 컨텍스트 창에서 경고를 사용할 대상 리소스를 선택합니다. **구독** 및 **'Virtual Machines' 리소스 종류** 드롭다운을 사용하여 모니터링하려는 리소스를 찾습니다. 검색 창을 사용하여 리소스를 검색할 수도 있습니다.

4. 대상 리소스를 선택한 후에는 **조건 추가** 를 클릭합니다.

5. **'CPU 백분율'** 을 선택합니다.

6. 필요에 따라 **기간** 및 **집계** 를 조정하여 메트릭을 구체화합니다. 이 메트릭 유형은 동작을 잘 나타내지 않으므로 '최대' 집계 유형을 사용하지 않는 것이 좋습니다. '최대' 집계 유형의 경우 정적 임계값이 더 적절할 수 있습니다.

7. 지난 6시간의 메트릭에 대한 차트가 표시됩니다. 경고 매개 변수를 다음과 같이 정의합니다.
    1. **조건 유형** - '동적' 옵션을 선택합니다.
    1. **민감도** - 중간/낮음 민감도를 선택하여 경고 노이즈를 줄입니다.
    1. **연산자** - 동작이 애플리케이션 사용량을 나타내지 않는 경우이면 '보다 큼'을 선택합니다.
    1. **빈도** - 경고의 비즈니스 영향에 따라 줄이는 것이 좋습니다.
    1. **실패 기간 수**(고급 옵션) - 뒤돌아 보기 시간 범위는 15분 이상이어야 합니다. 예를 들어 기간을 5분으로 설정하는 경우 실패 기간 수는 3개 이상이어야 합니다.

8. 최근 데이터에 기반하여 계산된 임계값이 메트릭 차트에 표시됩니다.

9. **완료** 를 클릭합니다.

10. **경고 규칙 이름**, **설명** 및 **심각도** 와 같은 **경고 세부 정보** 를 입력합니다.

11. 기존 작업 그룹을 선택하거나 새 작업 그룹을 만들어서 경고에 작업 그룹을 추가합니다.

12. **완료** 를 클릭하여 메트릭 경고 규칙을 저장합니다.

> [!NOTE]
> 포털을 통해 생성되는 메트릭 경고는 대상 리소스와 동일한 리소스 그룹에 생성됩니다.

### <a name="dynamic-thresholds-on-application-insights-http-request-execution-time"></a>Application Insights HTTP 요청 실행 시간의 동적 임계값

1. [Azure Portal](https://portal.azure.com)에서 **모니터** 를 클릭 합니다. [모니터] 보기는 모든 모니터링 설정과 데이터를 하나의 보기로 통합합니다.

2. **경고** 를 클릭한 다음, **+ 새로운 경고 규칙** 을 클릭합니다.

    > [!TIP]
    > 대부분의 리소스 블레이드도 **모니터링** 아래의 리소스 메뉴에 **경고** 가 있으며, 여기서 경고를 만들 수 있습니다.

3. **대상 선택** 을 클릭하고, 로드되는 컨텍스트 창에서 경고를 사용할 대상 리소스를 선택합니다. **구독** 및 **'Application Insights' 리소스 종류** 드롭다운을 사용하여 모니터링하려는 리소스를 찾습니다. 검색 창을 사용하여 리소스를 검색할 수도 있습니다.

4. 대상 리소스를 선택한 후에는 **조건 추가** 를 클릭합니다.

5. **'HTTP 요청 실행 시간'** 을 선택합니다.

6. 필요에 따라 **기간** 및 **집계** 를 조정하여 메트릭을 구체화합니다. 이 메트릭 유형은 동작을 잘 나타내지 않으므로 '최대' 집계 유형을 사용하지 않는 것이 좋습니다. '최대' 집계 유형의 경우 정적 임계값이 더 적절할 수 있습니다.

7. 지난 6시간의 메트릭에 대한 차트가 표시됩니다. 경고 매개 변수를 다음과 같이 정의합니다.
    1. **조건 유형** - '동적' 옵션을 선택합니다.
    1. **연산자** - 기간 단축 시 발생하는 경고를 줄이려면 '보다 큼'을 선택합니다.
    1. **빈도** - 경고의 비즈니스 영향에 따라 줄이는 것이 좋습니다.

8. 최근 데이터에 기반하여 계산된 임계값이 메트릭 차트에 표시됩니다.

9. **완료** 를 클릭합니다.

10. **경고 규칙 이름**, **설명** 및 **심각도** 와 같은 **경고 세부 정보** 를 입력합니다.

11. 기존 작업 그룹을 선택하거나 새 작업 그룹을 만들어서 경고에 작업 그룹을 추가합니다.

12. **완료** 를 클릭하여 메트릭 경고 규칙을 저장합니다.

> [!NOTE]
> 포털을 통해 생성되는 메트릭 경고는 대상 리소스와 동일한 리소스 그룹에 생성됩니다.

## <a name="interpreting-dynamic-threshold-charts"></a>동적 임계값 차트 해석

다음은 값이 허용 되는 임계값을 벗어날 때 발생 하는 메트릭, 동적 임계값 제한 및 일부 경고를 보여 주는 차트입니다.

![메트릭 경고를 구성 하는 방법에 대 한 자세한 정보](media/alerts-dynamic-thresholds/threshold-picture-8bit.png)

다음 정보를 사용 하 여 이전 차트를 해석할 수 있습니다.

- **Blue line** -시간에 따른 실제 측정 된 메트릭입니다.
- **파란색 음영 영역** -메트릭에 대해 허용 된 범위를 표시 합니다. 메트릭 값이이 범위 내에 유지 되는 동안에는 경고가 발생 하지 않습니다.
- **파란색 점** -차트의 일부를 마우스 왼쪽 단추로 클릭 한 다음 파란색 선 위로 마우스를 가져가면 개별 집계 된 메트릭 값을 보여 주는 파란색 점이 커서 아래에 나타납니다.
- **파란색 점이 있는 팝업** -측정 된 메트릭 값 (파란색 점) 및 허용 되는 범위의 상한 값과 하 한 값을 표시 합니다.  
- **검정색 원이 있는 빨간색 점** -허용 된 범위에서 첫 번째 메트릭 값을 표시 합니다. 이 값은 메트릭 경고를 발생 시키고 활성 상태로 전환 하는 값입니다.
- **빨간색 점**-허용 된 범위를 벗어난 추가 측정 된 값을 표시 합니다. 추가 메트릭 경고는 발생 하지 않지만 경고는 활성 상태로 유지 됩니다.
- **빨강 영역** -메트릭 값이 허용 되는 범위를 벗어난 시간을 표시 합니다. 후속 측정 된 값이 허용 되는 범위를 벗어나는 경우에만 경고는 활성 상태로 유지 되지만 새 경고는 발생 하지 않습니다.
- **빨강 영역 끝** -파란색 줄이 허용 되는 값 내부에 있으면 빨강 영역이 중지 되 고 측정 된 값 선은 파란색으로 바뀝니다. 검은색 윤곽선을 사용 하 여 빨간색 점이 발생 했을 때 발생 하는 메트릭 경고의 상태는 해결 됨으로 설정 됩니다. 
