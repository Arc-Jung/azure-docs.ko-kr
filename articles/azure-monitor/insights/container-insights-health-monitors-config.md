---
title: 컨테이너 상태 모니터 구성에 대한 Azure 모니터 | 마이크로 소프트 문서
description: 이 문서에서는 컨테이너에 대한 Azure 모니터의 상태 모니터의 자세한 구성을 설명하는 콘텐츠를 제공합니다.
ms.topic: conceptual
ms.date: 12/01/2019
ms.openlocfilehash: 99ea6e96f5a8a486784cb3d633a6e031b60eaad7
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/28/2020
ms.locfileid: "80055710"
---
# <a name="azure-monitor-for-containers-health-monitor-configuration-guide"></a>컨테이너 상태 모니터 구성 가이드에 대한 Azure 모니터

모니터는 Azure Monitor에서 컨테이너에 대한 상태를 측정하고 오류를 검색하기 위한 기본 요소입니다. 이 문서에서는 상태 측정 방법의 개념과 [상태(미리 보기)](container-insights-health.md) 기능을 사용하여 Kubernetes 클러스터의 상태를 모니터링하고 보고하는 상태 모델을 구성하는 요소를 이해하는 데 도움이 됩니다.

>[!NOTE]
>상태 기능은 현재 공개 미리 보기입니다.
>

## <a name="monitors"></a>모니터

모니터는 관리 개체의 특정 양상에 대한 성능을 측정합니다. 각 모니터는 두 개 또는 세 개의 성능 상태를 포함합니다. 모니터는 항상 한 가지 상태만 표시합니다. 컨테이너화된 에이전트에 의해 로드된 모니터가 정상 상태로 초기화됩니다. 상태는 다른 상태에 대해 지정된 조건이 검색된 경우에만 변경됩니다.

특정 개체의 전반적인 상태는 각 모니터의 상태에서 결정됩니다. 이 계층 구조는 컨테이너에 대한 Azure 모니터의 상태 계층 화 창에 나와 있습니다. 상태 롤업 방법에 대한 정책은 집계 모니터 구성의 일부입니다.

## <a name="types-of-monitors"></a>모니터 유형

|모니터 | 설명 | 
|--------|-------------|
| 유닛 모니터 |단위 모니터는 리소스 또는 응용 프로그램의 일부 측면을 측정합니다. 리소스의 성능 또는 가용성을 결정하기 위해 성능 카운터를 검사하는 것일 수 있습니다. |
|집계 모니터 | 집계 모니터는 여러 모니터를 그룹화하여 단일 상태 집계 상태를 제공합니다. 단위 모니터는 일반적으로 특정 집계 모니터로 구성됩니다. 예를 들어 노드 집계 모니터는 노드 CPU 사용률, 메모리 사용률 및 노드 상태의 상태를 롤업합니다.
 |

### <a name="aggregate-monitor-health-rollup-policy"></a>집계 모니터 상태 롤업 정책

각 집계 모니터는 상태 롤업 정책을 정의합니다. 집계 모니터에 대한 가능한 상태 롤업 정책은 다음과 같습니다.

#### <a name="worst-state-policy"></a>최악의 상태 정책

집계 모니터의 상태는 하위 모니터의 상태와 최악의 상태와 일치합니다. 집계 모니터에서 사용하는 가장 일반적인 정책입니다.

![집계 모니터 롤업 최악의 상태 의 예](./media/container-insights-health-monitoring-cfg/aggregate-monitor-rollup-worstof.png)

### <a name="percentage-policy"></a>백분율 정책

소스 개체는 지정된 비율의 대상 개체 중 가장 적합한 상태의 단일 멤버의 최악의 상태와 일치합니다. 이 정책은 대상 개체가 정상으로 간주되려면 대상 개체의 일정 비율이 정상이어야 하는 경우에 사용됩니다. 백분율 정책은 모니터를 상태 심각도의 내림차순으로 정렬하고 집계 모니터의 상태는 최악의 N% 상태로 계산됩니다(N은 구성 매개 변수 *StateThresholdPercentage에*의해 결정됩니다).

예를 들어 컨테이너 이미지의 5개의 컨테이너 인스턴스가 있고 개별 상태가 **중요,** **경고,** **정상,** **정상,** **정상**입니다.  컨테이너 CPU 사용률 모니터의 상태는 심각도의 내림차순으로 정렬할 때 컨테이너의 90%의 최악의 상태가 **중요하기** 때문에 **치명적입니다.**

## <a name="understand-the-monitoring-configuration"></a>모니터링 구성 이해

컨테이너용 Azure Monitor에는 다음과 같이 구성된 여러 주요 모니터링 시나리오가 포함되어 있습니다.

### <a name="unit-monitors"></a>장치 모니터

|**모니터 이름** | 모니터 유형 | **설명** | **매개 변수** | **값** |
|-----------------|--------------|-----------------|---------------|-----------|
|노드 메모리 사용률 |유닛 모니터 |이 모니터는 cadvisor 보고 데이터를 사용하여 1분마다 노드의 메모리 사용률을 평가합니다. |연속샘플포스테이트트랜지션<br> 페일If그레이터비율<br> 워리미그레이터탄백분율 | 3<br> 90<br> 80  ||
|노드 CPU 사용률 |유닛 모니터 |이 모니터는 cadvisor보고 데이터를 사용하여 1분마다 노드의 CPU 사용률을 확인합니다. | 연속샘플포스테이트트랜지션<br> 페일If그레이터비율<br> 워리미그레이터탄백분율 | 3<br> 90<br> 80  ||
|노드 상태 |유닛 모니터 |이 모니터는 Kubernetes에서 보고한 노드 조건을 검사합니다.<br> 현재 다음과 같은 노드 조건이 확인됩니다: 디스크 압력, 메모리 압력, PID 압력, 디스크 부족, 네트워크 사용 불가, 노드에 대한 준비 상태.<br> 위의 조건 에서 디스크 *에서* 또는 *네트워크를 사용할 수 없는* **경우** **모니터가 중요** 상태로 변경됩니다.<br> **준비** 상태 이외의 다른 조건이 **true와**같으면 모니터가 **경고** 상태로 변경됩니다. | 노드조건유형실패상태 | 아웃 디스크, 네트워크 사용 가능 ||
|컨테이너 메모리 사용률 |유닛 모니터 |이 모니터는 컨테이너 인스턴스의 RSS(메모리 사용률)의 결합된 상태 상태를 보고합니다.<br> 각 샘플을 단일 임계값과 비교하고 구성 매개 변수에 의해 지정된 간단한 **비교를 수행합니다.**<br> 해당 상태는 컨테이너 상태(예: 중요, 경고, 정상)의 심각도 내림차순으로 정렬된 컨테이너(StateThresholdPercentage) 인스턴스의 90%의 최악의 상태로 계산됩니다.<br> 컨테이너 인스턴스에서 레코드를 받지 못하면 컨테이너 인스턴스의 상태가 알 **수 없음으로**보고되고 **임계** 상태에 대한 정렬 순서에서 더 높은 우선 순위가 있습니다.<br> 각 개별 컨테이너 인스턴스의 상태는 구성에 지정된 임계값을 사용하여 계산됩니다. 사용량이 임계 임계값(90%)을 초과하는 경우 인스턴스가 **임계** 임계값(90%) 미만인 경우 임계 상태에 있습니다. 하지만 경고 임계값(80%)보다 크면 인스턴스가 **경고** 상태에 있습니다. 그렇지 않으면 **정상** 상태입니다. |연속샘플포스테이트트랜지션<br> 실패하면LessThan백분율<br> 상태 임계값백분율<br> 워리미그레이터탄백분율| 3<br> 90<br> 90<br> 80 ||
|컨테이너 CPU 사용률 |유닛 모니터 |이 모니터는 컨테이너 인스턴스의 CPU 사용률의 결합된 상태 상태를 보고합니다.<br> 각 샘플을 단일 임계값과 비교하고 구성 매개 변수에 의해 지정된 간단한 **비교를 수행합니다.**<br> 해당 상태는 컨테이너 상태(예: 중요, 경고, 정상)의 심각도 내림차순으로 정렬된 컨테이너(StateThresholdPercentage) 인스턴스의 90%의 최악의 상태로 계산됩니다.<br> 컨테이너 인스턴스에서 레코드를 받지 못하면 컨테이너 인스턴스의 상태가 알 **수 없음으로**보고되고 **임계** 상태에 대한 정렬 순서에서 더 높은 우선 순위가 있습니다.<br> 각 개별 컨테이너 인스턴스의 상태는 구성에 지정된 임계값을 사용하여 계산됩니다. 사용량이 임계 임계값(90%)을 초과하는 경우 인스턴스가 **임계** 임계값(90%) 미만인 경우 임계 상태에 있습니다. 하지만 경고 임계값(80%)보다 크면 인스턴스가 **경고** 상태에 있습니다. 그렇지 않으면 **정상** 상태입니다. |연속샘플포스테이트트랜지션<br> 실패하면LessThan백분율<br> 상태 임계값백분율<br> 워리미그레이터탄백분율| 3<br> 90<br> 90<br> 80 ||
|시스템 워크로드 포드 준비 |유닛 모니터 |이 모니터는 지정된 워크로드에서 준비 상태의 포드 백분율을 기반으로 상태를 보고합니다. 포드의 100% 미만이 **정상** 상태에 있는 경우 해당 상태가 **중요로** 설정됩니다. |연속샘플포스테이트트랜지션<br> 실패하면LessThan백분율 |2<br> 100 ||
|쿠베 API 상태 |유닛 모니터 |이 모니터는 Kube API 서비스의 상태를 보고합니다. Kube API 끝점을 사용할 수 없는 경우 모니터가 중요한 상태입니다. 이 특정 모니터의 경우 상태는 kube api 서버의 '노드' 끝점에 대한 쿼리를 만들어 결정됩니다. OK 응답 코드 이외의 다른 것은 모니터를 **임계** 상태로 변경합니다. | 구성 속성 없음 |||

### <a name="aggregate-monitors"></a>집계 모니터

|**모니터 이름** | **설명** | **알고리즘** |
|-----------------|-----------------|---------------|
|노드 |이 모니터는 모든 노드 모니터의 집계입니다. 자식 모니터의 상태와 최악의 상태와 일치합니다.<br> 노드 CPU 사용률<br> 노드 메모리 사용률<br> 노드 상태 | 최악의|
|노드 풀 |이 모니터는 노드 풀 *에이전트 풀의*모든 노드의 결합된 상태 상태를 보고합니다. 이 상태는 노드 풀의 노드 중 최악의 상태인 80%의 상태를 기반으로 노드 상태의 심각도 내림차순(즉, 중요, 경고, 정상)으로 정렬된 세 가지 상태 모니터입니다.|백분율 |
|노드(노드 풀의 상위) |모든 노드 풀의 집계 모니터입니다. 해당 상태는 자식 모니터의 최악의 상태(즉, 클러스터에 있는 노드 풀)를 기반으로 합니다. |최악의 |
|클러스터(노드의 상위/<br> 쿠베르네테스 인프라) |이 모니터는 자식 모니터의 상태와 최악의 상태, 즉 kubernetes 인프라 및 노드와 일치하는 상위 모니터입니다. |최악의 |
|쿠베르네테스 인프라 |이 모니터는 클러스터의 관리되는 인프라 구성 요소의 결합된 상태 상태를 보고합니다. 해당 상태는 자식 모니터 상태 즉 kube 시스템 워크로드 및 API 서버 상태 '최악의'상태로 계산됩니다. |최악의|
|시스템 워크로드 |이 모니터는 kube 시스템 워크로드의 상태를 보고합니다. 이 모니터는 자식 모니터의 상태와 최악의 상태, 즉 준비 상태(워크로드의 모니터 및 **컨테이너)의 Pods와 일치합니다.** |최악의 |
|컨테이너 |이 모니터는 지정된 워크로드에서 컨테이너의 전반적인 상태를 보고합니다. 이 모니터는 **CPU 사용률** 및 메모리 **사용률** 모니터인 최악의 상태와 자식 모니터의 상태를 일치시입니다. |최악의 |

## <a name="next-steps"></a>다음 단계

[모니터 클러스터 상태를](container-insights-health.md) 보고 Kubernetes 클러스터의 상태를 보는 방법에 대해 알아봅니다.
