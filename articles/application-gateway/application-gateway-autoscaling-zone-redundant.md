---
title: 자동 크기 조정 및 영역 중복 Application Gateway v2
description: 이 문서에서는 자동 크기 조정 및 영역 중복 기능을 포함하는 Azure 응용 프로그램 Standard_v2 및 WAF_v2 SKU를 소개합니다.
services: application-gateway
author: vhorne
ms.service: application-gateway
ms.topic: article
ms.date: 03/24/2020
ms.author: victorh
ms.openlocfilehash: 7feb0f00c5431048d19d4ad6cb3860f6eb8ed052
ms.sourcegitcommit: 7e04a51363de29322de08d2c5024d97506937a60
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 04/14/2020
ms.locfileid: "81312698"
---
# <a name="autoscaling-and-zone-redundant-application-gateway-v2"></a>자동 크기 조정 및 영역 중복 Application Gateway v2 

응용 프로그램 게이트웨이 및 웹 응용 프로그램 방화벽(WAF)도 Standard_v2 및 WAF_v2 SKU에서 사용할 수 있습니다. v2 SKU는 성능 향상을 제공하며 자동 크기 조정, 영역 중복 성 및 정적 VIP 지원과 같은 중요한 새로운 기능에 대한 지원을 추가합니다. 표준 및 WAF SKU에 따른 기존 기능은 [비교](#differences-with-v1-sku) 섹션에 나열된 몇 가지 예외를 제외하고 새 v2 SKU에서 계속 지원됩니다.

새로운 v2 SKU에는 다음과 같은 향상된 기능이 포함되어 있습니다.

- **자동 크기 조정**: 자동 크기 조정 SKU의 Application Gateway 또는 WAF 배포는 트래픽 부하 패턴의 변화에 따라 강화 또는 축소할 수 있습니다. 또한 자동 크기 조정을 사용하면 프로비전 시 배포 크기 또는 인스턴스 수를 선택할 필요가 없습니다. 이 SKU는 진정한 탄력성을 제공합니다. Standard_v2 및 WAF_v2 SKU에서 응용 프로그램 게이트웨이는 고정 용량(자동 크기 조정 비활성화)과 자동 크기 조정 사용 모드 모두에서 작동할 수 있습니다. 고정 용량 모드는 워크로드가 일관적이고 예측 가능한 시나리오에 유용합니다. 자동 크기 조정 모드는 응용 프로그램 트래픽의 분산을 참조하는 응용 프로그램에 유용합니다.
- **영역 중복성**: 응용 프로그램 게이트웨이 또는 WAF 배포는 여러 가용성 영역에 걸쳐 있을 수 있으며 트래픽 관리자를 사용하여 각 영역에서 별도의 응용 프로그램 게이트웨이 인스턴스를 프로비전할 필요가 없습니다. 응용 프로그램 게이트웨이 인스턴스가 배포되는 단일 영역 또는 여러 영역을 선택할 수 있으므로 영역 오류에 대한 복원력이 향상됩니다. 애플리케이션에 대한 백 엔드 풀을 가용성 영역 전반에 유사하게 배포할 수 있습니다.

  영역 중복성은 Azure 영역을 사용할 수 있는 경우에만 사용할 수 있습니다. 다른 지역에서는 다른 모든 기능이 지원됩니다. 자세한 내용은 [Azure의 가용성 영역이란 무엇입니까?](../availability-zones/az-overview.md#services-support-by-region)
- **정적 VIP**: 응용 프로그램 게이트웨이 v2 SKU는 정적 VIP 유형을 독점적으로 지원합니다. 이렇게 하면 응용 프로그램 게이트웨이와 연결된 VIP가 다시 시작한 후에도 배포 수명 주기에 대해 변경되지 않습니다.  v1에는 정적 VIP가 없으므로 응용 프로그램 게이트웨이를 통해 앱 서비스로 라우팅하는 도메인 이름 라우팅에 IP 주소 대신 응용 프로그램 게이트웨이 URL을 사용해야 합니다.
- **헤더 다시 쓰기**: 응용 프로그램 게이트웨이를 사용하면 v2 SKU를 사용하여 HTTP 요청 및 응답 헤더를 추가, 제거 또는 업데이트할 수 있습니다. 자세한 내용은 [응용 프로그램 게이트웨이를 사용 하 여 HTTP 헤더 다시 작성](rewrite-http-headers.md) 을 참조 하십시오.
- **키 볼트 통합**: 응용 프로그램 게이트웨이 v2는 HTTPS 지원 수신기에 연결된 서버 인증서에 대한 키 볼트와의 통합을 지원합니다. 자세한 내용은 [Key Vault 인증서를 통해 TLS 종료를](key-vault-certs.md)참조하십시오.
- **Azure Kubernetes 서비스 침투 컨트롤러**: 응용 프로그램 게이트웨이 v2 침투 컨트롤러를 사용하면 Azure 응용 프로그램 게이트웨이를 AKS 클러스터로 알려진 AZURE Kubernetes 서비스(AKS)의 침투로 사용할 수 있습니다. 자세한 내용은 [응용 프로그램 게이트웨이 침투 컨트롤러란 무엇입니까?](ingress-controller-overview.md)
- **성능 향상**: v2 SKU는 표준/WAF SKU에 비해 최대 5배 더 나은 TLS 오프로드 성능을 제공합니다.
- **더 빠른 배포 및 업데이트 시간** v2 SKU는 표준/WAF SKU에 비해 더 빠른 배포 및 업데이트 시간을 제공합니다. 여기에는 WAF 구성 변경사항도 포함됩니다.

![](./media/application-gateway-autoscaling-zone-redundant/application-gateway-autoscaling-zone-redundant.png)

## <a name="supported-regions"></a>지원되는 지역

Standard_v2 및 WAF_v2 SKU는 미국 중북부, 미국 중남부, 미국 서부, 미국 서부 2, 미국 동부, 동부 미국 2, 중부 미국, 북유럽, 서유럽, 동남아시아, 프랑스 중부, 영국 서부, 일본 동부, 일본 서부, 오스트레일리아 동부, 호주 남동부, 브라질 남부, 캐나다 중부, 캐나다 동부, 동아시아, 한국 중부, 한국 , 영국 남부, 인도 중부, 서인도, 인도 남부.

## <a name="pricing"></a>가격 책정

v2 SKU를 사용하면 가격 책정 모델이 소비에 의해 구동되며 더 이상 인스턴스 수 또는 크기에 연결되지 않습니다. v2 SKU 가격에는 두 가지 구성 요소가 있습니다.

- **고정 가격** - Standard_v2 또는 WAF_v2 게이트웨이를 프로비전하기 위한 시간당(또는 부분 시간) 가격입니다. 최소 인스턴스 0개는 항상 고정 가격에 포함된 서비스의 고가용성을 보장합니다.
- **용량 단위 가격** - 고정 비용 외에 비용이 청구되는 소비 기반 비용입니다. 용량 단위 요금은 또한 시간당 또는 부분 시간단위로 계산됩니다. 용량 단위에는 계산 단위, 영구 연결 및 처리량의 세 가지 차원이 있습니다. 계산 단위는 소비된 프로세서 용량의 척도입니다. 계산 단위에 영향을 미치는 요소는 TLS 연결/초, URL 다시 쓰기 계산 및 WAF 규칙 처리입니다. 영구 연결은 지정된 청구 간격에서 응용 프로그램 게이트웨이에 대한 설정된 TCP 연결을 측정한 값입니다. 처리량은 지정된 청구 간격으로 시스템에서 처리되는 평균 메가비트/초입니다.  청구는 예약된 인스턴스 수 보다 높은 모든 것에 대해 용량 단위 수준에서 수행됩니다.

각 용량 단위는 계산 단위 1개 또는 영구 연결 2500개 또는 2.22Mbps 처리량으로 구성됩니다.

계산 단위 지침:

- **Standard_v2** - 각 컴퓨팅 단위는 RSA 2048비트 키 TLS 인증서를 통해 초당 약 50개의 연결을 할 수 있습니다.
- **WAF_v2** - 각 계산 단위는 70-30% 트래픽 혼합에 대해 초당 약 10개의 동시 요청을 지원할 수 있으며 70% 요청은 2KB GET/POST 미만이고 더 높은 요청은 남아 있습니다. WAF 성능은 현재 응답 크기에 영향을 받지 않습니다.

> [!NOTE]
> 각 인스턴스는 현재 약 10개의 용량 단위를 지원할 수 있습니다.
> 계산 단위가 처리할 수 있는 요청 수는 TLS 인증서 키 크기, 키 교환 알고리즘, 헤더 다시 쓰기 및 WAF 들어오는 요청 크기의 경우와 같은 다양한 기준에 따라 달라집니다. 응용 프로그램 테스트를 수행하여 계산 단위당 요청 속도를 확인하는 것이 좋습니다. 용량 단위와 계산 단위는 청구가 시작되기 전에 메트릭으로 사용할 수 있습니다.

다음 표에서는 예제 가격을 보여 주며 그림 만 을 사용합니다.

**미국 동부 가격**:

|              SKU 이름                             | 고정 가격 ($/hr)  | 용량 단가($/CU-hr)   |
| ------------------------------------------------- | ------------------- | ------------------------------- |
| Standard_v2                                       |    0.20             | 0.0080                          |
| WAF_v2                                            |    0.36             | 0.0144                          |

자세한 가격 정보는 [가격 책정 페이지를](https://azure.microsoft.com/pricing/details/application-gateway/)참조하십시오. 

**실시예 1**

응용 프로그램 게이트웨이 Standard_v2 5개의 인스턴스의 고정 용량으로 수동 크기 조정 모드에서 자동 크기 조정 없이 프로비전됩니다.

고정 가격 = 744(시간) * $0.20 = $148.8 <br>
용량 단위 = 744(시간) * 인스턴스당 용량 단위 10개 * 인스턴스 5개 * 용량 단위 시간당 0.008 USD = $297.6

총 가격 = $148.8 + $297.6 = $446.4

**실시예 2**

애플리케이션 게이트웨이 standard_v2 최소 인스턴스가 0개인 한 달 동안 프로비전되며, 이 기간 동안 평균 8.88Mbps의 데이터 전송인 초당 25개의 새로운 TLS 연결을 수신합니다. 연결이 짧다고 가정하면 가격은 다음과 같습니다.

고정 가격 = 744(시간) * $0.20 = $148.8

용량 단위 가격 = 744(시간) * 최대(연결/초의 경우 25/50 계산 단위, 처리량의 경우 8.88/2.22용량 단위) * $0.008 = 744 * 4 * 0.008 = $23.81

총 가격 = $148.8+23.81 = $172.61

보시다시피 전체 인스턴스가 아닌 4개의 용량 단위에 대해서만 요금이 청구됩니다. 

> [!NOTE]
> Max 함수는 값 쌍에서 가장 큰 값을 반환합니다.


**실시예 3**

응용 프로그램 게이트웨이 standard_v2 한 달 동안 프로비전되며 인스턴스는 최소 5개입니다. 트래픽이 없고 연결이 짧다고 가정하면 가격은 다음과 같습니다.

고정 가격 = 744(시간) * $0.20 = $148.8

용량 단위 가격 = 744(시간) * 최대(연결/초의 경우 0/50 계산 단위, 처리량의 경우 0/2.22 용량 단위) * $0.008 = 744 * 50 * 0.008 = $297.60

총 가격 = $148.80+297.60 = $446.4

이 경우 트래픽이 없더라도 5개 인스턴스 전체에 대한 요금이 청구됩니다.

**실시예 4**

애플리케이션 게이트웨이 standard_v2 최소 5개의 인스턴스로 한 달 동안 프로비전되지만, 이번에는 평균 125mbps의 데이터 전송과 초당 25개의 TLS 연결이 있습니다. 트래픽이 없고 연결이 짧다고 가정하면 가격은 다음과 같습니다.

고정 가격 = 744(시간) * $0.20 = $148.8

용량 단위 가격 = 744(시간) * 최대(연결/초의 경우 25/50 계산 단위, 처리량에 대한 용량 단위 125/2.22 개) * $ 0.008 = 744 * 57 * 0.008 = $339.26

총 가격 = $148.80+339.26 = $488.06

이 경우 전체 인스턴스 5개에 7개의 용량 단위(인스턴스의 7/10)에 대한 요금이 청구됩니다.  

**예제 5**

응용 프로그램 게이트웨이 WAF_v2 한 달 동안 프로비전됩니다. 이 기간 동안 초당 25개의 새로운 TLS 연결, 평균 8.88Mbps의 데이터 전송을 수신하며 초당 80건의 요청을 수행합니다. 연결이 수명이 짧고 응용 프로그램에 대한 계산 단위 계산이 계산 단위당 10RPS를 지원한다고 가정하면 가격은 다음과 같습니다.

고정 가격 = 744(시간) * $0.36 = $267.84

용량 단위 가격 = 744(시간) * 최대(컴퓨팅 단위 최대(연결/초, 80/10 WAF RPS의 경우 25/50), 처리량에 대한 8.88/2.22 용량 단위) * $0.0144 = 744 * 8 * 0.0144 = $85.71

총 가격 = $267.84 + $85.71 = $353.55

> [!NOTE]
> Max 함수는 값 쌍에서 가장 큰 값을 반환합니다.

## <a name="scaling-application-gateway-and-waf-v2"></a>응용 프로그램 게이트웨이 및 WAF v2 크기 조정

응용 프로그램 게이트웨이 및 WAF는 다음 두 가지 모드로 확장하도록 구성할 수 있습니다.

- **자동 크기 조정** - 자동 크기 조정을 사용하도록 설정하면 응용 프로그램 게이트웨이 및 WAF v2 SCO가 응용 프로그램 트래픽 요구 사항에 따라 확장 또는 축소됩니다. 이 모드는 응용 프로그램에 더 나은 탄력성을 제공하고 응용 프로그램 게이트웨이 크기 또는 인스턴스 수를 추측할 필요가 없습니다. 또한 이 모드를 사용하면 게이트웨이가 최대 트래픽 로드에 대해 최대 프로비저닝된 용량으로 실행되지 않아도 비용을 절감할 수 있습니다. 최소 및 선택적으로 최대 인스턴스 수를 지정해야 합니다. 최소 용량은 트래픽이 없는 경우에도 응용 프로그램 게이트웨이 및 WAF v2가 지정된 최소 인스턴스 수 미만으로 떨어지지 않도록 합니다. 각 인스턴스는 10개의 추가 예약 용량 단위로 계산됩니다. 0은 예약된 용량이 없음을 나타내며 본질적으로 순수하게 자동 크기 조정입니다. 최소 인스턴스가 0개는 항상 고정 가격에 포함된 서비스의 고가용성을 보장합니다. 또한 선택적으로 최대 인스턴스 수를 지정하여 응용 프로그램 게이트웨이가 지정된 인스턴스 수를 초과하여 확장되지 않도록 할 수도 있습니다. 게이트웨이에서 제공하는 트래픽 양에 대한 요금은 계속 청구됩니다. 인스턴스 수는 0에서 125사이일 수 있습니다. 지정하지 않으면 최대 인스턴스 수의 기본값은 20입니다.
- **수동** - 게이트웨이가 자동으로 조정되지 않는 수동 모드를 선택할 수도 있습니다. 이 모드에서 응용 프로그램 게이트웨이 또는 WAF가 처리할 수 있는 트래픽보다 많은 트래픽이 있으면 트래픽이 손실될 수 있습니다. 수동 모드에서는 인스턴스 수를 지정하는 것이 필수입니다. 인스턴스 수는 1~125개의 인스턴스까지 다양할 수 있습니다.

## <a name="feature-comparison-between-v1-sku-and-v2-sku"></a>v1 SKU와 v2 SKU 간의 기능 비교

다음 표에서는 각 SKU에서 사용할 수 있는 기능을 비교합니다.

|                                                   | v1 SKU   | v2 SKU   |
| ------------------------------------------------- | -------- | -------- |
| 자동 확장                                       |          | &#x2713; |
| 영역 중복                                   |          | &#x2713; |
| 정적 VIP                                        |          | &#x2713; |
| Azure Kubernetes 서비스(AKS) 침투 컨트롤러 |          | &#x2713; |
| Azure Key Vault 통합                       |          | &#x2713; |
| HTTP(S) 헤더 다시 쓰기                           |          | &#x2713; |
| URL 기반 라우팅                                 | &#x2713; | &#x2713; |
| 다중 사이트 호스팅                             | &#x2713; | &#x2713; |
| 트래픽 리디렉션                               | &#x2713; | &#x2713; |
| WAF(웹 애플리케이션 방화벽)                    | &#x2713; | &#x2713; |
| WAF 사용자 지정 규칙                                  |          | &#x2713; |
| 전송 계층 보안(TLS)/보안 소켓 계층(SSL) 종료            | &#x2713; | &#x2713; |
| 종단 간 TLS 암호화                         | &#x2713; | &#x2713; |
| 세션 선호도                                  | &#x2713; | &#x2713; |
| 사용자 지정 오류 페이지                                | &#x2713; | &#x2713; |
| WebSocket 지원                                 | &#x2713; | &#x2713; |
| HTTP/2 지원                                    | &#x2713; | &#x2713; |
| 연결 드레이닝                               | &#x2713; | &#x2713; |

> [!NOTE]
> 이제 자동 크기 조정 v2 SKU는 [기본 상태 프로브를](application-gateway-probe-overview.md#default-health-probe) 지원하여 백 엔드 풀의 모든 리소스의 상태를 자동으로 모니터링하고 비정상으로 간주되는 백 엔드 멤버를 강조 표시합니다. 기본 상태 프로브는 사용자 지정 프로브 구성이 없는 백 엔드에 대해 자동으로 구성됩니다. 자세한 내용은 [응용 프로그램 게이트웨이의 상태 프로브를](application-gateway-probe-overview.md)참조하십시오.

## <a name="differences-with-v1-sku"></a>v1 SKU와의 차이점

|차이|세부 정보|
|--|--|
|인증 인증서|지원되지 않습니다.<br>자세한 내용은 [응용 프로그램 게이트웨이를 사용하여 종단 간 TLS 개요를](ssl-overview.md#end-to-end-tls-with-the-v2-sku)참조하십시오.|
|동일한 서브넷에서 Standard_v2와 표준 애플리케이션 게이트웨이 혼합|지원 안 함|
|응용 프로그램 게이트웨이 서브넷의 사용자 정의 경로(UDR)|지원되는(특정 시나리오). 미리 보기에서.<br> 지원되는 시나리오에 대한 자세한 내용은 [응용 프로그램 게이트웨이 구성 개요를](configuration-overview.md#user-defined-routes-supported-on-the-application-gateway-subnet)참조하십시오.|
|인바운드 포트 범위에 대한 NSG| - 65200 ~ 65535(Standard_v2 SKU)<br>- 65503 ~ 65534(Standard SKU)<br>자세한 내용은 [FAQ](application-gateway-faq.md#are-network-security-groups-supported-on-the-application-gateway-subnet)을 참조하세요.|
|Azure 진단의 성능 로그|지원되지 않습니다.<br>Azure 메트릭을 사용해야 합니다.|
|결제|청구는 2019년 7월 1일에 시작될 예정입니다.|
|FIPS 모드|현재는 지원되지 않습니다.|
|ILB 전용 모드|현재는 지원되지 않습니다. 공용 및 ILB 모드가 함께 지원됩니다.|
|Netwatcher 통합|지원되지 않습니다.|
|Azure Security Center 통합|아직 사용할 수 없습니다.

## <a name="migrate-from-v1-to-v2"></a>v1에서 v2로 마이그레이션

Azure PowerShell 스크립트는 PowerShell 갤러리에서 v1 응용 프로그램 게이트웨이/WAF에서 v2 자동 크기 조정 SKU로 마이그레이션하는 데 도움이 됩니다. 이 스크립트는 v1 게이트웨이에서 구성을 복사하는 데 도움이 됩니다. 트래픽 마이그레이션은 여전히 사용자의 책임입니다. 자세한 내용은 [azure 응용 프로그램 게이트웨이 를 v1에서 v2로 마이그레이션을](migrate-v1-v2.md)참조하십시오.

## <a name="next-steps"></a>다음 단계

- [빠른 시작: Azure 응용 프로그램 게이트웨이를 사용 하 고 직접 웹 트래픽 - Azure 포털](quick-create-portal.md)
- [Azure PowerShell을 사용하여 예약된 가상 IP 주소로 자동 크기 조정, 영역 중복 애플리케이션 게이트웨이 만들기](tutorial-autoscale-ps.md)
- [Application Gateway](overview.md)에 대해 자세히 알아보세요.
- [Azure Firewall](../firewall/overview.md)에 대해 자세히 알아보세요.
