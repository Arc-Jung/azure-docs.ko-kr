<properties
   pageTitle="Azure 백업에서 파일 및 폴더의 느린 백업 문제 해결 | Microsoft Azure"
   description="Azure 백업 성능 문제의 원인을 진단하고 줄이는 데 도움이 되는 문제 해결 지침을 제공합니다."
   services="backup"
   documentationCenter=""
   authors="genlin"
   manager="markgal"
   editor=""/>

<tags
    ms.service="backup"
    ms.workload="storage-backup-recovery"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="07/20/2016"
    ms.author="genli"/>

# Azure 백업에서 파일 및 폴더의 느린 백업 문제 해결

이 문서에서는 Azure 백업을 사용하는 파일 및 폴더 백업의 느린 백업 성능 문제를 진단하고 원인을 줄이는 데 도움이 되는 문제 해결 지침을 제공합니다. Azure 백업 에이전트를 사용하여 파일을 백업하는 경우 백업 프로세스가 예상보다 오래 걸릴 수 있습니다. 이 문제는 다음 중 하나 이상에 의해 발생할 수 있습니다.

-	[백업 중인 컴퓨터에서 성능 병목 현상이 발생하는 경우](#cause1)
-	[다른 프로세스 또는 바이러스 백신 소프트웨어가 Azure 백업을 방해하는 경우](#cause2)
-	[백업 에이전트가 Azure VM(가상 컴퓨터)에서 실행 중인 경우](#cause3)
-	[많은 수의 파일(수백만 개)을 백업하려는 경우](#cause4)

다음 섹션에서는 문제의 구체적 원인을 확인하는 데 도움을 줍니다.

문제 해결을 시작하기 전에 [최신 Azure 백업 에이전트](http://aka.ms/azurebackup_agent)를 다운로드하여 설치하는 것이 좋습니다. Microsoft는 다양한 문제를 해결하고, 기능을 추가하고, 성능을 향상시키기 위해 백업 에이전트를 자주 업데이트합니다.

일반적인 구성 문제가 발생하지 않도록 [Azure 백업 서비스 - FAQ](backup-azure-backup-faq.md)를 검토하는 것이 좋습니다.

## 문제 해결 단계
<a id="cause1"></a>
## 원인 1: 백업되고 있는 컴퓨터의 성능 병목 현상으로 인한 백업 속도 저하

### 해결 방법

백업 중인 컴퓨터에서 병목 현상이 나타나 지연을 발생시킬 수 있습니다. 예를 들어 컴퓨터가 디스크에 읽거나 쓰는 기능, 네트워크를 통해 데이터를 전송하는 대역폭 등이 여기에 해당될 수 있습니다.

Windows에서는 [성능 모니터](https://technet.microsoft.com/magazine/2008.08.pulse.aspx)(Perfmon)라는 기본 제공 도구를 제공하여 이러한 병목 상태를 검색합니다. 아래 표는 성능 카운터와 백업이 최적 상태가 되는 범위를 요약해서 보여 줍니다.

다음은 병목 현상 진단에 도움이 될 수 있는 몇 가지 성능 카운터 및 범위입니다.

| 카운터 | 상태 |
|---|---|
|Logical Disk(Physical Disk)--%idle | • 100% 유휴 ~ 50% 유휴 = 정상</br>• 49% 유휴 ~ 20% 유휴 = 경고 또는 모니터링</br>• 19% 유휴 ~ 0% 유휴 = 위험 또는 사양을 벗어남|
| 논리 디스크(실제 디스크)--%평균 Disk Sec Read or Write | • 0.001ms ~ 0.015ms = 정상</br>• 0.015ms ~ 0.025 = 경고 또는 모니터링</br>• 0.026ms 이상 = 위험 또는 사양을 벗어남|
| 논리 디스크(실제 디스크)--현재 디스크 큐 길이(모든 인스턴스) | 6분이 넘는 시간 동안 80개 요청 |
| Memory--Pool Non Paged Bytes|• 사용된 풀의 60% 미만 = 정상<br>• 사용된 풀의 61% - 80% = 경고 또는 모니터링</br>• 사용된 풀의 80% 초과 = 위험 또는 사양을 벗어남|
| Memory--Pool Paged Bytes |• 사용된 풀의 60% 미만 = 정상</br>• 사용된 풀의 61% - 80% = 경고 또는 모니터링</br>• 사용된 풀의 80% 초과 = 위험 또는 사양을 벗어남|
| Memory--Available Megabytes| • 사용 가능한 여유 메모리의 50% 이상 = 정상</br>• 사용 가능한 여유 메모리의 25% = 모니터링</br>• 사용 가능한 여유 메모리의 10% = 경고</br>• 사용 가능한 여유 메모리의 100MB 또는 5% 미만 = 위험 또는 사양을 벗어남|
|Processor--\\%Processor Time(모든 인스턴스)|• 60% 미만 사용 = 정상</br>• 61% - 90% 사용 = 모니터링 또는 주의</br>• 91% - 100% 사용 = 위험|


> [AZURE.NOTE] 인프라가 가능한 원인으로 격리되면 더 나은 성능을 위해 주기적으로 디스크의 조각 모음을 수행하는 것이 좋습니다.

<a id="cause2"></a>
## 원인 2: 다른 프로세스 또는 바이러스 백신 소프트웨어가 Azure 백업 프로세스를 방해함

Windows 시스템 내의 다른 프로세스가 Azure 백업 에이전트 프로세스의 성능에 부정적인 영향을 미치는 경우가 확인되었습니다. 예를 들어 Azure 백업 에이전트 및 다른 프로그램을 함께 사용하여 데이터를 백업하거나 바이러스 백신 소프트웨어가 실행되고 있고 백업할 파일이 잠겨 있는 경우 파일을 여러 번 잠그면서 경합이 발생할 수 있습니다. 이 경우 백업이 실패하거나 작업이 예상보다 오래 걸릴 수 있습니다.

### 해결 방법

이 시나리오에서 가장 좋은 방법은 다른 백업 프로그램을 해제하고 Azure 백업 에이전트의 백업 시간이 달라지는지 확인하는 것입니다. 일반적으로 여러 개의 백업이 동시에 실행되지 않도록 하는 것만으로도 백업이 서로 방해받지 않습니다.

바이러스 백신 프로그램의 경우 다음 파일 및 위치를 제외하는 것이 좋습니다.

- C:\\Program Files\\Microsoft Azure Recovery Services Agent\\bin\\cbengine.exe를 프로세스로 제외합니다.
- C:\\Program Files\\Microsoft Azure Recovery Services Agent\\ 폴더를 제외합니다.
- 스크래치 위치를 제외합니다(위 표준 위치를 사용하지 않는 경우).

<a id="cause3"></a>
## 원인 3: 백업 에이전트가 Azure VM(가상 컴퓨터)에서 실행되고 있음

### 해결 방법

VM에서 백업 에이전트를 실행하는 경우 실제 컴퓨터에서 실행할 때보다 성능이 더 느려집니다. 이것은 IOPS 제한 때문으로 예상됩니다. 그러나 백업되는 데이터 드라이브를 프리미엄 저장소로 전환하여 성능을 최적화할 수 있습니다. 이 문제를 해결하기 위해 계속 노력 중이며, 이후 릴리스에서 수정 사항을 사용할 수 있게 될 것입니다.

<a id="cause4"></a>
## 원인 4: 많은 수의 파일(수백만) 백업

### 해결 방법

많은 양의 데이터를 이동하면 더 작은 볼륨을 이동할 때보다 시간이 오래 걸릴 것으로 예상됩니다. 하지만 경우에 따라 백업 시간이 데이터의 크기뿐만 아니라 파일이나 폴더의 수에도 관련이 있습니다. 특히 수백만 개의 작은 파일(몇 바이트에서 몇 킬로바이트 크기)을 백업하는 경우 더욱 그렇습니다.

이 동작은 데이터를 백업하고 Azure로 이동하면서 동시에 파일 카탈로그를 만들며, 드문 경우지만 카탈로그 작업이 오래 걸릴 수 있기 때문에 나타납니다.

아래 단계에 따라 병목 상태를 이해하고 다음 단계에서 작업을 진행하세요.

a. **UI에 전송되는 데이터 양에 대한 진행률이 표시됨** - 이 경우 데이터가 계속 전송되며 네트워크 대역폭 또는 데이터 크기로 인해 지연이 발생할 수 있습니다.

b. **UI에 진행률이 표시되지 않음** - 이 경우 "C:\\Microsoft Azure Recovery Services Agent\\Temp"에 있는 로그를 열고 로그에서 "FileProvider::EndData" 항목을 확인합니다. 이 항목은 데이터 전송이 완료되었으며 카탈로그 작업이 발생함을 나타냅니다. 백업 작업을 취소하지 말고, 대신 카탈로그가 끝날 때까지 좀 더 기다리세요. 문제가 지속되면 [Azure 지원](https://portal.azure.com/#create/Microsoft.Support)에 문의하세요.

<!---HONumber=AcomDC_0720_2016-->