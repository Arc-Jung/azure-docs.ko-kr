<properties
	pageTitle="Azure 가상 컴퓨터 백업 - 백업 | Microsoft Azure"
	description="등록 후 Azure 가상 컴퓨터를 백업하는 방법 배우기"
	services="backup"
	documentationCenter=""
	authors="trinadhk"
	manager="shreeshd"
	editor=""/>

<tags ms.service="backup" ms.workload="storage-backup-recovery" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="hero-article" ms.date="09/14/2015" ms.author="trinadhk"; "aashishr"; "jimpark"/>


# Azure 가상 컴퓨터 백업
이 문서는 Azure 가상 컴퓨터 백업에 대한 필수 가이드입니다. 진행하기 전에 모든 [필수 조건](backup-azure-vms-introduction.md#prerequisites)이 충족되었는지 확인해야 합니다.

Azure 가상 컴퓨터 백업에는 3가지 주요 단계가 포함됩니다.

![Azure 가상 컴퓨터를 백업하는 세 단계](./media/backup-azure-vms/3-steps-for-backup.png)

>[AZURE.NOTE]가상 컴퓨터 백업은 로컬입니다. 지정한 Azure 지역에서 백업 저장소는 다른 Azure 지역의 가상 컴퓨터를 백업할 수 없습니다. 따라서 백업이 필요한 VM이 있는 모든 Azure 지역의 경우, 해당 지역에 1개 이상의 백업 저장소가 만들어져야 합니다.

## 1\. Azure 가상 컴퓨터 검색
검색 프로세스는 클라우드 서비스 이름 및 지역과 같은 추가 정보와 함께 구독의 가상 컴퓨터 목록을 Azure에 쿼리합니다. 검색 프로세스는 항상 첫 번째 단계로 실행해야 합니다. 이는 구독에 추가된 새 가상 컴퓨터와 식별하기 위한 것입니다.

### 검색 프로세스를 시작하려면

1. Azure 포털의 **복구 서비스**에서 찾을 수 있는 백업 저장소로 이동한 다음 **등록된 항목** 탭을 클릭합니다.

2. 드롭다운 메뉴의 워크로드 유형을 **Azure 가상 컴퓨터**로 선택한 다음 **선택** 단추를 클릭합니다.

    ![워크로드 선택](./media/backup-azure-vms/discovery-select-workload.png)

3. 페이지 맨 아래에 있는 **검색** 단추를 클릭합니다. ![검색 단추](./media/backup-azure-vms/discover-button-only.png)

4. 검색 프로세스는 가상 컴퓨터를 표로 정리하는 동안 몇 분 동안 실행할 수 있습니다. 검색 프로세스가 실행되는 동안 화면 아래쪽에 알림 메시지가 표시됩니다.

    ![vms 검색](./media/backup-azure-vms/discovering-vms.png)

5. 검색 프로세스가 완료되면 알림 메시지가 표시됩니다.

    ![검색-완료](./media/backup-azure-vms/discovery-complete.png)

##  2\. Azure 가상 컴퓨터 등록
가상 컴퓨터를 보호하려면 먼저 Azure 백업 서비스에 등록해야 합니다. 등록 프로세스의 주요 목표는 Azure 백업 서비스와 가상 컴퓨터를 연결하는 것입니다. 등록은 일반적으로 일회성 작업입니다.

>[AZURE.NOTE]백업 확장은 등록 단계 동안 설치되지 않습니다. 백업 에이전트의 설치 및 업데이트는 이제 예약된 백업 작업의 일부가 되었습니다.

### 가상 컴퓨터를 등록하려면

1. Azure 포털의 **복구 서비스**에서 찾을 수 있는 백업 저장소로 이동한 다음 **등록된 항목** 탭을 클릭합니다.

2. 드롭다운 메뉴의 워크로드 유형을 **Azure 가상 컴퓨터**로 선택한 다음 선택 단추를 클릭합니다.

    ![워크로드 선택](./media/backup-azure-vms/discovery-select-workload.png)

3. 페이지 맨 아래에 있는 **등록** 단추를 클릭합니다.

    ![등록 단추](./media/backup-azure-vms/register-button-only.png)

4. **등록 항목** 바로 가기 메뉴에서 등록하려는 가상 컴퓨터를 선택합니다. 동일한 이름을 가진 가상 컴퓨터가 두 개 이상 있는 경우 클라우드 서비스를 사용하여 가상 컴퓨터를 구분합니다.

    **등록** 작업은 대규모로 수행될 수 있으며 이는 여러 가상 컴퓨터를 한 번에 선택하여 등록할 수 있다는 뜻입니다. 백업을 위해 가상 컴퓨터를 준비하는 데 들이는 한 번의 노력을 크게 줄여 줍니다.

5. 등록해야 하는 각 가상 컴퓨터에 대한 작업이 만들어집니다. 알림 메시지는 이 활동의 상태를 보여줍니다. **작업 보기**를 클릭하여 **작업** 페이지로 이동합니다.

    ![등록 작업](./media/backup-azure-vms/register-create-job.png)

6. 가상 컴퓨터가 등록된 항목 목록에도 나타나며 등록 작업의 상태가 표시됩니다.

    ![등록 상태 1](./media/backup-azure-vms/register-status01.png)

7. 작업이 완료되면 포털의 상태가 등록된 상태를 반영하도록 변경됩니다.

    ![등록 상태 2](./media/backup-azure-vms/register-status02.png)

## 3\. 보호: Azure 가상 컴퓨터 백업
이 단계에는 가상 컴퓨터의 백업 및 보존 정책 설정이 포함됩니다. 단일 보호 작업을 사용하여 여러 가상 컴퓨터를 규모별로 보호할 수 있습니다.

>[AZURE.NOTE]2015년 5월 이후에 만든 Azure 백업 자격 증명 모음은 자격 증명 모음에 기본 제공되는 기본 정책을 사용합니다. 이 기본 정책을 30일의 기본 보존 기간 및 하루 한 번 백업 일정과 함께 제공됩니다.

가상 컴퓨터를 보호하려면 다음 단계를 수행합니다.

1. Azure 포털의 **복구 서비스**에서 찾을 수 있는 백업 저장소로 이동한 다음 **등록된 항목** 탭을 클릭합니다.
2. 드롭다운 메뉴의 워크로드 형식을 **Azure 가상 컴퓨터**로 선택한 다음 **선택**을 클릭합니다.

    ![포털에서 워크로드 선택](./media/backup-azure-vms/select-workload.png)

3. 페이지 맨 아래에 있는 **보호**를 클릭합니다. **보호 항목** 마법사가 나타납니다. 이 마법사는 등록되고 보호되지 않은 가상 컴퓨터만을 나열합니다.

4. **항목 보호** 마법사에서 보호할 가상 컴퓨터를 선택할 수 있습니다. 동일한 이름을 가진 가상 컴퓨터가 두 개 이상 있는 경우 클라우드 서비스를 사용하여 가상 컴퓨터를 구분합니다.

    **보호** 작업은 대규모로 수행될 수 있으며 이는 여러 가상 컴퓨터를 한 번에 선택하여 보호할 수 있음을 의미합니다. 가상 컴퓨터를 준비하는 데 들이는 노력을 크게 줄여 줍니다.

    ![규모로 보호 구성](./media/backup-azure-vms/protect-at-scale.png)

5. **보호 항목** 마법사의 두 번째 화면에서 백업 일정을 선택하여 선택한 가상 컴퓨터를 백업합니다. 정책의 기존 집합에서 선택하거나 새로 정의합니다.

    각 백업 저장소에서 여러 백업 정책을 사용할 수 있습니다. 정책은 백업을 예약 및 보존하는 방법에 대한 세부 정보를 반영합니다. 예를 들어 다른 백업 정책이 매주 토요일 오전 6시에 백업되는 반면 한 백업 정책은 매일 밤 10시에 백업될 수 있습니다. 여러 백업 정책을 통해 가상 컴퓨터 인프라에 대한 백업 예약을 유연하게 할 수 있습니다.

    각 백업 정책 정책에는 해당 정책과 연관된 여러 가상 컴퓨터가 있을 수 있습니다. 가상 컴퓨터는 특정 시간에 한 정책과만 연관될 수 있습니다.

    ![새 정책으로 보호](./media/backup-azure-vms/policy-schedule.png)

6. **보호 항목** 마법사의 세 번째 화면에서 수행된 백업과 연결될 보존 범위를 선택합니다. 이 화면에서는 보존 체계를 기반으로 한 업계 표준 GFS(Grandfather-Father-Son)를 지원합니다. [장기 보존](#long-term-retention)에 대해 자세히 알아보세요.

    또한 백업 정책은 예약된 백업의 보존 체계를 포함합니다. 이전 화면에서 기존 백업 정책을 선택하면 보존 체계를 수정하지 못하고 백업은 정책에 정의된 보존 정책을 수행합니다.

    ![유연한 보존으로 보호](./media/backup-azure-vms/policy-retention.png)

7. 각 가상 컴퓨터에 대한 작업을 만들어 보호 정책을 구성하고 가상 컴퓨터를 정책과 연결합니다. **작업** 탭을 클릭하고 적합한 필터를 선택하여 **보호 구성** 작업 목록을 봅니다.

    ![보호 작업 구성](./media/backup-azure-vms/protect-configureprotection.png)


## 이후 보호 작업

### 백업 확장의 설치
Azure 백업 서비스가 매끄럽게 업그레이드를 처리하고 다루기 힘든 사용자 간섭 없이 백업 확장을 패치합니다. 이는 일반적으로 백업 제품과 관련된 "에이전트 관리 오버헤드"의 사용자를 안심시킵니다.

#### 오프라인 VM
백업 확장은 VM을 실행하는 경우 설치됩니다. 또한 실행 중인 VM은 응용 프로그램 일치 시점을 확보하는 가장 큰 기회를 제공합니다. 그러나 Azure 백업 서비스는 VM이 꺼져 확장을 설치할 수 없더라도(즉, 오프라인 VM) VM을 계속 백업합니다. 그 영향은 일관성에서 나타납니다. 이러한 경우, 복귀 지점에 *일관되게 충돌*이 발생합니다.

### 초기 백업
가상 컴퓨터가 정책으로 보호되면, 이는 *보호됨 - (초기 백업 보류 중)* 상태로 **보호된 항목** 탭 아래에 표시됩니다. 기본적으로 첫 번째 예약된 백업은 초기 백업입니다. 보호 구성 직후 초기 백업을 트리거하려면 **보호된 항목** 페이지의 아래쪽에 있는 **지금 백업** 단추를 사용합니다.

Azure 백업 서비스는 초기 백업 작업에 대한 백업 작업을 만듭니다. **작업** 탭을 클릭하여 작업 목록을 봅니다. 백업 작업의 일부로 Azure 백업 서비스는 각 가상 컴퓨터에서 백업 확장에 대한 명령을 발행하여 모든 쓰기를 플러시하고 일관된 스냅숏을 찍습니다.

![진행 중인 백업](./media/backup-azure-vms/protect-inprogress.png)

초기 백업이 완료되면 **보호된 항목** 탭에서 가상 컴퓨터의 *보호 상태*가 *보호됨*으로 표시됩니다.

![가상 컴퓨터는 복구 지점으로 백업됨](./media/backup-azure-vms/protect-backedupvm.png)

### 백업 상태 및 세부 정보 보기
보호되면 가상 컴퓨터 수가 **대시보드** 페이지 요약에서도 증가합니다. 또한 **대시보드** 페이지에서 지난 24시간 내의 성공 및 실패한 작업 수 및 아직 진행 중인 작업 수를 보여줍니다. 한 범주를 클릭하면 **작업** 페이지에서 해당 범주를 자세히 다루게 됩니다.

![대시보드 페이지에서 백업 상태](./media/backup-azure-vms/dashboard-protectedvms.png)

>[AZURE.NOTE]대시보드의 값은 24시간마다 한 번 새로 고쳐집니다.

### 장기 보존
보존 정책은 백업을 저장할 기간을 나타냅니다. 모든 백업 지점에 대한 "일반 보존"을 지정하는 대신 백업이 수행되는 시기에 따라 다른 보존 정책을 지정할 수 있습니다. 예를 들어, 각 분기 말에 수행된 백업 지점은 감사를 위해 더 오랜 기간 동안 유지되어야 하는 반면, 매일 수행된 백업 지점(작업 복구 지점 역할)은 90일 동안 유지되어야 합니다.

![가상 컴퓨터는 복구 지점으로 백업됨](./media/backup-azure-vms/long-term-retention.png)

1. **일 단위 보존 정책**: 매일 수행된 백업이 30일 동안 저장됩니다.
2. **주 단위 보존 정책**: 매주 일요일에 수행된 백업이 104주 동안 유지됩니다.
3. **월 단위 보존 정책**: 매달 마지막 주 일요일에 수행된 백업이 120개월 동안 유지됩니다.
4. **월 단위 보존 정책**: 매년 1월 첫째 주 일요일에 수행된 백업이 99년 동안 유지됩니다.

## 복구 지점의 일관성
백업 데이터를 처리할 때 고객들은 복원된 후의 VM 동작을 염려합니다. 고객이 문의하는 일반적인 질문은 다음과 같습니다.

- 가상 컴퓨터가 부팅되나요?
- 해당 데이터를 디스크에서 사용할 수 있나요? (또는) 데이터 손실이 있나요?
- 응용 프로그램이 데이터를 읽을 수 있나요? (또는) 데이터 손상이 있나요?
- 응용 프로그램에서 데이터를 이해할 수 있나요? (또는) 응용 프로그램이 데이터를 읽을 때 일관성이 있나요?

다음 표에서 Azure VM 백업 및 복원 중에 발생하는 일관성 유형을 설명합니다.

| 일관성 | VSS 기반 | 설명 및 세부 정보 |
|-------------|-----------|---------|
| 응용 프로그램 일관성 | 예 | Microsoft 워크로드에서 다음을 확인하는 데 적합한 위치입니다.<ol><li> VM이 *부팅*됩니다. <li>*손상이 없습니다*. <li>*데이터 손실이 없습니다*.<li> 데이터는 백업 시 VSS를 사용하는 응용 프로그램을 포함하여 데이터를 사용하는 응용 프로그램과 일치됩니다.</ol> VSS(볼륨 스냅숏 서비스)를 통해 데이터가 저장소에 제대로 작성되었음을 확인할 수 있습니다. 대부분의 Microsoft 워크로드에는 데이터 일관성과 관련된 워크로드 관련 동작을 수행하는 VSS 작성자가 있습니다. 예를들어 Microsoft SQL Server에는 트랜잭션 로그 파일에 대한 쓰기를 확인하고 데이터베이스가 제대로 수행되었는지 확인하는 VSS 작성자가 있습니다.<br><br> Azure VM 백업의 경우, 응용 프로그램에 일관된 복구 지점이 있다는 것은 백업 확장이 VSS 워크플로를 적용하고 VM 스냅숏을 촬영하기 전에 *제대로* 완료할 수 있었음을 의미합니다. 기본적으로 Azure VM에서 모든 응용 프로그램의 VSS 작성자도 적용되었음을 의미합니다.<br><br>[어떻게 동작하는지](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)에 대해 자세히 다루어 [VSS의 기본 사항](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx)에 대해 알아봅니다. |
| 파일 시스템 일관성 | 예 - Windows 컴퓨터의 경우 | 파일 시스템이 일관될 수 있는 복구 지점이 있는 두 가지 시나리오가 있습니다.<ul><li>Azure에서 Linux VM 백업, Linux에는 VSS에 해당하는 플랫폼이 없기 때문.<li>Azure에서 Windows VM 백업 중에 VSS 오류.</li></ul> 두 경우 모두 최선의 방법은 다음을 확인하는 것입니다. <ol><li> VM이 *부팅*됩니다. <li>*손상이 없습니다*.<li>*데이터 손실이 없습니다*.</ol> 응용 프로그램은 복원된 데이터에 대해 고유한 "수정" 메커니즘을 구현해야 합니다.|
| 충돌 일관성 | 아니요 | 이 상황은 "충돌"을 경험하는 컴퓨터와 같습니다(소프트 또는 하드 재설정 모두). 이 문제는 일반적으로 Azure 가상 컴퓨터가 백업 시 종료 될 때 발생 합니다. Azure 가상 컴퓨터 백업의 경우, 일관된 복구 지점에 충돌이 있다는 것은 Azure 백업이 저장소의 데이터 일관성을 보장해 주지 않는다는 뜻입니다(OS 관점 또는 응용 프로그램의 관점에서). 백업 시 디스크에 이미 존재 하는 데이터만이 캡처 및 백업된 내용입니다. <br/> <br/> 보장은 없지만, 대부분의 경우 OS가 부팅됩니다. 이는 일반적으로 손상 오류를 수정하기 위한 chkdsk와 같은 디스크 검사 과정 이후에 발생합니다. 메모리 내 데이터 또는 디스크에 완전히 플러시되지 않은 쓰기는 손실됩니다. 일반적으로 응용 프로그램은 데이터 롤백 작업을 수행해야 하는 경우에 고유한 확인 매커니즘을 수행합니다. Azure VM 백업의 경우, 일관된 복구 지점에 충돌이 있다는 것은 Azure 백업이 저장소의 데이터 일관성을 보장해 주지 않는다는 뜻입니다(OS 관점 또는 응용 프로그램의 관점에서). 일반적으로 백업 시 Azure VM이 종료되는 경우 발생합니다.<br><br>예를 들어 트랜잭션 로그에 데이터베이스에 없는 항목이 있는 경우 데이터베이스 소프트웨어는 데이터가 일치할 때까지 롤백합니다. 여러 가상 디스크(예: 스팬 볼륨)에 분산된 데이터를 다룰 때 충돌-일관성 복구 지점은 데이터 정확성에 대해 보장하지 않습니다.|


## 성능 및 리소스 사용률
온-프레미스로 배포되는 백업 소프트웨어와 마찬가지로 Azure의 VM의 백업도 용량 및 리소스 사용률에 대한 계획을 세워야 합니다. [Azure 저장소 제한](azure-subscription-service-limits.md#storage-limits)은 워크로드 실행에 대한 영향을 최소화하면서 최대의 성능을 얻기 위한 VM 배포 구성 방법을 정의합니다. 백업 성능에 영향을 미치는 두 가지 주요 Azure 저장소 제한이 있습니다.

- 저장소 계정당 최대 송신
- 저장소 계정당 총 요청 속도

백업 데이터가 고객 저장소 계정으로부터 복사되면, 저장소 계정의 IOPS 및 송신(저장소 처리량) 메트릭을 향해 계산됩니다. 동시에 가상 컴퓨터도 실행되어 IOPS와 처리량을 사용합니다. 목표는 총 트래픽 - 백업 및 가상 컴퓨터 -이 저장소 계정 제한을 초과 하지 않는지 확인하는 것입니다.

백업은 많은 메모리를 소모하며 최대한 빨리 백업을 완료하기 위해 가능한 한 많은 리소스를 사용하려고 합니다. 그러나 모든 IO 작업은 *초당 60MB*의 제한이 있는 *단일 Blob의 목표 처리량*에 의해 제한됩니다. 백업 프로세스의 속도를 높이기 위해, VM의 각 디스크 백업을 *병렬로* 시도합니다. 따라서 VM에 4개의 디스크가 있는 경우, Azure 백업은 4개의 디스크를 모두 병렬로 백업하게 됩니다. 따라서 고객 저장소 계정으로부터 백업 트래픽이 있는지 판단하는 가장 중요한 단일 요소는 저장소 계정으로부터 백업되고 있는 **디스크 수**입니다.

성능에 영향을 주는 두 번째 요소는 **백업 일정**입니다. 동시에 모든 VM을 백업하도록 구성하는 경우, Azure 백업은 가능한 한 많은 디스크를 백업하려 하므로 *병렬로* 백업되는 디스크 수가 증가합니다. 저장소 계정의 백업 트래픽을 줄일 수는 한 가지 방법은 다른 VM이 겹치지 않게 하루의 서로 다른 시간대에 백업되는지 확인하는 것입니다.

### 용량 계획
이러한 모든 요소를 한데 모으는 것은 저장소 계정 사용을 적절하게 계획해야 함을 의미합니다. [VM 백업 용량 계획 Excel 시트](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33)를 다운로드하여 디스크 및 백업 일정 선택의 영향을 확인하세요.

### 백업 처리량
백업 중인 각 디스크에 대해 Azure 백업은 디스크의 블록을 읽고 변경 된 데이터(증분 백업)만 저장합니다. 아래 표는 다음과 같은 Azure 백업으로부터 예상할 수 있는 평균 처리량 값을 보여줍니다.

| 백업 작업 | 최상의 처리량 |
| ---------------- | ---------- |
| 초기 백업 | 160Mbps |
| 증분 백업(DR) | 640Mbps <br><br> 백업해야 하는 디스크에 분산된 변동이 많은 경우 이 처리량이 훨씬 감소할 수 있습니다. |

이를 사용하여 지정된 크기의 디스크 백업에 소요되는 시간을 예상할 수 있습니다.

### 총 VM 백업 시간
대부분의 시간은 데이터를 읽고 쓰는 데 사용되지만, VM을 백업하는 데 소요되는 총 시간에는 다음과 같은 기타 작업도 포함됩니다.

1. [백업 확장 설치 또는 업데이트](backup-azure-vms.md#offline-vms)하는 데 소요되는 시간
2. 큐 대기 시간: 서비스는 다수의 고객으로부터 백업을 처리하기 때문에, 백업 작업은 즉시 시작되지 않을 수 있습니다. 한 VM의 평균 대기 시간은 15-30분입니다.

## 문제 해결
가상 컴퓨터 백업 도중 발생하는 오류에 대한 해결 방법의 전체 목록을 가져옵니다.

- [가상 컴퓨터 백업 문제 해결](backup-azure-vms-troubleshoot.md)

## 다음 단계
Azure 백업 시작하기에 대해 자세히 알아보려면 다음을 참조하세요.

- [가상 컴퓨터 복원](backup-azure-restore-vms.md)
- [가상 컴퓨터 관리](backup-azure-manage-vms.md)

<!---HONumber=Sept15_HO3-->