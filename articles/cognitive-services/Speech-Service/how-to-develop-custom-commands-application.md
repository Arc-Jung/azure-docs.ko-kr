---
title: '방법: 사용자 지정 명령 개발 응용 프로그램-음성 서비스'
titleSuffix: Azure Cognitive Services
description: 사용자 지정 명령 응용 프로그램을 개발 하 고 사용자 지정 하는 방법을 알아봅니다. 이러한 음성 명령 앱은 작업 완료 또는 명령 및 제어 시나리오에 가장 적합 합니다.
services: cognitive-services
author: trevorbye
manager: nitinme
ms.service: cognitive-services
ms.subservice: speech-service
ms.topic: conceptual
ms.date: 12/15/2020
ms.author: trbye
ms.openlocfilehash: b3e9c1e8ad23ea0ebf540eddbd6d4a03b8a72fe2
ms.sourcegitcommit: 8be279f92d5c07a37adfe766dc40648c673d8aa8
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 12/31/2020
ms.locfileid: "97835077"
---
# <a name="develop-custom-commands-applications"></a>사용자 지정 명령 응용 프로그램 개발

이 방법 문서에서는 사용자 지정 명령 응용 프로그램을 개발 하 고 구성 하는 방법을 알아봅니다. 사용자 지정 명령 기능을 사용 하면 음성 우선 상호 작용 환경에 최적화 된 풍부한 음성 명령 앱을 빌드할 수 있습니다. 기능은 작업 완료 또는 명령 및 제어 시나리오에 가장 적합 합니다. IoT (사물 인터넷) 장치 및 주변 및 헤드리스 장치에 특히 적합 합니다.

이 문서에서는 TV를 켜고 끌 수 있으며 온도를 설정 하 고 경보를 설정할 수 있는 응용 프로그램을 만듭니다. 이러한 기본 명령을 만든 후에는 명령을 사용자 지정 하는 다음 옵션에 대해 알아봅니다.

* 명령에 매개 변수 추가
* 명령 매개 변수에 구성 추가
* 상호 작용 규칙 빌드
* 음성 응답을 위한 언어 생성 템플릿 만들기
* 사용자 지정 음성 도구 사용

## <a name="create-an-application-by-using-simple-commands"></a>간단한 명령을 사용 하 여 응용 프로그램 만들기

빈 사용자 지정 명령 응용 프로그램을 만들어 시작 합니다. 자세한 내용은 [빠른](quickstart-custom-commands-application.md)시작을 참조 하세요. 이 응용 프로그램에서는 프로젝트를 가져오는 대신 빈 프로젝트를 만듭니다.

1. **이름** 상자에 프로젝트 *이름 (또는 원하는 다른 이름)* 을 입력 합니다.
1. **언어** 목록에서 **영어 (미국)** 를 선택 합니다.
1. LUIS 리소스를 선택 하거나 만듭니다.

   > [!div class="mx-imgBorder"]
   > !["새 프로젝트" 창을 보여 주는 스크린샷](media/custom-commands/create-new-project.png)

### <a name="update-luis-resources-optional"></a>LUIS 리소스 업데이트 (옵션)

**새 프로젝트** 창에서 선택한 제작 리소스를 업데이트할 수 있습니다. 예측 리소스를 설정할 수도 있습니다. 

예측 리소스는 사용자 지정 명령 응용 프로그램이 게시 될 때 인식에 사용 됩니다. 개발 및 테스트 단계 중에는 예측 리소스가 필요 하지 않습니다.

### <a name="add-a-turnon-command"></a>TurnOn 명령 추가

만든 빈 스마트 공간-Lite 사용자 지정 명령 응용 프로그램에서 명령을 추가 합니다. 이 명령은 utterance를 처리 `Turn on the tv` 합니다. 메시지와 함께 응답 `Ok, turning the tv on` 합니다.

1. 왼쪽 창의 맨 위에 있는 **새 명령** 을 선택 하 여 새 명령을 만듭니다. **새 명령** 창이 열립니다.
1. **이름** 필드에 값을 입력 `TurnOn` 합니다.
1. **만들기** 를 선택합니다.

가운데 창에는 명령의 속성이 나열 됩니다. 

다음 표에서는 명령의 구성 속성에 대해 설명 합니다. 자세한 내용은 [사용자 지정 명령 개념 및 정의](./custom-commands-references.md)를 참조 하세요.

| 구성            | Description                                                                                                                 |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------- |
| 예제 문장 | 예 길이 발언 사용자가이 명령을 트리거할 수 있습니다.                                                                 |
| 매개 변수       | 명령을 완료 하는 데 필요한 정보입니다.                                                                                |
| 완료 규칙 | 명령을 수행 하기 위해 수행할 작업입니다. 예: 사용자에 게 응답 하거나 웹 서비스와 통신 합니다. |
| 상호 작용 규칙   | 보다 구체적 이거나 복잡 한 상황을 처리 하는 다른 규칙                                                              |


> [!div class="mx-imgBorder"]
> ![명령을 만들 위치를 보여 주는 스크린샷](media/custom-commands/add-new-command.png)

#### <a name="add-example-sentences"></a>예제 문장 추가

**예제 문장** 섹션에서 사용자가 말할 수 있는 내용의 예를 제공 합니다.

1. 가운데 창에서 **예제 문장** 을 선택 합니다.
1. 오른쪽 창에 다음 예제를 추가 합니다.

    ```
    Turn on the tv
    ```

1.  창 맨 위에서 **저장** 을 선택합니다.

매개 변수를 아직가지고 있지 않으므로 **완료 규칙** 섹션으로 이동할 수 있습니다.

#### <a name="add-a-completion-rule"></a>완료 규칙 추가

다음에는 명령에 완료 규칙이 필요 합니다. 이 규칙은 사용자에 게 처리 작업을 수행 하 고 있음을 알려 줍니다. 

규칙 및 완료 규칙에 대 한 자세한 내용은 [사용자 지정 명령 개념 및 정의](./custom-commands-references.md)를 참조 하세요.

1. 기본 완료 규칙 **완료** 를 선택 합니다. 그런 다음 다음과 같이 편집 합니다.

    
    | 설정    | 제안 값                          | Description                                        |
    | ---------- | ---------------------------------------- | -------------------------------------------------- |
    | **이름**       | `ConfirmationResponse`                  | 규칙의 용도를 설명 하는 이름입니다.          |
    | **조건** | 없음                                     | 규칙을 실행할 수 있는 시기를 결정 하는 조건    |
    | **actions**    | **음성 응답 보내기**  >  **간단한 편집기**  >  **첫 번째 변형** > `Ok, turning the tv on` | 규칙 조건이 참인 경우 수행할 동작입니다. |

   > [!div class="mx-imgBorder"]
   > ![음성 응답을 만들 위치를 보여 주는 스크린샷](media/custom-commands/create-speech-response-action.png)

1. **저장** 을 선택 하 여 작업을 저장 합니다.
1. **완료 규칙** 섹션으로 돌아가서 **저장** 을 선택 하 여 모든 변경 내용을 저장 합니다. 

    > [!NOTE]
    > 명령과 함께 제공 되는 기본 완료 규칙을 사용할 필요가 없습니다. 기본 완료 규칙을 삭제 하 고 사용자 고유의 규칙을 추가할 수 있습니다.

### <a name="add-a-settemperature-command"></a>SetTemperature 명령 추가

이제 명령 하나를 추가 `SetTemperature` 합니다. 이 명령은 단일 utterance를 사용 하 여 `Set the temperature to 40 degrees` 메시지에 응답 `Ok, setting temperature to 40 degrees` 합니다.

새 명령을 만들려면 명령에 사용한 단계를 따르고, `TurnOn` 예제 문장을 사용 `Set the temperature to 40 degrees` 합니다.

그런 다음 기존 **완료** 완료 규칙을 다음과 같이 편집 합니다.

| 설정    | 제안 값                          |
| ---------- | ---------------------------------------- |
| **이름**  | `ConfirmationResponse`                  |
| **조건** | 없음                                     |
| **actions**    | **음성 응답 보내기**  >  **간단한 편집기**  >  **첫 번째 변형** > `Ok, setting temperature to 40 degrees` |

**저장** 을 선택 하 여 명령에 대 한 모든 변경 내용을 저장 합니다.

### <a name="add-a-setalarm-command"></a>SetAlarm 명령 추가

새 명령을 만듭니다 `SetAlarm` . 예제 문장을 사용 `Set an alarm for 9 am tomorrow` 합니다. 그런 다음 기존 **완료** 완료 규칙을 다음과 같이 편집 합니다.

| 설정    | 제안 값                          |
| ---------- | ---------------------------------------- |
| **이름**  | `ConfirmationResponse`                  |
| **조건** | 없음                                     |
| **actions**    | **음성 응답 보내기**  >  **간단한 편집기**  >  **첫 번째 변형** > `Ok, setting an alarm for 9 am tomorrow` |

**저장** 을 선택 하 여 명령에 대 한 모든 변경 내용을 저장 합니다.

### <a name="try-it-out"></a>사용해 보기

테스트 창을 사용 하 여 응용 프로그램의 동작을 테스트 합니다. 

1. 창의 오른쪽 위 모퉁이에서 **학습** 아이콘을 선택 합니다. 
1. 교육이 완료 되 면 **테스트** 를 선택 합니다. 

음성 또는 텍스트를 사용 하 여 다음 utterance 예제를 사용해 보세요.

- 입력: *온도를 40도로 설정 합니다* .
- 예상 응답: 정상, 온도를 40 각도로 설정
- *Tv 켜기* 를 입력 합니다.
- 예상 응답: 정상, tv 켜기
- 입력: *내일 오전 9 시에 경보 설정*
- 예상 응답: Ok, 내일 오전 9 시의 경보 설정

> [!div class="mx-imgBorder"]
> ![웹 채팅 인터페이스에서 테스트를 보여 주는 스크린샷](media/custom-commands/create-basic-test-chat.png)

> [!TIP]
> 테스트 창에서이 음성 입력 또는 텍스트 입력의 처리 방법에 대 한 정보를 **설정** 합니다 .를 선택할 수 있습니다.

## <a name="add-parameters-to-commands"></a>명령에 매개 변수 추가

이 섹션에서는 명령에 매개 변수를 추가 하는 방법에 대해 알아봅니다. 명령에는 작업을 완료 하는 매개 변수가 필요 합니다. 복잡 한 시나리오에서 매개 변수를 사용 하 여 사용자 지정 작업을 트리거하는 조건을 정의할 수 있습니다.

### <a name="configure-parameters-for-a-turnon-command"></a>TurnOn 명령에 대 한 매개 변수 구성

기존 명령을 편집 하 여 여러 장치를 설정 하 고 해제 하는 것부터 시작 `TurnOn` 합니다.

1. 이제 명령이 on 및 off 시나리오를 모두 처리 하기 때문에 명령 이름을이 *아닌* 상태로 바꿉니다.
   1. 왼쪽 창에서 **TurnOn** 명령을 선택 합니다. 그런 다음 창의 맨 위에 있는 **새로 만들기 명령** 옆에 있는 줄임표 (**...**) 단추를 선택 합니다.
   
   1. **이름 바꾸기** 를 선택 합니다. 이름 **바꾸기 명령** 창에서 이름을 *turnonoff* 로 변경 합니다.

1. 명령에 새 매개 변수를 추가 합니다. 매개 변수는 사용자가 장치를 켤 지 여부를 나타냅니다.
   1. 가운데 창 위쪽에서  **추가** 를 선택 합니다. 드롭다운 메뉴에서 **매개 변수** 를 선택 합니다.
   1. 오른쪽 창의 **매개 변수** 섹션에서 **이름** 상자에를 추가 `OnOff` 합니다.
   1. **필수** 를 선택 합니다. **필수 매개 변수에 대 한 응답 추가** 창에서 **단순 편집기** 를 선택 합니다. **첫 번째 변형** 필드에 *On 또는 Off?* 를 추가 합니다.
   1. **업데이트** 를 선택합니다.

       > [!div class="mx-imgBorder"]
       > ![필수 매개 변수 응답을 만들 위치를 보여 주는 스크린샷](media/custom-commands/add-required-on-off-parameter-response.png)
   
   1. 다음 표를 사용 하 여 매개 변수의 속성을 구성 합니다. 명령의 모든 구성 속성에 대 한 자세한 내용은 [사용자 지정 명령 개념 및 정의](./custom-commands-references.md)를 참조 하세요.
      

       | Configuration      | 제안 값     | Description                                                      |
       | ------------------ | ----------------| ---------------------------------------------------------------------|
       | **이름**               | `OnOff`           | 매개 변수에 대 한 설명이 포함 된 이름입니다.                                                                           |
       | **전역**          | 선택 취소       | 이 매개 변수의 값이 응용 프로그램의 모든 명령에 전역적으로 적용 되는지 여부를 나타내는 확인란입니다.|
       | **필수**           | 선택됨         | 명령이 완료 되기 전에이 매개 변수의 값이 필요한 지 여부를 나타내는 확인란입니다. |
       | **필수 매개 변수에 대 한 응답**      |**간단한 편집기** > `On or Off?`      | 이 매개 변수 값을 알 수 없는 경우 요청 하는 프롬프트입니다. |
       | **형식**               | **String**          | 숫자, 문자열, 날짜/시간 또는 지리와 같은 매개 변수 유형입니다.   |
       | **Configuration**      | **내부 카탈로그에서 미리 정의 된 입력 값 허용** | 문자열의 경우이 설정은 입력을 가능한 값 집합으로 제한 합니다. |
       | **미리 정의 된 입력 값**     | `on`, `off`           | 사용할 수 있는 값 및 해당 별칭 집합입니다.         |
       
        
   1. 미리 정의 된 입력 값을 추가 하려면 **미리 정의 된 입력 추가** 를 선택 합니다. 위의 표에 나와 있는 것 처럼 **새 항목**  창에서 *이름* 을 입력 합니다. 이 경우 별칭을 사용 하 고 있지 않으므로이 필드를 비워 둘 수 있습니다.
   
      > [!div class="mx-imgBorder"]
      > ![매개 변수를 만드는 방법을 보여 주는 스크린샷](media/custom-commands/create-on-off-parameter.png)

   1. **저장** 을 선택 하 여 매개 변수의 모든 구성을 저장 합니다.
 
#### <a name="add-a-subjectdevice-parameter"></a>주제 장치 매개 변수 추가

1. 이 명령을 사용 하 여 제어할 수 있는 장치의 이름을 나타내는 두 번째 매개 변수를 추가 하려면 **추가** 를 선택 합니다. 다음 구성을 사용 합니다.


    | 설정            | 제안 값       |
    | ------------------ | --------------------- |
    | **이름**               | `SubjectDevice`         |
    | **전역**          | 선택 취소             |
    | **필수**           | 선택됨               |
    | **필수 매개 변수에 대 한 응답**     | **간단한 편집기** > `Which device do you want to control?`    | 
    | **형식**               | **String**                |          |
    | **Configuration**      | **내부 카탈로그에서 미리 정의 된 입력 값 허용** | 
    | **미리 정의 된 입력 값** | `tv`, `fan`               |
    | **별칭** ( `tv` )      | `television`, `telly`     |

1. **저장** 을 선택합니다.

#### <a name="modify-example-sentences"></a>예제 문장 수정

매개 변수를 사용 하는 명령의 경우 가능한 모든 조합을 포함 하는 예제 문장을 추가 하는 것이 좋습니다. 예를 들면 다음과 같습니다.

* 전체 매개 변수 정보: `turn {OnOff} the {SubjectDevice}`
* 부분 매개 변수 정보: `turn it {OnOff}`
* 매개 변수 정보 없음: `turn something`

다양 한 수준의 정보를 사용 하는 예제 문장을 사용 하면 사용자 지정 명령 응용 프로그램에서 부분 정보를 사용 하 여 단일 샷 해상도와 여러 턴 해상도를 모두 확인할 수 있습니다.

이 정보를 염두에 두면 다음과 같은 제안 된 매개 변수를 사용 하도록 예제 문장을 편집 합니다.

```
turn {OnOff} the {SubjectDevice}
{SubjectDevice} {OnOff}
turn it {OnOff}
turn something {OnOff}
turn something
```

**저장** 을 선택합니다.

> [!TIP]
> 예제-문장 편집기에서 중괄호를 사용 하 여 매개 변수를 참조 합니다. 예들 들어 `turn {OnOff} the {SubjectDevice}`입니다.
> 이전에 만든 매개 변수에서 지원 되는 자동 완성 기능에 대 한 탭을 사용 합니다.

#### <a name="modify-completion-rules-to-include-parameters"></a>매개 변수를 포함 하도록 완료 규칙 수정

기존 완료 규칙을 수정 `ConfirmationResponse` 합니다.

1. **조건** 섹션에서 **조건 추가** 를 선택 합니다.
1. **새 조건** 창의 **유형** 목록에서 **필수 매개 변수** 를 선택 합니다. 다음 목록에서 **Onoff** 및- **device 장치** 를 모두 선택 합니다.
1. **Isglobal** 은 선택 하지 않은 상태로 둡니다.
1. **만들기** 를 선택합니다.
1. **작업** 섹션에서 **음성 응답 보내기** 작업을 마우스로 가리키고 편집 단추를 선택 하 여 편집 합니다. 이번에는 새로 만든 `OnOff` 및 매개 변수를 사용 합니다 `SubjectDevice` .

    ```
    Ok, turning the {SubjectDevice} {OnOff}
    ```
1. **저장** 을 선택합니다.

오른쪽 창의 맨 위에 있는 **학습** 아이콘을 선택 하 여 변경 내용을 시험해 보세요. 

교육이 완료 되 면 **테스트** 를 선택 합니다. **테스트 응용 프로그램** 창이 나타납니다. 다음 상호 작용을 시도 합니다.

- 입력: *tv* 끄기
- 출력: 확인, tv 끄기
- 입력: *tv* 끄기
- 출력: 확인, tv 끄기
- 입력: *해제*
- 출력: 제어할 장치를 선택 하십시오.
- 입력: *tv*
- 출력: 확인, tv 끄기

### <a name="configure-parameters-for-a-settemperature-command"></a>SetTemperature 명령에 대 한 매개 변수 구성

`SetTemperature`사용자가의 지시에 따라 온도를 설정할 수 있도록 명령을 수정 합니다.

`Temperature`매개 변수를 추가 합니다. 다음 구성을 사용합니다.

| Configuration      | 제안 값     |
| ------------------ | ----------------|
| **이름**               | `Temperature`           |
| **필수**           | 선택됨         |
| **필수 매개 변수에 대 한 응답**      | **간단한 편집기** > `What temperature would you like?`
| **형식**               | `Number`          |


예제 길이 발언를 편집 하 여 다음 값을 사용 합니다.

```
set the temperature to {Temperature} degrees
change the temperature to {Temperature}
set the temperature
change the temperature
```

기존 완료 규칙을 편집 합니다. 다음 구성을 사용 합니다.

| Configuration      | 제안 값     |
| ------------------ | ----------------|
| **조건**         | **필수 매개 변수**  >  **온도**           |
| **actions**           | **음성 응답 보내기** > `Ok, setting temperature to {Temperature} degrees` |

### <a name="configure-parameters-for-a-setalarm-command"></a>SetAlarm 명령에 대 한 매개 변수 구성

이라는 매개 변수를 추가 `DateTime` 합니다. 다음 구성을 사용 합니다.

   | 설정                           | 제안 값                     | 
   | --------------------------------- | ----------------------------------------|
   | **이름**                              | `DateTime`                               |
   | **필수**                          | 선택됨                                 |
   | **필수 매개 변수에 대 한 응답**   | **간단한 편집기** > `For what time?`            | 
   | **형식**                              | **DateTime**                                |
   | **날짜 기본값**                     | 날짜가 누락 된 경우 today를 사용 합니다.            |
   | **시간 기본값**                     | 시간이 누락 된 경우 날짜의 시작을 사용 합니다.     |


> [!NOTE]
> 이 문서에서는 대부분 문자열, 숫자 및 날짜/시간 매개 변수 형식을 사용 합니다. 지원 되는 모든 매개 변수 형식 및 해당 속성 목록은 [사용자 지정 명령 개념 및 정의](./custom-commands-references.md)를 참조 하세요.


예제 길이 발언를 편집 합니다. 다음 값을 사용합니다.

```
set an alarm for {DateTime}
set alarm {DateTime}
alarm for {DateTime}
```

기존 완료 규칙을 편집 합니다. 다음 구성을 사용 합니다.

   | 설정    | 제안 값                               |
   | ---------- | ------------------------------------------------------- |
   | **actions**    | **음성 응답 보내기** > `Ok, alarm set for {DateTime}`  |

다른 명령과 관련 된 길이 발언를 사용 하 여 세 개의 명령을 함께 테스트 합니다. (다른 명령 간을 전환할 수 있습니다.)

- 입력: *경보 설정*
- 출력: 시간에 대 한
- 입력: *Tv 켜기*
- 출력: 양호, tv 켜기
- 입력: *경보 설정*
- 출력: 시간에 대 한
- 입력: *오후 5* 시
- 출력: 정상, 2020-05-01 17:00:00에 대해 설정 되는 경보

## <a name="add-configurations-to-command-parameters"></a>명령 매개 변수에 구성 추가

이 섹션에서는 다음을 포함 하 여 고급 매개 변수 구성에 대해 자세히 알아봅니다.

 - 매개 변수 값이 사용자 지정 명령 응용 프로그램 외부에서 정의 된 집합에 속할 수 있는 방법입니다.
 - 매개 변수 값에 유효성 검사 절을 추가 하는 방법입니다.

### <a name="configure-a-parameter-as-an-external-catalog-entity"></a>매개 변수를 외부 카탈로그 엔터티로 구성

사용자 지정 명령 기능을 사용 하면 웹 끝점을 통해 호스트 되는 외부 카탈로그를 참조 하도록 문자열 형식 매개 변수를 구성할 수 있습니다. 따라서 사용자 지정 명령 응용 프로그램을 편집 하지 않고도 외부 카탈로그를 독립적으로 업데이트할 수 있습니다. 이 방법은 카탈로그 항목이 여러 개 있는 경우에 유용 합니다.

`SubjectDevice`명령에서 매개 변수를 다시 사용 `TurnOnOff` 합니다. 이 매개 변수에 대 한 현재 구성에는 **내부 카탈로그의 미리 정의 된 입력이 허용** 됩니다. 이 구성은 매개 변수 구성에서 장치에 대 한 고정 목록을 나타냅니다. 이 콘텐츠를 독립적으로 업데이트할 수 있는 외부 데이터 원본으로 이동 합니다.

콘텐츠를 이동 하려면 먼저 새 웹 끝점을 추가 합니다. 왼쪽 창에서 **웹 끝점** 섹션으로 이동 합니다. 새 웹 끝점을 추가 합니다. 다음 구성을 사용 합니다.

| 설정 | 제안 값 |
|----|----|
| **이름** | `getDevices` |
| **URL** | `https://aka.ms/speech/cc-sampledevices` |
| **방법** | **GET** |


URL에 대해 제안 된 값이 작동 하지 않으면 제어할 수 있는 장치 목록으로 구성 된 JSON 파일을 반환 하는 웹 끝점을 구성 하 고 호스팅합니다. 웹 끝점은 다음과 같이 형식이 지정 된 JSON 파일을 반환 해야 합니다.
    
```json
{
    "fan" : [],
    "refrigerator" : [
        "fridge"
    ],
    "lights" : [
        "bulb",
        "bulbs",
        "light"
        "light bulb"
    ],
    "tv" : [
        "telly",
        "television"
        ]
}

```

다음으로, 주제 **장치** 매개 변수 설정 페이지로 이동 합니다. 다음 속성을 설정 합니다.

| 설정 | 제안 값 |
| ----| ---- |
| **Configuration** | **외부 카탈로그의 미리 정의 된 입력 허용** |                               
| **카탈로그 끝점** | `getDevices` |
| **방법** | **GET** |

그런 다음 **저장** 을 선택합니다.

> [!IMPORTANT]
> 왼쪽 창의 **웹 끝점** 섹션에 웹 끝점이 설정 되어 있지 않으면 외부 카탈로그의 입력을 허용 하도록 매개 변수를 구성 하는 옵션이 표시 되지 않습니다.

**학습** 을 선택 하 여 사용해 보세요. 교육이 완료 되 면 **테스트** 를 선택 하 고 몇 가지 상호 작용을 시도 합니다.

* 입력: *켜기*
* 출력: 제어할 장치를 선택 하십시오.
* 입력: *광원*
* 출력: 정상, 표시등 켜기

> [!NOTE]
> 이제 웹 끝점에서 호스트 되는 모든 장치를 제어할 수 있습니다. 그러나 응용 프로그램을 학습 하 여 새 변경 내용을 테스트 한 후 응용 프로그램을 다시 게시 해야 합니다.

### <a name="add-validation-to-parameters"></a>매개 변수에 유효성 검사 추가

*유효성 검사* 는 매개 변수 값에 대 한 제약 조건을 구성할 수 있도록 하는 특정 매개 변수 형식에 적용 되는 구문입니다. 값이 제약 조건에 속하지 않을 경우 수정 하 라는 메시지가 표시 됩니다. 유효성 검사 구문을 확장 하는 매개 변수 형식 목록은 [사용자 지정 명령 개념 및 정의](./custom-commands-references.md)를 참조 하세요.

명령을 사용 하 여 유효성 검사를 테스트 `SetTemperature` 합니다. 다음 단계를 사용 하 여 매개 변수에 대 한 유효성 검사를 추가 `Temperature` 합니다.

1. 왼쪽 창에서 **SetTemperature** 명령을 선택 합니다.
1. 가운데 창에서 **온도** 를 선택 합니다.
1. 오른쪽 창에서 **유효성 검사 추가** 를 선택 합니다.
1. **새 유효성 검사** 창에서 다음 표와 같이 유효성 검사를 구성 합니다. 그런 다음 **만들기** 를 선택합니다.


    | 매개 변수 구성 | 제안 값 | Description |
    | ---- | ---- | ---- |
    | **최소 값** | `60` | Number 매개 변수의 경우이 매개 변수에서 가정할 수 있는 최소 값입니다. |
    | **최 댓 값** | `80` | Number 매개 변수의 경우이 매개 변수에서 가정할 수 있는 최대 값입니다. |
    | **실패 응답** |  **간단한 편집기**  >  **첫 번째 변형** > `Sorry, I can only set temperature between 60 and 80 degrees. What temperature do you want?` | 유효성 검사에 실패 하는 경우 새 값을 요청 하는 메시지 |

    > [!div class="mx-imgBorder"]
    > ![범위 유효성 검사를 추가 하는 방법을 보여 주는 스크린샷](media/custom-commands/add-validations-temperature.png)

오른쪽 창의 맨 위에 있는 **학습** 아이콘을 선택 하 여 사용해 보세요. 학습을 완료 한 후 **테스트** 를 선택 합니다. 몇 가지 상호 작용을 시도 합니다.

- Input: *온도를 72도로 설정 합니다* .
- 출력: 정상, 온도를 72 각도로 설정
- Input: *온도를 45도로 설정 합니다* .
- 출력: 죄송 합니다. 60 ~ 80도 사이의 온도를 설정할 수 있습니다.
- Input: *대신 72도로 설정*
- 출력: 정상, 온도를 72 각도로 설정

## <a name="add-interaction-rules"></a>상호 작용 규칙 추가

상호 작용 규칙은 특정 하거나 복잡 한 상황을 처리 하는 *추가* 규칙입니다. 사용자 고유의 상호 작용 규칙을 자유롭게 작성할 수 있지만이 예제에서는 다음 시나리오에 대해 상호 작용 규칙을 사용 합니다.

* 명령 확인
* 명령에 1 단계 수정 추가

상호 작용 규칙에 대 한 자세한 내용은 [사용자 지정 명령 개념 및 정의](./custom-commands-references.md)를 참조 하세요.

### <a name="add-confirmations-to-a-command"></a>명령에 확인 추가

확인을 추가 하려면 `SetTemperature` 명령을 사용 합니다. 확인을 수행 하려면 다음 단계를 사용 하 여 상호 작용 규칙을 만듭니다.

1. 왼쪽 창에서 **SetTemperature** 명령을 선택 합니다.
1. 가운데 창에서 **추가** 를 선택 하 여 상호 작용 규칙을 추가 합니다. 그런 다음 **상호 작용 규칙**  >  **확인 명령** 을 선택 합니다.

    이 작업을 수행 하면 3 개의 상호 작용 규칙이 추가 됩니다. 규칙은 사용자에 게 알람의 날짜 및 시간을 확인 하도록 요청 합니다. 다음에는 확인 (예 또는 아니요)을 사용 해야 합니다.

    1. 다음 구성을 사용 하 여 **확인 명령** 상호 작용 규칙을 수정 합니다.
        1. 이름을 **온도 확인** 으로 변경 합니다.
        1. 새 조건: **필수 매개 변수**  >  **온도** 를 추가 합니다.
        1. 새 작업을 추가 합니다. 음성 응답을 **입력** 하세요.  >    >  **온도를 {온도}도로 설정** 하 시겠습니까?
        1. **기대** 섹션에서 **사용자의 확인 필요로** 기본값을 그대로 둡니다.
      
         > [!div class="mx-imgBorder"]
         > ![필수 매개 변수 응답을 만드는 방법을 보여 주는 스크린샷](media/custom-speech-commands/add-validation-set-temperature.png)
    

    1. **확인 성공** 상호 작용 규칙을 수정 하 여 성공적인 확인 (사용자가 예)을 처리 합니다.
      
          1. 이름을 **확인 온도 성공** 으로 변경 합니다.
          1. 기존 **확인이 성공** 상태를 유지 합니다.
          1. 새 조건 추가:   >  **필수 매개 변수**  >  **온도** 를 입력 합니다.
          1. 기본 **실행 후 상태** 값을 **완료 규칙 실행** 으로 그대로 둡니다.

    1. 확인이 거부 된 경우 (사용자가 아니요를 언급 함) 시나리오를 처리 하도록 **확인 거부** 된 상호 작용 규칙을 수정 합니다.

          1. 이름을 **확인 온도 거부 됨** 으로 변경 합니다.
          1. 기존 **확인이 거부** 된 상태를 유지 합니다.
          1. 새 조건 추가:   >  **필수 매개 변수**  >  **온도** 를 입력 합니다.
          1. 새 동작 **추가:**  >  **음성 응답 보내기**  >  **문제가 없습니다. 온도는 어떻게 되나요?**
          1. **사용자의 입력을 기다리도록** 기본 **실행 후 상태** 값을 변경 합니다.

> [!IMPORTANT]
> 이 문서에서는 기본 제공 확인 기능을 사용 합니다. 상호 작용 규칙을 하나씩 수동으로 추가할 수도 있습니다.
   
**학습** 을 선택 하 여 변경 내용을 시험해 보세요. 교육이 완료 되 면 **테스트** 를 선택 합니다.

- **Input**: *온도를 80도로 설정 합니다* .
- **출력**: 온도를 80 각도로 설정 하 시겠습니까?
- **입력**: *아니요*
- **출력**: 문제가 없습니다. 온도는 어떻게 되나요?
- **입력**: *72도*
- **출력**: 온도를 72 각도로 설정 하 시겠습니까?
- **입력**: *예*
- **출력**: 정상, 온도를 72 각도로 설정

### <a name="implement-corrections-in-a-command"></a>명령에서 수정 구현

이 섹션에서는 1 단계 수정을 구성 합니다. 이 수정 작업은 처리 작업이 실행 된 후에 사용 됩니다. 또한 명령이 아직 수행 되지 않은 경우 수정이 기본적으로 사용 되는 방법의 예를 볼 수 있습니다. 명령이 완료 되지 않은 경우 수정 내용을 추가 하려면 새 매개 변수를 추가 `AlarmTone` 합니다.

왼쪽 창에서 **Setalarm** 명령을 선택 합니다. 그런 다음 **AlarmTone** 새 매개 변수를 추가 합니다.
        
- **이름의** > `AlarmTone`
- **유형**  >  **문자열**
- **기본값**  >  **Chimes**
- **구성**  >  **내부 카탈로그에서 미리 정의 된 입력 값 허용**
- **미리 정의 된 입력 값**  >  **Chimes**, **Jingle** 및 **Echo** (이러한 값은 미리 정의 된 개별 입력입니다.)


그런 다음 **DateTime** 매개 변수에 대 한 응답을 ' **AlarmTone}로 톤을 사용 하 여 알람을 설정 하기 위해 준비로 업데이트 합니다. 시간을 결정** 합니다. 그런 후 다음과 같이 완료 규칙을 수정 합니다.

1. 기존 완료 규칙 **ConfirmationResponse** 를 선택 합니다.
1. 오른쪽 창에서 기존 작업 위로 마우스를 이동 하 고 **편집** 을 선택 합니다.
1. 음성 응답을로 업데이트 `OK, alarm set for {DateTime}. The alarm tone is {AlarmTone}` 합니다.

> [!IMPORTANT]
> 알람은 진행 중인 명령에서 명시적인 구성 없이 변경 될 수 있습니다. 예를 들어 명령이 아직 완료 되지 않은 경우 변경할 수 있습니다. 명령이 아직 수행 되지 않은 경우 턴 번호에 관계 없이 모든 명령 매개 변수에 대해 *기본적으로* 수정이 활성화 됩니다.

#### <a name="implement-a-correction-when-a-command-is-finished"></a>명령이 완료 되 면 수정 내용 구현

사용자 지정 명령 플랫폼에서는 명령이 완료 된 경우에도 1 단계를 수정할 수 있습니다. 이 기능은 기본적으로 사용 하도록 설정 되어 있지 않습니다. 명시적으로 구성 해야 합니다. 

다음 단계를 사용 하 여 1 단계 수정을 구성 합니다.

1. **Setalarm** 명령에서 이전에 설정 된 경보를 업데이트 하는 형식 **업데이트 이전 명령의** 상호 작용 규칙을 추가 합니다. 상호 작용 규칙의 이름을 **이전 경보 업데이트로** 바꿉니다.
1. 기본 조건을 그대로 둡니다. **이전 명령을 업데이트** 해야 합니다.
1. 새 조건 추가:   >  **필수 매개 변수**  >  **DateTime** 을 입력 합니다.
1. 새 동작 **추가:**  >  **음성 응답을 보냅니다**  >  .**단순 편집기**  >  **이전 경보 시간을 {DateTime} (으)로 업데이트** 합니다.
1. 기본 **실행 후 상태** 값은 **명령 완료** 로 그대로 둡니다.

**학습** 을 선택 하 여 변경 내용을 시험해 보세요. 교육이 완료 될 때까지 기다린 후 **테스트** 를 선택 합니다.

- **Input**: *경보를 설정 합니다.*
- **출력**: 경보를 chimes로 설정할 준비가 되었습니다. 시간에 대해
- **Input**: *내일 오전 9 시 (Jingle)로 경보를 설정 합니다.*
- **출력**: 정상, 2020-05-21 09:00:00에 대해 경보를 설정 합니다. 경보 음은 Jingle입니다.
- **입력**: *아니요, 오전 8 시.*
- **출력**: 이전 경보 시간을 2020-05-29 08:00으로 업데이트 합니다.

> [!NOTE]
> 실제 응용 프로그램에서는이 수정 규칙의 **작업** 섹션에서 작업을 클라이언트에 다시 보내거나 HTTP 끝점을 호출 하 여 시스템의 경보 시간을 업데이트 해야 합니다. 이 작업은 단순히 경보 시간 업데이트를 담당 해야 합니다. 명령의 다른 특성을 담당 하지 않아야 합니다. 이 경우 해당 특성은 알람 톤입니다.

## <a name="add-language-generation-templates-for-speech-responses"></a>음성 응답을 위한 언어 생성 템플릿 추가

LG (언어 생성) 템플릿을 사용 하 여 클라이언트로 전송 되는 응답을 사용자 지정할 수 있습니다. 응답에 분산을 도입 합니다. 다음을 사용 하 여 언어 생성을 달성할 수 있습니다.

* 언어 생성 템플릿.
* 적응 식.

사용자 지정 명령 템플릿은 Bot Framework의 [LG 템플릿을](/azure/bot-service/file-format/bot-builder-lg-file-format#templates)기반으로 합니다. 사용자 지정 명령 기능은 필요할 때 새 LG 템플릿을 만들기 때문에 (매개 변수나 동작의 음성 응답) LG 템플릿의 이름을 지정할 필요가 없습니다. 

따라서 다음과 같이 템플릿을 정의할 필요가 없습니다.

 ```
    # CompletionAction
    - Ok, turning {OnOff} the {SubjectDevice}
    - Done, turning {OnOff} the {SubjectDevice}
    - Proceeding to turn {OnOff} {SubjectDevice}
 ```

대신 다음과 같이 이름 없이 템플릿의 본문을 정의할 수 있습니다.

> [!div class="mx-imgBorder"]
> ![템플릿 편집기 예를 보여 주는 스크린샷](./media/custom-commands/template-editor-example.png)


이러한 변경으로 인해 클라이언트에 전송 되는 음성 응답의 변형이 도입 됩니다. Utterance의 경우 제공 된 옵션에서 해당 음성 응답이 임의로 선택 됩니다.

LG 템플릿을 활용 하 여 적응 식을 사용 하 여 명령에 대 한 복잡 한 음성 응답을 정의할 수도 있습니다. 자세한 내용은 [LG 템플릿 형식](/azure/bot-service/file-format/bot-builder-lg-file-format#templates)을 참조 하세요. 

기본적으로 사용자 지정 명령 기능은 다음과 같은 사소한 차이점이 있는 모든 기능을 지원 합니다.

* LG 템플릿에서 엔터티는로 표시 됩니다 `${entityName}` . 사용자 지정 명령 기능은 엔터티를 사용 하지 않습니다. 하지만 매개 변수를 표현 또는 표현과 함께 변수로 사용할 수 있습니다 `${parameterName}` `{parameterName}` .
* *Lg* 파일을 직접 편집 하지 않으므로 사용자 지정 명령 기능은 템플릿 컴퍼지션 및 확장을 지원 하지 않습니다. 자동으로 만들어진 템플릿의 응답만 편집 합니다.
* 사용자 지정 명령 기능은 LG에서 삽입 하는 사용자 지정 함수를 지원 하지 않습니다. 미리 정의 된 함수가 지원 됩니다.
* 사용자 지정 명령 기능은, 및과 같은 옵션을 지원 하지 않습니다 `strict` `replaceNull` `lineBreakStyle` .

### <a name="add-template-responses-to-a-turnonoff-command"></a>TurnOnOff 명령에 템플릿 응답 추가

명령을 수정 `TurnOnOff` 하 여 새 매개 변수를 추가 합니다. 다음 구성을 사용 합니다.

| 설정            | 제안 값       | 
| ------------------ | --------------------- | 
| **이름**               | `SubjectContext`         | 
| **전역**          | 선택 취소             | 
| **필수**           | 선택 취소               | 
| **형식**               | **String**                |
| **기본값**      | `all` |
| **Configuration**      | **내부 카탈로그에서 미리 정의 된 입력 값 허용** | 
| **미리 정의 된 입력 값** | `room`, `bathroom`, `all`|

#### <a name="modify-a-completion-rule"></a>완료 규칙 수정

기존 완료 규칙 **ConfirmationResponse** 의 **작업** 섹션을 편집 합니다. **작업 편집** 창에서 **템플릿 편집기** 로 전환 합니다. 그런 다음 텍스트를 다음 예제로 바꿉니다.

```
- IF: @{SubjectContext == "all" && SubjectDevice == "lights"}
    - Ok, turning all the lights {OnOff}
- ELSEIF: @{SubjectDevice == "lights"}
    - Ok, turning {OnOff} the {SubjectContext} {SubjectDevice}
- ELSE:
    - Ok, turning the {SubjectDevice} {OnOff}
    - Done, turning {OnOff} the {SubjectDevice}
```

다음 입력 및 출력을 사용 하 여 응용 프로그램을 학습 하 고 테스트 합니다. 응답의 변형을 확인 합니다. 변형은 템플릿 값의 여러 대안이 나 적응 식을 사용 하 여 생성 됩니다.

* 입력: *tv 켜기*
* 출력: 양호, tv 켜기
* 입력: *tv 켜기*
* 출력: 완료, tv 설정
* Input: *조명을* 끕니다.
* 출력: 정상, 모든 조명 해제
* 입력: *대화방 광원 끄기*
* 출력: 정상, 실내 조명 해제

## <a name="use-a-custom-voice"></a>사용자 지정 음성 사용

사용자 지정 명령 응답을 사용자 지정 하는 또 다른 방법은 출력 음성을 선택 하는 것입니다. 기본 음성을 사용자 지정 음성으로 전환 하려면 다음 단계를 사용 합니다.

1. 사용자 지정 명령 응용 프로그램의 왼쪽 창에서 **설정** 을 선택 합니다.
1. 가운데 창에서 **사용자 지정 음성** 을 선택 합니다.
1. 표에서 사용자 지정 음성 또는 공용 음성을 선택 합니다.
1. **저장** 을 선택합니다.

> [!div class="mx-imgBorder"]
> ![샘플 문장과 매개 변수를 보여 주는 스크린샷](media/custom-commands/select-custom-voice.png)

> [!NOTE]
> 공용 음성의 경우 신경망은 특정 지역 에서만 사용할 수 있습니다. 자세한 내용은 [음성 서비스 지원 지역](./regions.md#standard-and-neural-voices)을 참조 하세요.
>
> 사용자 지정 **음성** 프로젝트 페이지에서 사용자 지정 음성을 만들 수 있습니다. 자세한 내용은 [사용자 지정 음성 시작](./how-to-custom-voice.md)을 참조 하세요.

이제 응용 프로그램은 기본 음성 대신 선택한 음성으로 응답 합니다.

## <a name="next-steps"></a>다음 단계

* Speech SDK를 사용 하 여 [사용자 지정 명령 응용 프로그램](how-to-custom-commands-setup-speech-sdk.md) 을 클라이언트 앱과 통합 하는 방법에 대해 알아봅니다.
* Azure DevOps를 사용 하 여 사용자 지정 명령 응용 프로그램에 대 한 [연속 배포를 설정](how-to-custom-commands-deploy-cicd.md) 합니다. 
                      
