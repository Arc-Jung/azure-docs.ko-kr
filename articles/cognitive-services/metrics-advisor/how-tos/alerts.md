---
title: 메트릭 관리자 경고 구성
titleSuffix: Azure Cognitive Services
description: 전자 메일, 웹 및 Azure DevOps에 대 한 후크를 사용 하 여 메트릭 Advisor 경고를 구성 하는 방법입니다.
services: cognitive-services
author: mrbullwinkle
manager: nitinme
ms.service: cognitive-services
ms.subservice: metrics-advisor
ms.topic: conceptual
ms.date: 09/14/2020
ms.author: mbullwin
ms.openlocfilehash: 30d8fdf99da7a4854db0985bed6256ecd6f7a366
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/19/2021
ms.locfileid: "93420923"
---
# <a name="how-to-configure-alerts-and-get-notifications-using-a-hook"></a>방법: 후크를 사용 하 여 경고 구성 및 알림 가져오기

메트릭 Advisor에서 변칙이 검색 된 후 후크를 사용 하 여 경고 설정에 따라 경고 알림이 트리거됩니다. 경고 설정은 여러 검색 구성에서 사용할 수 있으며, 다양 한 매개 변수를 사용 하 여 경고 규칙을 사용자 지정할 수 있습니다.

## <a name="create-a-hook"></a>후크 만들기

메트릭 관리자는 세 가지 유형의 후크, 즉 전자 메일 후크, 웹 후크 및 Azure DevOps를 지원 합니다. 특정 시나리오에 적합 한 항목을 선택할 수 있습니다.       

### <a name="email-hook"></a>전자 메일 후크

> [!Note]
> 메트릭 관리자 리소스 관리자는 변칙 경고를 전송 하기 전에 전자 메일 설정을 구성 하 고 메트릭 관리자에 SMTP 관련 정보를 입력 해야 합니다. 리소스 그룹 관리자 또는 구독 관리자는 메트릭 관리자 리소스의 액세스 제어 탭에서 하나 이상의 *Cognitive Services 메트릭 관리자 관리자* 역할을 할당 해야 합니다. [전자 메일 설정 구성에 대해 자세히 알아보세요](../faq.md#how-to-set-up-email-settings-and-enable-alerting-by-email).

전자 메일 후크를 만들려면 다음 매개 변수를 사용할 수 있습니다. 

전자 메일 후크는 **메일 받는** 사람 섹션에 지정 된 전자 메일 주소로 변칙 경고를 보내는 채널입니다. 두 가지 유형의 경고 전자 메일 ( *데이터 피드를 사용할 수 없음* 경고 및 하나 이상의 비정상을 포함 하는 *인시던트 보고서* )이 전송 됩니다. 

|매개 변수 |설명  |
|---------|---------|
| Name | 전자 메일 후크에 대 한 이름입니다. |
| 전자 메일 주소| 경고를 보낼 전자 메일 주소|
| 외부 링크 | 문제 해결 노트와 같이 사용자 지정 된 리디렉션을 사용 하도록 설정 하는 선택적 필드입니다. |
| 사용자 지정 변칙 경고 제목 | 제목 템플릿은 `${severity}` ,, `${alertSettingName}` `${datafeedName}` , `${metricName}` , `${detectConfigName}` `${timestamp}` `${topDimension}` `${incidentCount}` ,,,,를 지원 합니다. `${anomalyCount}`

**확인** 을 클릭 하면 전자 메일 후크가 생성 됩니다. 모든 경고 설정에서 사용 하 여 변칙 경고를 받을 수 있습니다. 

### <a name="web-hook"></a>웹 후크

> [!Note]
> * **POST** 요청 메서드를 사용 합니다.
> * 요청 본문 커밋되지 다음과 유사 합니다.  
    `{"timestamp":"2019-09-11T00:00:00Z","alertSettingGuid":"49635104-1234-4c1c-b94a-744fc920a9eb"}`
> * 웹 후크가 만들어지거나 수정 되 면 API는 빈 요청 본문으로 테스트로 호출 됩니다. API는 200 HTTP 코드를 반환 해야 합니다.

웹 후크는 메트릭 관리자 서비스에서 사용할 수 있는 모든 정보에 대 한 진입점으로, 경고가 트리거될 때 사용자가 제공한 api를 호출 합니다. 모든 경고는 웹 후크를 통해 보낼 수 있습니다.

웹 후크를 만들려면 다음 정보를 추가 해야 합니다.

|매개 변수 |설명  |
|---------|---------|
|엔드포인트     | 경고가 트리거될 때 호출 되는 API 주소입니다.        |
|사용자 이름/암호 | API 주소를 인증 하는 데 사용할 수 있습니다. 인증이 필요 하지 않은 경우이 검정색으로 둡니다.         |
|헤더     | API 호출의 사용자 지정 헤더입니다.        |

:::image type="content" source="../media/alerts/create-web-hook.png" alt-text="웹 후크 만들기 창.":::

웹 후크를 통해 알림이 푸시되 면 다음 Api를 사용 하 여 경고에 대 한 세부 정보를 가져올 수 있습니다. 로 푸시되는 API 서비스에서 *타임 스탬프* 및 *alertsettingguid* 를 설정 하 고 다음 쿼리를 사용 합니다. 
- `query_alert_result_anomalies`
- `query_alert_result_incidents`

### <a name="azure-devops"></a>Azure DevOps

또한 메트릭 관리자는 Azure DevOps의 작업 항목 자동 생성을 지원 하 여 변칙이 검색 되 면 문제/버그를 추적 합니다. 모든 경고는 Azure DevOps 후크를 통해 전송 될 수 있습니다.

Azure DevOps 후크를 만들려면 다음 정보를 추가 해야 합니다.

|매개 변수 |설명  |
|---------|---------|
| Name | 후크에 대 한 이름입니다. |
| 조직 | DevOps가 속한 조직 |
| Project | DevOps의 특정 프로젝트입니다. |
| 액세스 토큰 |  DevOps에 인증 하기 위한 토큰입니다. | 

> [!Note]
> 메트릭 관리자가 변칙 경고를 기반으로 작업 항목을 만들도록 하려면 쓰기 권한을 부여 해야 합니다. 후크를 만든 후에는 모든 경고 설정에서 사용할 수 있습니다. **후크 설정** 페이지에서 후크를 관리 합니다.

## <a name="add-or-edit-alert-settings"></a>경고 설정 추가 또는 편집

메트릭 세부 정보 페이지로 이동 하 여 메트릭 세부 정보 페이지의 왼쪽 아래에 있는 **경고 설정** 섹션을 찾습니다. 선택한 검색 구성에 적용 되는 모든 경고 설정이 나열 됩니다. 새 검색 구성이 만들어지면 경고 설정이 없으며 경고가 전송 되지 않습니다.  
**추가**, **편집** 및 **삭제** 아이콘을 사용 하 여 경고 설정을 수정할 수 있습니다.

:::image type="content" source="../media/alerts/alert-setting.png" alt-text="경고 설정 메뉴 항목입니다.":::

**추가** 또는 **편집** 단추를 클릭 하 여 경고 설정을 추가 하거나 편집할 수 있는 창을 가져옵니다.

:::image type="content" source="../media/alerts/edit-alert.png" alt-text="경고 설정 추가 또는 편집":::

**경고 설정 이름**:이 경고 설정의 이름입니다. 이 메시지는 경고 전자 메일 제목에 표시 됩니다.

**후크**: 경고를 보낼 후크에 대 한 목록입니다.

위의 스크린샷에 표시 된 섹션은 하나의 구성 검색에 대 한 설정입니다. 다른 검색 구성에 대해 서로 다른 경고 설정을 지정할 수 있습니다. 이 창의 세 번째 드롭다운 목록을 사용 하 여 대상 구성을 선택 합니다. 

### <a name="filter-settings"></a>필터 설정 

다음은 하나의 검색 구성에 대 한 필터 설정입니다.

**에 대 한 경고** 에는 변칙 필터링을 위한 4 가지 옵션이 있습니다.

* **모든 시리즈의 비정상**: 모든 비정상이 경고에 포함 됩니다.         
* **계열 그룹의 변칙**: 차원 값을 기준으로 계열을 필터링 합니다. 일부 차원에 대해 특정 값을 설정 합니다. 계열이 지정 된 값과 일치 하는 경우에만 비정상이 경고에 포함 됩니다.       
* **즐겨 찾는 시리즈의** 이상: 즐겨찾기로 표시 된 계열만 경고에 포함 됩니다.        |
* **모든 시리즈의 상위 N 개에서** 이상:이 필터는 값이 상위 n에 있는 계열에 대해서만 관심이 있는 경우에 해당 합니다. 몇 가지 타임 스탬프를 다시 살펴보고 이러한 타임 스탬프에 있는 계열의 값이 상위 N에 있는지 확인 합니다. "상위 n 개" 수가 지정 된 수보다 크면 변칙이 경고에 포함 됩니다.        |

**변칙 옵션 필터** 는 다음 옵션을 포함 하는 추가 필터입니다.

- **심각도** : 변칙 심각도는 지정 된 범위 내에 있는 경우에만 포함 됩니다.
- 다시 **알림** : 경고에서 트리거되는 경우 다음 N 개 요소 (기간)에서 비정상 상태에 대 한 경고를 일시적으로 중지 합니다.
    - 다시 **알림 유형** : **series** 로 설정 하면 트리거된 비정상은 해당 계열만 다시 알림 합니다. **메트릭에** 대해 트리거된 하나는이 메트릭의 모든 계열을 다시 알림 합니다.
    - 다시 **알림 번호** : 다시 알림을 적용할 점 (마침표) 수입니다.
    - **연속 하지 않는 경우 다시 설정** :이를 선택 하면 트리거된 비정상은 다음 n 개의 연속 이상 상태를 다시 알림 합니다. 다음 데이터 요소 중 하나가 비정상이 아닌 경우 다시 알림을 다시 설정 합니다. 이 확인란을 선택 취소 하면 연속 데이터 요소가 잘못 되지 않은 경우에도 다음 n 개 요소 (기간)가 다시 알림 됩니다.
- **값** (선택 사항): 값으로 필터링 합니다. 조건을 충족 하는 점 값만 포함 됩니다. 다른 메트릭의 해당 값을 사용 하는 경우 두 메트릭의 차원 이름이 일치 해야 합니다.

필터링 되지 않은 비정상은 경고에서 전송 됩니다.

### <a name="add-cross-metric-settings"></a>교차 메트릭 설정 추가

경고 설정 페이지에서 **+ 교차 메트릭 설정 추가** 를 클릭 하 여 다른 섹션을 추가 합니다.

**연산자** 선택기는 각 섹션의 논리적 관계로, 경고를 보낼지 여부를 결정 합니다.


|연산자  |설명  |
|---------|---------|
|AND     | 계열이 각 경고 섹션과 일치 하 고 모든 데이터 요소가 비정상 인 경우에만 경고를 보냅니다. 메트릭에 차원 이름이 서로 다른 경우 경고가 트리거되지 않습니다.         |
|또는     | 하나 이상의 섹션에 이상이 포함 되어 있는 경우 경고를 보냅니다.         |

:::image type="content" source="../media/alerts/alert-setting-operator.png" alt-text="여러 경고 설정 섹션에 대 한 연산자":::

## <a name="next-steps"></a>다음 단계

- [피드백을 사용하여 변칙 검색 조정](anomaly-feedback.md)
- [인시던트를 진단](diagnose-incident.md)합니다.
- [메트릭을 구성하고 구성 감지 미세 조정](configure-metrics.md)