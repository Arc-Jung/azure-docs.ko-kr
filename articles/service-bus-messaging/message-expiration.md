---
title: Azure Service Bus-메시지 만료
description: 이 문서에서는 Azure Service Bus 메시지의 만료 및 라이브 시간에 대해 설명 합니다. 이러한 기한이 지나면 메시지가 더 이상 배달 되지 않습니다.
ms.topic: conceptual
ms.date: 02/17/2021
ms.openlocfilehash: 505a041d2f6129b159166e9f99ce7fef779e1e66
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/03/2021
ms.locfileid: "101698368"
---
# <a name="message-expiration-time-to-live"></a>메시지 만료(TTL(Time To Live))
메시지의 페이로드 또는 메시지가 수신기에 전달하는 명령이나 조회는 거의 항상 특정 형식의 애플리케이션 수준 만료 기한을 따릅니다. 이러한 기간 후에는 콘텐츠가 더 이상 배달되지 않거나 요청된 작업이 더 이상 실행되지 않습니다.

큐 및 토픽이 주로 애플리케이션 또는 애플리케이션 부분의 부분 실행 컨텍스트에서 사용되는 개발 및 테스트 환경에서는 다음 테스트 실행이 새로 시작될 수 있게 표준 테스트 메시지를 자동으로 가비지 수집되도록 할 수 있습니다.

상대 기간을 지정 하는 **ttl (time to live)** 시스템 속성을 설정 하 여 개별 메시지에 대 한 만료를 제어할 수 있습니다. 만료는 메시지가 엔터티 큐에 추가될 때 절대 인스턴스가 됩니다. 이때 **utc (협정 세계시)** 속성은 큐에 대기 된 시간- **utc** ttl (time  +  **to live**) 값을 사용 합니다. 조정 된 메시지에 대 한 TTL (time-to-live) 설정은 적극적으로 수신 대기 중인 클라이언트가 없는 경우에는 적용 되지 않습니다.

**만료** 날짜가 지난 후에는 메시지를 검색할 수 없게 됩니다. 만료는 현재 배달을 위해 잠겨 있는 메시지에 영향을 주지 않습니다. 이러한 메시지는 여전히 정상적으로 처리 됩니다. 잠금이 만료되거나 메시지가 중단되면 만료가 즉시 적용됩니다.

메시지가 잠금 상태인 경우 애플리케이션이 만료된 메시지를 소유하고 있을 수 있습니다. 애플리케이션이 메시지를 계속 처리하려고 할지 또는 메시지를 중단하도록 선택할지는 구현자가 결정합니다.

메시지의 ttl **(time-to-live) 값을** 시간 또는 일 단위로 설정 하는 것이 좋습니다. 낮은 값 (초 또는 밀리초)으로 설정 하면 메시지가 만료 되어 소비자가이를 사용할 수 있습니다. 

## <a name="entity-level-expiration"></a>엔터티 수준 만료
큐 또는 토픽으로 전송 되는 모든 메시지는 엔터티 수준에서 설정 되는 기본 만료 될 수 있습니다. 나중에 만들고 조정 하는 동안 포털에서 설정할 수도 있습니다. 기본 만료는 엔터티에 전송 된 모든 메시지에 대해 ttl (time to live)이 명시적으로 설정 되지 않은 경우에 사용 됩니다. 기본 만료는 ttl (time-to-live) 값의 상한으로도 작동 합니다. 기본값 보다 더 긴 ttl (time-to-live)이 만료 된 메시지는 큐에 대기 되기 전에 기본 메시지 ttl (time-to-live) 값으로 자동 조정 됩니다.

> [!NOTE]
> 조정 된 메시지에 대 한 기본 ttl (time-to-live) 값은 singed 64 비트 정수에 사용할 수 있는 최대 값입니다 (달리 지정 되지 않은 경우).
>
> 메시징 엔터티 (큐 및 토픽)의 경우 기본 만료 시간도 Service Bus standard 및 premium 계층에 대해 singed 64 비트 정수에 대해 가능한 최대값입니다. **기본 계층의** 경우 기본 (최대) 만료 시간은 **14 일** 입니다.

만료 된 메시지를 [배달 못 한 편지 큐](service-bus-dead-letter-queues.md)로 선택적으로 이동할 수 있습니다. 프로그래밍 방식으로 또는 Azure Portal를 사용 하 여이 설정을 구성할 수 있습니다. 이 옵션을 사용하지 않도록 설정하면 만료된 메시지가 삭제됩니다. 배달 못 한 편지 큐로 이동 된 만료 된 메시지는 broker가 사용자 속성 섹션에 저장 하는 [배달 못 한 편지 이유](service-bus-dead-letter-queues.md#moving-messages-to-the-dlq) 속성을 평가 하 여 다른 배달 못 한 편지 메시지와 구분할 수 있습니다. 

이전 경우에서 메시지가 잠금 상태이고 엔터티에 해당 플래그가 설정된 경우 만료되지 않도록 보호하면 메시지는 잠금이 중단되거나 만료될 때 배달 못한 메시지 큐로 이동됩니다. 그러나 메시지를 성공적으로 합의 하는 경우에는 이동 되지 않습니다. 그러면 응용 프로그램에서이를 정상적으로 처리 하는 것으로 가정 합니다.

만료에 대 한 ttl (time-to-live) 및 자동 (및 트랜잭션) 배달 못 한 편지의 조합은 최종 기한에 도달 하는 경우 처리기에 지정 된 작업이 최종 기한에 도달 하면 처리를 위해 검색 되는지 여부에 대 한 확신을 설정 하는 데 중요 한 도구입니다.

예를 들어 확장이 제한된 백 엔드에서 작업을 안정적으로 실행해야 하며, 경우에 따라 트래픽 급증이 발생하거나 해당 백 엔드 가용성의 영향을 받지 않도록 하려는 웹 사이트가 있다고 가정해보겠습니다. 일반적인 경우 제출된 사용자 데이터에 대한 서버 쪽 처리기가 해당 정보를 큐에 밀어 넣고, 이후에 트랜잭션을 회신 큐로 성공적으로 처리했음을 확인하는 응답을 수신하게 됩니다. 트래픽 스파이크가 발생 하 고 백 엔드 처리기가 시간 내에 백로그 항목을 처리할 수 없는 경우 만료 된 작업은 배달 못 한 편지 큐에 반환 됩니다. 대화형 사용자에게 요청된 작업이 평소보다 약간 더 오래 걸린다고 알릴 수 있으며, 요청은 처리 경로의 다른 큐에 배치될 수 있습니다. 이 경우 최종 처리 결과는 전자 메일로 사용자에게 전송됩니다. 


## <a name="temporary-entities"></a>임시 엔터티

지정 된 기간 동안 사용 되지 않은 경우 자동으로 제거 되는 임시 엔터티로 Service Bus 큐, 토픽 및 구독을 만들 수 있습니다.
 
자동 정리는 엔터티가 동적으로 생성 되 고 사용 후 정리 되지 않는 개발 및 테스트 시나리오에서 유용 합니다 .이는 테스트 또는 디버깅 실행이 중단 된 경우에 발생 합니다. 이 기능은 애플리케이션이 응답을 웹 서버 프로세스로 다시 수신하거나 비교적 수명이 짧아서 개체 인스턴스가 사라질 때 해당 엔터티를 안정적으로 정리하기 어려운 개체로 다시 수신하기 위해 회신 큐와 같은 동적 엔터티를 만들 경우에도 유용합니다.

이 기능은 네임 스페이스의 **유휴 상태에서 자동 삭제** 속성을 사용 하 여 설정 됩니다. 이 속성은 엔터티를 자동으로 삭제하기까지 유휴(사용되지 않은) 상태를 유지해야 하는 기간으로 설정됩니다. 이 속성에 대한 최솟값은 5입니다.
 
## <a name="idleness"></a>끊김

엔터티(큐, 토픽 및 구독) 끊김 시 고려할 사항입니다.

- 큐
    - 전송 없음  
    - 수신 없음  
    - 큐 업데이트 없음  
    - 예약된 메시지 없음  
    - Browse/Peek 없음 
- 토픽  
    - 전송 없음  
    - 토픽 업데이트 없음  
    - 예약된 메시지 없음 
- Subscriptions
    - 수신 없음  
    - 구독 업데이트 없음  
    - 구독에 추가된 새 규칙 없음  
    - Browse/Peek 없음  
 

## <a name="next-steps"></a>다음 단계

Service Bus 메시징에 대해 자세히 알아보려면 다음 항목을 참조하세요.

* [Service Bus 큐, 토픽 및 구독](service-bus-queues-topics-subscriptions.md)
* [Service Bus 큐 시작](service-bus-dotnet-get-started-with-queues.md)
* [Service Bus 토픽 및 구독을 사용하는 방법](service-bus-dotnet-how-to-use-topics-subscriptions.md)
