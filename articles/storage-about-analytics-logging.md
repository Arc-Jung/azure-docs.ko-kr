<properties 
	pageTitle="저장소 분석 로깅 정보" 
	description="저장소 분석 로그와 인증된 요청을 사용하는 방법 및 로그 저장 방법에 대해 설명합니다. " 
	services="storage" 
	documentationCenter="" 
	authors="tamram" 
	manager="adinah" 
	editor="cgronlun"/>

<tags 
	ms.service="storage" 
	ms.workload="storage" 
	ms.tgt_pltfrm="na" 
	ms.devlang="na" 
	ms.topic="article" 
	ms.date="02/20/2015" 
	ms.author="tamram"/>

# 저장소 분석 로깅 정보

## 개요
저장소 분석은 저장소 서비스에 대해 성공한 요청과 실패한 요청 관련 상세 정보를 기록합니다. 이 정로를 사용하면 개별 요청을 모니터링하고 저장소 서비스의 문제를 진단할 수 있습니다. 요청은 최상의 노력을 기준으로 기록됩니다.

저장소 분석을 사용하려면 모니터링할 각 서비스에 대해 저장소 분석을 개별적으로 사용하도록 설정해야 합니다. [Azure 관리 포털](https://manage.windowsazure.com/)에서 저장소 분석을 사용하도록 설정할 수 있습니다. 자세한 내용은 [저장소 계정을 모니터링하는 방법](../how-to-monitor-a-storage-account)을 참조하세요. REST API 또는 클라이언트 라이브러리를 통해 프로그래밍 방식으로 저장소 분석을 사용하도록 설정할 수도 있습니다. Blob 서비스 속성 가져오기, 큐 서비스 속성 가져오기 및 테이블 서비스 속성 가져오기 작업을 사용하여 각 서비스에 대해 저장소 분석을 사용하도록 설정합니다.

저장소 서비스 활동이 있는 경우에만 로그 항목이 작성됩니다. 예를 들어 저장소 계정의 Blob 서비스에는 활동이 있지만 테이블 또는 큐 서비스에는 활동이 없으면 Blob 서비스와 관련된 로그만 작성됩니다.

##인증된 요청 로깅
다음과 같은 유형의 인증된 요청이 기록됩니다.

- 성공한 요청

- 실패한 요청(제한 시간, 제한, 네트워크, 권한 부여 및 기타 오류)

- SAS(공유 액세스 서명)를 사용하는 요청(실패한 요청 및 성공한 요청 포함

- 분석 데이터에 대한 요청

로그 만들기/삭제 등 저장소 분석 자체에서 수행한 요청은 기록되지 않습니다. 기록되는 데이터의 전체 목록은 [저장소 분석에서 기록한 작업 및 상태 메시지](https://msdn.microsoft.com/library/hh343260.aspx) 및 [저장소 분석 로그 형식](https://msdn.microsoft.com/library/hh343259.aspx) 항목에 나와 있습니다.

##익명 요청 로깅
다음과 같은 유형의 익명 요청이 기록됩니다.

- 성공한 요청

- 서버 오류

- 클라이언트와 서버에 대한 시간 초과 오류

- 오류 코드가 304(수정되지 않음)인 실패한 GET 요청

기타 모든 실패한 익명 요청은 기록되지 않습니다. 기록되는 데이터의 전체 목록은 [저장소 분석에서 기록한 작업 및 상태 메시지](https://msdn.microsoft.com/library/hh343260.aspx) 및 [저장소 분석 로그 형식](](https://msdn.microsoft.com/library/hh343259.aspx)) 항목에 나와 있습니다.

##로그 저장 방법
모든 로그는 $logs 컨테이너의 블록 Blob에 저장됩니다. 이 컨테이너는 저장소 계정에 대해 저장소 분석을 사용하도록 설정하면 자동으로 작성됩니다. $logs 컨테이너는 `http://<accountname>.blob.core.windows.net/$logs`와 같은 저장소 계정의 Blob 네임스페이스에 있습니다. 저장소 계정을 사용하도록 설정한 후에는 이 컨테이너를 삭제할 수 없지만 해당 콘텐츠는 삭제할 수 있습니다.

>[Azure.NOTE] $logs 컨테이너는 [ListContainers](https://msdn.microsoft.com/library/ee758348.aspx) 등의 메서드를 사용하여 컨테이너 나열 작업을 수행할 때는 표시되지 않으므로 직접 액세스해야 합니다. 예를 들어 [ListBlobs](https://msdn.microsoft.com/library/ee772878.aspx) 메서드를 사용하여 '$logs' 컨테이너의 Blob에 액세스할 수 있습니다.
요청을 기록할 때 저장소 분석은 중간 결과를 블록으로 업로드합니다. 그리고 이러한 블록을 정기적으로 커밋하여 Blob로 제공합니다.

같은 시간에 생성되는 로그의 경우 중복 레코드가 있을 수 있습니다. **RequestId** 및 **Operation** 번호를 검사하여 레코드 중복 여부를 확인할 수 있습니다.

##로그 명명 규칙
각 로그는 다음 형식으로 작성됩니다.

    <service-name>/YYYY/MM/DD/hhmm/<counter>.log 

다음 표에서는 로그 이름의 각 특성에 대해 설명합니다.

| 특성      	| 설명                                                                                                                                                                                	|
|----------------	|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|
| <service-name> 	| 저장소 서비스의 이름입니다. 예: blob, table, queue                                                                                                                        	|
| YYYY           	| 로그의 4자리 연도입니다. 예를 들면 다음과 같습니다. 2011                                                                                                                                         	|
| MM             	| 로그의 2자리 월입니다. 예를 들면 다음과 같습니다. 07                                                                                                                                           	|
| DD             	| 로그의 2자리 월입니다. 예를 들면 다음과 같습니다. 07                                                                                                                                           	|
| hh             	| 로그의 시작 시간을 나타내는 24시간 UTC 형식의 2자리 시간입니다. 예를 들면 다음과 같습니다. 18                                                                                   	|
| mm             	| 로그의 시작 분을 나타내는 2자리 숫자입니다. >[AZURE.NOTE]현재 저장소 분석 버전에서는 이 값이 지원되지 않으며 해당 값은 항상 00입니다. 	|
| <counter>      	| 1시간 동안 저장소 서비스에 대해 생성되는 로그 Blob의 수를 나타내는 0부터 시작되는 6자리 카운터입니다. 이 카운터는 000000부터 시작됩니다. 예를 들면 다음과 같습니다. 000001   	|

위의 예제가 결합된 완전한 샘플 로그 이름이 아래에 나와 있습니다.

    blob/2011/07/31/1800/000001.log

위의 로그에 액세스하는 데 사용할 수 있는 샘플 URI는 다음과 같습니다.

    https://<accountname>.blob.core.windows.net/$logs/blob/2011/07/31/1800/000001.log 

저장소 요청이 기록되면 생성되는 로그 이름과 요청한 작업이 완료된 시간 간의 상관 관계가 지정됩니다. 예를 들어 GetBlob 요청이 2011/7/31 오후 6:30에 완료된 경우 로그는 'blob/2011/07/31/1800/' 접두사를 사용하여 작성됩니다.

##로그 메타데이터
모든 로그 Blob는 해당 Blob에 포함된 로깅 데이터를 식별하는 데 사용할 수 있는 메타데이터와 함께 저장됩니다. 아래 표에서 각 메타데이터 특성에 대해 설명합니다.

| 특성  	| 설명                                                                                                                                                                                                                                               	|
|------------	|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|
| LogType    	| 로그에 읽기, 쓰기 또는 삭제 작업과 관련된 정보가 포함되는지 여부를 설명합니다. 이 값에는 한 가지 형식이 포함될 수도 있고 3개 형식이 모두 조합(쉼표로 구분)되어 포함될 수도 있습니다.   예제 1: write 예제 2: read,write 예제 3: read,write,delete 	|
| StartTime  	| 로그에서 가장 오래된 항목의 시간(YYYY-MM-DDThh:mm:ssZ 형식)입니다. 예를 들면 다음과 같습니다. 2011-07-31T18:21:46Z                                                                                                                                          	|
| EndTime    	| 로그에서 가장 최신 항목의 시간(YYYY-MM-DDThh:mm:ssZ 형식)입니다. 예를 들면 다음과 같습니다. 2011-07-31T18:22:09Z                                                                                                                                            	|
| LogVersion 	| 로그 형식의 버전입니다. 현재 지원되는 유일한 값: 1.0                                                                                                                                                                                 	|

다음 목록에는 위 예제를 사용하는 전체 샘플 메타데이터가 표시되어 있습니다.

- LogType=write 

- StartTime=2011-07-31T18:21:46Z 

- EndTime=2011-07-31T18:22:09Z 

- LogVersion=1.0 

##로깅 데이터 액세스

Azure 관리되는 라이브러리에서 제공하는 .NET API를 비롯한 Blob 서비스 API를 사용하면 '$logs' 컨테이너의 모든 데이터에 액세스할 수 있습니다. 저장소 계정 관리자는 로그를 읽고 삭제할 수는 있지만 작성하거나 업데이트할 수는 없습니다. 로그를 쿼리할 때는 로그 메타데이터와 로그 이름을 모두 사용할 수 있습니다. 지정한 시간의 로그가 잘못된 순서로 표시될 수도 있지만 메타데이터는 항상 로그 내의 로그 항목 시간 간격을 지정합니다. 따라서 특정 로그를 검색할 때 로그 이름과 메타데이터 조합을 사용할 수 있습니다.

##다음 단계

[저장소 분석 로그 형식](https://msdn.microsoft.com/library/hh343259.aspx)

[저장소 분석에서 기록한 작업 및 상태 메시지](https://msdn.microsoft.com/library/hh343260.aspx) 

[저장소 분석 메트릭 정보](https://msdn.microsoft.com/library/hh343258.aspx) 
<!--HONumber=47-->
