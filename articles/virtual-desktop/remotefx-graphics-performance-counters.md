---
title: 원격 데스크톱의 그래픽 성능 문제 진단-Azure
description: 이 문서에서는 원격 데스크톱 프로토콜 세션에서 RemoteFX 그래픽 카운터를 사용 하 여 Windows 가상 데스크톱의 그래픽에서 성능 문제를 진단 하는 방법을 설명 합니다.
services: virtual-desktop
author: ChJenk
ms.service: virtual-desktop
ms.topic: troubleshooting
ms.date: 05/23/2019
ms.author: v-chjenk
ms.openlocfilehash: 8cd24861b9d7432a582d1b635b8ffcf0d8d2b9e6
ms.sourcegitcommit: b2db98f55785ff920140f117bfc01f1177c7f7e2
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/16/2019
ms.locfileid: "68233634"
---
# <a name="diagnose-graphics-performance-issues-in-remote-desktop"></a>원격 데스크톱의 그래픽 성능 문제 진단

원격 세션의 경험 품질 문제를 진단 하기 위해 성능 모니터의 RemoteFX 그래픽 섹션에서 카운터가 제공 되었습니다. 이 문서는 이러한 카운터를 사용 하 여 원격 데스크톱 프로토콜 (RDP) 세션 중에 그래픽 관련 성능 병목 현상을 파악 하 고 해결 하는 데 도움이 됩니다.

## <a name="find-your-remote-session-name"></a>원격 세션 이름 찾기

그래픽 성능 카운터를 식별 하려면 원격 세션 이름이 필요 합니다. 이 섹션의 지침에 따라 각 카운터의 인스턴스를 식별 합니다.

1. 원격 세션에서 Windows 명령 프롬프트를 엽니다.
2. **Qwinsta** 명령을 실행 하 고 세션 이름을 찾습니다.
    - 세션이 다중 세션 VM (가상 컴퓨터)에서 호스트 되는 경우: 각 카운터의 인스턴스는 세션 이름 (예: "rdp-tcp 37")을 접미사 하는 번호를 갖습니다.
    - 세션이 vGPU (가상 그래픽 처리 장치)를 지 원하는 VM에서 호스트 되는 경우: 각 카운터의 인스턴스는 VM이 아닌 서버에 저장 됩니다. 카운터 인스턴스는 세션 이름에 "Win8 Enterprise VM"과 같은 VM 이름을 포함 합니다.

>[!NOTE]
> 카운터의 이름에는 RemoteFX가 있지만 vGPU 시나리오에는 원격 데스크톱 그래픽도 포함 됩니다.

## <a name="access-performance-counters"></a>액세스 성능 카운터

원격 세션 이름을 확인 한 후 다음 지침에 따라 원격 세션에 대 한 RemoteFX 그래픽 성능 카운터를 수집 합니다.

1. **시작** > **관리**도구성능 > **모니터**를 선택 합니다.
2. **성능 모니터** 대화 상자에서 **모니터링 도구**를 확장 하 고 **성능 모니터**를 선택한 다음 **추가**를 선택 합니다.
3. **카운터 추가** 대화 상자의 **사용 가능한 카운터** 목록에서 RemoteFX 그래픽에 대 한 섹션을 확장 합니다.
4. 모니터링할 카운터를 선택 합니다.
5. **선택한 개체의 인스턴스** 목록에서 선택한 카운터에 대해 모니터링할 특정 인스턴스를 선택한 다음 **추가**를 선택 합니다. 사용 가능한 모든 카운터 인스턴스를 선택 하려면 **모든 인스턴스**를 선택 합니다.
6. 카운터를 추가한 후 **확인**을 선택 합니다.

선택한 성능 카운터가 성능 모니터 화면에 표시 됩니다.

>[!NOTE]
>호스트의 각 활성 세션에는 각 성능 카운터의 고유한 인스턴스가 있습니다.

## <a name="diagnose-issues"></a>문제 진단

그래픽 관련 성능 문제는 일반적으로 다음 네 가지 범주로 나뉩니다.

- 낮은 프레임 율
- 임의 정지
- 높은 입력 대기 시간
- 프레임 품질이 나쁨

### <a name="addressing-low-frame-rate-random-stalls-and-high-input-latency"></a>낮은 프레임 속도로, 무작위 정지 및 높은 입력 대기 시간 해결

먼저 출력 프레임/초 카운터를 확인 합니다. 클라이언트에서 사용할 수 있는 프레임 수를 측정 합니다. 이 값이 입력 프레임/초 카운터 보다 작은 경우 프레임을 건너뜁니다. 병목 상태를 식별 하려면 건너뛴 프레임/초 카운터를 사용 합니다.

건너뛴 프레임 수/초 카운터에는 다음 세 가지 유형이 있습니다.

- 건너뛴 프레임/초 (서버 리소스 부족)
- 건너뛴 프레임/초 (네트워크 리소스 부족)
- 건너뛴 프레임/초 (클라이언트 리소스 부족)

건너뛴 프레임/초 카운터의 값이 높으면 카운터가 추적 하는 리소스와 관련이 있음을 의미 합니다. 예를 들어 클라이언트가 프레임을 제공 하는 속도와 동일한 속도로 프레임을 디코딩하고 표시 하지 않으면 건너뛴 프레임 수/초 (클라이언트 리소스 부족) 카운터가 높습니다.

출력 프레임/초 카운터가 입력 프레임/초 카운터와 일치 하는 경우에도 여전히 이상한 지연 또는 상태일을 발견할 수 있습니다. 평균 인코딩 시간이 원인일 수 있습니다. 인코딩은 단일 세션 (vGPU) 시나리오의 서버와 다중 세션 시나리오의 VM에서 발생 하는 동기 프로세스입니다. 평균 인코딩 시간은 33 밀리초 미만 이어야 합니다. 평균 인코딩 시간이 33 밀리초 미만 이지만 여전히 성능 문제가 있는 경우 사용 중인 앱 또는 운영 체제에 문제가 있을 수 있습니다.

앱 관련 문제를 진단 하는 방법에 대 한 자세한 내용은 [사용자 입력 지연 성능 카운터](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/rds-rdsh-performance-counters)를 참조 하세요.

RDP는 33 밀리초의 평균 인코딩 시간을 지원 하므로 초당 최대 30 개의 프레임 속도로 입력 프레임 속도를 지원 합니다. 33 밀리초는 지원 되는 최대 프레임 률입니다. 대부분의 경우 사용자가 경험 하는 프레임 비율은 원본에서 RDP에 프레임을 제공 하는 빈도에 따라 낮아집니다. 예를 들어 비디오 감시와 같은 작업을 수행 하려면 전체 입력 프레임 속도가 30 프레임/초 여야 하지만 문서를 자주 편집 하지 않는 등의 계산 집약적인 작업을 수행 하는 경우에는 사용자의 성능이 저하 되지 않고 입력 프레임/초에 대해 훨씬 더 낮은 값이 발생 합니다. 경험 품질.

### <a name="addressing-poor-frame-quality"></a>프레임 품질 저하 해결

프레임 품질 카운터를 사용 하 여 프레임 품질 문제를 진단 합니다. 이 카운터는 출력 프레임의 품질을 원본 프레임의 품질에 대 한 백분율로 나타냅니다. 품질 손실은 RemoteFX 때문 이거나 그래픽 원본에 내재 될 수도 있습니다. RemoteFX가 품질 손실을 야기 하는 경우이 문제는 더 높은 품질의 콘텐츠를 전송 하기 위해 네트워크 또는 서버 리소스가 부족할 수 있습니다.

## <a name="mitigation"></a>해결 방법

서버 리소스에서 병목 현상이 발생 하는 경우 다음 방법 중 하나를 수행 하 여 성능을 향상 시킵니다.

- 호스트 당 세션 수를 줄입니다.
- 서버에서 메모리 및 계산 리소스를 늘립니다.
- 연결의 해상도를 삭제 합니다.

네트워크 리소스에서 병목 현상이 발생 하는 경우 다음 방법 중 하나를 사용 하 여 세션당 네트워크 가용성을 향상 시킵니다.

- 호스트 당 세션 수를 줄입니다.
- 높은 대역폭의 네트워크를 사용 합니다.
- 연결의 해상도를 삭제 합니다.

클라이언트 리소스에서 병목 상태가 발생 하는 경우 다음 방법 중 하나를 수행 하 여 성능을 향상 시킵니다.

- 최신 원격 데스크톱 클라이언트를 설치 합니다.
- 클라이언트 컴퓨터에서 메모리 및 계산 리소스를 늘립니다.

> [!NOTE]
> 현재 원본 프레임/초 카운터를 지원 하지 않습니다. 현재 원본 프레임/초 카운터는 항상 0을 표시 합니다.

## <a name="next-steps"></a>다음 단계

- GPU에 최적화 된 Azure 가상 머신을 만들려면 [Windows 가상 데스크톱 미리 보기 환경에 대 한 gpu (그래픽 처리 장치) 가속 구성](https://docs.microsoft.com/azure/virtual-desktop/configure-vm-gpu)을 참조 하세요.
- 문제 해결 및 에스컬레이션 트랙의 개요는 [문제 해결 개요, 사용자 의견 및 지원](https://docs.microsoft.com/azure/virtual-desktop/troubleshoot-set-up-overview)을 참조 하세요.
- 미리 보기 서비스에 대 한 자세한 내용은 [Windows Desktop Preview environment](https://docs.microsoft.com/azure/virtual-desktop/environment-setup)를 참조 하세요.
