<properties 
	pageTitle="공유 액세스 서명: SAS 모델 이해 | Microsoft Azure" 
	description="공유 액세스 서명을 사용하여 Blob, 큐 및 테이블 리소스 액세스 권한을 위임하는 방법에 대해 알아봅니다." 
	services="storage" 
	documentationCenter="" 
	authors="tamram" 
	manager="adinah" 
	editor=""/>

<tags 
	ms.service="storage" 
	ms.workload="storage" 
	ms.tgt_pltfrm="na" 
	ms.devlang="dotnet" 
	ms.topic="article" 
	ms.date="11/10/2014" 
	ms.author="tamram"/>



# 공유 액세스 서명, 1부: SAS 모델 이해

SAS(공유 액세스 서명)를 사용하면 계정 키를 노출하지 않고 다른 클라이언트에게 저장소 계정의 Blob, 테이블 및 큐에 대한 제한된 액세스 권한을 확실히 부여할 수 있습니다. 공유 액세스 서명에 관한 이 자습서의 1부에서는 SAS 모델의 개요를 제공하고 SAS 모범 사례를 검토합니다. [자습서의 2부](../storage-dotnet-shared-access-signature-part-2/)에서는 Blob 서비스를 통해 공유 액세스 서명을 만드는 프로세스를 안내합니다.

## 공유 액세스 서명 정의 ##

공유 액세스 서명은 저장소 계정의 리소스에 대한 위임된 권한을 제공합니다. 즉, 계정 액세스 키를 공유할 필요 없이 지정된 권한 집합을 사용하여 지정된 기간 동안 클라이언트에게 Blob, 큐 또는 테이블에 대한 제한된 권한을 부여할 수 있습니다. SAS는 저장소 리소스에 인증된 액세스를 수행하는 데 필요한 모든 정보가 쿼리 매개 변수에 있는 URI입니다. SAS를 사용하여 저장소 리소스에 액세스하려는 클라이언트는 SAS를 적절한 생성자 또는 메서드에 전달하면 됩니다.

## 공유 액세스 서명은 언제 사용하나요? ##

계정 키로 신뢰할 수 없는 클라이언트에게 저장소 계정의 리소스에 대한 액세스 권한을 제공하려는 경우에 SAS를 사용할 수 있습니다. 저장소 계정 키는 기본 키와 보조 키를 모두 포함하여, 계정과 계정에 있는 모든 리소스에 대한 관리 권한을 부여합니다. 이러한 계정 키가 노출되면 계정이 악의적이거나 부주의하게 사용될 수 있습니다. 공유 액세스 서명은 다른 클라이언트가 계정 키를 사용하지 않고 부여된 권한에 따라 저장소 계정에서 데이터를 읽고, 쓰고, 삭제하도록 허용하는 안전한 대체 방법입니다.

SAS가 유용한 일반적인 시나리오로는 다른 사용자가 저장소 계정에서 데이터를 읽고 쓰는 서비스가 있습니다. 저장소 계정에 사용자 데이터를 저장하는 시나리오에는 다음과 같은 두 가지 일반적인 디자인 패턴이 있습니다.


1\. 클라이언트는 인증을 수행하는 프런트 엔드 프록시 서비스를 통해 데이터를 업로드하고 다운로드합니다. 프런트 엔드 프록시 서비스는 비즈니스 규칙의 유효성을 검사할 수 있다는 장점이 있지만, 데이터의 양이 많거나 트랜잭션 볼륨이 높은 경우 수요에 맞게 확장 가능한 서비스를 구축하려면 많은 비용이 필요하거나 어려움이 따를 수 있습니다.

![sas-storage-fe-proxy-service][sas-storage-fe-proxy-service]

2\.	간단한 서비스에서 필요에 따라 클라이언트를 인증한 다음 SAS를 생성합니다. 클라이언트는 SAS를 수신한 후 SAS에 정의된 권한을 사용하여 SAS에 허용된 간격으로 저장소 계정 리소스에 직접 액세스할 수 있습니다. SAS를 사용하면 프런트 엔드 프록시 서비스를 통해 모든 데이터를 라우팅할 필요성이 감소됩니다.

![sas-storage-provider-service][sas-storage-provider-service]

대부분의 실제 서비스에서는 포함된 시나리오에 따라 두 가지 방법을 혼합하여 사용할 수 있습니다. 즉, 일부 데이터는 프런트 엔드 프록시를 통해 처리 및 확인하고 일부 데이터는 SAS를 사용하여 직접 저장하거나 읽습니다.

## 공유 액세스 서명 사용 방법 ##

공유 액세스 서명은 저장소 리소스를 가리키고 클라이언트가 리소스에 액세스하는 방법을 나타내는 특수한 일련의 쿼리 매개 변수를 포함하는 URI입니다. 이러한 매개 변수 중 하나인 서명은 SAS 매개 변수에서 구성되고 계정 키로 서명됩니다. 이 서명은 Azure 저장소에서 SAS를 인증하는 데 사용됩니다.

공유 액세스 서명에는 정의를 제공하고 URI에 매개 변수로 표시되는 다음과 같은 제약 조건이 있습니다.

- **저장소 리소스.** 액세스를 위임할 수 있는 저장소 리소스에는 컨테이너, Blob, 큐, 테이블 및 테이블 엔터티 범위가 포함됩니다.
- **시작 시간.** SAS가 유효해지는 시간입니다. 공유 액세스 서명의 시작 시간은 선택 사항입니다. 생략한 경우 SAS가 즉시 적용됩니다. 
- **만료 시간.** SAS가 더 이상 유효하지 않게 되는 시간입니다. 모범 사례에 따라 SAS의 만료 시간을 지정하거나 만료 시간을 저장된 액세스 정책과 연결하는 것이 좋습니다(아래 내용 참조).
- **사용 권한.** SAS에 지정된 사용 권한은 클라이언트가 SAS를 사용하여 저장소 리소스에 대해 수행할 수 있는 작업을 나타냅니다. 

다음은 Blob에 대한 읽기 및 쓰기 권한을 제공하는 SAS URI의 예입니다. 테이블에서는 URI의 각 부분이 SAS에서 어떤 역할을 하는지를 이해할 수 있도록 세분화했습니다.

https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt?sv=2012-02-12&st=2013-04-29T22%3A18%3A26Z&se=2013-04-30T02%3A23%3A26Z&sr=b&sp=rw&sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D

<table border="1" cellpadding="0" cellspacing="0">
    <tbody>
        <tr>
            <td valign="top" width="213">
                <p>
                    Blob URI
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    Blob의 주소입니다. HTTPS를 사용하는 것이 좋습니다.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="213">
                <p>
                    저장소 서비스 버전
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    sv=2012-02-12
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    2012-02-12 이후의 저장소 서비스 버전의 경우 이 매개 변수는 사용할 버전을 나타냅니다.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="213">
                <p>
                    시작 시간
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    st=2013-04-29T22%3A18%3A26Z
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    ISO 8061 형식으로 지정됩니다. SAS를 즉시 유효화하려면 시작 시간을 생략하세요.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="213">
                <p>
                    만료 시간
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    se=2013-04-30T02%3A23%3A26Z
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    ISO 8061 형식으로 지정됩니다.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="213">
                <p>
                    리소스
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    sr=b
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    Blob의 리소스입니다.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="213">
                <p>
                    권한
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    sp=rw
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    SAS에서 부여하는 권한에는 읽기 및 쓰기가 포함됩니다.
                </p>
            </td>
        </tr>
        <tr>
            <td valign="top" width="213">
                <p>
                    서명
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D
                </p>
            </td>
            <td valign="top" width="213">
                <p>
                    Blob에 대한 액세스 권한을 인증하는 데 사용합니다. 이 서명은 SHA256 알고리즘을 사용하여 서명할 문자열과 키를 통해 계산되고 Base64 인코딩을 사용하여 인코드되는 HMAC입니다.
                </p>
            </td>
        </tr>
    </tbody>
</table>


## 공유 액세스 정책을 사용하여 공유 액세스 서명 제어 ##

공유 액세스 서명은 다음 두 가지 형식 중 하나를 사용할 수 있습니다.

- **임시 SAS:** 임시 SAS를 만들면 SAS의 시작 시간, 만료 시간 및 사용 권한이 모두 SAS URI에 지정됩니다(또는 시작 시간이 생략된 경우 내재됨). 이 유형의 SAS는 컨테이너, Blob, 테이블 또는 큐에 만들 수 있습니다.
- **저장된 액세스 정책을 사용하는 SAS:** 저장된 액세스 정책은 리소스 컨테이너(Blob 컨테이너, 테이블 또는 큐)에서 정의되며, 하나 이상의 공유 액세스 서명에 대한 제약 조건을 관리하는 데 사용할 수 있습니다. SAS를 공유 액세스 정책과 연결할 경우 SAS는 저장된 액세스 정책에 대해 정의된 제약 조건(시작 시간, 만료 시간 및 사용 권한)을 상속합니다.

두 형식의 차이점은 주요 시나리오인 해지에 중요합니다. SAS는 URL이므로 SAS를 시작하도록 요청한 사용자에 상관없이 SAS를 획득한 모든 사용자가 SAS를 사용할 수 있습니다. SAS가 공개적으로 게시된 경우 전 세계의 모든 사용자가 SAS를 사용할 수 있습니다. 분산된 SAS는 다음 네 가지 중 하나에 해당할 때까지 유효합니다.

1.	SAS에 지정된 만료 시간에 도달한 경우
2.	SAS에서 참조되는 저장된 액세스 정책에 지정된 만료 시간에 도달한 경우(저장된 액세스 정책을 참조하고 이 정책에 만료 시간이 지정된 경우). 시간 간격이 경과하거나 저장된 액세스 정책에서 만료 시간을 과거의 시간으로 수정한 경우에 해당하며, 이는 SAS를 해지하는 한 가지 방법입니다.
3.	SAS에서 참조되는 저장된 액세스 정책을 삭제한 경우(SAS를 해지하는 다른 방법). 동일한 이름을 사용하여 저장된 액세스 정책을 다시 만들면 저장된 액세스 정책에 연결된 사용 권한에 따라 모든 기존 SAS 토큰이 다시 유효해집니다(SAS의 만료 시간이 경과하지 않은 것으로 가정). SAS를 해지하기 위해 만료 시간을 미래의 시간으로 지정하여 액세스 정책을 다시 만들 경우 다른 이름을 사용해야 합니다.
4.	SAS를 만드는 데 사용된 계정 키를 다시 생성한 경우.  이렇게 하면 해당 계정 키를 사용하는 모든 응용 프로그램 구성 요소는 다른 유효한 계정 키 또는 새로 생성된 계정 키를 사용하도록 업데이트될 때까지 인증되지 않습니다.
 
## 공유 액세스 서명을 사용하는 모범 사례 ##

응용 프로그램에서 공유 액세스 서명을 사용할 경우 다음과 같은 두 가지 잠재적 위험에 대해 잘 알고 있어야 합니다.

- SAS가 누설될 경우 SAS를 획득한 모든 사용자가 SAS를 사용하여 저장소 계정을 손상시킬 수 있습니다.
- 클라이언트 응용 프로그램에 제공된 SAS가 만료되어 응용 프로그램이 서비스에서 새 SAS를 검색할 수 없는 경우 응용 프로그램의 기능이 저하될 수 있습니다.  

다음은 공유 액세스 서명을 사용하여 이러한 위험을 조율하는 데 도움이 되는 권장 사항입니다.

1. **항상 HTTPS를 사용**하여 SAS를 만들거나 SAS를 분산합니다.  HTTP를 통해 SAS를 전달할 경우 SAS가 노출되면 메시지 가로채기(man-in-the-middle) 공격을 수행하는 공격자가 SAS를 읽은 다음 의도된 사용자처럼 SAS를 사용할 수 있으므로, 악의적인 사용자가 중요한 데이터를 손상시킬 수 있습니다.
2. **저장된 액세스 정책을 최대한 참조합니다.** 저장된 액세스 정책을 사용하면 저장소 계정 키를 다시 생성할 필요 없이 사용 권한을 해지할 수 있습니다. 만료 시간을 매우 길게(또는 무제한) 설정하고 정기적으로 업데이트하여 만료 시간을 미래의 시간으로 이동해야 합니다.
3. **임시 SAS의 경우 짧은 만료 시간을 사용합니다.** 그러면 SAS가 자신도 모르게 손상되더라도 SAS를 단기적으로만 실행할 수 있습니다. 이 방법은 저장된 액세스 정책을 참조할 수 없는 경우에 특히 중요합니다. 또한 업로드할 수 있는 시간을 제한하여 Blob에 쓸 수 있는 데이터의 양을 제한할 수 있습니다.
4. **필요한 경우 클라이언트가 SAS를 자동으로 갱신하도록 허용합니다.** 클라이언트는 예상 만료일 이전에 SAS를 갱신하여 SAS를 제공하는 서비스를 사용할 수 없을 때 다시 시도할 수 있는 시간적 여유를 확보해야 합니다. 지정된 만료 시간 내에 완료할 수 있는 즉각적인 소규모 단기 작업에 SAS를 사용할 경우에는 SAS를 갱신할 필요가 없습니다. 하지만 클라이언트가 SAS를 통해 일상 요청을 수행하는 경우에는 중간에 만료될 수 있습니다. 따라서 위에서 설명한 SAS 단기 실행 요구 사항과 클라이언트가 조기에 갱신을 요청하여 갱신 이전에 SAS가 만료되어 가동 중단이 발생하는 것을 방지해야 하는 요구 사항을 적절하게 조율하는 것이 중요합니다.
5. **SAS 시작 시간에 유의하세요.** SAS 시작 시간을 **지금**으로 설정한 경우 클럭 오차(컴퓨터의 차이에 따른 현재 시간의 차이)로 인해 처음 몇 분 동안 간헐적으로 오류가 발생할 수 있습니다. 일반적으로 시작 시간을 최소 15분 이전으로 설정하거나 설정하지 않습니다. 그러면 시작 시간이 즉시 유효해집니다. 이는 만료 시간에도 일반적으로 적용됩니다. 요청 방향에서 최대 15분의 클럭 오차가 발생할 수 있습니다. 2012-02-12 이전 REST 버전을 사용하는 클라이언트의 경우 저장된 액세스 정책을 참조하지 않는 SAS의 최대 기간은 1시간이고, 이 시간보다 더 긴 기간을 지정하는 정책은 실패합니다.
6.	**액세스할 리소스를 구체적으로 지정하세요.** 일반적으로 보안을 위한 최적의 방법은 사용자에게 필요한 최소 권한을 제공하는 것입니다. 사용자가 단일 엔터티에 대한 읽기 권한만 필요한 경우 해당 엔터티에 대한 읽기 권한만 부여하고 모든 엔터티에 대한 읽기/쓰기/삭제 권한은 부여하지 않습니다. 그러면 SAS 손상 위협을 완화하여 SAS가 공격자의 수중에 넘어갈 가능성이 낮아집니다.
7.	**SAS 사용 작업을 포함한 모든 사용량에 대한 요금이 계정에 청구됩니다.** Blob에 쓰기 권한을 제공한 경우 사용자가 200GB Blob을 업로드하도록 선택할 수 있습니다. 사용자에게 읽기 권한도 제공한 경우 사용자가 이 Blob을 10번 다운로드하도록 선택하여 2TB의 발신 비용이 청구될 수 있습니다. 또한 제한된 권한을 제공하여 악의적인 사용자의 공격 가능성을 낮추세요. 단기 실행 SAS를 사용하여 이 위협을 줄이세요. 이때 종료 시간의 클럭 오차에 유의하세요.
8.	**SAS를 사용하여 작성된 데이터의 유효성을 검사하세요.** 클라이언트 응용 프로그램이 저장소 계정에 데이터를 쓸 경우 해당 데이터에 문제가 있을 수 있습니다. 데이터를 사용할 준비가 되기 이전에 응용 프로그램에서 데이터의 유효성을 검사하거나 권한을 부여해야 하는 경우 데이터를 작성한 이후 응용 프로그램에서 데이터를 사용하기 이전에 유효성 검사를 수행해야 합니다. 그러면 SAS를 적절한 방법으로 습득한 사용자나 누설된 SAS를 악용하는 사용자로 인해 계정이 손상되거나 데이터에 악의적인 데이터가 기록되는 것을 방지할 수 있습니다.
9. **경우에 따라 SAS를 사용하지 마세요.** 저장소 계정에 대한 특정 작업 관련 위험이 SAS의 이점을 능가하는 경우도 있습니다. 그런 작업에 대해서는 비즈니스 규칙 유효성 검사, 인증 및 감사를 수행한 이후에 저장소 계정에 쓰는 중간 계층 서비스를 만듭니다. 또한 다른 방법으로 액세스를 관리하는 것이 더 간단한 경우도 있습니다. 예를 들어 컨테이너의 모든 Blob을 공개적으로 읽기 가능하도록 설정하려면 모든 클라이언트가 액세스하도록 SAS를 제공하는 대신에 컨테이너를 공용으로 설정할 수 있습니다.
10.	**저장소 분석을 사용하여 응용 프로그램을 모니터링합니다.** 로깅 및 메트릭을 사용하여 SAS 공급자 서비스의 가동 중단이나 저장된 액세스 정책의 잘못된 제거로 인한 인증 오류의 급격한 증가를 관찰할 수 있습니다. 추가 정보는 [Azure 저장소 팀 블로그](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx)를 참조하세요.

## 결론 ##

공유 액세스 서명은 계정 키가 필요하지 않은 클라이언트에게 저장소 계정에 대한 제한된 권한을 제공하는 데 유용합니다.  일반적으로 공유 액세스 서명은 Azure 저장소를 사용하는 응용 프로그램에 대한 보안 모델의 필수적인 부분입니다.  여기에 나열된 모범 사례를 따를 경우 SAS를 사용하여 응용 프로그램의 보안을 훼손하지 않으면서 저장소 계정에 있는 리소스에 유연하게 액세스할 수 있습니다.

## Next Steps ##

[공유 액세스 서명, 2부: Blob 서비스를 통해 SAS 만들기 및 사용](../storage-dotnet-shared-access-signature-part-2/)

[Azure 저장소 리소스에 대한 액세스 관리](http://msdn.microsoft.com/library/windowsazure/ee393343.aspx)

[공유 액세스 서명을 사용하여 액세스 위임(REST API)](http://msdn.microsoft.com/library/windowsazure/ee395415.aspx)

[테이블 및 큐 SAS 소개](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-table-sas-shared-access-signature-queue-sas-and-update-to-blob-sas.aspx)
[sas-storage-fe-proxy-service]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-fe-proxy-service.png
[sas-storage-provider-service]: ./media/storage-dotnet-shared-access-signature-part-1/sas-storage-provider-service.png


<!--HONumber=42-->
