---
title: Azure 사이트 복구를 사용 하 고 Azure에서 하이퍼 VM을 다시 실패
description: Azure 사이트 복구를 사용하여 Azure에서 온-프레미스 사이트로 Hyper-V VM을 장애 조치하는 방법
services: site-recovery
author: rajani-janaki-ram
manager: gauravd
ms.service: site-recovery
ms.topic: article
ms.date: 09/12/2019
ms.author: rajanaki
ms.openlocfilehash: 4b005ae308576db6fd26fcf079161430b266ec3f
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/28/2020
ms.locfileid: "79281783"
---
# <a name="run-a-failback-for-hyper-v-vms"></a>Hyper-V VM에 대한 장애 복구(failback) 실행

이 문서에서는 온-프레미스 사이트에서 Azure로 의 Hyper-VM을 장애 조치 한 후 생성된 Azure VM을 [Azure 사이트 복구를](site-recovery-overview.md)사용하여 장애 복구하는 방법을 설명합니다.

- Azure에서 온-프레미스 사이트로 계획된 장애 조치(failover)를 실행하여 Azure에서 Hyper-V VM을 다시 장애 조치합니다. 장애 조치 방향이 Azure에서 온-프레미스로 지정되는 경우 장애 조치로 간주됩니다.
- Azure는 가용성이 높은 환경이며 VM은 항상 사용할 수 있기 때문에 Azure의 장애 복구는 계획된 활동입니다. 워크로드가 온-프레미스에서 다시 실행되도록 작은 가동 중지 시간을 계획할 수 있습니다. 
- 계획된 장애 복구는 Azure의 VM을 해제하고 최신 변경 내용을 다운로드합니다. 데이터 손실이 예상되지 않습니다.

## <a name="before-you-start"></a>시작하기 전에

1. 원래 위치 복구 및 대체 위치 복구 - 사용할 수 [있는 장애 복구 유형을 검토합니다.](failover-failback-overview.md#hyper-v-reprotectionfailback)
2. Azure VM이 관리디스크가 아닌 저장소 계정을 사용하고 있는지 확인합니다. 관리 되는 디스크를 사용 하 여 복제 된 Hyper-V VM의 장애 복구 지원 되지 않습니다.
3. 온-프레미스 하이퍼-V 호스트(또는 사이트 복구와 함께 사용하는 경우 시스템 센터 VMM 서버)가 실행되고 Azure에 연결되어 있는지 확인합니다. 
4. VM에 대해 장애 조치 및 커밋이 완료되었는지 확인합니다. Azure에서 Hyper-VVM의 장애 복구를 위해 특정 사이트 복구 구성 요소를 설정할 필요가 없습니다.
5. 온-프레미스 VM을 완료하고 시작하는 데 필요한 시간은 여러 가지 요인에 따라 달라집니다. 데이터 다운로드 속도를 높이려면 더 많은 스레드를 사용하여 다운로드를 병렬화하도록 Microsoft 복구 서비스 에이전트를 구성할 수 있습니다. [자세히 알아봅니다](https://support.microsoft.com/help/3056159/how-to-manage-on-premises-to-azure-protection-network-bandwidth-usage).


## <a name="fail-back-to-the-original-location"></a>원래 위치로 장애 복구(failback)

Azure의 Hyper-V VM을 원래 온-프레미스 VM으로 장애 복구하려면 다음과 같이 Azure에서 온-프레미스 사이트로 계획된 장애 조치(failover)를 실행합니다.

1. **복제된 항목>** 볼트에서 VM을 선택합니다. **계획된 장애 조치(failover)>** VM을 마우스 오른쪽 단추로 클릭합니다. 복구 계획에 실패한 경우 계획 이름을 선택하고 장애 **조치(Failover)** > **계획 장애 조치(Failover)를**클릭합니다.
2. **계획된 장애 조치(Failover)를 확인하면서**소스 및 대상 위치를 선택합니다. 장애 조치 방향을 유의하십시오. 기본 에서 장애 조치가 예상대로 작동하고 모든 가상 시스템이 보조 위치에 있는 경우 정보 전용입니다.
3. **데이터 동기화에서**옵션을 선택합니다.
    - **장애 조치 전에 데이터를 동기화(델타 변경 만 동기화)**—이 옵션은 VM을 종료하지 않고 동기화할 때 VM의 가동 중지 시간을 최소화합니다.
        - **1단계**: Azure VM의 스냅숏을 생성하여 온-프레미스 하이퍼-V 호스트에 복사합니다. 컴퓨터가 Azure에서 계속 실행됩니다.
        - **2단계**: Azure VM을 종료하여 새 변경 사항이 발생하지 않도록 합니다. 최종 델타 변경 집합은 온-프레미스 서버로 전송되고 온-프레미스 VM이 시작됩니다.
    - **장애 조치 중에만 데이터를 동기화(전체 다운로드)**—이 옵션은 대부분의 디스크가 변경되었다고 가정하고 체크섬을 계산하는 데 시간을 소비하지 않기 때문에 더 빠릅니다. 이 옵션은 체크섬 계산을 수행하지 않습니다.
        - 디스크의 다운로드를 수행합니다. 
        - 한 동안 Azure를 실행했거나 온-프레미스 VM이 삭제된 경우 이 옵션을 사용하는 것이 좋습니다.

4. VMM의 경우 클라우드에 대한 데이터 암호화가 활성화된 경우 **암호화 키에서**VMM 서버에 공급자를 설치하는 동안 데이터 암호화를 사용하도록 설정할 때 발급된 인증서를 선택합니다.
5. 장애 조치를 시작합니다. **작업** 탭에서 장애 조치 진행 상황을 따를 수 있습니다.
6. 장애 조치 전에 데이터를 동기화하는 옵션을 선택한 경우 초기 데이터 동기화가 완료된 후 Azure에서 가상 컴퓨터를 종료할 준비가 된 후 **작업** > 작업 이름 > **완료 장애 조치**입니다. 다음을 수행합니다.
    - Azure 컴퓨터를 종료합니다.
    - 최신 변경 내용을 온-프레미스 VM으로 전송합니다.
    - 온-프레미스 VM을 시작합니다.
7. 이제 온-프레미스 VM 컴퓨터에 로그인하여 예상대로 사용할 수 있는지 확인할 수 있습니다.
8. 가상 머신이 커밋 보류 상태입니다. **커밋**을 클릭하여 장애 조치(failover)를 커밋합니다.
9. 장애 복구를 완료하려면 **역복제를** 클릭하여 온-프레미스 VM을 Azure에 다시 복제하기 시작합니다.



## <a name="fail-back-to-an-alternate-location"></a>대체 위치로 장애 복구(failback) 

다음과 같이 대체 위치로 장애 조치:

1. 새 하드웨어를 설정하는 경우 [지원되는 버전의 Windows](hyper-v-azure-support-matrix.md#replicated-vms)및 컴퓨터에 Hyper-V 역할을 설치합니다.
2. 원본 서버에 있던 동일한 이름의 가상 네트워크 스위치를 만듭니다.
3. **보호된 항목** > **보호 그룹** > \<보호 \<그룹> -> VirtualMachineName> 장애 조치(failover)를 선택한 다음 **계획된 장애 조치(failover)를**선택합니다.
4. **계획된 장애 조치(Failover) 확인에서** **온-프레미스 가상 시스템 만들기가 존재하지 않는 경우**선택합니다.
5. **호스트 이름에서**VM을 배치할 새 Hyper-V 호스트 서버를 선택합니다.
6. **데이터 동기화에서**장애 조치 전에 데이터를 동기화하는 옵션을 선택하는 것이 좋습니다. 이렇게 하면 VM을 종료하지 않고 동기화할 때 VM의 가동 중지 시간이 최소화됩니다. 메서드는 다음 작업을 수행합니다.
    - **1단계**: Azure VM의 스냅숏을 만들고 온-프레미스 하이퍼-V 호스트에 복사합니다. 컴퓨터가 Azure에서 계속 실행됩니다.
    - **2단계**: Azure VM을 종료하여 새 변경 사항이 발생하지 않도록 합니다. 최종 변경 집합이 온-프레미스 서버로 전송되면 온-프레미스 가상 머신이 시작됩니다.
    
7. 확인 표시를 클릭하여 장애 조치(장애 복구)를 시작합니다.
8. 초기 동기화가 끝나고 Azure VM을 종료할 준비가 되면 **작업** > \<계획 장애 조치 작업> > **완료 장애 조치**입니다. 이렇게 하면 Azure 컴퓨터가 종료되고 최신 변경 내용을 온-프레미스 VM으로 전송하고 시작됩니다.
9. 온-프레미스 VM에 로그인하여 모든 것이 예상대로 작동하는지 확인할 수 있습니다.
10. **커밋을** 클릭하여 장애 조치(failover)를 완료합니다. 커밋은 Azure VM 및 해당 디스크를 삭제하고 온-프레미스 VM을 다시 보호할 수 있도록 준비합니다.
10. **역복제를** 클릭하여 온-프레미스 VM을 Azure에 복제하기 시작합니다. Azure에서 VM이 꺼진 이후 델타 변경 내용만 복제됩니다.

    > [!NOTE]
    > 데이터 동기화 중에 장애 조치 작업을 취소하면 온-프레미스 VM이 손상된 상태가 됩니다. 이는 데이터 동기화가 Azure VM 디스크의 최신 데이터를 온-프레미스 데이터 디스크로 복사하고 동기화가 완료될 때까지 디스크 데이터가 일관된 상태가 아닐 수 있기 때문입니다. 데이터 동기화가 취소된 후 온-프레미스 VM이 시작되면 부팅되지 않을 수 있습니다. 이 경우 장애 조치(failover)를 다시 실행하여 데이터 동기화를 완료합니다.


## <a name="next-steps"></a>다음 단계
온-프레미스 VM이 Azure에 복제된 후 필요에 따라 [Azure에 대한 또 다른 장애 조치(failover)를 실행할](site-recovery-failover.md) 수 있습니다.
