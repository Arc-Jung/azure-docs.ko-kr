<properties
	pageTitle="복구 계획 만들기 | Microsoft Azure" 
	description="Azure Site Recovery를 사용하여 장애 조치(failover)할 복구 계획과 가상 컴퓨터 및 실제 서버의 복구 그룹을 만듭니다." 
	services="site-recovery" 
	documentationCenter="" 
	authors="rayne-wiselman" 
	manager="jwhit" 
	editor=""/>

<tags 
	ms.service="site-recovery" 
	ms.devlang="na"
	ms.topic="article"
	ms.tgt_pltfrm="na"
	ms.workload="storage-backup-recovery" 
	ms.date="02/01/2016" 
	ms.author="raynew"/>

# 복구 계획 만들기

Azure Site Recovery 서비스는 가상 컴퓨터와 물리적 서버의 복제, 장애 조치(Failover) 및 복구를 오케스트레이션하여 BCDR(비즈니스 연속성 및 재해 복구) 전략에 기여합니다. 컴퓨터는 Azure 또는 보조 온-프레미스 데이터 센터로 복제할 수 있습니다. 빠른 개요를 알아보려면 [Azure Site Recovery란?](site-recovery-overview.md)을 확인하세요.


## 개요

이 문서는 복구 계획을 만들고 사용자 지정하는 정보를 제공합니다.

복구 계획은 함께 장애 조치(failover)하려는 가상 컴퓨터나 실제 서버가 포함된 하나 이상의 정렬된 그룹으로 구성되어 있습니다. 복구 계획은 다음을 수행합니다.

- 장애 조치(failover)된 다음 함께 시작하는 컴퓨터의 그룹을 정의합니다.
- 복구 계획 그룹에서 함께 그룹화하여 컴퓨터 간의 종속성을 모델링합니다. 예를 들어, 장애 조치를 취하고 및 특정 응용프로그램을 표시하려는 경우, 동일한 복구 계획 그룹에서 해당 응용프로그램에 대한 가상 컴퓨터를 그룹화합니다.
- 자동화하고 장애 조치를 확장합니다. 복구 계획에서 테스트를 실행하고 계획되거나 계획되지 않은 장애 조치를 실행할 수 있습니다. 스크립트, Azure 자동화 및 수동 작업을 사용하여 복구 계획을 사용자 지정할 수 있습니다.

복구 계획은 사이트 복구 포털에서 **복구 계획**에 표시됩니다.


이 문서의 하단 또는 [Azure 복구 서비스 포럼](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr)에서 의견이나 질문을 게시합니다.

## 시작하기 전에

다음 사항에 유의하십시오.

- 복구 계획에서 단일 네트워크 어댑터와 다중 네트워크 어댑터로 VM을 혼합해서는 안 됩니다. Azure 클라우드 서비스에서 이러한 VM을 혼합하는 것이 허용되지 않기 때문입니다.
- 스크립트와 수동 작업으로 복구 계획을 확장할 수 있습니다. 다음 사항에 유의하십시오.
	- Windows PowerShel을 사용하여 스크립트 작성
	- 예외를 정상적으로 처리할 수 있도록 스크립트에서 try-catch 블록을 사용하는지 확인합니다. 스크립트에 예외가 있다면 실행이 중지하고 작업에 실패한 것으로 표시합니다. 오류가 발생한 경우 스크립트의 모든 남은 부분이 실행되지 않습니다. 이 경우 계획되지 않은 장애 조치를 실행하면 복구 계획이 계속됩니다. 이 경우 계획된 장애 조치를 실행하면 복구 계획이 중지됩니다. 이 경우 스크립트를 수정하고 예상된 대로 실행하게 한 다음, 복구 계획을 다시 실행합니다.
	- Write-host 명령이 복구 계획 스크립트에서 작동 하지 않으며 스크립트가 실패합니다. 출력을 만들고자 한다면 기본 스크립트를 실행하는 프록시 스크립트를 만들고 모든 출력이 >> 명령을 사용하여 파이프되는지 확인합니다.
	- 600초 이내에 반환하지 않는 경우 스크립트 시간이 초과됩니다.
	- 모든 항목이 STDERR에 기록된다면 스크립트가 실패로 분류됩니다. 이 정보는 스크립트 실행 세부 정보에 표시됩니다.
	- 배포에서 VMM을 사용하는 경우 다음에 유의하세요.

		- 복구 계획 내 스크립트는 VMM 서비스 계정의 컨텍스트에서 실행됩니다. 이 스크립트가 위치한 원격 공유에서 이 계정에 읽기 권한이 있는지 확인하고 VMM 서비스 계정 권한 수준에서 실행하는 스크립트를 테스트합니다.
		- VMM cmdlet은 Windows PowerShell 모듈로 배달됩니다. VMM Windows PowerShell 모듈은 VMM 콘솔을 설치할 때 설치됩니다. 스크립트에서 다음 명령을 사용하여 스크립트에 VMM 모듈을 로드할 수 있습니다. Import-module-Name virtualmachinemanager [자세한 내용 보기](hhttps://technet.microsoft.com/library/hh875013.aspx).
		- VMM 배포에 최소 1개의 라이브러리 서버가 있는지 확인합니다. 기본적으로 라이브러리는 VMM 서버에 대한 경로를 공유하며, MSCVMMLibrary라는 폴더 이름으로 VMM 서버에 로컬로 위치해 있습니다.
		- 라이브러리 공유 경로가 원격인 경우(또는 로컬이지만 MSCVMMLibrary와 공유하지 않는 경우), 공유를 다음처럼 구성합니다( \\libserver2.contoso.com\\share\\를 예제로 사용).
			- 레지스트리 편집기를 열고 HKEY\_LOCAL\_MACHINE\\SOFTWARE\\MICROSOFT\\Azure Site Recovery\\Registration으로 이동합니다.
			-  ScriptLibraryPath 값을 편집하고 값을 \\libserver2.contoso.com\\share로 넣습니다. 전체 FQDN을 지정합니다. 공유 위치에 대한 사용 권한을 제공합니다.
			-  VMM 서비스 계정과 동일한 권한을 가진 사용자 계정으로 스크립트를 테스트하여 독립 실행형에서 테스트한 스크립트가 복구 계획에서도 동일한 방식으로 실행되는지 확인합니다. VMM 서버에서 실행 정책을 다음과 같이 우회하도록 설정합니다.
				-  상승된 권한을 사용하여 64 비트 Windows PowerShell 콘솔을 엽니다.
				-  유형: **Set-executionpolicy bypass**. [자세한 내용 보기](https://technet.microsoft.com/library/ee176961.aspx).

## 복구 계획 만들기

복구 계획을 만드는 방식은 사이트 복구 배포에 따라 달라집니다.

- **VMware VM 및 물리적 서버 복제** - 계획을 만들고 가상 컴퓨터 및 물리적 서버를 포함하는 복제 그룹을 복구 계획에 추가합니다.
- **Hyper-V VM 복제(VMM 클라우드에 있음)** - 계획을 만들고 VMM 클라우드에서 보호된 Hyper-V 가상 컴퓨터를 복구 계획에 추가합니다.
- **Hyper-V VM 복제(VMM 클라우드에 없음)** - 계획을 만들고 보호 그룹에서 보호된 Hyper-V 가상 컴퓨터를 복구 계획에 추가합니다.
- **SAN 복제** - 계획을 만들고 가상 컴퓨터를 포함하는 복제 그룹을 복구 계획에 추가합니다. 복제 그룹 내의 모든 가상 컴퓨터가 함께 장애 조치(failover)를 취해야 하기 때문에(장애 조치(failover)가 먼저 저장소 계층에서 발생) 특정 가상 컴퓨터가 아닌 복제 그룹을 선택합니다.


다음과 같이 복구 계획을 만듭니다.

1. **복구 계획** 탭 > **복구 계획 만들기**를 클릭합니다. 복구 계획 이름, 원본 및 대상을 지정합니다. 원본 서버에 장애 조치(Failover) 및 복구를 사용하도록 설정한 가상 컴퓨터가 있어야 합니다.

	- VMM에서 VMM으로 복제하는 경우 **원본 유형** > **VMM**과 원본 및 대상 VMM 서버를 차례로 선택합니다. **Hyper-V**를 클릭하여 Hyper-V 복제본을 사용하도록 구성된 클라우드를 표시합니다. 
	- SAN을 사용하여 VMM에서 VMM으로 복제하는 경우 **원본 유형** > **VMM**과 원본 및 대상 VMM 서버를 차례로 선택합니다. **SAN**을 클릭하여 SAN 복제를 위해 구성된 클라우드를 표시합니다.
	- VMM에서 Azure로 복제하는 경우 **원본 유형** > **VMM**을 선택합니다. 원본 VMM 서버 및 **Azure**를 대상으로 선택합니다.
	- Hyper-V 사이트로부터 복제하는 경우 **원본 유형** > **Hyper-V 사이트**를 선택합니다. 이 사이트를 원본으로, **Azure**를 대상으로 선택합니다.
- VMware 또는 물리적 온-프레미스 서버를 Azure로 복제하는 경우 구성 서버를 원본으로, **Azure**를 대상으로 선택합니다.

2. **가상 컴퓨터 선택**에서 복구 계획 내 기본 그룹(그룹 1)에 추가하고자 하는 가상 컴퓨터(또는 복제 그룹)를 선택합니다.

## 복구 계획 사용자 지정

보호된 가상 컴퓨터나 복제 그룹을 기본 복구 계획 그룹에 추가하고 계획을 만든 후에 사용자 지정할 수 있습니다.

- **새 그룹 추가**—추가 복구 계획 그룹을 추가할 수 있습니다. 추가한 그룹이 추가한 순서대로 번호가 지정됩니다. 최대 7개의 그룹을 추가할 수 있습니다. 이러한 새 그룹에 추가 컴퓨터나 복제 그룹을 추가할 수 있습니다. 가상 컴퓨터나 복제 그룹은 1개의 복구 계획 그룹에만 포함할 수 있음을 기억하십시오.
- ****스크립트 추가**—복구 계획 그룹 앞뒤로 스크립트를 추가할 수 있습니다. 스크립트를 추가하면 해당 그룹에 대해 새로운 작업 집합이 추가됩니다. 예를 들어, 그룹 1에 대한 사전 단계 집합이 Group 1: Pre-steps라는 이름으로 생성됩니다. 모든 사전 단계가 이 집합 내에 나열됩니다. 배포된 VMM 서버를 보유한 경우 주 사이트에만 스크립트를 추가할 수 있음을 기억하십시오.
- **수동 작업 추가**—복구 계획 그룹의 앞 또는 뒤에 실행되는 수동 작업을 추가할 수 있습니다. 복구 계획을 실행할 때 수동 작업을 삽입한 지점에서 중지되며, 대화상자가 나타나서 수동 작업이 완료되었는지 여부를 지정할 것을 요청합니다.

## 스크립트로 복구 계획 확장

복구 계획에 스크립트를 추가할 수 있습니다.

- VMM 원본 사이트가 있는 경우 VMM 서버에 스크립트를 생성하고 복구 계획에 포함할 수 있습니다.
- Azure에 복제하는 경우 Azure 자동화 실행서를 복구 계획에 통합할 수 있습니다.

### VMM 스크립트 만들기


스크립트를 다음과 같이 만듭니다.

1. 라이브러리 공유에 새 폴더를 만듭니다. 예: <VMMServerName>\\MSSCVMMLibrary\\RPScripts. 원본 및 대상 VMM 서버에 놓습니다.
2. 스크립트(예: RPScript)를 만들고 예상한 대로 작동하는지 확인합니다.
3. 원본 및 대상 VMM 서버에서 <VMMServerName>\\MSSCVMMLibrary 위치에 스크립트를 놓습니다.

### Azure 자동화 Runbook 만들기

Azure 자동화 Runbook을 계획의 일환으로 실행하여 복구 계획을 확장할 수 있습니다. [자세히 알아보기](site-recovery-runbook-automation.md).


### 복구 계획에 사용자 지정 설정 추가

1. 사용자 지정하려는 복구 계획을 엽니다.
2. 클릭하여 가상 컴퓨터나 새 그룹을 추가합니다.
3. 스크립트나 수동 작업을 추가하려면 **단계** 목록에서 아무 항목이나 클릭하고 **스크립트** 또는 **수동 작업**을 클릭합니다. 스크립트나 작업을 선택한 항목의 앞 또는 뒤에 추가할 것인지 지정합니다. **위로 이동** 및 **아래로 이동** 명령 단추를 사용하여 스크립트의 위치를 위/아래로 이동합니다.
4. VMM 스크립트를 추가하는 경우 **VMM 스크립트에 대한 장애 조치**를 선택하고 **스크립트 경로** 유형에서 공유에 대한 상대 경로를 입력합니다. 따라서, 여기 예제에서 공유가 \<VMMServerName>\\MSSCVMMLibrary\\RPScripts에 위치해 있는 경우 경로를 다음과 같이 지정합니다. \\RPScripts\\RPScript.PS1.
5. Azure 자동화 Runbook을 추가하는 경우 Runbook이 위치한 **Azure 자동화 계정**을 지정하고 적절한 **Azure Runbook 스크립트**를 선택합니다.
5. 복구 계획의 장애 조치를 실행하여 스크립트가 예상대로 작동하는지 확인합니다.


## 다음 단계

환경을 확인하는 테스트 장애 조치(failover), 계획되거나 계획되지 않은 장애 조치(failover)를 포함하는 복구 계획의 여러 유형의 장애 조치(failover)를 실행할 수 있습니다. [자세히 알아봅니다](site-recovery-failover.md).


 

<!---HONumber=AcomDC_0204_2016-->