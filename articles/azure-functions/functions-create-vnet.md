---
title: Azure 함수를 Azure 가상 네트워크와 통합
description: Azure 가상 네트워크에 함수를 연결하는 방법을 보여 주는 단계별 자습서
author: alexkarcher-msft
ms.topic: article
ms.date: 5/03/2019
ms.author: alkarche
ms.reviewer: glenga
ms.openlocfilehash: 0c70c69f547405eb8ebdcf6dcc6ae597db151e53
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/27/2020
ms.locfileid: "75433224"
---
# <a name="tutorial-integrate-functions-with-an-azure-virtual-network"></a>자습서: Azure Virtual Network에 Azure Functions 통합

이 자습서에서는 Azure Functions를 사용하여 Azure 가상 네트워크의 리소스에 연결하는 방법을 보여 주며 있습니다. 당신은 인터넷과 가상 네트워크에서 워드 프레스를 실행하는 VM에 모두 액세스 할 수있는 기능을 만들 수 있습니다.

> [!div class="checklist"]
> * 프리미엄 요금제에서 기능 앱 만들기
> * 가상 네트워크에서 VM에 워드프레스 사이트 배포
> * 기능 앱을 가상 네트워크에 연결
> * 워드 프레스 리소스에 액세스 하는 기능 프록시를 만듭니다.
> * 가상 네트워크 내부에서 워드 프레스 파일을 요청

## <a name="topology"></a>토폴로지

다음 다이어그램은 만드는 솔루션의 아키텍처를 보여 주며 있습니다.

 ![가상 네트워크 통합을 위한 UI](./media/functions-create-vnet/topology.png)

프리미엄 플랜에서 실행되는 함수는 VNet 통합 기능을 포함하는 Azure 앱 서비스의 웹 앱과 동일한 호스팅 기능을 갖습니다. 문제 해결 및 고급 구성을 포함한 VNet 통합에 대한 자세한 내용은 [Azure 가상 네트워크와 앱 통합을](../app-service/web-sites-integrate-with-vnet.md)참조하십시오.

## <a name="prerequisites"></a>사전 요구 사항

이 자습서에서는 IP 주소 지정 및 서브넷을 이해하는 것이 중요합니다. 주소 지정 [및 서브넷의 기본 사항을 다루는 이 문서에서](https://support.microsoft.com/help/164015/understanding-tcp-ip-addressing-and-subnetting-basics)시작할 수 있습니다. 더 많은 기사와 비디오를 온라인으로 사용할 수 있습니다.

Azure 구독이 없는 경우 시작하기 전에 [무료 계정을](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) 만드세요.

## <a name="create-a-function-app-in-a-premium-plan"></a>프리미엄 요금제에서 함수 앱 만들기

먼저 [프리미엄 요금제에서]함수 앱을 만듭니다. 이 계획은 가상 네트워크 통합을 지원하면서 서버없는 규모를 제공합니다.

[!INCLUDE [functions-premium-create](../../includes/functions-premium-create.md)]  

오른쪽 상단 모서리에 있는 핀 아이콘을 선택하여 기능 앱을 대시보드에 고정할 수 있습니다. 고정을 사용하면 VM을 만든 후 이 함수 앱으로 쉽게 돌아갈 수 있습니다.

## <a name="create-a-vm-inside-a-virtual-network"></a>가상 네트워크 내에서 VM 만들기

다음, 가상 네트워크 (제트 웨어에 의해[워드 프레스 LEMP7 최대 성능)](https://jetware.io/appliances/jetware/wordpress4_lemp7-170526/profile?us=azure) 내에서 워드 프레스를 실행 하는 미리 구성된된 VM을 만듭니다. 워드 프레스 VM 때문에 저렴한 비용과 편의의 사용된다. 이 시나리오는 REST API, 앱 서비스 환경 및 기타 Azure 서비스와 같은 가상 네트워크의 모든 리소스와 함께 작동합니다. 

1. 포털에서 + 왼쪽 탐색 창, 검색 필드 유형에서 `WordPress LEMP7 Max Performance`리소스 **만들기를** 선택하고 Enter 를 누릅니다.

1. 검색 결과에서 **워드프레스 LEMP 최대 성능을** 선택합니다. **소프트웨어 계획으로** **CentOS에 대한 워드 프레스 LEMP 최대 성능의 소프트웨어** 계획을 선택하고 **만들기를**선택합니다.

1. **기본** 탭에서 이미지 아래의 표에 지정된 대로 VM 설정을 사용합니다.

    ![VM을 만들기 위한 기본 탭](./media/functions-create-vnet/create-vm-1.png)

    | 설정      | 제안 값  | 설명      |
    | ------------ | ---------------- | ---------------- |
    | **구독** | 사용자의 구독 | 리소스가 생성되는 구독입니다. | 
    | **[리소스 그룹](../azure-resource-manager/management/overview.md)**  | myResourceGroup | 또는 `myResourceGroup`함수 앱으로 만든 리소스 그룹을 선택합니다. 함수 앱, WordPress VM 및 호스팅 계획에 대해 동일한 리소스 그룹을 사용하면 이 자습서를 완료할 때 리소스를 쉽게 정리할 수 있습니다. |
    | **가상 컴퓨터 이름** | VNET 워드 프레스 | VM 이름은 리소스 그룹에서 고유해야 합니다. |
    | **[지역](https://azure.microsoft.com/regions/)** | (유럽) 서유럽 | 가까운 지역 또는 VM에 액세스하는 함수 근처 영역을 선택합니다. |
    | **크기** | B1s | **크기 변경을** 선택한 다음 1vCPU와 1GB메모리가 있는 B1s 표준 이미지를 선택합니다. |
    | **인증 유형** | 암호 | 암호 인증을 사용하려면 **사용자 이름**, 보안 **암호**및 **암호를 확인하도록**지정해야 합니다. 이 자습서에서는 문제를 해결해야 하지 않는 한 VM에 로그인할 필요가 없습니다. |

1. **네트워킹** 탭을 선택하고 가상 네트워크 구성에서 **새 만들기를 선택합니다.**

1. **가상 네트워크 만들기에서**이미지 아래의 표에서 설정을 사용합니다.

    ![VM 만들기의 네트워킹 탭](./media/functions-create-vnet/create-vm-2.png)

    | 설정      | 제안 값  | 설명      |
    | ------------ | ---------------- | ---------------- |
    | **이름** | myResourceGroup-vnet | 가상 네트워크에 대해 생성된 기본 이름을 사용할 수 있습니다. |
    | **주소 범위** | 10.10.0.0/16 | 가상 네트워크에 단일 주소 범위를 사용합니다. |
    | **서브넷 이름** | 튜토리얼 넷 | 서브넷의 이름입니다. |
    | **주소** 범위(서브넷) | 10.10.1.0/24   | 서브넷 크기는 서브넷에 추가할 수 있는 인터페이스 수를 정의합니다. 이 서브넷은 워드 프레스 사이트에서 사용됩니다.  서브넷은 `/24` 254개의 호스트 주소를 제공합니다. |

1. 가상 네트워크를 만들려면 **확인을** 선택합니다.

1. **네트워킹** 탭에서 **공용 IP에**대해 **없음을** 선택합니다.

1. **관리** 탭을 선택한 다음 진단 저장소 계정에서 함수 앱으로 만든 저장소 계정을 **선택합니다.**

1. **검토 + 만들기를**선택합니다. 유효성 검사가 완료되면 **에서 만들기를**선택합니다. VM 만들기 프로세스는 몇 분 정도 걸립니다. 생성된 VM은 가상 네트워크에만 액세스할 수 있습니다.

1. VM을 만든 후 **리소스로 이동을** 선택하여 새 VM의 페이지를 본 다음 **설정**에서 **네트워킹을** 선택합니다.

1. **공용 IP가**없는지 확인합니다. 함수 앱에서 VM에 연결하는 데 사용하는 **개인 IP를**기록합니다.

    ![VM의 네트워킹 설정](./media/functions-create-vnet/vm-networking.png)

이제 가상 네트워크 내에 WordPress 사이트가 완전히 배포되었습니다. 이 사이트는 공용 인터넷에서 액세스할 수 없습니다.

## <a name="connect-your-function-app-to-the-virtual-network"></a>기능 앱을 가상 네트워크에 연결

가상 네트워크에서 VM에서 실행되는 WordPress 사이트를 사용하면 이제 함수 앱을 해당 가상 네트워크에 연결할 수 있습니다.

1. 새 기능 앱에서 **플랫폼 기능** > **네트워킹을**선택합니다.

    ![기능 앱에서 네트워킹 선택](./media/functions-create-vnet/networking-0.png)

1. **VNet 통합에서** **여기를 클릭하여 구성합니다.**

    ![네트워크 피처 구성 현황](./media/functions-create-vnet/Networking-1.png)

1. 가상 네트워크 통합 페이지에서 **VNet 추가(미리 보기)를 선택합니다.**

    ![VNet 통합 미리 보기 추가](./media/functions-create-vnet/networking-2.png)

1. **네트워크 기능 상태에서**이미지 아래의 표에서 설정을 사용합니다.

    ![함수 앱 가상 네트워크 정의](./media/functions-create-vnet/networking-3.png)

    | 설정      | 제안 값  | 설명      |
    | ------------ | ---------------- | ---------------- |
    | **가상 네트워크** | 마이리소스그룹-vnet | 이 가상 네트워크는 이전에 만든 네트워크입니다. |
    | **서브넷** | 새 서브넷 만들기 | 함수 앱에서 사용할 가상 네트워크에서 서브넷을 만듭니다. 빈 서브넷을 사용하도록 VNet 통합을 구성해야 합니다. 함수가 VM과 다른 서브넷을 사용하는 것은 중요하지 않습니다. 가상 네트워크는 두 서브넷 간의 트래픽을 자동으로 라우팅합니다. |
    | **서브넷 이름** | 함수-그물 | 새 서브넷의 이름입니다. |
    | **가상 네트워크 주소 블록** | 10.10.0.0/16 | 워드 프레스 사이트에서 사용하는 동일한 주소 블록을 선택합니다. 하나의 주소 블록만 정의되어야 합니다. |
    | **주소 범위** | 10.10.2.0/24   | 서브넷 크기는 프리미엄 요금제 기능 앱이 확장할 수 있는 총 인스턴스 수를 제한합니다. 이 예제에서는 `/24` 사용 가능한 호스트 주소가 254개 인 서브넷을 사용합니다. 이 서브넷은 과도하게 프로비저닝되었지만 계산하기 쉽습니다. |

1. 서브넷을 추가하려면 **확인을** 선택합니다. VNet 통합 및 네트워크 기능 상태 페이지를 닫고 함수 앱 페이지로 돌아갑니다.

이제 기능 앱이 워드프레스 사이트가 실행되는 가상 네트워크에 액세스할 수 있습니다. 다음으로 Azure [Functions 프록시를](functions-proxies.md) 사용하여 워드프레스 사이트에서 파일을 반환합니다.

## <a name="create-a-proxy-to-access-vm-resources"></a>VM 리소스에 액세스하는 프록시 만들기

VNet 통합을 사용하도록 설정하면 함수 앱에서 프록시를 만들어 가상 네트워크에서 실행 중인 VM에 요청을 전달할 수 있습니다.

1. 함수 앱에서 **프록시를** > **+** 선택한 다음 이미지 아래표의 프록시 설정을 사용합니다.

    ![프록시 설정 정의](./media/functions-create-vnet/create-proxy.png)

    | 설정  | 제안 값  | 설명      |
    | -------- | ---------------- | ---------------- |
    | **이름** | PlAnT | 이름은 모든 값일 수 있습니다. 프록시를 식별하는 데 사용됩니다. |
    | **경로 템플릿** | /플랜트 | VM 리소스에 매핑되는 라우팅입니다. |
    | **백 엔드 URL** | http://<YOUR_VM_IP>/wp-콘텐츠/테마/트웬티세븐틴/에셋/이미지/header.jpg | 이전에 `<YOUR_VM_IP>` 만든 워드 프레스 VM의 IP 주소로 바꿉니다. 이 매핑은 사이트에서 단일 파일을 반환합니다. |

1. 함수 앱에 프록시를 추가하려면 **만들기를** 선택합니다.

## <a name="try-it-out"></a>체험

1. 브라우저에서 **백 엔드**URL로 사용한 URL에 액세스해 보십시오. 예상대로 요청 시간이 시간 단축됩니다. 워드 프레스 사이트가 인터넷이 아닌 가상 네트워크에만 연결되어 있기 때문에 시간 시간이 발생합니다.

1. 새 프록시에서 **프록시 URL** 값을 복사하여 브라우저의 주소 표시줄에 붙여넣습니다. 반환 된 이미지는 가상 네트워크 내에서 실행 되는 WordPress 사이트에서 입니다.

    ![워드 프레스 사이트에서 반환 된 식물 이미지 파일](./media/functions-create-vnet/plant.png)

함수 앱이 인터넷과 가상 네트워크에 모두 연결되어 있습니다. 프록시는 공용 인터넷을 통해 요청을 받은 다음 연결된 가상 네트워크로 해당 요청을 전달하는 간단한 HTTP 프록시 역할을 합니다. 그런 다음 프록시는 인터넷을 통해 응답을 공개적으로 다시 전달합니다.

[!INCLUDE [clean-up-section-portal](../../includes/clean-up-section-portal.md)]

## <a name="next-steps"></a>다음 단계

이 자습서에서 WordPress 사이트는 함수 앱에서 프록시를 사용하여 호출되는 API 역할을 합니다. 이 시나리오는 쉽게 설정하고 시각화할 수 있기 때문에 좋은 자습서를 만듭니다. 가상 네트워크 내에 배포된 다른 API를 사용할 수 있습니다. 가상 네트워크 내에 배포된 API를 호출하는 코드가 있는 함수를 만들 수도 있습니다. 보다 현실적인 시나리오는 데이터 클라이언트 API를 사용하여 가상 네트워크에 배포된 SQL Server 인스턴스를 호출하는 함수입니다.

프리미엄 플랜에서 실행되는 기능은 PremiumV2 요금제의 웹 앱과 동일한 기본 앱 서비스 인프라를 공유합니다. Azure 앱 [서비스의 웹 앱에](../app-service/overview.md) 대한 모든 설명서는 프리미엄 요금제 기능에 적용됩니다.

> [!div class="nextstepaction"]
> [기능의 네트워킹 옵션에 대해 자세히 알아보기](./functions-networking-options.md)

[프리미엄 플랜]: functions-scale.md#premium-plan
