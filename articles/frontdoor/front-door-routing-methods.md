---
title: Azure 전면 도어-트래픽 라우팅 방법 | Microsoft Docs
description: 이 문서는 Front Door에서 사용하는 다양한 트래픽 라우팅 방법을 이해하는 데 도움이 됩니다.
services: front-door
documentationcenter: ''
author: duongau
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/28/2020
ms.author: duau
ms.openlocfilehash: 2bc056620ff964747dfd83e7525cb5bfd2eb8e52
ms.sourcegitcommit: 3792cf7efc12e357f0e3b65638ea7673651db6e1
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/29/2020
ms.locfileid: "91449137"
---
# <a name="front-door-routing-methods"></a>Front Door 라우팅 메서드

Azure 전면 도어는 서로 다른 서비스 끝점에 HTTP/HTTPS 트래픽을 라우팅하는 방법을 결정 하는 다양 한 종류의 트래픽 라우팅 방법을 지원 합니다. 클라이언트에서 전방 도어에 도달 하면 요청이 최상의 백 엔드 인스턴스로 전달 되도록 구성 된 라우팅 메서드가 적용 됩니다. 

프런트 도어에서 사용할 수 있는 네 가지 트래픽 라우팅 방법이 있습니다.

* **[대기 시간](#latency):** 대기 시간 기반 라우팅은 요청이 민감도 범위 내에서 허용 가능한 최저 대기 시간 백 엔드로 전송되도록 해줍니다. 기본적으로 사용자 요청은 네트워크 대기 시간과 관련 하 여 "가장 가까운" 백 엔드 집합으로 전송 됩니다.
* ** [우선 순위](#priority):** 모든 트래픽을 처리 하도록 기본 백 엔드를 구성 하려는 경우 백 엔드에 우선 순위를 할당할 수 있습니다. 기본 백 엔드를 사용할 수 없게 되는 경우 보조 백 엔드는 백업이 될 수 있습니다.
* ** [가중치](#weighted):** 백 엔드 집합 간에 트래픽을 분산 하려는 경우 백 엔드에 가중치를 할당할 수 있습니다. 균등 하 게 배포할지 아니면 가중치 계수에 따라 사용할지 여부입니다.
* ** [세션 선호도](#affinity):** 프런트 엔드 호스트 또는 도메인에 대해 세션 선호도를 구성 하 여 동일한 최종 사용자의 요청이 동일한 백 엔드로 전송 되도록 할 수 있습니다.

모든 Front Door 구성에는 백 엔드 상태 및 자동화된 인스턴트 글로벌 장애 조치(failover)의 모니터링이 포함됩니다. 자세한 내용은 [Front Door 백 엔드 모니터링](front-door-health-probes.md)을 참조하세요. 프런트 도어는 단일 라우팅 메서드를 기반으로 하 여 작업할 수 있습니다. 그러나 응용 프로그램 요구 사항에 따라 여러 라우팅 메서드를 결합 하 여 최적의 라우팅 토폴로지를 구축할 수도 있습니다.

## <a name="lowest-latencies-based-traffic-routing"></a><a name = "latency"></a>최저 대기 시간 기반 트래픽 라우팅

전 세계적으로 둘 이상의 위치에 백 엔드를 배포 하면 최종 사용자에 게 ' 가장 가까운 ' 대상으로 트래픽을 라우팅하여 응용 프로그램의 응답성을 향상 시킬 수 있습니다. 프런트 도어 구성의 기본 트래픽 라우팅 메서드는 최종 사용자의 요청을 요청을 받은 프런트 도어 환경의 가장 가까운 백 엔드로 전달 합니다. Azure 전면 도어의 애니캐스트 아키텍처와 결합 된이 접근 방식은 각 최종 사용자의 위치에 따라 최대한의 개인 설정 된 성능을 제공 하도록 보장 합니다.

' 가장 가까운 ' 백 엔드는 지리적 거리를 기준으로 가장 가까운 것은 아닙니다. 대신, Front Door는 네트워크 대기 시간을 측정하여 가장 가까운 백 엔드를 결정합니다. [Front Door의 라우팅 아키텍처](front-door-routing-architecture.md)에 대해 자세히 알아보세요. 

다음은 전체 의사 결정 흐름입니다.

| 사용할 수 있는 백 엔드 | 우선 순위 | 대기 시간 신호(상태 프로브 기반) | 가중치 |
|-------------| ----------- | ----------- | ----------- |
| 먼저 상태 프로브에 대해 사용 하도록 설정 되 고 정상 (200 OK)으로 반환 되는 모든 백 엔드를 선택 합니다. 6 개의 백 엔드가 A, B, C, D, E 및 F 인 경우, 그 중에 C가 비정상이 고 E가 비활성화 됩니다. 사용 가능한 백 엔드 목록은 A, B, D 및 F입니다.  | 그런 다음 사용 가능한 항목 사이에서 가장 높은 우선 순위 백 엔드가 선택 됩니다. 백 엔드 A, B, D의 우선 순위는 1이 고 백 엔드 F의 우선 순위는 2입니다. 그런 다음 선택한 백 엔드는 A, B, D가 됩니다.| 대기 시간 범위로 백 엔드를 선택합니다(최저 대기 시간 및 지정된 ms에서 대기 시간 민감도). 백 엔드 A가 15 인 경우 B는 30 밀리초이 고 60 D는 배치이 고, 시간은 30 밀리초이 고, d는 30 밀리초를 초과 하는 프런트 도어 환경에서 30 밀리초를 초과 하므로 가장 낮은 대기 시간 풀이 백 엔드 A와 B로 구성 됩니다. | 마지막으로, Front Door는 지정된 가중치 비율에서 최종 선택된 백 엔드 풀 중에서 트래픽을 라운드 로빈합니다. 예를 들어, 백 엔드 A의 가중치가 5이고 백 엔드 B의 가중치가 8인 경우 트래픽은 백 엔드 5와 8 사이에서 5:8 비율로 분산됩니다. |

>[!NOTE]
> 기본적으로, 대기 시간 민감도 속성은 0ms로 설정됩니다. 즉, 항상 요청을 사용 가능한 가장 빠른 백 엔드로 전달합니다.

## <a name="priority-based-traffic-routing"></a><a name = "priority"></a>우선 순위 기반 트래픽 라우팅

주 서버를 중단 하는 경우 둘 이상의 백업 서비스를 배포 하 여 조직에서 서비스에 대 한 고가용성을 제공 하려는 경우가 종종 있습니다. 업계 전체에서 이 토폴로지는 활성/대기 또는 활성/수동 배포 토폴로지라고 하기도 합니다. '우선 순위' 트래픽 라우팅 메서드를 사용하여 Azure 고객은 이러한 장애 조치(Failover) 패턴을 쉽게 구현할 수 있습니다.

기본 Front Door에는 우선 순위가 동등한 백 엔드 목록이 포함되어 있습니다. 기본적으로, Front Door는 최고 우선 순위 백 엔드(최저 우선 순위 값), 즉 기본 백 엔드 집합으로만 트래픽을 전송합니다. 기본 백 엔드를 사용할 수 없는 경우, 프런트 도어는 트래픽을 백 엔드의 보조 집합 (우선 순위에 대 한 두 번째로 낮은 값)으로 라우팅합니다. 기본 및 보조 백 엔드를 모두 사용할 수 없는 경우 트래픽은 세 번째로 이동 하는 방식으로 진행 됩니다. 백 엔드의 가용성은 구성된 상태(활성 또는 비활성화)과 상태 프로브의 결정에 따른 지속적인 백 엔드 상태에 기반합니다.

### <a name="configuring-priority-for-backends"></a>백 엔드에 대한 우선 순위 구성

프런트 도어 구성의 백 엔드 풀에 있는 각 백 엔드에는 ' Priority ' 라는 속성이 있습니다 .이 속성은 1에서 5 사이의 숫자가 될 수 있습니다. Azure Front 도어를 사용 하면 각 백 엔드에 대해이 속성을 사용 하 여 백 엔드 우선 순위를 명시적으로 구성할 수 있습니다. 이 속성은 1에서 5 사이의 값입니다. 값이 낮을수록 더 높은 우선 순위를 나타냅니다. 백 엔드는 우선 순위 값을 공유할 수 있습니다.

## <a name="weighted-traffic-routing-method"></a><a name = "weighted"></a>가중 트래픽 라우팅 방법
'가중' 트래픽 라우팅 메서드를 사용하면 균등하게 트래픽을 분산하거나 미리 정의된 가중치를 사용할 수 있습니다.

가중 트래픽 라우팅 메서드에서는 백 엔드 풀의 Front Door 구성에서 각 백 엔드에 가중치를 할당할 수 있습니다. 가중치는 1에서 1000 사이의 정수입니다. 이 매개 변수는 기본 가중치인 '50'을 사용합니다.

허용 되는 대기 시간 민감도를 포함 하는 사용 가능한 백 엔드 목록을 사용 하면 트래픽이 지정 된 가중치 비율을 사용 하 여 라운드 로빈 메커니즘과 함께 배포 됩니다. 대기 시간 민감도를 0 밀리초로 설정 하면 네트워크 대기 시간이 동일한 두 개의 백 엔드가 있는 경우를 제외 하 고이 속성은 적용 되지 않습니다. 

가중 메서드를 사용하면 다음과 같은 몇 가지 유용한 시나리오를 사용할 수 있습니다.

* **점진적 응용 프로그램 업그레이드**: 새 백 엔드로 라우팅하는 트래픽의 비율을 제공 하 고, 다른 백 엔드와 동일 하 게 유지 하기 위해 시간 경과에 따라 점진적으로 트래픽을 증가 시킵니다.
* **Azure에 애플리케이션 마이그레이션**: Azure 및 외부 백 엔드로 백 엔드 풀을 만듭니다. 새 백 엔드를 선호하도록 백 엔드의 가중치를 조정합니다. 새 백 엔드를 비활성화하는 것으로 시작하여 최저 가중치를 할당하고 대부분 트래픽을 처리하는 수준까지 서서히 늘려 점진적으로 설정할 수 있습니다. 마지막으로 선호도가 낮은 백 엔드를 비활성화한 후 풀에서 이들을 제거합니다.  
* **추가 용량을 위한 클라우드 버스트**: Front Door 뒤에 두어 온-프레미스 배포를 클라우드로 신속하게 확장합니다. 클라우드에서 추가 용량이 필요한 경우 더 많은 백 엔드를 추가 또는 활성화하고 각 백 엔드로 분산되는 트래픽 비율을 지정할 수 있습니다.

## <a name="session-affinity"></a><a name = "affinity"></a>세션 선호도
기본적으로, 세션 선호도를 사용 하지 않으면 프런트 도어는 동일한 클라이언트에서 다른 백 엔드로 들어오는 요청을 전달 합니다. 일부 상태 저장 응용 프로그램 또는 특정 시나리오에서는 동일한 사용자의 요청을 결과 초기 요청을 처리 한 동일한 백 엔드를 선호 합니다. 쿠키 기반 세션 선호도 기능은 동일한 백 엔드에서 사용자 세션을 유지하려는 경우에 유용합니다. Azure Front 도어가 관리 되는 쿠키를 사용 하 여 처리를 위해 사용자 세션에서 동일한 백 엔드로 결과 트래픽을 보낼 수 있습니다.

세션 선호도는 구성된 각 도메인(또는 하위 도메인)에 대해 프론트 엔드 호스트 레벨에서 활성화할 수 있습니다. 활성화되면 Front Door는 사용자 세션에 쿠키를 추가합니다. 쿠키 기반 세션 선호도를 통해 Front Door는 동일한 IP 주소를 사용하고 있더라도 다른 사용자를 식별할 수 있어 다른 백 엔드 간에 트래픽을 더 고르게 분산시킬 수 있습니다.

Front Door가 현재 세션 쿠키만을 지원하고 있으므로, 쿠키 수명은 사용자의 세션과 동일합니다. 

> [!NOTE]
> 공용 프록시는 세션 선호도를 방해할 수 있습니다. 이는 세션을 구축하려면 Front Door가 세션 선호도 쿠키를 응답에 추가해야 하기 때문입니다. 즉, 동일한 리소스를 요청하는 다른 클라이언트의 쿠키를 방해하므로 응답이 캐싱 가능한 경우 실행할 수 없습니다. 이로부터 보호하기 위해 시도될 때 백 엔드가 캐싱 가능한 응답을 전송하면 세션 선호도는 설정되지 **않습니다**. 세션이 이미 설정된 경우 백 엔드에서 응답을 캐싱할 수 있다면 문제가 되지 않습니다.
> 응답에 HTTP 304 상태 코드가 **없을 경우** 세션 선호도는 다음 상황에서 설정됩니다.
> - 응답에는 ```Cache-Control``` "private" 또는 no store와 같이 캐싱을 방지 하는 헤더에 대해 설정 된 특정 값이 있습니다.
> - 응답에 만료되지 않은 ```Authorization``` 헤더가 있습니다.
> - 응답에 HTTP 302 상태 코드가 있습니다.

## <a name="next-steps"></a>다음 단계

- [Front Door를 만드는](quickstart-create-front-door.md) 방법을 알아봅니다.
- [Front Door의 작동 원리](front-door-routing-architecture.md)를 알아봅니다.
