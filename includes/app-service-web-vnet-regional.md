---
author: ccompy
ms.service: app-service-web
ms.topic: include
ms.date: 02/27/2020
ms.author: ccompy
ms.openlocfilehash: e0db3ce7d31b838ca6f7d566083a33ee215d3399
ms.sourcegitcommit: 7581df526837b1484de136cf6ae1560c21bf7e73
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/31/2020
ms.locfileid: "80419562"
---
지역 별 VNet 통합을 사용하면 앱에서 다음에 액세스할 수 있습니다.

* 통합하는 동일한 지역의 가상 네트워크의 리소스입니다.
* 가상 네트워크의 리소스가 동일한 지역에 있는 가상 네트워크를 피어로 연결합니다.
* 서비스 엔드포인트 보안 서비스.
* Azure ExpressRoute 연결의 리소스입니다.
* 연결된 가상 네트워크의 리소스입니다.
* Azure ExpressRoute 연결을 포함하는 피어리 연결의 리소스입니다.
* 전용 끝점.

동일한 리전에서 VNet 통합을 사용하는 경우 다음 Azure 네트워킹 기능을 사용할 수 있습니다.

* **NSG(네트워크 보안 그룹)**: 통합 서브넷에 배치된 NSG를 사용하여 아웃바운드 트래픽을 차단할 수 있습니다. VNet 통합을 사용하여 앱에 대한 인바운드 액세스를 제공할 수 없기 때문에 인바운드 규칙이 적용되지 않습니다.
* **경로 표(DRS)**: 통합 서브넷에 라우트 테이블을 배치하여 원하는 곳에 아웃바운드 트래픽을 보낼 수 있습니다.

기본적으로 앱은 RFC1918 트래픽만 가상 네트워크로 라우팅합니다. 모든 아웃바운드 트래픽을 가상 네트워크로 라우팅하려면 앱 에 WEBSITE_VNET_ROUTE_ALL 앱 설정을 적용합니다. 앱 설정을 구성하려면 다음을 수행하십시오.

1. 앱 포털의 **구성** UI로 이동합니다. **새 애플리케이션 설정**을 선택합니다.
1. **이름** 상자에 **WEBSITE_VNET_ROUTE_ALL** 입력하고 **값** 상자에 **1을** 입력합니다.

   ![응용 프로그램 설정 제공][4]

1. **확인**을 선택합니다.
1. **저장**을 선택합니다.

모든 아웃바운드 트래픽을 가상 네트워크로 라우팅하는 경우 통합 서브넷에 적용되는 NSG 및 DR의 적용을 받습니다. 모든 아웃바운드 트래픽을 가상 네트워크로 라우팅할 때 트래픽을 다른 곳으로 보낼 경로를 제공하지 않는 한 아웃바운드 주소는 앱 속성에 나열된 아웃바운드 주소입니다.

동일한 리전에서 VNet 통합을 사용하는 데는 몇 가지 제한사항이 있습니다.

* 전역 피어링 연결에서 리소스에 연결할 수 없습니다.
* 이 기능은 PremiumV2 앱 서비스 계획을 지원하는 최신 Azure 앱 서비스 규모 단위에서만 사용할 수 있습니다.
* 통합 서브넷은 하나의 앱 서비스 계획에서만 사용할 수 있습니다.
* 앱 서비스 환경에 있는 격리된 계획 앱에서는 이 기능을 사용할 수 없습니다.
* 이 기능에는 Azure Resource Manager 가상 네트워크에서 주소가 32개 이상인 /27인 사용되지 않는 서브넷이 필요합니다.
* 앱과 가상 네트워크는 동일한 지역에 있어야 합니다.
* 통합 앱으로가상 네트워크를 삭제할 수 없습니다. 가상 네트워크를 삭제하기 전에 통합을 제거합니다.
* 앱과 동일한 구독에서만 가상 네트워크와 통합할 수 있습니다.
* 앱 서비스 계획당 하나의 지역 VNet 통합만 가질 수 있습니다. 동일한 앱 서비스 계획의 여러 앱이 동일한 가상 네트워크를 사용할 수 있습니다.
* 지역 VNet 통합을 사용하는 앱이 있는 동안에는 앱 또는 요금제의 구독을 변경할 수 없습니다.

각 계획 인스턴스에 하나의 주소가 사용됩니다. 앱을 인스턴스 5개로 확장하면 5개의 주소가 사용됩니다. 할당 후 서브넷 크기를 변경할 수 없으므로 앱이 도달할 수 있는 규모를 수용할 수 있을 만큼 충분히 큰 서브넷을 사용해야 합니다. 주소가 64인 /26이 권장 크기입니다. 주소가 64인 /26은 30개의 인스턴스가 있는 프리미엄 요금제에 수용됩니다. 계획을 확장하거나 축소할 때 짧은 기간 동안 주소의 두 배가 필요합니다.

다른 계획의 앱이 다른 계획의 앱으로 이미 연결된 가상 네트워크에 도달하도록 하려면 기존 VNet 통합에서 사용하는 것과 다른 서브넷을 선택합니다.

이 기능은 Linux용 미리 보기입니다. 이 기능의 Linux 형식은 RFC 1918 주소(10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16)에 대한 호출만 지원합니다.

### <a name="web-or-function-app-for-containers"></a>컨테이너용 웹 또는 함수 앱

기본 제공 이미지로 Linux에서 앱을 호스팅하는 경우 지역 별 VNet 통합은 추가 변경 없이 작동합니다. 컨테이너에 대한 웹 또는 함수 앱을 사용하는 경우 VNet 통합을 사용하려면 도커 이미지를 수정해야 합니다. docker 이미지에서 하드 코딩된 포트 번호를 사용하는 대신 PORT 환경 변수를 기본 웹 서버의 수신 대기 포트로 사용합니다. PORT 환경 변수는 컨테이너 시작 시간에 플랫폼에 의해 자동으로 설정됩니다. SSH를 사용하는 경우 지역 VNet 통합을 사용할 때 SSH_PORT 환경 변수가 지정한 포트 번호를 수신대기하도록 SSH 데몬을 구성해야 합니다. Linux에서는 게이트웨이에 필요한 VNet 통합을 지원하지 않습니다.

### <a name="service-endpoints"></a>서비스 엔드포인트

지역 별 VNet 통합을 사용하면 서비스 끝점을 사용할 수 있습니다. 앱에서 서비스 끝점을 사용하려면 지역 VNet 통합을 사용하여 선택한 가상 네트워크에 연결합니다. 그런 다음 통합에 사용한 서브넷에서 서비스 끝점을 구성합니다.

### <a name="network-security-groups"></a>네트워크 보안 그룹

네트워크 보안 그룹을 사용하여 가상 네트워크의 리소스에 대한 인바운드 및 아웃바운드 트래픽을 차단할 수 있습니다. 지역 VNet 통합을 사용하는 앱은 [네트워크 보안 그룹을][VNETnsg] 사용하여 가상 네트워크 또는 인터넷의 리소스에 대한 아웃바운드 트래픽을 차단할 수 있습니다. 공용 주소에 대한 트래픽을 차단하려면 응용 프로그램 설정을 WEBSITE_VNET_ROUTE_ALL 설정해야 합니다. VNet 통합은 앱의 아웃바운드 트래픽에만 영향을 미치기 때문에 NSG의 인바운드 규칙은 앱에 적용되지 않습니다.

앱에 대한 인바운드 트래픽을 제어하려면 액세스 제한 기능을 사용합니다. 통합 서브넷에 적용되는 NSG는 통합 서브넷에 적용되는 경로에 관계없이 적용됩니다. WEBSITE_VNET_ROUTE_ALL 1로 설정되어 있고 통합 서브넷의 공용 주소 트래픽에 영향을 주는 경로가 없는 경우에도 모든 아웃바운드 트래픽은 통합 서브넷에 할당된 NSG의 적용을 받습니다. WEBSITE_VNET_ROUTE_ALL 설정되지 않은 경우 NSG는 RFC1918 트래픽에만 적용됩니다.

### <a name="routes"></a>경로

경로 테이블을 사용하여 앱에서 원하는 곳으로 아웃바운드 트래픽을 라우팅할 수 있습니다. 기본적으로 경로 테이블은 RFC1918 대상 트래픽에만 영향을 줍니다. WEBSITE_VNET_ROUTE_ALL 1로 설정하면 모든 아웃바운드 호출이 영향을 받습니다. 통합 서브넷에 설정된 경로는 인바운드 앱 요청에 대한 회신에 영향을 주지 않습니다. 일반적인 대상에는 방화벽 장치 또는 게이트웨이가 포함될 수 있습니다.

온-프레미스에서 모든 아웃바운드 트래픽을 라우팅하려는 경우 경로 테이블을 사용하여 모든 아웃바운드 트래픽을 ExpressRoute 게이트웨이로 보낼 수 있습니다. 트래픽을 게이트웨이로 라우팅하는 경우 외부 네트워크에서 경로를 설정하여 회신을 다시 보내야 합니다.

BGP(테두리 게이트웨이 프로토콜) 경로도 앱 트래픽에 영향을 줍니다. ExpressRoute 게이트웨이와 같은 BGP 경로가 있는 경우 앱 아웃바운드 트래픽이 영향을 받습니다. 기본적으로 BGP 경로는 RFC1918 대상 트래픽에만 영향을 줍니다. WEBSITE_VNET_ROUTE_ALL 1로 설정된 경우 모든 아웃바운드 트래픽은 BGP 경로의 영향을 받을 수 있습니다.


<!--Image references-->
[4]: ../includes/media/web-sites-integrate-with-vnet/vnetint-appsetting.png

<!--Links-->
[VNETnsg]: https://docs.microsoft.com/azure/virtual-network/security-overview/