# Azure 네트워킹

Azure 응용 프로그램과 데이터를 연결하는 가장 쉬운 방법은 일반 인터넷 연결을 통하는 방법입니다. 하지만 이 간단한 방법이 항상 가장 좋은 방법이지는 않습니다. Azure에서도 사용자를 Azure 데이터 센터에 연결하는 기술을 제공합니다. 이 문서에서는 이러한 기술에 대해 살펴봅니다.

## 목차

-   [Azure 가상 네트워크][Azure 가상 네트워크]
-   [Azure 트래픽 관리자][Azure 트래픽 관리자]

<a name="Vnet"></a>

## Azure 가상 네트워크

Azure를 통해 Microsoft 데이터 센터에서 실행하는 VM(가상 컴퓨터)을 만들 수 있습니다. 조직에서 그러한 VM을 사용하여 회사의 직원이 사용할 엔터프라이즈 응용 프로그램 또는 다른 소프트웨어를 실행하려고 한다고 가정합니다. 예를 들어 클라우드에 SharePoint 팜을 만들거나, 인벤토리 관리 응용 프로그램을 실행하려고 할 수 있습니다. 사용자가 최대한 편리하게 하려면 이러한 응용 프로그램이 사용자 고유의 데이터 센터에서 실행 중인 것처럼 액세스되어야 합니다.

이런 종류의 문제에 대한 일반적인 해법은 VPN(가상 사설망)을 만드는 것입니다. 오늘날 모든 규모의 조직은 VPN을 만들어 지점 컴퓨터를 본사 데이터 센터에 연결합니다. 그림 1에서 보는 바와 같이 Azure VM에서도 이와 같은 방법을 사용할 수 있습니다.

<a name="Fig1"></a>

![01\_Networking][01\_Networking]

**그림 1: Azure 가상 네트워크를 사용하여 사용자의 온-프레미스 데이터 센터에 연결된 클라우드에서 가상 네트워크를 만들 수 있습니다.**

그림에서 알 수 있듯이 Azure 가상 네트워크를 통해 Azure 데이터 센터에서 VM 그룹에 *가상 네트워크 또는 VNET*이라는 논리적 경계를 만들 수 있습니다. 그런 다음 이 VNET과 사용자의 로컬 네트워크 간에 IPsec 연결을 만들 수 있습니다. Azure 가상 컴퓨터, Azure 클라우드 서비스 또는 둘 다를 사용하여 VNET의 VM을 만들 수 있습니다. 다시 말해서 이 VM은 Azure IaaS(Infrastructure as a Service) 기술이나 PaaS(Platform as a Service) 기술 중 하나를 사용하여 만들어졌을 수 있습니다.
무엇을 선택하든 IPsec 연결을 만들려면 로컬 네트워크에 연결되어 있는 특수 하드웨어인 VPN 게이트웨이 장치가 필요하며, 네트워크 관리자의 서비스도 필요합니다. 일단 연결이 되면 VNET에서 실행 중인 Azure VM은 조직의 다른 일부 네트워크처럼 보입니다.

[그림 1][그림 1]에서 제안하는 것처럼 자신의 네트워크에서 사용된 IP 주소 공간과 같은 공간으로부터 Azure VM의 IP 주소를 할당합니다. 여기에서 보여 준 시나리오에서는 개인 IP 주소가 사용되며, 클라우드의 VM은 단지 다른 IP 서브넷입니다. 로컬 네트워크에서 실행 중인 소프트웨어에서는 이러한 VM을 로컬 컴퓨터라 여기고 기존의 VPN으로 작업하는 것처럼 인식합니다. 이 연결은 IP 수준에서 이루어지므로 모든 운영 체제에서 양쪽 모두의 가상 및 물리적 컴퓨터를 실행할 수 있습니다. Windows Server 또는 Linux를 실행하는 Azure VM은 Windows, Linux 또는 다른 시스템을 실행하는 온-프레미스 컴퓨터와 상호 작용할 수 있습니다. 또한 System Center 등의 주요 관리 도구를 사용하여 클라우드 VM과 포함된 응용 프로그램을 관리할 수도 있습니다.

많은 상황에서 Azure 가상 네트워크를 사용하는 것이 적합합니다. 이미 언급했듯이 이 방법을 통해 엔터프라이즈 사용자는 보다 쉽게 클라우드 응용 프로그램에 액세스할 수 있습니다. 이러한 사용 용이성의 중요한 점은 기존 온-프레미스 Active Directory 도메인의 Azure VM 부분이 실행하는 응용 프로그램에 사용자 SSO(Single Sign-On)를 제공하도록 만드는 기능입니다. 또한 원하는 경우 클라우드에 Active Directory 도메인을 만든 다음 이 도메인을 사용자의 온-프레미스 네트워크에 연결할 수도 있습니다.

Azure 데이터 센터에 VNET을 만들면 주문형 리소스의 대용량 풀에 효과적으로 액세스할 수 있습니다. 주문형 VM을 만들어 실행하는 동안 지불하고 더 이상 필요 없을 때 제거(지불 중지)할 수 있습니다. 새 소프트웨어를 빌드하는 개발 팀처럼 미리 구성된 컴퓨터에 빠르게 액세스해야 하는 시나리오의 경우에 유용합니다. 필요한 리소스를 로컬 관리자가 설정하도록 기다리지 않고 이러한 리소스를 공용 클라우드에 직접 만들 수 있습니다.

가상 네트워크를 통해 Azure VM이 온-프레미스 리소스에 로컬로 나타나는 것처럼 그 반대도 마찬가지입니다. 이제 로컬 네트워크에서 실행 중인 소프트웨어가 Azure VNET에서 실행 중인 응용 프로그램에 로컬로 나타납니다. 예를 들어 클라우드에서 작동하는 것이 더 저렴하다고 결정하여 기존 온-프레미스 응용 프로그램을 Azure로 이동한다고 가정합니다. 하지만 응용 프로그램에서 사용하는 데이터가 법적으로 온-프레미스에 저장되어야 하는 경우에는 가상 네트워크를 사용하면 클라우드 응용 프로그램이 온-프레미스 데이터베이스 시스템을 마치 로컬인 것처럼 인식하여 바로 액세스됩니다. 어떤 시나리오를 선택하든 결과는 같습니다. Azure는 사용자 고유의 데이터 센터 확장이 됩니다.

<a name="TrafficMngr"></a>

## Azure 트래픽 관리자

Azure 응용 프로그램을 성공적으로 빌드했다고 가정합니다. 전 세계 여러 나라의 많은 사람이 이 응용 프로그램을 사용합니다. 아주 멋진 일이지만 흔히 성공에는 새로운 문제도 따릅니다. 예를 들어 응용 프로그램이 세계 각기 다른 곳에 있는 여러 Azure 데이터 센터에서 실행되고 있는 것 같습니다. 사용자가 항상 최상의 경험을 할 수 있도록 이러한 데이터 센터에서 어떻게 트래픽을 지능적으로 직접 요청할 수 있습니까?

Azure 트래픽 관리자는 이런 문제를 해결하도록 설계되었습니다. 그림 2에서 그 방법을 보여 줍니다.

<a name="Fig3"></a>

![03\_TrafficManager][03\_TrafficManager]

**그림 2: Azure 트래픽 관리자는 사용자로부터 요청을 다른 Azure 데이터 센터에서 실행 중인 응용 프로그램의 인스턴스에 지능적으로 전달합니다.**

이 예에서 사용자의 응용 프로그램은 4개의 데이터 센터에 있는 VM에서 실행 중입니다. 4개의 데이터 센터 중 두 개는 미국, 하나는 유럽 그리고 나머지 하나는 아시아에 있습니다. 베를린에 있는 사용자가 그 응용 프로그램에 액세스하고자 한다고 가정합니다. 트래픽 관리자를 사용 중이면 다음과 같이 처리됩니다.

원래대로 사용자 시스템은 응용 프로그램의 DNS 이름을 조회합니다(1단계). 이 쿼리는 Azure DNS 시스템으로 전달되고(2단계), 그런 다음 이 응용 프로그램의 트래픽 관리자 정책을 조회합니다. 각 정책은 그래픽 인터페이스나 REST API 중 하나를 통해 특정 Azure 응용 프로그램의 소유자가 만듭니다. 만들어졌다 하더라도 정책은 다음 세 가지 부하 분산 옵션 중 하나를 지정합니다.

-   **성능:** 모든 요청이 사용자 시스템에서 데이터 센터로 전송되며 대기 시간이 가장 적습니다.
-   **장애 조치(Failover):** 데이터 센터를 사용할 수 없는 경우를 제외하고 모든 요청은 이 정책의 생성자가 지정한 데이터 센터로 보내집니다. 이 경우 요청은 정책 생성자가 정의한 우선 순위에 따라 다른 데이터 센터로 전달됩니다.
-   **라운드 로빈:** 모든 요청은 응용 프로그램이 실행 중인 모든 데이터 센터에 동일하게 분산됩니다.

일단 올바른 정책을 설정하면 트래픽 관리자는 지정된 세 옵션을 근거로(3단계) 이 요청을 보내야 하는 데이터 센터를 결정합니다. 그런 다음 선택한 데이터 센터의 위치를 사용자에게 보내고(4단계), 사용자는 그 응용 프로그램 인스턴스에 액세스합니다(5단계).

이를 위해서 트래픽 관리자는 각 데이터 센터에서 실행 중인 응용 프로그램의 현재 인스턴스 이미지를 가지고 있어야 합니다. 이렇게 하려면 트래픽 관리자는 HTTP GET을 통해 응용 프로그램의 각 복사본을 주기적으로 ping한 다음 응답을 받았는지 여부를 기록합니다. 응용 프로그램 인스턴스가 응답을 중지하면 ping에 다시 응답할 때까지 트래픽 관리자는 해당 인스턴스로 사용자를 전달하지 않습니다.

모든 응용 프로그램이 트래픽 관리자가 필요할 만큼 크거나 광범위하지는 않습니다. 하지만 그런 경우에는 아주 유용한 서비스가 될 수 있습니다.

  [Azure 가상 네트워크]: #Vnet
  [Azure 트래픽 관리자]: #TrafficMngr
  [01\_Networking]: ./media/azure-networking/Networking_01Networking.png
  [그림 1]: #Fig1
  [03\_TrafficManager]: ./media/azure-networking/Networking_03TrafficManager.png
