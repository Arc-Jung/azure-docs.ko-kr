---
author: ccompy
ms.service: app-service-web
ms.topic: include
ms.date: 02/27/2020
ms.author: ccompy
ms.openlocfilehash: 2d2a82552a846cedfa5da3bb6ec6df8a40b67732
ms.sourcegitcommit: bc792d0525d83f00d2329bea054ac45b2495315d
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78671532"
---
기능을 설정하기 쉽다고 해서 환경에 문제가 없는 것은 아닙니다. 원하는 엔드포인트에 액세스하다가 문제가 발생하는 경우, 앱 콘솔에서 연결을 테스트하는 데 사용할 수 있는 유틸리티가 있습니다. 사용할 수 있는 두 개의 콘솔이 있습니다. 하나는 Kudu 콘솔이고, 다른 하나는 Azure Portal의 콘솔입니다. 앱에서 Kudu 콘솔에 도달하려면 도구 -> Kudu로 차례로 이동합니다. [Sitename]. Kudo 콘솔에 연결할 수도 있습니다. 웹 사이트가 로드 되 면 디버그 콘솔 탭으로 이동 합니다. Azure Portal 호스트 된 콘솔로 이동 하려면 앱에서 도구-> 콘솔로 이동 합니다. 

#### <a name="tools"></a>도구
도구 **ping**, **nslookup**및 **tracert** 는 보안 제약 조건으로 인해 콘솔을 통해 작동 하지 않습니다. Void를 채우기 위해 별도의 두 가지 도구를 추가 했습니다. DNS 기능을 테스트하기 위해 nameresolver.exe라는 도구가 추가되었습니다. 구문은 다음과 같습니다.

    nameresolver.exe hostname [optional: DNS Server]

**nameresolver**를 사용하여 앱에서 사용하는 호스트 이름을 확인합니다. 이렇게 하면 DNS에 잘못 구성된 항목이 있는지 또는 DNS 서버에 대한 액세스가 없는지를 테스트할 수 있습니다. 환경 변수 WEBSITE_DNS_SERVER 및 WEBSITE_DNS_ALT_SERVER를 살펴보면 앱이 콘솔에서 사용할 DNS 서버를 볼 수 있습니다.

다음 도구는 호스트와 포트에 대한 TCP 연결을 테스트하는 데 사용할 수 있습니다. 이 도구는 **tcpping**이라고 하며, 구문은 다음과 같습니다.

    tcpping.exe hostname [optional: port]

특정 호스트 및 포트에 연결할 수 있으면 **tcpping** 유틸리티에서 이를 알려줍니다. 호스트 및 포트 조합에서 수신 대기하는 애플리케이션이 있고 네트워크를 통해 앱에서 지정된 호스트 및 포트에 액세스할 수 있는 경우에만 성공으로 표시될 수 있습니다.

#### <a name="debugging-access-to-vnet-hosted-resources"></a>VNet에서 호스트되는 리소스에 대한 액세스 디버깅
특정 호스트와 포트에 앱이 도달하지 못하도록 방해할만한 요소는 많이 있습니다. 대부분의 경우 다음 세 가지 중 하나입니다.

* **중간에 방화벽이 있음.** 중간에 방화벽이 있으면 TCP 시간 제한에 도달합니다. 이 경우 TCP 시간 제한은 21초입니다. **tcpping** 도구를 사용하여 연결을 테스트합니다. TCP 시간 초과는 방화벽 뒤에 많은 항목이 있으나 방화벽 뒤에서 시작하기 때문일 수 있습니다. 
* **DNS에 액세스할 수 없음.** DNS 시간 제한은 DNS 서버당 3초입니다. DNS 서버가 2개 있으면 제한 시간은 6초입니다. DNS가 작동하는지 확인하려면 nameresolver를 사용합니다. VNet이 구성된 DNS를 사용하지 않으므로 nslookup을 사용할 수 없음에 주의하세요. 액세스할 수 없는 경우 DNS에 대 한 액세스를 차단 하는 방화벽 또는 NSG가 있을 수 있습니다.

이러한 항목으로 인해 문제가 해결 되지 않으면 먼저 다음을 확인 하세요. 

**지역 VNet 통합**
* 대상이 RFC1918 주소가 아니고 WEBSITE_VNET_ROUTE_ALL 1로 설정 되어 있지 않나요?
* 통합 서브넷에서 송신을 차단 하는 NSG가 있나요?
* Express 경로 또는 VPN을 통해 이동 하는 경우 온-프레미스 게이트웨이는 트래픽을 Azure로 라우팅하도록 구성 되나요? VNet의 끝점에 연결할 수 있지만 온-프레미스에 연결할 수 없는 경우 경로를 확인 합니다.
* 통합 서브넷에 대 한 위임을 설정할 수 있는 권한이 있나요? 지역 VNet 통합 구성 중 통합 서브넷이 Microsoft 웹에 위임 됩니다. VNet 통합 UI가 자동으로 서브넷을 Microsoft. 웹에 위임 합니다. 계정에 위임 설정을 위한 충분 한 네트워킹 권한이 없는 경우 통합 서브넷의 특성을 설정 하 여 서브넷을 위임할 수 있는 사용자가 필요 합니다. 통합 서브넷을 수동으로 위임 하려면 Azure Virtual Network 서브넷 UI로 이동 하 고 Microsoft 웹에 대 한 위임을 설정 합니다. 

**게이트웨이 필요 VNet 통합**
* RFC 1918 범위 (10.0.0.0-10.255.255.255/172.16.0.0-172.31.255.255/192.168.0.0-192.168.255.255)의 지점 및 사이트 간 주소 범위 입니까?
* 게이트웨이가 포털에서 실행되고 있나요? 게이트웨이가 다운되어 있으면 다시 가동시킵니다.
* 인증서가 동기화 된 것으로 표시 되거나 네트워크 구성이 변경 된 것으로 의심 됩니까?  인증서가 동기화 되지 않은 상태 이거나, Asp와 동기화 되지 않은 VNet 구성의 변경 내용이 있는 것으로 의심 되는 경우 "네트워크 동기화"를 누릅니다.
* VPN을 통해 이동 하는 경우 온-프레미스 게이트웨이는 트래픽 백업을 Azure로 라우팅하도록 구성 되나요? VNet의 끝점에 연결할 수 있지만 온-프레미스에 연결할 수 없는 경우 경로를 확인 합니다.
* 지점 및 사이트 간 및 Express 경로를 모두 지 원하는 공존 게이트웨이를 사용 하려고 하나요? 공존 게이트웨이는 VNet 통합에서 지원 되지 않습니다.

네트워킹 문제를 디버깅 하는 것은 특정 호스트에 대 한 액세스를 차단 하는 것을 확인할 수 없기 때문입니다. 포트 조합입니다. 여기에 해당하는 경우는 다음과 같습니다.

* 지점 및 사이트 간 IP 범위에서 응용 프로그램 포트에 대 한 액세스를 차단 하는 방화벽이 호스트에 있습니다. 보통 교차 서브넷에는 공용 액세스가 필요합니다.
* 대상 호스트가 다운 되었습니다.
* 응용 프로그램이 다운 되었습니다.
* IP 또는 호스트 이름이 잘못 되었습니다.
* 응용 프로그램이 예상한 것과 다른 포트에서 수신 대기 하 고 있습니다. 엔드포인트 호스트에서 "netstat -aon"을 사용하여 프로세스 ID를 수신 대기 포트와 일치시킬 수 있습니다. 
* 네트워크 보안 그룹은 지점과 사이트 간 IP 범위에서 응용 프로그램 호스트 및 포트에 대 한 액세스를 차단 하는 방식으로 구성 됩니다.

앱이 실제로 사용 하는 주소는 알지 못합니다. 통합 서브넷 또는 지점 및 사이트 간 주소 범위의 모든 주소일 수 있으므로 전체 주소 범위에서 액세스를 허용 해야 합니다. 

추가적인 디버그 단계에는 다음 내용이 포함됩니다.

* VNet의 VM에 연결 하 고 여기에서 리소스 호스트: 포트에 대 한 연결을 시도 합니다. TCP 액세스를 테스트하려면 **test-netconnection** PowerShell 명령을 사용합니다. 구문은 다음과 같습니다.

      test-netconnection hostname [optional: -Port]

* VM에서 응용 프로그램을 가져오고 **tcpping** 을 사용 하 여 앱에서 해당 호스트 및 포트에 대 한 액세스를 테스트 합니다.

#### <a name="on-premises-resources"></a>온-프레미스 리소스 ####

앱에서 온-프레미스 리소스에 연결할 수 없으면 VNet에서 리소스에 연결할 수 있는지 확인합니다. **test-netconnection** PowerShell 명령을 사용하여 TCP 액세스를 확인합니다. VM이 온-프레미스 리소스에 연결할 수 없는 경우 VPN 또는 Express 경로 연결이 제대로 구성 되지 않을 수 있습니다.

VNet 호스팅된 VM에서 온-프레미스 시스템에 연결할 수 있지만 앱에서는 연결할 수 없는 경우 다음과 같은 이유 중 하나가 원인일 수 있습니다.

* 사용자의 경로가 서브넷 또는 온-프레미스 게이트웨이의 지점 및 사이트 간 주소 범위로 구성 되지 않았습니다.
* 네트워크 보안 그룹이 지점 및 사이트 간 IP 범위에 대 한 액세스를 차단 합니다.
* 온-프레미스 방화벽이 지점 및 사이트 간 IP 범위의 트래픽을 차단 하 고 있습니다.
* 지역 VNet 통합 기능을 사용 하 여 비-RFC 1918 주소에 연결 하려고 합니다.