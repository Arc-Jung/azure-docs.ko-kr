---
title: 포함 파일
description: 포함 파일
services: virtual-machines
author: albecker1
ms.service: virtual-machines
ms.topic: include
ms.date: 09/25/2020
ms.author: albecker1
ms.custom: include file
ms.openlocfilehash: e5a6dae98e786bf55dc17d8fabe42f84e9927442
ms.sourcegitcommit: ffa7a269177ea3c9dcefd1dea18ccb6a87c03b70
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/30/2020
ms.locfileid: "91605795"
---
![Dsv3 설명서](media/vm-disk-performance/dsv3-documentation.jpg)

최대 **캐시 되지 않은** 디스크 처리량은 가상 머신에서 처리할 수 있는 기본 저장소 최대 한도입니다. 호스트 캐싱을 사용 하도록 설정 하는 경우 **캐시** 된 최대 저장소 처리량 제한은 별도의 제한입니다. 호스트 캐싱은 저장소를 신속 하 게 작성 하거나 읽을 수 있는 VM에 더 가깝게 배치 하는 방식으로 작동 합니다. 호스트 캐싱에 대해 VM에서 사용할 수 있는 저장소 크기는 설명서에 있습니다. 예를 들어 Standard_D8s_v3가 200 GiB 캐시 저장소와 함께 제공 되는 것을 볼 수 있습니다.

가상 컴퓨터를 만들고 디스크를 연결할 때 호스트 캐싱을 사용 하도록 설정할 수 있습니다. 또한 기존 VM에서 디스크를 캐시 하는 호스트를 설정 및 해제 하도록 조정할 수 있습니다.

![호스트 캐싱](media/vm-disk-performance/host-caching.jpg)

호스트 캐싱은 각 디스크의 워크 로드 요구 사항에 맞게 조정할 수 있습니다. 읽기 및 쓰기 작업의 균형을 유지 하는 작업에 대해 읽기/쓰기 작업을 수행 하는 작업의 경우에만 읽기/쓰기 작업을 수행 하기 위해 호스트 캐싱을 읽기 전용으로 설정할 수 있습니다. 워크 로드가 이러한 패턴 중 하나를 따르지 않는 경우 호스트 캐싱 사용을 사용 하지 않는 것이 좋습니다. 

다른 호스트 캐시 설정에 대 한 몇 가지 예제를 실행 하 여 데이터 흐름 및 성능에 미치는 영향을 확인해 보겠습니다. 이 첫 번째 예제에서는 호스트 캐싱 설정이 **읽기 전용**으로 설정 된 경우 IO 요청에서 발생 하는 상황을 살펴보겠습니다.

설정:
- Standard_D8s_v3 
    - 캐시 된 IOPS: 16000
    - 캐시 되지 않은 IOPS: 12800
- P30 데이터 디스크 
    - IOPS: 5000
    - **호스트 캐싱: 읽기 전용** 

읽기를 수행 하 고 원하는 데이터를 캐시에서 사용할 수 있는 경우 캐시에서 요청 된 데이터를 반환 하 고 디스크에서 읽을 필요가 없습니다. 이 읽기는 VM의 캐시 된 제한에 계산 됩니다.

![읽기 호스트 캐싱 읽기 적중](media/vm-disk-performance/host-caching-read-hit.jpg)

읽기를 수행 하 고 원하는 데이터를 캐시에서 사용할 수 **없는** 경우 읽기 요청이 디스크로 릴레이 된 후 캐시와 VM 모두에 전달 됩니다. 이 읽기는 VM의 캐시 되지 않은 제한과 VM의 캐시 된 제한에 계산 됩니다.

![읽기 호스트 캐싱 읽기 누락](media/vm-disk-performance/host-caching-read-miss.jpg)

쓰기를 수행 하는 경우 완료 된 것으로 간주 되기 전에 쓰기를 캐시와 디스크 모두에 써야 합니다. 이 쓰기는 VM의 캐시 되지 않은 제한 및 VM의 캐시 된 제한에 계산 됩니다.

![호스트 캐싱 쓰기 읽기](media/vm-disk-performance/host-caching-write.jpg)

다음 예제에서는 호스트 캐시 설정이 **읽기/쓰기로**설정 된 경우 IO 요청에서 발생 하는 상황을 살펴보겠습니다.

설정:
- Standard_D8s_v3 
    - 캐시 된 IOPS: 16000
    - 캐시 되지 않은 IOPS: 12800
- P30 데이터 디스크 
    - IOPS: 5000
    - **호스트 캐싱: 읽기/쓰기** 

읽기는 읽기 전용과 정확히 동일한 방식으로 처리 됩니다. 쓰기는 읽기/쓰기 캐싱과는 다릅니다. 읽기/쓰기로 설정 된 호스트 캐싱을 사용 하 여 작성 하는 경우 완료 된 것으로 간주 되도록 쓰기 전용을 호스트 캐시에 써야 합니다. 그런 다음 쓰기는 디스크에 백그라운드 프로세스로 지연 기록 됩니다. 즉, 쓰기는 캐시에 기록 될 때 캐시 된 IO로 계산 되 고 디스크에 지연 기록 될 때 캐시 되지 않은 IO에 계산 됩니다.

![읽기/쓰기 호스트 캐싱 쓰기](media/vm-disk-performance/host-caching-read-write.jpg)

Standard_D8s_v3 가상 머신에 대 한 예제를 계속 살펴보겠습니다. 이 시간을 제외 하 고 디스크에 대 한 호스트 캐싱을 사용 하도록 설정 하 고 이제 VM의 IOPS 한도가 16000 IOPS로 설정 됩니다. 5000 IOPS를 처리할 수 있는 세 개의 기본 P30 디스크가 VM에 연결 되어 있습니다.

설정:
- Standard_D8s_v3 
    - 캐시 된 IOPS: 16000
    - 캐시 되지 않은 IOPS: 12800
- P30 OS 디스크 
    - IOPS: 5000
    - 호스트 캐싱: 읽기/쓰기 
- 2 P30 데이터 디스크
    - IOPS: 5000
    - 호스트 캐싱: 읽기/쓰기

![호스트 캐싱 예제](media/vm-disk-performance/host-caching-example-without-remote.jpg)

이제 캐싱이 설정 된이 Standard_D8s_v3 가상 컴퓨터를 사용 하는 응용 프로그램은 15000 IOPS에 대 한 요청을 만듭니다. 이러한 요청은 연결 된 각 기본 디스크에 5000 IOPS로 세분화 되며 성능 50, 발생 하지 않습니다.

## <a name="combined-uncached-and-cached-limits"></a>결합 된 캐시 되지 않은 및 캐시 된 제한

가상 컴퓨터의 캐싱 제한은 캐시 되지 않은 제한과는 다릅니다. 즉, vm에 연결 된 디스크에서 호스트 캐싱을 사용 하도록 설정할 수 있습니다. 또한 다른 디스크의 호스트 캐싱을 사용 하도록 설정 하 여 가상 컴퓨터에서 캐시 된 한도의 총 저장소 IO와 캐시 되지 않은 제한을 더한 값을 얻을 수 있습니다. 이러한 한도를 함께 사용 하는 방법을 구체화 하는 데 도움이 되는 예제를 실행 하 여 가상 머신 및 프리미엄 디스크 연결 구성을 계속 Standard_D8s_v3 합니다.

설정:
- Standard_D8s_v3 
    - 캐시 된 IOPS: 16000
    - 캐시 되지 않은 IOPS: 12800
- P30 OS 디스크 
    - IOPS: 5000
    - 호스트 캐싱: 읽기/쓰기
- 2 P30 데이터 디스크 X 2
    - IOPS: 5000
    - 호스트 캐싱: 읽기/쓰기
- 2 P30 데이터 디스크 X 2
    - IOPS: 5000
    - 호스트 캐싱: 사용 안 함

![원격 저장소를 사용 하는 호스트 캐싱 예제](media/vm-disk-performance/host-caching-example-with-remote.jpg)

이제를 사용 하 여 Standard_D8s_v3 가상 머신에서 실행 되는 응용 프로그램이 25000 IOPS에 대 한 요청을 만듭니다. 이 요청은 해당 디스크의 3 개에서 호스트 캐싱을 사용 하 고 있고 디스크 2 개를 사용 하지 않는 경우 연결 된 각 기본 디스크에 5000 IOPS로 구분 됩니다. 호스트 캐싱을 사용 하는 3 개는 캐시 된 한도 (16000) 내에 있기 때문에 해당 요청이 성공적으로 완료 되 고 저장소 성능 50, 발생 하지 않습니다. 또한 호스트 캐싱을 사용 하지 않는 2 개의 디스크가 12800의 캐시 되지 않은 제한 내에 있기 때문에 해당 요청도 성공적으로 완료 되 고 50, 발생 하지 않습니다.

## <a name="metrics-for-disk-performance"></a>디스크 성능에 대 한 메트릭
Azure에는 가상 머신 및 디스크의 작동 방식에 대 한 통찰력을 제공 하는 메트릭이 있습니다. 이러한 메트릭은 Azure Portal 통해 시각적으로 보거나 API 호출을 통해 검색할 수 있습니다. 메트릭은 1 분 간격으로 계산 됩니다. 다음 메트릭은 VM 및 디스크 IO 및 처리량 성능에 대 한 통찰력을 얻는 데 사용할 수 있습니다.
- **Os 디스크 큐 깊이** – os 디스크에서 읽거나 쓰는 동안 대기 중인 현재 미해결 IO 요청 수입니다.
- **Os 디스크 읽기 바이트/초** – os 디스크에서 초당 읽은 바이트 수입니다.
- **Os 디스크 읽기 작업/초** – os 디스크에서 초당 읽은 입력 작업의 수입니다.
- **Os Disk Write bytes/Sec** – os 디스크에서 초당 기록 되는 바이트 수입니다.
- **Os 디스크 쓰기 작업/초** – os 디스크에서 1 초 안에 기록 된 출력 작업의 수입니다.
- **데이터 디스크 큐 깊이** – 데이터 디스크에서 읽거나 쓸 때까지 대기 중인 현재 미해결 IO 요청 수입니다.
- **데이터 디스크 읽기 바이트/초** – 데이터 디스크에서 초당 읽은 바이트 수입니다.
- **데이터 디스크 읽기 작업/초** – 데이터 디스크에서 초당 읽은 입력 작업 수입니다.
- **데이터 디스크 쓰기 바이트/초** – 데이터 디스크에서 초당 기록 되는 바이트 수입니다.
- **데이터 디스크 쓰기 작업/초** – 데이터 디스크에서 1 초 안에 작성 된 출력 작업의 수입니다.
- **Disk Read bytes/Sec** – VM에 연결 된 모든 디스크에서 초당 읽은 총 바이트 수입니다.
- **디스크 읽기 작업/초** – VM에 연결 된 모든 디스크에서 초당 읽은 입력 작업 수입니다.
- **Disk Write Bytes/Sec** – VM에 연결 된 모든 디스크에서 초당 기록 되는 바이트 수입니다.
- **디스크 쓰기 작업/초** – VM에 연결 된 모든 디스크에서 초당 작성 된 출력 작업의 수입니다.

## <a name="storage-io-utilization-metrics"></a>저장소 IO 사용률 메트릭
디스크 IO 50,을 진단 하는 데 도움이 되는 메트릭:
- **데이터 디스크 Iops 사용 백분율** -프로 비전 된 데이터 디스크 iops를 통해 완료 된 데이터 디스크 iops에서 계산 된 백분율입니다. 이 금액이 100%에 해당 하는 경우 응용 프로그램을 실행 하는 IO가 데이터 디스크의 IOPS 제한 보다 더 많이 발생 합니다.
- **사용 된 데이터 디스크 대역폭 (%** )-프로 비전 된 데이터 디스크 처리량에 대해 완료 된 데이터 디스크 처리량에 의해 계산 된 비율입니다. 이 금액이 100%에 해당 하는 경우 데이터를 실행 하는 응용 프로그램은 데이터 디스크의 대역폭 제한에서 IO가 됩니다.
- **Os 디스크 Iops 사용 백분율** -프로 비전 된 OS 디스크 iops를 통해 완료 된 OS 디스크 iops에서 계산 된 백분율입니다. 이 금액이 100%에 해당 하는 경우 OS 디스크의 IOPS 제한에서 응용 프로그램이 실행 되는 IO가 됩니다.
- **Os 디스크 대역폭 사용 백분율** -프로 비전 된 os 디스크 처리량을 통해 완료 된 os 디스크 처리량에 의해 계산 된 백분율입니다. 이 금액이 100%에 해당 하는 경우 실행 중인 응용 프로그램은 OS 디스크의 대역폭 한도를 초과 하는 IO가 됩니다.

VM IO 50,을 진단 하는 데 도움이 되는 메트릭:
- **사용 된 VM 캐시 된 Iops 비율** -캐시 된 최대 가상 머신 IOPS 제한을 초과 하 여 완료 된 총 IOPS로 계산 된 백분율입니다. 이 금액이 100%에 해당 하는 경우 실행 중인 응용 프로그램은 VM의 캐시 된 IOPS 제한 보다 더 많은 IO가 됩니다.
- **사용 된 VM 캐시 된 대역폭 비율** -캐시 된 최대 가상 머신 처리량에 대해 완료 된 총 디스크 처리량으로 계산 되는 백분율입니다. 이 금액이 100%에 해당 하는 경우 실행 중인 응용 프로그램은 VM의 캐시 된 대역폭 제한 보다 더 많은 IO가 됩니다.
- **VM 캐시 되지 않은 IOPS 사용 백분율** -가상 머신의 총 IOPS로 계산 된 비율이 최대 캐시 되지 않은 가상 머신 IOPS 제한을 초과 했습니다. 이 금액이 100%에 해당 하는 경우 실행 중인 응용 프로그램은 VM의 캐시 되지 않은 IOPS 제한 보다 더 많은 IO가 됩니다.
- **VM 캐시 되지 않은 대역폭 사용 백분율** -가상 머신의 총 디스크 처리량으로 계산 된 비율이 최대 프로 비전 된 가상 머신 처리량을 초과 했습니다. 이 금액이 100%에 해당 하는 경우 실행 중인 응용 프로그램은 VM의 캐시 되지 않은 대역폭 제한에서 IO가 됩니다.

