<properties  writer="josephd" editor="tysonn" manager="dongill" />

# 부하 분산 가상 컴퓨터

Azure에서 만든 모든 가상 컴퓨터는 개인 네트워크 채널을 사용하여 동일한 클라우드 서비스 또는 가상 네트워크에 있는 다른 가상 컴퓨터와 자동으로 통신할 수 있습니다. 인터넷 호스트에서 시작되었거나 다른 클라우드 서비스 또는 가상 네트워크에 있는 가상 컴퓨터에서 시작된 트래픽과 같은 모든 다른 인바운드 통신에는 끝점이 필요합니다.

끝점은 다양한 목적으로 사용될 수 있습니다. Azure 관리 포털을 사용하여 만든 가상 컴퓨터의 끝점에 적용되는 기본적인 용도와 구성은 RDP(원격 데스크톱 프로토콜) 및 원격 Windows PowerShell 세션 트래픽을 위한 것입니다. 이 끝점을 사용하여 가상 컴퓨터를 인터넷으로 원격 관리할 수 있습니다.

끝점의 다른 용도는 Azure 부하 분산 장치가 여러 가상 컴퓨터 또는 서비스 사이에 특정 유형의 트래픽을 분산하도록 구성하는 것입니다. 예를 들어 웹 요청 트래픽의 부하를 여러 웹 서버 또는 웹 역할에 분배할 수 있습니다.

가상 컴퓨터에 정의된 각 끝점은 공용 및 개인 포트, TCP 또는 UDP에 할당됩니다. 인터넷 호스트는 들어오는 트래픽을 클라우드 서비스 및 공용 포트의 공용 IP 주소로 보내고, 클라우드 서비스 내부의 가상 컴퓨터 및 서비스는 개인 IP 주소 및 개인 포트를 수신 대기합니다. 부하 분산 장치는 들어오는 트래픽의 공용 IP 주소 및 포트 번호를 가상 컴퓨터의 개인 IP 주소 및 포트 번호로 매핑하고 가상 컴퓨터에서 오는 응답 트래픽의 경우 반대 방향으로 매핑합니다.

여러 가상 컴퓨터 또는 서비스에서 트래픽의 부하를 분산하도록 구성하면 Azure는 들어오는 트래픽을 임의로 분산합니다.

웹 역할이나 작업자 역할 인스턴스를 포함하는 클라우드 서비스의 경우 서비스 정의에 공용 끝점을 정의할 수 있으며, 가상 컴퓨터를 포함하는 클라우드 서비스의 경우 가상 컴퓨터를 만들 때 가상 컴퓨터에 끝점을 추가하거나 나중에 끝점을 추가할 수 있습니다.

다음 그림은 공용 및 개인 TCP 포트 80에서 세 대의 가상 컴퓨터 사이에 공유되는 표준(암호화되지 않음) 웹 트래픽의 부하 분산 끝점을 보여 줍니다. 이 세 대의 가상 컴퓨터는 부하 분산 집합에 속합니다.

![부하 분산](./media/load-balancing-vms/LoadBalancing.png)

인터넷 클라이언트가 클라우드 서비스의 공용 IP 주소 및 TCP 포트 80에 웹 페이지 요청을 보내면 부하 분산 장치는 부하 분산 집합에 있는 세 대의 가상 컴퓨터에 임의로 요청을 분산합니다.

Azure 가상 컴퓨터 부하 분산 집합을 만들려면 다음 단계를 따르십시오.

* [1단계: 첫 번째 가상 컴퓨터 만들기](#firstmachine)
* [2단계: 동일한 클라우드 서비스에 추가로 가상 컴퓨터 만들기](#addmachines)
* [3단계: 첫 번째 가상 컴퓨터로 부하 분산 집합 만들기](#loadbalance)
* [4단계: 부하 분산 집합에 가상 컴퓨터 추가](#addtoset)

## <a id="firstmachine"> </a>1단계: 첫 번째 가상 컴퓨터 만들기

아직 로그인하지 않은 경우 [Azure 관리 포털][1]에 로그인합니다. 가상 컴퓨터는 From Gallery 또는 Quick Create 방법을 사용하여 만들 수 있습니다.

* **From Gallery** - **From Gallery** 방법을 사용하면 가상 컴퓨터를 만들 때 끝점을 만들 수 있습니다. 또한 가상 컴퓨터를 만들 때 생성되는 클라우드 서비스의 이름을 지정할 수도 있습니다. 자세한 정보는 [Linux에서 실행되는 가상 컴퓨터 만들기](../virtual-machines-linux-tutorial) 또는 [Windows Server에서 실행되는 가상 컴퓨터 만들기](../virtual-machines-windows-tutorial)를 참조하십시오.

* **Quick Create** - 이미지 갤러리에서 이미지를 선택하고 기본적인 정보를 입력하여 가상 컴퓨터를 만듭니다. 이 방법을 사용하는 경우 가상 컴퓨터를 만든 후에 끝점을 추가해야 하며, 클라우드 서비스에 기본 이름을 사용하게 됩니다. 자세한 내용은 [가상 컴퓨터를 빠르게 만드는 방법](../virtual-machines-quick-create)을 참조하십시오.

**참고**: Quick Create 방법으로 가상 컴퓨터를 만들고 나면 관리 포털의 클라우드 서비스 페이지에 새 클라우드 서비스 이름뿐 아니라 서비스에 대한 여러 정보가 표시됩니다.

## <a id="addmachines"> </a>2단계: 동일한 클라우드 서비스에 추가로 가상 컴퓨터 만들기

From Gallery 방법을 사용하여 동일한 클라우드 서비스에 추가 가상 컴퓨터를 첫 번째 가상 컴퓨터로 만듭니다.

## <a id="loadbalance"> </a>3단계: 첫 번째 가상 컴퓨터로 부하 분산 집합 만들기

1.  Azure 관리 포털에서 **Virtual Machines**를 클릭한 후 첫 번째 가상 컴퓨터의 이름을 클릭합니다.

2.  **끝점**을 클릭한 후 **Add**를 클릭합니다.

3.  Add an endpoint to a virtual machine 페이지에서 오른쪽 화살표를 클릭합니다.

4.  Specify the details of the endpoint 페이지에서 다음을 수행합니다.
    * **이름**에 끝점 이름을 입력하거나 일반 프로토콜용으로 사전 정의된 끝점 목록에서 선택합니다.
    * **Protocol**에서 끝점 유형에 따라 필요한 프로토콜을 TCP 또는 UDP 중에 선택합니다.
    * **Public Port** 및 **Private Port**에 가상 컴퓨터에서 사용할 포트 번호를 필요에 따라
      입력합니다. 가상 컴퓨터에서 개인 포트와 방화벽 규칙을 사용하여 응용 프로그램에 맞추어 트래픽을 리디렉션할 수
      있습니다. 개인 포트는 공용 포트와 같게 설정해도 됩니다. 예를 들어 웹(HTTP) 트래픽의 끝점의 경우 공용 포트와
      개인 포트 모두에 포트 80을 할당할 수 있습니다.
	<p></p>
5.  **Create a load-balanced set**를 선택한 후 오른쪽 화살표를 클릭합니다.

6.  Configure the load-balanced set 페이지에서 부하 분산 집합의 이름을 입력한 후 Azure 부하 분산 장치 프로브 동작의 값을 할당합니다. 부하 분산 장치는 프로브를 사용하여 부하 분산 집합의 가상 컴퓨터가 들어오는 트래픽을 수신할 수 있는지 여부를 결정합니다.

7.  확인 표시를 클릭하여 부하 분산 끝점을 만듭니다. 가상 컴퓨터의 **끝점** 페이지에 있는 **Load-balanced set name** 열에 **예**가 표시됩니다.

## <a id="addtoset"> </a>4단계: 부하 분산 집합에 가상 컴퓨터 추가

부하 분산 집합을 만든 후에 다른 가상 컴퓨터를 집합에 추가합니다. 동일한 클라우드 서비스의 각 가상 컴퓨터에 대해 다음을
수행합니다.

1.  관리 포털에서 **Virtual Machines**를 클릭하고 가상 컴퓨터의 이름을 클릭한 후 **끝점**을 클릭하고 **Add**를 클릭합니다.

2.  Add an endpoint to a virtual machine 페이지에서 **Add endpoint to an existing load-balanced set**를 클릭하고 부하 분산 집합 이름을 선택한 후 오른쪽 화살표를 클릭합니다.

3.  Specify the details of the endpoint 페이지에서 끝점 이름을 입력한 후 확인 표시를 클릭합니다.

<!-- LINKS -->



[1]: http://manage.windowsazure.com